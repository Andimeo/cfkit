
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-743380-5"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-743380-5');
        </script>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="17f23c10261cc6068d8992c224f22902"/>
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01"/>

    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery-1.8.3.js"></script>
    <script type="application/javascript">
        window.locale = "en";
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }

        /* Protection against trailing dot in domain. */
        let hostLength = window.location.host.length;
        if (hostLength > 1 && window.location.host[hostLength - 1] === '.') {
            window.location = window.location.protocol + "//" + window.location.host.substring(0, hostLength - 1);
        }
    </script>

    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="j3">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="//codeforces.org/s/60067/images/codeforces-sponsored-by-ton.png" />
    <link rel="image_src" href="//codeforces.org/s/60067/images/codeforces-sponsored-by-ton.png" />
    <meta property="og:title" content="Problems - Codeforces"/>
    <meta property="og:description" content=""/>
    
    <meta property="og:site_name" content="Codeforces"/>
    
    
    
    
    
    
    <meta name="utc_offset" content="+03:00"/>
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Problems - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community" />
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup" />
    <meta name="robots" content="index, follow" />

    <link rel="stylesheet" href="//codeforces.org/s/60067/css/font-awesome.min.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/line-awesome.min.css" type="text/css" charset="utf-8" />

        <link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>


    <link rel="apple-touch-icon" sizes="57x57" href="//codeforces.org/s/60067/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="//codeforces.org/s/60067/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="//codeforces.org/s/60067/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="//codeforces.org/s/60067/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="//codeforces.org/s/60067/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="//codeforces.org/s/60067/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="//codeforces.org/s/60067/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="//codeforces.org/s/60067/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="//codeforces.org/s/60067/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="//codeforces.org/s/60067/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="//codeforces.org/s/60067/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="//codeforces.org/s/60067/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="//codeforces.org/s/60067/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="//codeforces.org/s/60067/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/prettify.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/clear.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/ttypography.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/problem-statement.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/second-level-menu.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/roundbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/datatable.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/table-form.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/topic.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/jquery.jgrowl.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/facebox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/jquery.wysiwyg.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/jquery.autocomplete.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/codeforces.datepick.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/colorbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/jquery.drafts.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/60067/css/community.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/60067/css/sidebar-menu.css" type="text/css" charset="utf-8" />

    <!-- MathJax -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    MathJax.Hub.Register.StartupHook("End", function () {
        Codeforces.runMathJaxListeners();
    });
    </script>
    <script type="text/javascript" async
            src="https://mathjax.codeforces.org/MathJax.js?config=TeX-AMS_HTML-full"
    >
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="//codeforces.org/s/60067/js/prettify/prettify.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/pushstream.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.easing.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.swipe.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.hotkeys.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/facebox.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/controls/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/controls/wysiwyg.table.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/controls/wysiwyg.image.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/controls/wysiwyg.link.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.datepick.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.drafts.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/clipboard.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/autosize.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/sjcl.js"></script>
    <script type="text/javascript" src="/scripts/68aa7efc4fbbd6282d910ae57877f8bf/en/codeforces-options.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/codeforces.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/EventCatcher.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/preparedVerdictFormats-en.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/confetti.min.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="//codeforces.org/s/60067/markitup/skins/markitup/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/markitup/sets/markdown/style.css" type="text/css" charset="utf-8" />


    <script type="text/javascript" src="//codeforces.org/s/60067/markitup/jquery.markitup.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/markitup/sets/markdown/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->




</head>
<body class=" "><span style='display:none;' class='csrf-token' data-csrf='17f23c10261cc6068d8992c224f22902'>&nbsp;</span>

<!-- .notificationTextCleaner used in Codeforces.showAnnouncements() -->
<div class="notificationTextCleaner" style="font-size: 0"></div>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 3.0rem;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    String.prototype.hashCode = function() {
        var hash = 0, i, chr;
        if (this.length === 0) return hash;
        for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };

    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile === "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>





    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 700
        });
    }, 100);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


    function showAnnouncements(json) {
        //info("j=" + JSON.stringify(json));

        if (json.t != "a") {
            return;
        }

        setTimeout(function() {
            Codeforces.showAnnouncements(json.d, "en");
        }, Math.random() * 500);
    }

    function showEventCatcherUserMessage(json) {
        if (json.t == "s") {
            var points = json.d[5];
            var passedTestCount = json.d[7];
            var judgedTestCount = json.d[8];
            var verdict = preparedVerdictFormats[json.d[12]];
            var verdictPrototypeDiv = $(".verdictPrototypeDiv");
            verdictPrototypeDiv.html(verdict);
            if (judgedTestCount != null && judgedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-judged").text(judgedTestCount);
            }
            if (passedTestCount != null && passedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-passed").text(passedTestCount);
            }
            if (points != null && points != undefined) {
                verdictPrototypeDiv.find(".verdict-format-points").text(points);
            }
            Codeforces.showMessage(verdictPrototypeDiv.text());
        }
    }

    $(".clickable-title").each(function() {
        var title = $(this).attr("data-title");
        if (title) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = title;
            $(this).attr("title", tmp.textContent || tmp.innerText || "");
        }
    });

    $(".clickable-title").click(function() {
        var title = $(this).attr("data-title");
        if (title) {
            Codeforces.alert(title);
        } else {
            Codeforces.alert($(this).attr("title"));
        }
    }).css("position", "relative").css("bottom", "3px");

        Codeforces.showDelayedMessage();

    Codeforces.reformatTimes();

    //Codeforces.initializePubSub();
    if (window.codeforcesOptions.subscribeServerUrl) {
        window.eventCatcher = new EventCatcher(
            window.codeforcesOptions.subscribeServerUrl,
            [
                Codeforces.getGlobalChannel(),
                Codeforces.getUserChannel(),
                Codeforces.getUserShowMessageChannel(),
                Codeforces.getContestChannel(),
                Codeforces.getParticipantChannel(),
                Codeforces.getTalkChannel()
            ]
        );

        if (Codeforces.getParticipantChannel()) {
            window.eventCatcher.subscribe(Codeforces.getParticipantChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getContestChannel()) {
            window.eventCatcher.subscribe(Codeforces.getContestChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getGlobalChannel()) {
            window.eventCatcher.subscribe(Codeforces.getGlobalChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserShowMessageChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserShowMessageChannel(), function(json) {
                showEventCatcherUserMessage(json);
            });
        }
    }

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>


<div id="body">
<div style="width: 950px; margin: 0 auto;" class="compact-problemset">
    <div id="header" style="position: relative; margin: 0;">
        <div style="float:left;">
            <div><a href="/aimtech2017"><img src="//assets.codeforces.com/images/aimtech-logo.png" style="width:180px;"/></a></div>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="//codeforces.org/s/60067/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="//codeforces.org/s/60067/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <br style="clear: both;"/>

    <div style="text-align: center; font-size: 1.8rem; margin-bottom: 0.5em;"
         class="caption">AIM Tech Round 4 (Div. 1)</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

    <div class="problem-frames">
        <div
                    style="margin-bottom: 2em;"
        >

    <style>
        #facebox .content:has(.diff-popup) {
            width: 90vw;
            max-width: 120rem !important;
        }

        .testCaseMarker {
            position: absolute;
            font-weight: bold;
            font-size: 1rem;
        }

        .diff-popup {
            width: 90vw;
            max-width: 120rem !important;
            display: none;
            overflow: auto;
        }

        .input-output-copier {
            font-size: 1.2rem;
            float: right;
            color: #888 !important;
            cursor: pointer;
            border: 1px solid rgb(185, 185, 185);
            padding: 3px;
            margin: 1px;
            line-height: 1.1rem;
            text-transform: none;
        }

        .input-output-copier:hover {
            background-color: #def;
        }

        .test-explanation textarea {
            width: 100%;
            height: 1.5em;
        }

        .pending-submission-message {
            color: darkorange !important;
        }
    </style>
    <script>
        const OPENING_SPACE = String.fromCharCode(1001);
        const CLOSING_SPACE = String.fromCharCode(1002);

        const nodeToText = function (node, pre) {
            let result = [];

            if (node.tagName === "SCRIPT" || node.tagName === "math"
                || (node.classList && node.classList.contains("input-output-copier")))
                return [];

            if (node.tagName === "NOBR") {
                result.push(OPENING_SPACE);
            }

            if (node.nodeType === Node.TEXT_NODE) {
                let s = node.textContent;
                if (!pre) {
                    s = s.replace(/\s+/g, " ");
                }
                if (s.length > 0) {
                    result.push(s);
                }
            }

            if (pre && node.tagName === "BR") {
                result.push("\n");
            }

            node.childNodes.forEach(function (child) {
                result.push(nodeToText(child, node.tagName === "PRE").join(""));
            });

            if (node.tagName === "DIV"
                || node.tagName === "P"
                || node.tagName === "PRE"
                || node.tagName === "UL"
                || node.tagName === "LI"
            ) {
                result.push("\n");
            }

            if (node.tagName === "NOBR") {
                result.push(CLOSING_SPACE);
            }

            return result;
        }

        const isSpecial = function (c) {
            return c === ',' || c === '.' || c === ';' || c === ')' || c === ' ';
        }

        const convertStatementToText = function(statmentNode) {
            const text = nodeToText(statmentNode, false).join("").replace(/ +/g, " ").replace(/\n\n+/g, "\n\n");
            let result = [];
            for (let i = 0; i < text.length; i++) {
                const c = text.charAt(i);
                if (c === OPENING_SPACE) {
                    if (!((i > 0 && text.charAt(i - 1) === '(') || (result.length > 0 && result[result.length - 1] === ' '))) {
                        result.push('+');
                    }
                } else if (c === CLOSING_SPACE) {
                    if (!(i + 1 < text.length && isSpecial(text.charAt(i + 1)))) {
                        result.push('-');
                    }
                } else {
                    result.push(c);
                }
            }
            return result.join("").split("\n").map(value => value.trim()).join("\n");
        };
    </script>
    <div class="diff-popup">
    </div>

<div class="problemindexholder" problemindex="A" data-uuid="ps_4dbe544ea61ac7425f398adbcf47859a445d225e">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A. Sorting by Subsequences</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>You are given a sequence <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>n</i></sub></span> consisting of <span class="tex-font-style-bf">different</span> integers. It is required to split this sequence into the <span class="tex-font-style-bf">maximum</span> number of subsequences such that after sorting integers in each of them in increasing order, the total sequence also will be sorted in increasing order.</p><p>Sorting integers in a subsequence is a process such that the numbers included in a subsequence are ordered in increasing order, and the numbers which are not included in a subsequence don't change their places.</p><p>Every element of the sequence must appear in exactly one subsequence.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of input data contains integer <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup></span>) — the length of the sequence.</p><p>The second line of input data contains <span class="tex-span"><i>n</i></span> different integers <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>n</i></sub></span> (<span class="tex-span"> - 10<sup class="upper-index">9</sup> ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>) — the elements of the sequence. It is guaranteed that all elements of the sequence are distinct.</p></div><div class="output-specification"><div class="section-title">Output</div><p>In the first line print the maximum number of subsequences <span class="tex-span"><i>k</i></span>, which the original sequence can be split into while fulfilling the requirements.</p><p>In the next <span class="tex-span"><i>k</i></span> lines print the description of subsequences in the following format: the number of elements in subsequence <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">0 &lt; <i>c</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i></span>), then <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> integers <span class="tex-span"><i>l</i><sub class="lower-index">1</sub>, <i>l</i><sub class="lower-index">2</sub>, ..., <i>l</i><sub class="lower-index"><i>c</i><sub class="lower-index"><i>i</i></sub></sub></span> (<span class="tex-span">1 ≤ <i>l</i><sub class="lower-index"><i>j</i></sub> ≤ <i>n</i></span>) — indices of these elements in the original sequence. </p><p>Indices could be printed in any order. Every index from <span class="tex-span">1</span> to <span class="tex-span"><i>n</i></span> must appear in output <span class="tex-font-style-bf">exactly once</span>.</p><p>If there are several possible answers, print any of them.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>6<br />3 2 1 6 5 4<br /></pre></div><div class="output"><div class="title">Output</div><pre>4<br />2 1 3<br />1 2<br />2 4 6<br />1 5<br /></pre></div><div class="input"><div class="title">Input</div><pre>6<br />83 -75 -49 11 37 62<br /></pre></div><div class="output"><div class="title">Output</div><pre>1<br />6 1 2 3 4 5 6<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample output:</p><p>After sorting the first subsequence we will get sequence <span class="tex-span">1 2 3 6 5 4</span>.</p><p>Sorting the second subsequence changes nothing.</p><p>After sorting the third subsequence we will get sequence <span class="tex-span">1 2 3 4 5 6</span>.</p><p>Sorting the last subsequence changes nothing.</p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=A]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {
        window.changedTests = new Set();

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");



        String.prototype.replaceAll = function (search, replace) {
            return this.split(search).join(replace);
        };

        $(".sample-test .title").each(function () {
            const preId = ("id" + Math.random()).replaceAll(".", "0");
            const cpyId = ("id" + Math.random()).replaceAll(".", "0");

            $(this).parent().find("pre").attr("id", preId);
            const $copy = $("<div title='Copy' data-clipboard-target='#" + preId + "' id='" + cpyId + "' class='input-output-copier'>Copy</div>");
            $(this).append($copy);

            const clipboard = new Clipboard('#' + cpyId, {
                text: function (trigger) {
                    const pre = document.querySelector('#' + preId);
                    const lines = pre.querySelectorAll(".test-example-line");
                    return Codeforces.filterClipboardText(pre.innerText, lines.length);
                }
            });

            const isInput = $(this).parent().hasClass("input");

            clipboard.on('success', function (e) {
                if (isInput) {
                    Codeforces.showMessage("The example input has been copied into the clipboard");
                } else {
                    Codeforces.showMessage("The example output has been copied into the clipboard");
                }
                e.clearSelection();
            });
        });

        $(".test-form-item input").change(function () {
            addPendingSubmissionMessage($($(this).closest("form")), "You changed the answer, do not forget to submit it if you want to save the changes");
            const index = $(this).closest(".problemindexholder").attr("problemindex");
            let test = "";
            $(this).closest("form input").each(function () {
                const test_ = $(this).attr("name");
                if (test_ && test_.substring(0, 4) === "test") {
                    test = test_;
                }
            });
            if (index.length > 0 && test.length > 0) {
                const indexTest = index + "::" + test;
                window.changedTests.add(indexTest);
            }
        });

        $(window).on('beforeunload', function () {
            if (window.changedTests.size > 0) {
                return 'Dialog text here';
            }
        });

        autosize($('.test-explanation textarea'));

        $(".test-example-line").hover(function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        let top = 1E20;
                        let left = 1E20;
                        let problem = $(this).closest(".problemindexholder");
                        $(this).closest(".input").find("." + clazz).css("background-color", "#FFFDE7").each(function() {
                            top = Math.min(top, $(this).offset().top);
                            left = Math.min(left, $(this).offset().left);
                        });
                        let testCaseMarker = problem.find(".testCaseMarker_" + end);
                        if (testCaseMarker.length === 0) {
                            const html = "<div class=\"testCaseMarker testCaseMarker_" + end + " notice\"></div>";
                            problem.append($(html));
                            testCaseMarker = problem.find(".testCaseMarker_" + end);
                        }
                        if (testCaseMarker) {
                            testCaseMarker.show()
                                    .offset({top, left: left - 20})
                                    .text(end);
                        }
                    }
                }
            });
        }, function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        $("." + clazz).css("background-color", "");
                        $(this).closest(".problemindexholder").find(".testCaseMarker_" + end).hide();
                    }
                }
            });
        });

    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="B" data-uuid="ps_7a615bc7af7c939a1c1eb8a4bf2104257a70ca76">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B. Interactive LowerBound</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p><span class="tex-font-style-it">This is an interactive problem.</span></p><p>You are given a <span class="tex-font-style-bf">sorted</span> in increasing order singly linked list. You should find the minimum integer in the list which is greater than or equal to <span class="tex-span"><i>x</i></span>.</p><p>More formally, there is a singly liked list built on an array of <span class="tex-span"><i>n</i></span> elements. Element with index <span class="tex-span"><i>i</i></span> contains two integers: <span class="tex-span"><i>value</i><sub class="lower-index"><i>i</i></sub></span> is the integer value in this element, and <span class="tex-span"><i>next</i><sub class="lower-index"><i>i</i></sub></span> that is the index of the next element of the singly linked list (or <span class="tex-font-style-tt">-1</span>, if the current element is the last). The list is sorted, i.e. if <span class="tex-span"><i>next</i><sub class="lower-index"><i>i</i></sub> ≠  - 1</span>, then <span class="tex-span"><i>value</i><sub class="lower-index"><i>next</i><sub class="lower-index"><i>i</i></sub></sub> &gt; <i>value</i><sub class="lower-index"><i>i</i></sub></span>.</p><p>You are given the number of elements in the list <span class="tex-span"><i>n</i></span>, the index of the first element <span class="tex-span"><i>start</i></span>, and the integer <span class="tex-span"><i>x</i></span>.</p><p>You can make up to <span class="tex-span">2000</span> queries of the following two types:</p><ul> <li> <span class="tex-font-style-tt">? i</span> (<span class="tex-span">1 ≤ <i>i</i> ≤ <i>n</i></span>) — ask the values <span class="tex-span"><i>value</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>next</i><sub class="lower-index"><i>i</i></sub></span>, </li><li> <span class="tex-font-style-tt">! ans</span> — give the answer for the problem: the minimum integer, greater than or equal to <span class="tex-span"><i>x</i></span>, or <span class="tex-font-style-tt">! -1</span>, if there are no such integers. Your program should terminate after this query. </li></ul><p>Write a program that solves this problem.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains three integers <span class="tex-span"><i>n</i></span>, <span class="tex-span"><i>start</i></span>, <span class="tex-span"><i>x</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 50000</span>, <span class="tex-span">1 ≤ <i>start</i> ≤ <i>n</i></span>, <span class="tex-span">0 ≤ <i>x</i> ≤ 10<sup class="upper-index">9</sup></span>) — the number of elements in the list, the index of the first element and the integer <span class="tex-span"><i>x</i></span>.</p></div><div class="output-specification"><div class="section-title">Output</div><p>To print the answer for the problem, print <span class="tex-font-style-tt">! ans</span>, where <span class="tex-font-style-tt">ans</span> is the minimum integer in the list greater than or equal to <span class="tex-span"><i>x</i></span>, or <span class="tex-font-style-tt">-1</span>, if there is no such integer.</p></div><div><div class="section-title">Interaction</div><p>To make a query of the first type, print <span class="tex-font-style-tt">? i</span> (<span class="tex-span">1 ≤ <i>i</i> ≤ <i>n</i></span>), where <span class="tex-font-style-tt">i</span> is the index of element you want to know information about.</p><p>After each query of type <span class="tex-font-style-tt">?</span> read two integers <span class="tex-span"><i>value</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>next</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">0 ≤ <i>value</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>, <span class="tex-span"> - 1 ≤ <i>next</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i></span>, <span class="tex-span"><i>next</i><sub class="lower-index"><i>i</i></sub> ≠ 0</span>).</p><p>It is guaranteed that if <span class="tex-span"><i>next</i><sub class="lower-index"><i>i</i></sub> ≠  - 1</span>, then <span class="tex-span"><i>value</i><sub class="lower-index"><i>next</i><sub class="lower-index"><i>i</i></sub></sub> &gt; <i>value</i><sub class="lower-index"><i>i</i></sub></span>, and that the array values give a valid singly linked list with <span class="tex-span"><i>start</i></span> being the first element.</p><p>Note that you can't ask more than <span class="tex-span">1999</span> queries of the type <span class="tex-font-style-tt">?</span>.</p><p>If <span class="tex-span"><i>next</i><sub class="lower-index"><i>i</i></sub> =  - 1</span> and <span class="tex-span"><i>value</i><sub class="lower-index"><i>i</i></sub> =  - 1</span>, then it means that you asked more queries than allowed, or asked an invalid query. Your program should immediately terminate (for example, by calling <span class="tex-font-style-tt">exit(0)</span>). You will receive &quot;<span class="tex-font-style-tt">Wrong Answer</span>&quot;, it means that you asked more queries than allowed, or asked an invalid query. If you ignore this, you can get other verdicts since your program will continue to read from a closed stream.</p><p>Your solution will get &quot;Idleness Limit Exceeded&quot;, if you don't print anything or forget to <span class="tex-font-style-tt">flush</span> the output, including the final answer.</p><p>To <span class="tex-font-style-tt">flush</span> you can use (just after printing a query and line end):</p><ul> <li> <span class="tex-font-style-tt">fflush(stdout)</span> in C++; </li><li> <span class="tex-font-style-tt">System.out.flush()</span> in Java; </li><li> <span class="tex-font-style-tt">stdout.flush()</span> in Python; </li><li> <span class="tex-font-style-tt">flush(output)</span> in Pascal; </li><li> For other languages see documentation. </li></ul><p><span><span class="tex-font-style-bf">Hacks format</span></span></p><p>For hacks, use the following format:</p><p>In the first line print three integers <span class="tex-span"><i>n</i></span>, <span class="tex-span"><i>start</i></span>, <span class="tex-span"><i>x</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 50000</span>, <span class="tex-span">1 ≤ <i>start</i> ≤ <i>n</i></span>, <span class="tex-span">0 ≤ <i>x</i> ≤ 10<sup class="upper-index">9</sup></span>).</p><p>In the next <span class="tex-span"><i>n</i></span> lines print the description of the elements of the list: in the <span class="tex-span"><i>i</i></span>-th line print two integers <span class="tex-span"><i>value</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>next</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">0 ≤ <i>value</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>, <span class="tex-span"> - 1 ≤ <i>next</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i></span>, <span class="tex-span"><i>next</i><sub class="lower-index"><i>i</i></sub> ≠ 0</span>).</p><p>The printed structure should be a valid singly linked list. In particular, it should be possible to reach all elements from <span class="tex-span"><i>start</i></span> by following links <span class="tex-span"><i>next</i><sub class="lower-index"><i>i</i></sub></span>, and the last element <span class="tex-span"><i>end</i></span> should have <span class="tex-font-style-tt">-1</span> in the <span class="tex-span"><i>next</i><sub class="lower-index"><i>end</i></sub></span>.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>5 3 80<br />97 -1<br />58 5<br />16 2<br />81 1<br />79 4<br /></pre></div><div class="output"><div class="title">Output</div><pre>? 1<br />? 2<br />? 3<br />? 4<br />? 5<br />! 81</pre></div></div></div><div class="note"><div class="section-title">Note</div><p>You can read more about singly linked list by the following link: <a href="https://en.wikipedia.org/wiki/Linked_list#Singly_linked_list">https://en.wikipedia.org/wiki/Linked_list#Singly_linked_list</a> </p><center><p>The illustration for the first sample case. Start and finish elements are marked dark. <img class="tex-graphics" src="https://espresso.codeforces.com/5202ec3b5e896b7db692ff7b80457c26cf6adb32.png" style="max-width: 100.0%;max-height: 100.0%;" /></p></center></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=B]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="C" data-uuid="ps_e58cbb90860b92e22214b3c471358477a60e74af">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C. Upgrading Tree</div><div class="time-limit"><div class="property-title">time limit per test</div>4 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>512 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>You are given a tree with <span class="tex-span"><i>n</i></span> vertices and you are allowed to perform <span class="tex-font-style-bf">no more than</span> <span class="tex-span">2<i>n</i></span> transformations on it. Transformation is defined by three vertices <span class="tex-span"><i>x</i>, <i>y</i>, <i>y</i>'</span> and consists of deleting edge <span class="tex-span">(<i>x</i>, <i>y</i>)</span> and adding edge <span class="tex-span">(<i>x</i>, <i>y</i>')</span>. Transformation <span class="tex-span"><i>x</i>, <i>y</i>, <i>y</i>'</span> could be performed if all the following conditions are satisfied:</p><ol> <li> There is an edge <span class="tex-span">(<i>x</i>, <i>y</i>)</span> in the current tree. </li><li> After the transformation the graph remains a tree. </li><li> After the deletion of edge <span class="tex-span">(<i>x</i>, <i>y</i>)</span> the tree would consist of two connected components. Let's denote the set of nodes in the component containing vertex <span class="tex-span"><i>x</i></span> by <span class="tex-span"><i>V</i><sub class="lower-index"><i>x</i></sub></span>, and the set of nodes in the component containing vertex <span class="tex-span"><i>y</i></span> by <span class="tex-span"><i>V</i><sub class="lower-index"><i>y</i></sub></span>. Then condition <span class="tex-span">|<i>V</i><sub class="lower-index"><i>x</i></sub>| &gt; |<i>V</i><sub class="lower-index"><i>y</i></sub>|</span> should be satisfied, i.e. the size of the component with <span class="tex-span"><i>x</i></span> should be strictly larger than the size of the component with <span class="tex-span"><i>y</i></span>. </li></ol><p>You should <span class="tex-font-style-bf">minimize</span> the sum of squared distances between all pairs of vertices in a tree, which you could get after no more than <span class="tex-span">2<i>n</i></span> transformations and output any sequence of transformations leading initial tree to such state.</p><p>Note that you don't need to minimize the number of operations. It is necessary to minimize only the sum of the squared distances.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of input contains integer <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 2·10<sup class="upper-index">5</sup></span>) — number of vertices in tree.</p><p>The next <span class="tex-span"><i>n</i> - 1</span> lines of input contains integers <span class="tex-span"><i>a</i></span> and <span class="tex-span"><i>b</i></span> (<span class="tex-span">1 ≤ <i>a</i>, <i>b</i> ≤ <i>n</i>, <i>a</i> ≠ <i>b</i></span>) — the descriptions of edges. It is guaranteed that the given edges form a tree.</p></div><div class="output-specification"><div class="section-title">Output</div><p>In the first line output integer <span class="tex-span"><i>k</i></span> (<span class="tex-span">0 ≤ <i>k</i> ≤ 2<i>n</i></span>) — the number of transformations from your example, <span class="tex-font-style-bf">minimizing</span> sum of squared distances between all pairs of vertices.</p><p>In each of the next <span class="tex-span"><i>k</i></span> lines output three integers <span class="tex-span"><i>x</i>, <i>y</i>, <i>y</i>'</span> — indices of vertices from the corresponding transformation.</p><p>Transformations with <span class="tex-span"><i>y</i> = <i>y</i>'</span> are allowed (even though they don't change tree) if transformation conditions are satisfied.</p><p>If there are several possible answers, print any of them.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3<br />3 2<br />1 3<br /></pre></div><div class="output"><div class="title">Output</div><pre>0<br /></pre></div><div class="input"><div class="title">Input</div><pre>7<br />1 2<br />2 3<br />3 4<br />4 5<br />5 6<br />6 7<br /></pre></div><div class="output"><div class="title">Output</div><pre>2<br />4 3 2<br />4 5 6</pre></div></div></div><div class="note"><div class="section-title">Note</div><center><p>This is a picture for the second sample. Added edges are dark, deleted edges are dotted.</p><p><img class="tex-graphics" src="https://espresso.codeforces.com/e673f9bdb501a0674ec4a21da846eef00abe1aaf.png" style="max-width: 100.0%;max-height: 100.0%;" /></p></center></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=C]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="D" data-uuid="ps_5e78efe33c6b14457631240ad86fe9b1784720bb">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. Dynamic Shortest Path</div><div class="time-limit"><div class="property-title">time limit per test</div>10 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>512 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>You are given a weighted directed graph, consisting of <span class="tex-span"><i>n</i></span> vertices and <span class="tex-span"><i>m</i></span> edges. You should answer <span class="tex-span"><i>q</i></span> queries of two types:</p><ul> <li> <span class="tex-font-style-tt">1 v</span> — find the length of shortest path from vertex <span class="tex-span">1</span> to vertex <span class="tex-span"><i>v</i></span>. </li><li> <span class="tex-font-style-tt">2 c <span class="tex-span"><i>l</i><sub class="lower-index">1</sub> <i>l</i><sub class="lower-index">2</sub> ... <i>l</i><sub class="lower-index"><i>c</i></sub></span></span> — add <span class="tex-span">1</span> to weights of edges with indices <span class="tex-span"><i>l</i><sub class="lower-index">1</sub>, <i>l</i><sub class="lower-index">2</sub>, ..., <i>l</i><sub class="lower-index"><i>c</i></sub></span>. </li></ul></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of input data contains integers <span class="tex-span"><i>n</i></span>, <span class="tex-span"><i>m</i></span>, <span class="tex-span"><i>q</i></span> (<span class="tex-span">1 ≤ <i>n</i>, <i>m</i> ≤ 10<sup class="upper-index">5</sup></span>, <span class="tex-span">1 ≤ <i>q</i> ≤ 2000</span>) — the number of vertices and edges in the graph, and the number of requests correspondingly.</p><p>Next <span class="tex-span"><i>m</i></span> lines of input data contain the descriptions of edges: <span class="tex-span"><i>i</i></span>-th of them contains description of edge with index <span class="tex-span"><i>i</i></span> — three integers <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i></span>, <span class="tex-span">0 ≤ <i>c</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>) — the beginning and the end of edge, and its initial weight correspondingly.</p><p>Next <span class="tex-span"><i>q</i></span> lines of input data contain the description of edges in the format described above (<span class="tex-span">1 ≤ <i>v</i> ≤ <i>n</i></span>, <span class="tex-span">1 ≤ <i>l</i><sub class="lower-index"><i>j</i></sub> ≤ <i>m</i></span>). It's guaranteed that inside single query all <span class="tex-span"><i>l</i><sub class="lower-index"><i>j</i></sub></span> are distinct. Also, it's guaranteed that a total number of edges in all requests of the second type does not exceed <span class="tex-span">10<sup class="upper-index">6</sup></span>.</p></div><div class="output-specification"><div class="section-title">Output</div><p>For each query of first type print the length of the shortest path from <span class="tex-span">1</span> to <span class="tex-span"><i>v</i></span> in a separate line. Print <span class="tex-font-style-tt">-1</span>, if such path does not exists.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3 2 9<br />1 2 0<br />2 3 0<br />2 1 2<br />1 3<br />1 2<br />2 1 1<br />1 3<br />1 2<br />2 2 1 2<br />1 3<br />1 2<br /></pre></div><div class="output"><div class="title">Output</div><pre>1<br />0<br />2<br />1<br />4<br />2<br /></pre></div><div class="input"><div class="title">Input</div><pre>5 4 9<br />2 3 1<br />2 4 1<br />3 4 1<br />1 2 0<br />1 5<br />1 4<br />2 1 2<br />2 1 2<br />1 4<br />2 2 1 3<br />1 4<br />2 1 4<br />1 4<br /></pre></div><div class="output"><div class="title">Output</div><pre>-1<br />1<br />2<br />3<br />4<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><center><p>The description of changes of the graph in the first sample case:</p><p><img class="tex-graphics" src="https://espresso.codeforces.com/aeb5751e557f6f6158f15919da64eee550146483.png" style="max-width: 100.0%;max-height: 100.0%;" /></p><p>The description of changes of the graph in the second sample case:</p><p><img class="tex-graphics" src="https://espresso.codeforces.com/5d4325fe06b5b55945d91d26c757ff5c9bdfbca1.png" style="max-width: 100.0%;max-height: 100.0%;" /></p></center></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=D]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 1em;"
        >


<div class="problemindexholder" problemindex="E" data-uuid="ps_1dcc64f5060e4e4c95097cf0a2f6a6ea95a8eb5b">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. Maximum Flow</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>You are given a directed graph, consisting of <span class="tex-span"><i>n</i></span> vertices and <span class="tex-span"><i>m</i></span> edges. The vertices <span class="tex-span"><i>s</i></span> and <span class="tex-span"><i>t</i></span> are marked as source and sink correspondingly. Additionally, there are no edges ending at <span class="tex-span"><i>s</i></span> and there are no edges beginning in <span class="tex-span"><i>t</i></span>.</p><p>The graph was constructed in a following way: initially each edge had capacity <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub> &gt; 0</span>. A maximum flow with source at <span class="tex-span"><i>s</i></span> and sink at <span class="tex-span"><i>t</i></span> was constructed in this flow network. Let's denote <span class="tex-span"><i>f</i><sub class="lower-index"><i>i</i></sub></span> as the value of flow passing through edge with index <span class="tex-span"><i>i</i></span>. Next, all capacities <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> and flow value <span class="tex-span"><i>f</i><sub class="lower-index"><i>i</i></sub></span> were erased. Instead, indicators <span class="tex-span"><i>g</i><sub class="lower-index"><i>i</i></sub></span> were written on edges — if flow value passing through edge <span class="tex-span"><i>i</i></span> was positive, i.e. <span class="tex-span">1</span> if <span class="tex-span"><i>f</i><sub class="lower-index"><i>i</i></sub> &gt; 0</span> and <span class="tex-span">0</span> otherwise.</p><p>Using the graph and values <span class="tex-span"><i>g</i><sub class="lower-index"><i>i</i></sub></span>, find out what is the <span class="tex-font-style-bf">minimum</span> possible number of edges in the initial flow network that could be saturated (the passing flow is equal to capacity, i.e. <span class="tex-span"><i>f</i><sub class="lower-index"><i>i</i></sub> = <i>c</i><sub class="lower-index"><i>i</i></sub></span>). Also construct the corresponding flow network with maximum flow in it.</p><p>A flow in directed graph is described by flow values <span class="tex-span"><i>f</i><sub class="lower-index"><i>i</i></sub></span> on each of the edges so that the following conditions are satisfied: </p><ul> <li> for each vertex, except source and sink, total incoming flow and total outcoming flow are equal, </li><li> for each edge <span class="tex-span">0 ≤ <i>f</i><sub class="lower-index"><i>i</i></sub> ≤ <i>c</i><sub class="lower-index"><i>i</i></sub></span> </li></ul><p>A flow is maximum if the difference between the sum of flow values on edges from the source, and the sum of flow values on edges to the source (there are no such in this problem), is maximum possible.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of input data contains four positive integers <span class="tex-span"><i>n</i>, <i>m</i>, <i>s</i>, <i>t</i></span> (<span class="tex-span">2 ≤ <i>n</i> ≤ 100</span>, <span class="tex-span">1 ≤ <i>m</i> ≤ 1000</span>, <span class="tex-span">1 ≤ <i>s</i>, <i>t</i> ≤ <i>n</i></span>, <span class="tex-span"><i>s</i> ≠ <i>t</i></span>) — the number of vertices, the number of edges, index of source vertex and index of sink vertex correspondingly.</p><p>Each of next <span class="tex-span"><i>m</i></span> lines of input data contain non-negative integers <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>g</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>u</i><sub class="lower-index"><i>i</i></sub>, <i>v</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i></span>, <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/d7c46b18c5ed3cbbf7f593217f7473a75df5a335.png" style="max-width: 100.0%;max-height: 100.0%;" />) — the beginning of edge <span class="tex-span"><i>i</i></span>, the end of edge <span class="tex-span"><i>i</i></span> and indicator, which equals to <span class="tex-span">1</span> if flow value passing through edge <span class="tex-span"><i>i</i></span> was positive and <span class="tex-span">0</span> if not.</p><p>It's guaranteed that no edge connects vertex with itself. Also it's guaranteed that there are no more than one edge between each ordered pair of vertices and that there exists at least one network flow that satisfies all the constrains from input data.</p></div><div class="output-specification"><div class="section-title">Output</div><p>In the first line print single non-negative integer <span class="tex-span"><i>k</i></span> — minimum number of edges, which should be saturated in maximum flow.</p><p>In each of next <span class="tex-span"><i>m</i></span> lines print two integers <span class="tex-span"><i>f</i><sub class="lower-index"><i>i</i></sub>, <i>c</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>c</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>, <span class="tex-span">0 ≤ <i>f</i><sub class="lower-index"><i>i</i></sub> ≤ <i>c</i><sub class="lower-index"><i>i</i></sub></span>) — the flow value passing through edge <span class="tex-span"><i>i</i></span> and capacity of edge <span class="tex-span"><i>i</i></span>. </p><p>This data should form a correct maximum flow in flow network. Also there must be exactly <span class="tex-span"><i>k</i></span> edges with statement <span class="tex-span"><i>f</i><sub class="lower-index"><i>i</i></sub> = <i>c</i><sub class="lower-index"><i>i</i></sub></span> satisfied. Also statement <span class="tex-span"><i>f</i><sub class="lower-index"><i>i</i></sub> &gt; 0</span> must be true if and only if <span class="tex-span"><i>g</i><sub class="lower-index"><i>i</i></sub> = 1</span>.</p><p>If there are several possible answers, print any of them.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>5 6 1 5<br />1 2 1<br />2 3 1<br />3 5 1<br />1 4 1<br />4 3 0<br />4 5 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>2<br />3 3<br />3 8<br />3 4<br />4 4<br />0 5<br />4 9<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><center><p>The illustration for second sample case. The saturated edges are marked dark, while edges with <span class="tex-span"><i>g</i><sub class="lower-index"><i>i</i></sub> = 0</span> are marked with dotted line. The integer on edge is the index of this edge in input list. <img class="tex-graphics" src="https://espresso.codeforces.com/a80cb6067d5d58458863f416f6ac95ad991a308a.png" style="max-width: 100.0%;max-height: 100.0%;" /></p></center></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=E]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
    </div>

    <div id="footer">
        <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2024 Mike Mirzayanov</div>
        <div>The only programming contests Web 2.0 platform</div>

    </div>

</div>
</div>
    <script type="application/javascript">
        if ('serviceWorker' in navigator && 'fetch' in window && 'caches' in window) {
            navigator.serviceWorker.register('/service-worker-60067.js')
                .then(function (registration) {
                    console.log('Service worker registered: ', registration);
                })
                .catch(function (error) {
                    console.log('Registration failed: ', error);
                });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8a0f689ed85a7782',t:'MTcyMDYwMjUwMS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

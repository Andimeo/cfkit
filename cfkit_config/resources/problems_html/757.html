
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-743380-5"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-743380-5');
        </script>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="a81b5dab949ba25a4fa07b1011610eaa"/>
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01"/>

    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery-1.8.3.js"></script>
    <script type="application/javascript">
        window.locale = "en";
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }

        /* Protection against trailing dot in domain. */
        let hostLength = window.location.host.length;
        if (hostLength > 1 && window.location.host[hostLength - 1] === '.') {
            window.location = window.location.protocol + "//" + window.location.host.substring(0, hostLength - 1);
        }
    </script>

    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="k2">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="//codeforces.org/s/82867/images/codeforces-sponsored-by-ton.png" />
    <link rel="image_src" href="//codeforces.org/s/82867/images/codeforces-sponsored-by-ton.png" />
    <meta property="og:title" content="Problems - Codeforces"/>
    <meta property="og:description" content=""/>
    
    <meta property="og:site_name" content="Codeforces"/>
    
    
    
    
    
    
    <meta name="utc_offset" content="+03:00"/>
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Problems - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community" />
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup" />
    <meta name="robots" content="index, follow" />

    <link rel="stylesheet" href="//codeforces.org/s/82867/css/font-awesome.min.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/line-awesome.min.css" type="text/css" charset="utf-8" />

        <link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>


    <link rel="apple-touch-icon" sizes="57x57" href="//codeforces.org/s/82867/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="//codeforces.org/s/82867/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="//codeforces.org/s/82867/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="//codeforces.org/s/82867/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="//codeforces.org/s/82867/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="//codeforces.org/s/82867/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="//codeforces.org/s/82867/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="//codeforces.org/s/82867/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="//codeforces.org/s/82867/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="//codeforces.org/s/82867/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="//codeforces.org/s/82867/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="//codeforces.org/s/82867/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="//codeforces.org/s/82867/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="//codeforces.org/s/82867/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/prettify.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/clear.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/ttypography.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/problem-statement.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/second-level-menu.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/roundbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/datatable.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/table-form.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/topic.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/jquery.jgrowl.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/facebox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/jquery.wysiwyg.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/jquery.autocomplete.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/codeforces.datepick.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/colorbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/jquery.drafts.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/82867/css/community.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/82867/css/sidebar-menu.css" type="text/css" charset="utf-8" />

    <!-- MathJax -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    MathJax.Hub.Register.StartupHook("End", function () {
        Codeforces.runMathJaxListeners();
    });
    </script>
    <script type="text/javascript" async
            src="https://mathjax.codeforces.org/MathJax.js?config=TeX-AMS_HTML-full"
    >
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="//codeforces.org/s/82867/js/prettify/prettify.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/pushstream.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.easing.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.swipe.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.hotkeys.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/facebox.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/controls/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/controls/wysiwyg.table.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/controls/wysiwyg.image.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/controls/wysiwyg.link.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.datepick.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.drafts.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/clipboard.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/autosize.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/sjcl.js"></script>
    <script type="text/javascript" src="/scripts/aceaa6ea286fe931bca570a1bb55e620/en/codeforces-options.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/codeforces.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/EventCatcher.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/preparedVerdictFormats-en.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/confetti.min.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="//codeforces.org/s/82867/markitup/skins/markitup/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/markitup/sets/markdown/style.css" type="text/css" charset="utf-8" />


    <script type="text/javascript" src="//codeforces.org/s/82867/markitup/jquery.markitup.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/markitup/sets/markdown/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->




</head>
<body class=" "><span style='display:none;' class='csrf-token' data-csrf='a81b5dab949ba25a4fa07b1011610eaa'>&nbsp;</span>

<!-- .notificationTextCleaner used in Codeforces.showAnnouncements() -->
<div class="notificationTextCleaner" style="font-size: 0"></div>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 3.0rem;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    String.prototype.hashCode = function() {
        var hash = 0, i, chr;
        if (this.length === 0) return hash;
        for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };

    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile === "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>





    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 700
        });
    }, 100);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


    function showAnnouncements(json) {
        //info("j=" + JSON.stringify(json));

        if (json.t != "a") {
            return;
        }

        setTimeout(function() {
            Codeforces.showAnnouncements(json.d, "en");
        }, Math.random() * 500);
    }

    function showEventCatcherUserMessage(json) {
        if (json.t == "s") {
            var points = json.d[5];
            var passedTestCount = json.d[7];
            var judgedTestCount = json.d[8];
            var verdict = preparedVerdictFormats[json.d[12]];
            var verdictPrototypeDiv = $(".verdictPrototypeDiv");
            verdictPrototypeDiv.html(verdict);
            if (judgedTestCount != null && judgedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-judged").text(judgedTestCount);
            }
            if (passedTestCount != null && passedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-passed").text(passedTestCount);
            }
            if (points != null && points != undefined) {
                verdictPrototypeDiv.find(".verdict-format-points").text(points);
            }
            Codeforces.showMessage(verdictPrototypeDiv.text());
        }
    }

    $(".clickable-title").each(function() {
        var title = $(this).attr("data-title");
        if (title) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = title;
            $(this).attr("title", tmp.textContent || tmp.innerText || "");
        }
    });

    $(".clickable-title").click(function() {
        var title = $(this).attr("data-title");
        if (title) {
            Codeforces.alert(title);
        } else {
            Codeforces.alert($(this).attr("title"));
        }
    }).css("position", "relative").css("bottom", "3px");

        Codeforces.showDelayedMessage();

    Codeforces.reformatTimes();

    //Codeforces.initializePubSub();
    if (window.codeforcesOptions.subscribeServerUrl) {
        window.eventCatcher = new EventCatcher(
            window.codeforcesOptions.subscribeServerUrl,
            [
                Codeforces.getGlobalChannel(),
                Codeforces.getUserChannel(),
                Codeforces.getUserShowMessageChannel(),
                Codeforces.getContestChannel(),
                Codeforces.getParticipantChannel(),
                Codeforces.getTalkChannel()
            ]
        );

        if (Codeforces.getParticipantChannel()) {
            window.eventCatcher.subscribe(Codeforces.getParticipantChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getContestChannel()) {
            window.eventCatcher.subscribe(Codeforces.getContestChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getGlobalChannel()) {
            window.eventCatcher.subscribe(Codeforces.getGlobalChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserShowMessageChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserShowMessageChannel(), function(json) {
                showEventCatcherUserMessage(json);
            });
        }
    }

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>


<div id="body">
<div style="width: 950px; margin: 0 auto;" class="compact-problemset">
    <div id="header" style="position: relative; margin: 0;">
        <div style="float:left;">
                  <a href="/"><img height="65" style="height: 65px;" src="//codeforces.org/s/82867/images/codeforces-sponsored-by-ton.png" alt="Codeforces"/></a>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="//codeforces.org/s/82867/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="//codeforces.org/s/82867/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <br style="clear: both;"/>

    <div style="text-align: center; font-size: 1.8rem; margin-bottom: 0.5em;"
         class="caption">Codecraft-17 and Codeforces Round 391 (Div. 1 + Div. 2, combined)</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

    <div class="problem-frames">
        <div
                    style="margin-bottom: 2em;"
        >

    <style>
        #facebox .content:has(.diff-popup) {
            width: 90vw;
            max-width: 120rem !important;
        }

        .testCaseMarker {
            position: absolute;
            font-weight: bold;
            font-size: 1rem;
        }

        .diff-popup {
            width: 90vw;
            max-width: 120rem !important;
            display: none;
            overflow: auto;
        }

        .input-output-copier {
            font-size: 1.2rem;
            float: right;
            color: #888 !important;
            cursor: pointer;
            border: 1px solid rgb(185, 185, 185);
            padding: 3px;
            margin: 1px;
            line-height: 1.1rem;
            text-transform: none;
        }

        .input-output-copier:hover {
            background-color: #def;
        }

        .test-explanation textarea {
            width: 100%;
            height: 1.5em;
        }

        .pending-submission-message {
            color: darkorange !important;
        }
    </style>
    <script>
        const OPENING_SPACE = String.fromCharCode(1001);
        const CLOSING_SPACE = String.fromCharCode(1002);

        const nodeToText = function (node, pre) {
            let result = [];

            if (node.tagName === "SCRIPT" || node.tagName === "math"
                || (node.classList && node.classList.contains("input-output-copier")))
                return [];

            if (node.tagName === "NOBR") {
                result.push(OPENING_SPACE);
            }

            if (node.nodeType === Node.TEXT_NODE) {
                let s = node.textContent;
                if (!pre) {
                    s = s.replace(/\s+/g, " ");
                }
                if (s.length > 0) {
                    result.push(s);
                }
            }

            if (pre && node.tagName === "BR") {
                result.push("\n");
            }

            node.childNodes.forEach(function (child) {
                result.push(nodeToText(child, node.tagName === "PRE").join(""));
            });

            if (node.tagName === "DIV"
                || node.tagName === "P"
                || node.tagName === "PRE"
                || node.tagName === "UL"
                || node.tagName === "LI"
            ) {
                result.push("\n");
            }

            if (node.tagName === "NOBR") {
                result.push(CLOSING_SPACE);
            }

            return result;
        }

        const isSpecial = function (c) {
            return c === ',' || c === '.' || c === ';' || c === ')' || c === ' ';
        }

        const convertStatementToText = function(statmentNode) {
            const text = nodeToText(statmentNode, false).join("").replace(/ +/g, " ").replace(/\n\n+/g, "\n\n");
            let result = [];
            for (let i = 0; i < text.length; i++) {
                const c = text.charAt(i);
                if (c === OPENING_SPACE) {
                    if (!((i > 0 && text.charAt(i - 1) === '(') || (result.length > 0 && result[result.length - 1] === ' '))) {
                        result.push('+');
                    }
                } else if (c === CLOSING_SPACE) {
                    if (!(i + 1 < text.length && isSpecial(text.charAt(i + 1)))) {
                        result.push('-');
                    }
                } else {
                    result.push(c);
                }
            }
            return result.join("").split("\n").map(value => value.trim()).join("\n");
        };
    </script>
    <div class="diff-popup">
    </div>

<div class="problemindexholder" problemindex="A" data-uuid="ps_6808074af96a9007ab3c5bde77a95338d7871fff">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A. Gotta Catch Em' All!</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Bash wants to become a Pokemon master one day. Although he liked a lot of Pokemon, he has always been fascinated by Bulbasaur the most. Soon, things started getting serious and his fascination turned into an obsession. Since he is too young to go out and catch Bulbasaur, he came up with his own way of catching a Bulbasaur.</p><p>Each day, he takes the front page of the newspaper. He cuts out the letters one at a time, from anywhere on the front page of the newspaper to form the word <span class="tex-font-style-tt">&quot;Bulbasaur&quot;</span> (without quotes) and sticks it on his wall. Bash is very particular about case — the first letter of <span class="tex-font-style-tt">&quot;Bulbasaur&quot;</span> must be upper case and the rest must be lower case. By doing this he thinks he has caught one Bulbasaur. He then repeats this step on the left over part of the newspaper. He keeps doing this until it is not possible to form the word <span class="tex-font-style-tt">&quot;Bulbasaur&quot;</span> from the newspaper.</p><p>Given the text on the front page of the newspaper, can you tell how many Bulbasaurs he will catch today?</p><p>Note: <span class="tex-font-style-bf">uppercase and lowercase letters are considered different.</span></p></div><div class="input-specification"><div class="section-title">Input</div><p>Input contains a single line containing a string <span class="tex-span"><i>s</i></span> (<span class="tex-span">1  ≤  |<i>s</i>|  ≤  10<sup class="upper-index">5</sup></span>) — the text on the front page of the newspaper without spaces and punctuation marks. <span class="tex-span">|<i>s</i>|</span> is the length of the string <span class="tex-span"><i>s</i></span>.</p><p>The string <span class="tex-span"><i>s</i></span> contains lowercase and uppercase English letters, i.e. <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/927e573ae77bcc049bc41fe8c3a0e981a45e9cd2.png" style="max-width: 100.0%;max-height: 100.0%;" />.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Output a single integer, the answer to the problem.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>Bulbbasaur<br /></pre></div><div class="output"><div class="title">Output</div><pre>1<br /></pre></div><div class="input"><div class="title">Input</div><pre>F<br /></pre></div><div class="output"><div class="title">Output</div><pre>0<br /></pre></div><div class="input"><div class="title">Input</div><pre>aBddulbasaurrgndgbualdBdsagaurrgndbb<br /></pre></div><div class="output"><div class="title">Output</div><pre>2<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first case, you could pick: <span class="tex-font-style-tt"><span class="tex-font-style-bf">Bulb</span>b<span class="tex-font-style-bf">asaur</span></span>.</p><p>In the second case, there is no way to pick even a single Bulbasaur.</p><p>In the third case, you can rearrange the string to <span class="tex-font-style-tt"><span class="tex-font-style-bf">BulbasaurBulbasaur</span>addrgndgddgargndbb</span> to get two words &quot;<span class="tex-font-style-tt">Bulbasaur</span>&quot;.</p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=A]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/82867");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {
        window.changedTests = new Set();

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");



        String.prototype.replaceAll = function (search, replace) {
            return this.split(search).join(replace);
        };

        $(".sample-test .title").each(function () {
            const preId = ("id" + Math.random()).replaceAll(".", "0");
            const cpyId = ("id" + Math.random()).replaceAll(".", "0");

            $(this).parent().find("pre").attr("id", preId);
            const $copy = $("<div title='Copy' data-clipboard-target='#" + preId + "' id='" + cpyId + "' class='input-output-copier'>Copy</div>");
            $(this).append($copy);

            const clipboard = new Clipboard('#' + cpyId, {
                text: function (trigger) {
                    const pre = document.querySelector('#' + preId);
                    const lines = pre.querySelectorAll(".test-example-line");
                    return Codeforces.filterClipboardText(pre.innerText, lines.length);
                }
            });

            const isInput = $(this).parent().hasClass("input");

            clipboard.on('success', function (e) {
                if (isInput) {
                    Codeforces.showMessage("The example input has been copied into the clipboard");
                } else {
                    Codeforces.showMessage("The example output has been copied into the clipboard");
                }
                e.clearSelection();
            });
        });

        $(".test-form-item input").change(function () {
            addPendingSubmissionMessage($($(this).closest("form")), "You changed the answer, do not forget to submit it if you want to save the changes");
            const index = $(this).closest(".problemindexholder").attr("problemindex");
            let test = "";
            $(this).closest("form input").each(function () {
                const test_ = $(this).attr("name");
                if (test_ && test_.substring(0, 4) === "test") {
                    test = test_;
                }
            });
            if (index.length > 0 && test.length > 0) {
                const indexTest = index + "::" + test;
                window.changedTests.add(indexTest);
            }
        });

        $(window).on('beforeunload', function () {
            if (window.changedTests.size > 0) {
                return 'Dialog text here';
            }
        });

        autosize($('.test-explanation textarea'));

        $(".test-example-line").hover(function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        let top = 1E20;
                        let left = 1E20;
                        let problem = $(this).closest(".problemindexholder");
                        $(this).closest(".input").find("." + clazz).css("background-color", "#FFFDE7").each(function() {
                            top = Math.min(top, $(this).offset().top);
                            left = Math.min(left, $(this).offset().left);
                        });
                        let testCaseMarker = problem.find(".testCaseMarker_" + end);
                        if (testCaseMarker.length === 0) {
                            const html = "<div class=\"testCaseMarker testCaseMarker_" + end + " notice\"></div>";
                            problem.append($(html));
                            testCaseMarker = problem.find(".testCaseMarker_" + end);
                        }
                        if (testCaseMarker) {
                            testCaseMarker.show()
                                    .offset({top, left: left - 20})
                                    .text(end);
                        }
                    }
                }
            });
        }, function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        $("." + clazz).css("background-color", "");
                        $(this).closest(".problemindexholder").find(".testCaseMarker_" + end).hide();
                    }
                }
            });
        });

    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="B" data-uuid="ps_190d69e21388e1047708c006f366944ab9416164">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B. Bash's Big Day</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>512 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Bash has set out on a journey to become the greatest Pokemon master. To get his first Pokemon, he went to Professor Zulu's Lab. Since Bash is Professor Zulu's favourite student, Zulu allows him to take as many Pokemon from his lab as he pleases.</p><p>But Zulu warns him that a group of <span class="tex-span"><i>k</i> &gt; 1</span> Pokemon with strengths <span class="tex-span">{<i>s</i><sub class="lower-index">1</sub>, <i>s</i><sub class="lower-index">2</sub>, <i>s</i><sub class="lower-index">3</sub>, ..., <i>s</i><sub class="lower-index"><i>k</i></sub>}</span> tend to fight among each other if <span class="tex-span"><i>gcd</i>(<i>s</i><sub class="lower-index">1</sub>, <i>s</i><sub class="lower-index">2</sub>, <i>s</i><sub class="lower-index">3</sub>, ..., <i>s</i><sub class="lower-index"><i>k</i></sub>) = 1</span> (see notes for <span class="tex-span"><i>gcd</i></span> definition).</p><p>Bash, being smart, does not want his Pokemon to fight among each other. However, he also wants to maximize the number of Pokemon he takes from the lab. Can you help Bash find out the maximum number of Pokemon he can take? </p><p><span class="tex-font-style-bf">Note</span>: A Pokemon cannot fight with itself.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The input consists of two lines.</p><p>The first line contains an integer <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup></span>), the number of Pokemon in the lab.</p><p>The next line contains <span class="tex-span"><i>n</i></span> space separated integers, where the <span class="tex-span"><i>i</i></span>-th of them denotes <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>s</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">5</sup></span>), the strength of the <span class="tex-span"><i>i</i></span>-th Pokemon.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print single integer — the maximum number of Pokemons Bash can take.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3<br />2 3 4<br /></pre></div><div class="output"><div class="title">Output</div><pre>2<br /></pre></div><div class="input"><div class="title">Input</div><pre>5<br />2 3 4 6 7<br /></pre></div><div class="output"><div class="title">Output</div><pre>3<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p><span class="tex-span"><i>gcd</i></span> (greatest common divisor) of positive integers set <span class="tex-span">{<i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>n</i></sub>}</span> is the maximum positive integer that divides all the integers <span class="tex-span">{<i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>n</i></sub>}</span>.</p><p>In the first sample, we can take Pokemons with strengths <span class="tex-span">{2, 4}</span> since <span class="tex-span"><i>gcd</i>(2, 4) = 2</span>.</p><p>In the second sample, we can take Pokemons with strengths <span class="tex-span">{2, 4, 6}</span>, and there is no larger group with <span class="tex-span"><i>gcd</i> ≠ 1</span>.</p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=B]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/82867");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="C" data-uuid="ps_701305f034cd440201c176154da56d026c764246">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C. Felicity is Coming!</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>It's that time of the year, Felicity is around the corner and you can see people celebrating all around the Himalayan region. The Himalayan region has <span class="tex-span"><i>n</i></span> gyms. The <span class="tex-span"><i>i</i></span>-th gym has <span class="tex-span"><i>g</i><sub class="lower-index"><i>i</i></sub></span> Pokemon in it. There are <span class="tex-span"><i>m</i></span> distinct Pokemon types in the Himalayan region numbered from <span class="tex-span">1</span> to <span class="tex-span"><i>m</i></span>. There is a special evolution camp set up in the fest which claims to evolve any Pokemon. The type of a Pokemon could change after evolving, subject to the constraint that if two Pokemon have the same type before evolving, they will have the same type after evolving. Also, if two Pokemon have different types before evolving, they will have different types after evolving. It is also possible that a Pokemon has the same type before and after evolving. </p><p>Formally, an <span class="tex-font-style-it">evolution plan</span> is a permutation <span class="tex-span"><i>f</i></span> of <span class="tex-span">{1, 2, ..., <i>m</i>}</span>, such that <span class="tex-span"><i>f</i>(<i>x</i>) = <i>y</i></span> means that a Pokemon of type <span class="tex-span"><i>x</i></span> evolves into a Pokemon of type <span class="tex-span"><i>y</i></span>.</p><p>The gym leaders are intrigued by the special evolution camp and all of them plan to evolve their Pokemons. The protocol of the mountain states that in each gym, for every type of Pokemon, the number of Pokemon of that type before evolving any Pokemon should be equal the number of Pokemon of that type after evolving all the Pokemons according to the evolution plan. They now want to find out how many distinct <span class="tex-font-style-it">evolution plans</span> exist which satisfy the protocol.</p><p>Two evolution plans <span class="tex-span"><i>f</i><sub class="lower-index">1</sub></span> and <span class="tex-span"><i>f</i><sub class="lower-index">2</sub></span> are distinct, if they have at least one Pokemon type evolving into a different Pokemon type in the two plans, i. e. there exists an <span class="tex-span"><i>i</i></span> such that <span class="tex-span"><i>f</i><sub class="lower-index">1</sub>(<i>i</i>) ≠ <i>f</i><sub class="lower-index">2</sub>(<i>i</i>)</span>.</p><p>Your task is to find how many distinct <span class="tex-font-style-it">evolution plans</span> are possible such that if all Pokemon in all the gyms are evolved, the number of Pokemon of each type in each of the gyms remains the same. As the answer can be large, output it modulo <span class="tex-span">10<sup class="upper-index">9</sup> + 7</span>.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains two integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>m</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup></span>, <span class="tex-span">1 ≤ <i>m</i> ≤ 10<sup class="upper-index">6</sup></span>) — the number of gyms and the number of Pokemon types.</p><p>The next <span class="tex-span"><i>n</i></span> lines contain the description of Pokemons in the gyms. The <span class="tex-span"><i>i</i></span>-th of these lines begins with the integer <span class="tex-span"><i>g</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>g</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">5</sup></span>) — the number of Pokemon in the <span class="tex-span"><i>i</i></span>-th gym. After that <span class="tex-span"><i>g</i><sub class="lower-index"><i>i</i></sub></span> integers follow, denoting types of the Pokemons in the <span class="tex-span"><i>i</i></span>-th gym. Each of these integers is between <span class="tex-span">1</span> and <span class="tex-span"><i>m</i></span>.</p><p>The total number of Pokemons (the sum of all <span class="tex-span"><i>g</i><sub class="lower-index"><i>i</i></sub></span>) does not exceed <span class="tex-span">5·10<sup class="upper-index">5</sup></span>.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Output the number of valid evolution plans modulo <span class="tex-span">10<sup class="upper-index">9</sup> + 7</span>.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>2 3<br />2 1 2<br />2 2 3<br /></pre></div><div class="output"><div class="title">Output</div><pre>1<br /></pre></div><div class="input"><div class="title">Input</div><pre>1 3<br />3 1 2 3<br /></pre></div><div class="output"><div class="title">Output</div><pre>6<br /></pre></div><div class="input"><div class="title">Input</div><pre>2 4<br />2 1 2<br />3 2 3 4<br /></pre></div><div class="output"><div class="title">Output</div><pre>2<br /></pre></div><div class="input"><div class="title">Input</div><pre>2 2<br />3 2 2 1<br />2 1 2<br /></pre></div><div class="output"><div class="title">Output</div><pre>1<br /></pre></div><div class="input"><div class="title">Input</div><pre>3 7<br />2 1 2<br />2 3 4<br />3 5 6 7<br /></pre></div><div class="output"><div class="title">Output</div><pre>24<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first case, the only possible evolution plan is: </p><center class="tex-equation"><img align="middle" class="tex-formula" src="https://espresso.codeforces.com/09e0e2f9394b52c6493c7865ece6f322b26434eb.png" style="max-width: 100.0%;max-height: 100.0%;" /></center><p>In the second case, any permutation of <span class="tex-span">(1,  2,  3)</span> is valid.</p><p>In the third case, there are two possible plans: </p><center class="tex-equation"><img align="middle" class="tex-formula" src="https://espresso.codeforces.com/c8db0de324b08c3f78b8db5ce7a45c1f4e206dcd.png" style="max-width: 100.0%;max-height: 100.0%;" /></center> <center class="tex-equation"><img align="middle" class="tex-formula" src="https://espresso.codeforces.com/5f569c7ffa0111a20a7bedc873c68fdf02d79d08.png" style="max-width: 100.0%;max-height: 100.0%;" /></center><p>In the fourth case, the only possible evolution plan is: </p><center class="tex-equation"><img align="middle" class="tex-formula" src="https://espresso.codeforces.com/64cf59d705c51be7d92ffd554bfa5d433917bcf8.png" style="max-width: 100.0%;max-height: 100.0%;" /></center></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=C]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/82867");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="D" data-uuid="ps_f6cdf6fae5cc9d68fba367ef2590f63921cfa891">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. Felicity's Big Secret Revealed</div><div class="time-limit"><div class="property-title">time limit per test</div>4 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>512 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>The gym leaders were fascinated by the evolutions which took place at Felicity camp. So, they were curious to know about the secret behind evolving Pokemon. </p><p>The organizers of the camp gave the gym leaders a PokeBlock, a sequence of <span class="tex-span"><i>n</i></span> ingredients. Each ingredient can be of type <span class="tex-span">0</span> or <span class="tex-span">1</span>. Now the organizers told the gym leaders that to evolve a Pokemon of type <span class="tex-span"><i>k</i></span> (<span class="tex-span"><i>k</i> ≥ 2</span>), they need to make a valid set of <span class="tex-span"><i>k</i></span> cuts on the PokeBlock to get smaller blocks.</p><p>Suppose the given PokeBlock sequence is <span class="tex-span"><i>b</i><sub class="lower-index">0</sub><i>b</i><sub class="lower-index">1</sub><i>b</i><sub class="lower-index">2</sub>... <i>b</i><sub class="lower-index"><i>n</i> - 1</sub></span>. You have a choice of making cuts at <span class="tex-span"><i>n</i> + 1</span> places, i.e., Before <span class="tex-span"><i>b</i><sub class="lower-index">0</sub></span>, between <span class="tex-span"><i>b</i><sub class="lower-index">0</sub></span> and <span class="tex-span"><i>b</i><sub class="lower-index">1</sub></span>, between <span class="tex-span"><i>b</i><sub class="lower-index">1</sub></span> and <span class="tex-span"><i>b</i><sub class="lower-index">2</sub></span>, ..., between <span class="tex-span"><i>b</i><sub class="lower-index"><i>n</i> - 2</sub></span> and <span class="tex-span"><i>b</i><sub class="lower-index"><i>n</i> - 1</sub></span>, and after <span class="tex-span"><i>b</i><sub class="lower-index"><i>n</i> - 1</sub></span>.</p><p>The <span class="tex-span"><i>n</i> + 1</span> choices of making cuts are as follows (where a <span class="tex-font-style-tt">|</span> denotes a possible cut):</p><center class="tex-equation"><span class="tex-span">| <i>b</i><sub class="lower-index">0</sub> | <i>b</i><sub class="lower-index">1</sub> | <i>b</i><sub class="lower-index">2</sub> | ... | <i>b</i><sub class="lower-index"><i>n</i> - 2</sub> | <i>b</i><sub class="lower-index"><i>n</i> - 1</sub> |</span></center><p>Consider a sequence of <span class="tex-span"><i>k</i></span> cuts. Now each pair of consecutive cuts will contain a binary string between them, formed from the ingredient types. The ingredients before the first cut and after the last cut are wasted, which is to say they are not considered. So there will be exactly <span class="tex-span"><i>k</i> - 1</span> such binary substrings. Every substring can be read as a binary number. Let <span class="tex-span"><i>m</i></span> be the maximum number out of the obtained numbers. If all the obtained numbers are positive and the set of the obtained numbers contains all integers from <span class="tex-span">1</span> to <span class="tex-span"><i>m</i></span>, then this set of cuts is said to be a valid set of cuts.</p><p>For example, suppose the given PokeBlock sequence is <span class="tex-span">101101001110</span> and we made <span class="tex-span">5</span> cuts in the following way:</p><center class="tex-equation"><span class="tex-span">10 | 11 | 010 | 01 | 1 | 10</span></center><p>So the <span class="tex-span">4</span> binary substrings obtained are: <span class="tex-span">11</span>, <span class="tex-span">010</span>, <span class="tex-span">01</span> and <span class="tex-span">1</span>, which correspond to the numbers <span class="tex-span">3</span>, <span class="tex-span">2</span>, <span class="tex-span">1</span> and <span class="tex-span">1</span> respectively. Here <span class="tex-span"><i>m</i> = 3</span>, as it is the maximum value among the obtained numbers. And all the obtained numbers are positive and we have obtained all integers from <span class="tex-span">1</span> to <span class="tex-span"><i>m</i></span>. Hence this set of cuts is a valid set of <span class="tex-span">5</span> cuts.</p><p>A Pokemon of type <span class="tex-span"><i>k</i></span> will evolve only if the PokeBlock is cut using a valid set of <span class="tex-span"><i>k</i></span> cuts. There can be many valid sets of the same size. Two valid sets of <span class="tex-span"><i>k</i></span> cuts are considered different if there is a cut in one set which is not there in the other set.</p><p>Let <span class="tex-span"><i>f</i>(<i>k</i>)</span> denote the number of valid sets of <span class="tex-span"><i>k</i></span> cuts. Find the value of <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/1f553c10ee29622384beda9934a033e929407c9c.png" style="max-width: 100.0%;max-height: 100.0%;" />. Since the value of <span class="tex-span"><i>s</i></span> can be very large, output <span class="tex-span"><i>s</i></span> modulo <span class="tex-span">10<sup class="upper-index">9</sup> + 7</span>.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The input consists of two lines. The first line consists an integer <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 75</span>) — the length of the PokeBlock. The next line contains the PokeBlock, a binary string of length <span class="tex-span"><i>n</i></span>.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Output a single integer, containing the answer to the problem, i.e., the value of <span class="tex-span"><i>s</i></span> modulo <span class="tex-span">10<sup class="upper-index">9</sup> + 7</span>.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>4<br />1011<br /></pre></div><div class="output"><div class="title">Output</div><pre>10<br /></pre></div><div class="input"><div class="title">Input</div><pre>2<br />10<br /></pre></div><div class="output"><div class="title">Output</div><pre>1<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample, the sets of valid cuts are:</p><p>Size <span class="tex-span">2</span>: <span class="tex-font-style-tt">|1|011</span>, <span class="tex-font-style-tt">1|01|1</span>, <span class="tex-font-style-tt">10|1|1</span>, <span class="tex-font-style-tt">101|1|</span>.</p><p>Size <span class="tex-span">3</span>: <span class="tex-font-style-tt">|1|01|1</span>, <span class="tex-font-style-tt">|10|1|1</span>, <span class="tex-font-style-tt">10|1|1|</span>, <span class="tex-font-style-tt">1|01|1|</span>.</p><p>Size <span class="tex-span">4</span>: <span class="tex-font-style-tt">|10|1|1|</span>, <span class="tex-font-style-tt">|1|01|1|</span>.</p><p>Hence, <span class="tex-span"><i>f</i>(2) = 4</span>, <span class="tex-span"><i>f</i>(3) = 4</span> and <span class="tex-span"><i>f</i>(4) = 2</span>. So, the value of <span class="tex-span"><i>s</i> = 10</span>.</p><p>In the second sample, the set of valid cuts is:</p><p>Size <span class="tex-span">2</span>: |1|0.</p><p>Hence, <span class="tex-span"><i>f</i>(2) = 1</span> and <span class="tex-span"><i>f</i>(3) = 0</span>. So, the value of <span class="tex-span"><i>s</i> = 1</span>.</p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=D]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/82867");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="E" data-uuid="ps_6554182788078c8c364f1757910a3ea2e9c0735f">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. Bash Plays with Functions</div><div class="time-limit"><div class="property-title">time limit per test</div>3 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Bash got tired on his journey to become the greatest Pokemon master. So he decides to take a break and play with functions.</p><p>Bash defines a function <span class="tex-span"><i>f</i><sub class="lower-index">0</sub>(<i>n</i>)</span>, which denotes the number of ways of factoring <span class="tex-span"><i>n</i></span> into two factors <span class="tex-span"><i>p</i></span> and <span class="tex-span"><i>q</i></span> such that <span class="tex-span"><i>gcd</i>(<i>p</i>, <i>q</i>) = 1</span>. In other words, <span class="tex-span"><i>f</i><sub class="lower-index">0</sub>(<i>n</i>)</span> is the number of ordered pairs of positive integers <span class="tex-span">(<i>p</i>, <i>q</i>)</span> such that <span class="tex-span"><i>p</i>·<i>q</i> = <i>n</i></span> and <span class="tex-span"><i>gcd</i>(<i>p</i>, <i>q</i>) = 1</span>.</p><p>But Bash felt that it was too easy to calculate this function. So he defined a series of functions, where <span class="tex-span"><i>f</i><sub class="lower-index"><i>r</i> + 1</sub></span> is defined as:</p><center class="tex-equation"><img align="middle" class="tex-formula" src="https://espresso.codeforces.com/b101481fcdac88d9015ae47191122daa3d5b0f7a.png" style="max-width: 100.0%;max-height: 100.0%;" /></center><p>Where <span class="tex-span">(<i>u</i>, <i>v</i>)</span> is any ordered pair of positive integers, they need not to be co-prime.</p><p>Now Bash wants to know the value of <span class="tex-span"><i>f</i><sub class="lower-index"><i>r</i></sub>(<i>n</i>)</span> for different <span class="tex-span"><i>r</i></span> and <span class="tex-span"><i>n</i></span>. Since the value could be huge, he would like to know the value modulo <span class="tex-span">10<sup class="upper-index">9</sup> + 7</span>. Help him!</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains an integer <span class="tex-span"><i>q</i></span> (<span class="tex-span">1 ≤ <i>q</i> ≤ 10<sup class="upper-index">6</sup></span>) — the number of values Bash wants to know.</p><p>Each of the next <span class="tex-span"><i>q</i></span> lines contain two integers <span class="tex-span"><i>r</i></span> and <span class="tex-span"><i>n</i></span> (<span class="tex-span">0 ≤ <i>r</i> ≤ 10<sup class="upper-index">6</sup></span>, <span class="tex-span">1 ≤ <i>n</i> ≤ 10<sup class="upper-index">6</sup></span>), which denote Bash wants to know the value <span class="tex-span"><i>f</i><sub class="lower-index"><i>r</i></sub>(<i>n</i>)</span>.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print <span class="tex-span"><i>q</i></span> integers. For each pair of <span class="tex-span"><i>r</i></span> and <span class="tex-span"><i>n</i></span> given, print <span class="tex-span"><i>f</i><sub class="lower-index"><i>r</i></sub>(<i>n</i>)</span> modulo <span class="tex-span">10<sup class="upper-index">9</sup> + 7</span> on a separate line.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>5<br />0 30<br />1 25<br />3 65<br />2 5<br />4 48<br /></pre></div><div class="output"><div class="title">Output</div><pre>8<br />5<br />25<br />4<br />630<br /></pre></div></div></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=E]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/82867");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="F" data-uuid="ps_016ec473c9197c9e75853406bafa9ec050c92afb">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">F. Team Rocket Rises Again</div><div class="time-limit"><div class="property-title">time limit per test</div>2.5 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>512 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>It's the turn of the year, so Bash wants to send presents to his friends. There are <span class="tex-span"><i>n</i></span> cities in the Himalayan region and they are connected by <span class="tex-span"><i>m</i></span> bidirectional roads. Bash is living in city <span class="tex-span"><i>s</i></span>. Bash has exactly one friend in each of the other cities. Since Bash wants to surprise his friends, he decides to send a Pikachu to each of them. <span class="tex-font-style-bf">Since there may be some cities which are not reachable from Bash's city, he only sends a Pikachu to those friends who live in a city reachable from his own city</span>. He also wants to send it to them as soon as possible.</p><p>He finds out the minimum time for each of his Pikachus to reach its destination city. Since he is a perfectionist, he informs all his friends with the time their gift will reach them. A Pikachu travels at a speed of <span class="tex-span">1</span> meters per second. His friends were excited to hear this and would be unhappy if their presents got delayed. Unfortunately Team Rocket is on the loose and they came to know of Bash's plan. They want to maximize the number of friends who are unhappy with Bash.</p><p>They do this by destroying exactly one of the other <span class="tex-span"><i>n</i> - 1</span> cities. This implies that <span class="tex-font-style-bf">the friend residing in that city dies, so he is unhappy as well</span>.</p><p>Note that <span class="tex-font-style-bf">if a city is destroyed, all the roads directly connected to the city are also destroyed and the Pikachu may be forced to take a longer alternate route</span>.</p><p><span class="tex-font-style-bf">Please also note that only friends that are waiting for a gift count as unhappy, even if they die.</span></p><p>Since Bash is already a legend, can you help Team Rocket this time and find out the maximum number of Bash's friends who can be made unhappy by destroying exactly one city.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains three space separated integers <span class="tex-span"><i>n</i></span>, <span class="tex-span"><i>m</i></span> and <span class="tex-span"><i>s</i></span> (<span class="tex-span">2 ≤ <i>n</i> ≤ 2·10<sup class="upper-index">5</sup></span>, <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/284399a97a1979fed316d54ddd16ca2f3e858fd6.png" style="max-width: 100.0%;max-height: 100.0%;" />, <span class="tex-span">1 ≤ <i>s</i> ≤ <i>n</i></span>) — the number of cities and the number of roads in the Himalayan region and the city Bash lives in.</p><p>Each of the next <span class="tex-span"><i>m</i></span> lines contain three space-separated integers <span class="tex-span"><i>u</i></span>, <span class="tex-span"><i>v</i></span> and <span class="tex-span"><i>w</i></span> (<span class="tex-span">1 ≤ <i>u</i>, <i>v</i> ≤ <i>n</i></span>, <span class="tex-span"><i>u</i> ≠ <i>v</i></span>, <span class="tex-span">1 ≤ <i>w</i> ≤ 10<sup class="upper-index">9</sup></span>) denoting that there exists a road between city <span class="tex-span"><i>u</i></span> and city <span class="tex-span"><i>v</i></span> of length <span class="tex-span"><i>w</i></span> meters.</p><p>It is guaranteed that no road connects a city to itself and there are no two roads that connect the same pair of cities.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print a single integer, the answer to the problem.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>4 4 3<br />1 2 1<br />2 3 1<br />2 4 1<br />3 1 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>2<br /></pre></div><div class="input"><div class="title">Input</div><pre>7 11 2<br />1 2 5<br />1 3 5<br />2 4 2<br />2 5 2<br />3 6 3<br />3 7 3<br />4 6 2<br />3 4 2<br />6 7 3<br />4 5 7<br />4 7 7<br /></pre></div><div class="output"><div class="title">Output</div><pre>4<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample, on destroying the city <span class="tex-span">2</span>, the length of shortest distance between pairs of cities <span class="tex-span">(3, 2)</span> and <span class="tex-span">(3, 4)</span> will change. Hence the answer is <span class="tex-span">2</span>.</p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=F]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/82867");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 1em;"
        >


<div class="problemindexholder" problemindex="G" data-uuid="ps_1e4788760cf37c2bcdba67daa12066e3551f79b4">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">G. Can Bash Save the Day?</div><div class="time-limit"><div class="property-title">time limit per test</div>5 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>768 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Whoa! You did a great job helping Team Rocket who managed to capture all the Pokemons sent by Bash. Meowth, part of Team Rocket, having already mastered the human language, now wants to become a master in programming as well. He agrees to free the Pokemons if Bash can answer his questions.</p><p>Initially, Meowth gives Bash a weighted tree containing <span class="tex-span"><i>n</i></span> nodes and a sequence <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>..., <i>a</i><sub class="lower-index"><i>n</i></sub></span> which is a permutation of <span class="tex-span">1, 2, ..., <i>n</i></span>. Now, Mewoth makes <span class="tex-span"><i>q</i></span> queries of one of the following forms:</p><ul>  <li> <span class="tex-font-style-tt">1 l r v</span>: meaning Bash should report <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/816a5c5f7673f6efda3e7eb855b33f1cd0660d88.png" style="max-width: 100.0%;max-height: 100.0%;" />, where <span class="tex-span"><i>dist</i>(<i>a</i>, <i>b</i>)</span> is the length of the shortest path from node <span class="tex-span"><i>a</i></span> to node <span class="tex-span"><i>b</i></span> in the given tree.  </li><li> <span class="tex-font-style-tt">2 x</span>: meaning Bash should swap <span class="tex-span"><i>a</i><sub class="lower-index"><i>x</i></sub></span> and <span class="tex-span"><i>a</i><sub class="lower-index"><i>x</i> + 1</sub></span> in the given sequence. This new sequence is used for later queries. </li></ul><p>Help Bash to answer the questions!</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains two integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>q</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 2·10<sup class="upper-index">5</sup></span>, <span class="tex-span">1 ≤ <i>q</i> ≤ 2·10<sup class="upper-index">5</sup></span>) — the number of nodes in the tree and the number of queries, respectively.</p><p>The next line contains <span class="tex-span"><i>n</i></span> space-separated integers — the sequence <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>n</i></sub></span> which is a permutation of <span class="tex-span">1, 2, ..., <i>n</i></span>.</p><p>Each of the next <span class="tex-span"><i>n</i> - 1</span> lines contain three space-separated integers <span class="tex-span"><i>u</i></span>, <span class="tex-span"><i>v</i></span>, and <span class="tex-span"><i>w</i></span> denoting that there exists an undirected edge between node <span class="tex-span"><i>u</i></span> and node <span class="tex-span"><i>v</i></span> of weight <span class="tex-span"><i>w</i></span>, (<span class="tex-span">1 ≤ <i>u</i>, <i>v</i> ≤ <i>n</i></span>, <span class="tex-span"><i>u</i> ≠ <i>v</i></span>, <span class="tex-span">1 ≤ <i>w</i> ≤ 10<sup class="upper-index">6</sup></span>). It is guaranteed that the given graph is a tree.</p><p>Each query consists of two lines. First line contains single integer <span class="tex-span"><i>t</i></span>, indicating the type of the query. Next line contains the description of the query: </p><ul> <li> <span class="tex-font-style-bf">t = 1</span>: Second line contains three integers <span class="tex-span"><i>a</i></span>, <span class="tex-span"><i>b</i></span> and <span class="tex-span"><i>c</i></span> (<span class="tex-span">1 ≤ <i>a</i>, <i>b</i>, <i>c</i> &lt; 2<sup class="upper-index">30</sup></span>) using which <span class="tex-span"><i>l</i></span>, <span class="tex-span"><i>r</i></span> and <span class="tex-span"><i>v</i></span> can be generated using the formula given below: <ul> <li> <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/41e63c8dc8bc8ccdd6518f3545d4ed6563ad0149.png" style="max-width: 100.0%;max-height: 100.0%;" />, </li><li> <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/d507471ec4ac41dfdb7ae85e8e229454a071fabf.png" style="max-width: 100.0%;max-height: 100.0%;" />, </li><li> <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/ef5c7174e223cf6451bba39d4eec35ac6d923636.png" style="max-width: 100.0%;max-height: 100.0%;" />. </li></ul> </li><li> <span class="tex-font-style-bf">t = 2</span>: Second line contains single integer <span class="tex-span"><i>a</i></span> (<span class="tex-span">1 ≤ <i>a</i> &lt; 2<sup class="upper-index">30</sup></span>) using which <span class="tex-span"><i>x</i></span> can be generated using the formula given below: <ul> <li> <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/d48156478483a72dae043d51512212446bbff09e.png" style="max-width: 100.0%;max-height: 100.0%;" />. </li></ul> </li></ul><p>The <span class="tex-span"><i>ans</i><sub class="lower-index"><i>i</i></sub></span> is the answer for the <span class="tex-span"><i>i</i></span>-th query, assume that <span class="tex-span"><i>ans</i><sub class="lower-index">0</sub> = 0</span>. If the <span class="tex-span"><i>i</i></span>-th query is of type 2 then <span class="tex-span"><i>ans</i><sub class="lower-index"><i>i</i></sub></span> = <span class="tex-span"><i>ans</i><sub class="lower-index"><i>i</i> - 1</sub></span>. It is guaranteed that: </p><ul> <li> <span class="tex-font-style-bf">for each query of type 1</span>: <span class="tex-span">1 ≤ <i>l</i> ≤ <i>r</i> ≤ <i>n</i></span>, <span class="tex-span">1 ≤ <i>v</i> ≤ <i>n</i></span>, </li><li> <span class="tex-font-style-bf">for each query of type 2</span>: <span class="tex-span">1 ≤ <i>x</i> ≤ <i>n</i> - 1</span>. </li></ul><p>The <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/c4b7092c0f7ce6535f2574569c98f7b3c2fe2c5f.png" style="max-width: 100.0%;max-height: 100.0%;" /> operation means bitwise exclusive OR.</p></div><div class="output-specification"><div class="section-title">Output</div><p>For each query of type <span class="tex-span">1</span>, output a single integer in a separate line, denoting the answer to the query.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>5 5<br />4 5 1 3 2<br />4 2 4<br />1 3 9<br />4 1 4<br />4 5 2<br />1<br />1 5 4<br />1<br />22 20 20<br />2<br />38<br />2<br />39<br />1<br />36 38 38<br /></pre></div><div class="output"><div class="title">Output</div><pre>23<br />37<br />28<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the sample, the actual queries are the following: </p><ul> <li> <span class="tex-font-style-tt">1 1 5 4</span> </li><li> <span class="tex-font-style-tt">1 1 3 3</span> </li><li> <span class="tex-font-style-tt">2 3</span> </li><li> <span class="tex-font-style-tt">2 2</span> </li><li> <span class="tex-font-style-tt">1 1 3 3</span> </li></ul></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=G]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/82867");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
    </div>

    <div id="footer">
        <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2024 Mike Mirzayanov</div>
        <div>The only programming contests Web 2.0 platform</div>

    </div>

</div>
</div>
    <script type="application/javascript">
        if ('serviceWorker' in navigator && 'fetch' in window && 'caches' in window) {
            navigator.serviceWorker.register('/service-worker-82867.js')
                .then(function (registration) {
                    console.log('Service worker registered: ', registration);
                })
                .catch(function (error) {
                    console.log('Registration failed: ', error);
                });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8a0aa47f5aab7784',t:'MTcyMDU1MjUyNS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

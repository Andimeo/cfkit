
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-743380-5"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-743380-5');
        </script>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="898b1e155ee489eac1af825aac0f9523"/>
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01"/>

    <script type="text/javascript" src="//codeforces.org/s/36856/js/jquery-1.8.3.js"></script>
    <script type="application/javascript">
        window.locale = "en";
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }

        /* Protection against trailing dot in domain. */
        let hostLength = window.location.host.length;
        if (hostLength > 1 && window.location.host[hostLength - 1] === '.') {
            window.location = window.location.protocol + "//" + window.location.host.substring(0, hostLength - 1);
        }
    </script>

    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="i2">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="//codeforces.org/s/36856/images/codeforces-sponsored-by-ton.png" />
    <link rel="image_src" href="//codeforces.org/s/36856/images/codeforces-sponsored-by-ton.png" />
    <meta property="og:title" content="Problems - Codeforces"/>
    <meta property="og:description" content=""/>
    
    <meta property="og:site_name" content="Codeforces"/>
    
    
    
    
    
    
    <meta name="utc_offset" content="+03:00"/>
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Problems - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community" />
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup" />
    <meta name="robots" content="index, follow" />

    <link rel="stylesheet" href="//codeforces.org/s/36856/css/font-awesome.min.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/36856/css/line-awesome.min.css" type="text/css" charset="utf-8" />

        <link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>


    <link rel="apple-touch-icon" sizes="57x57" href="//codeforces.org/s/36856/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="//codeforces.org/s/36856/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="//codeforces.org/s/36856/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="//codeforces.org/s/36856/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="//codeforces.org/s/36856/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="//codeforces.org/s/36856/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="//codeforces.org/s/36856/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="//codeforces.org/s/36856/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="//codeforces.org/s/36856/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="//codeforces.org/s/36856/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="//codeforces.org/s/36856/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="//codeforces.org/s/36856/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="//codeforces.org/s/36856/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="//codeforces.org/s/36856/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="//codeforces.org/s/36856/css/prettify.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/36856/css/clear.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/36856/css/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/36856/css/ttypography.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/36856/css/problem-statement.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/36856/css/second-level-menu.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/36856/css/roundbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/36856/css/datatable.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/36856/css/table-form.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/36856/css/topic.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/36856/css/jquery.jgrowl.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/36856/css/facebox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/36856/css/jquery.wysiwyg.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/36856/css/jquery.autocomplete.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/36856/css/codeforces.datepick.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/36856/css/colorbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/36856/css/jquery.drafts.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/36856/css/community.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/36856/css/sidebar-menu.css" type="text/css" charset="utf-8" />

    <!-- MathJax -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    MathJax.Hub.Register.StartupHook("End", function () {
        Codeforces.runMathJaxListeners();
    });
    </script>
    <script type="text/javascript" async
            src="https://mathjax.codeforces.org/MathJax.js?config=TeX-AMS_HTML-full"
    >
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="//codeforces.org/s/36856/js/prettify/prettify.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/36856/js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/36856/js/pushstream.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/36856/js/jquery.easing.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/36856/js/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/36856/js/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/36856/js/jquery.swipe.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/36856/js/jquery.hotkeys.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/36856/js/facebox.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/36856/js/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/36856/js/controls/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/36856/js/controls/wysiwyg.table.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/36856/js/controls/wysiwyg.image.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/36856/js/controls/wysiwyg.link.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/36856/js/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/36856/js/jquery.datepick.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/36856/js/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/36856/js/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/36856/js/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/36856/js/jquery.drafts.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/36856/js/clipboard.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/36856/js/autosize.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/36856/js/sjcl.js"></script>
    <script type="text/javascript" src="/scripts/bb1342251996c2653ea14b0f672b79a1/en/codeforces-options.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/36856/js/codeforces.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/36856/js/EventCatcher.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/36856/js/preparedVerdictFormats-en.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/36856/js/confetti.min.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="//codeforces.org/s/36856/markitup/skins/markitup/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/36856/markitup/sets/markdown/style.css" type="text/css" charset="utf-8" />


    <script type="text/javascript" src="//codeforces.org/s/36856/markitup/jquery.markitup.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/36856/markitup/sets/markdown/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->




</head>
<body class=" "><span style='display:none;' class='csrf-token' data-csrf='898b1e155ee489eac1af825aac0f9523'>&nbsp;</span>

<!-- .notificationTextCleaner used in Codeforces.showAnnouncements() -->
<div class="notificationTextCleaner" style="font-size: 0"></div>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 3.0rem;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    String.prototype.hashCode = function() {
        var hash = 0, i, chr;
        if (this.length === 0) return hash;
        for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };

    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile === "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>





    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 700
        });
    }, 100);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


    function showAnnouncements(json) {
        //info("j=" + JSON.stringify(json));

        if (json.t != "a") {
            return;
        }

        setTimeout(function() {
            Codeforces.showAnnouncements(json.d, "en");
        }, Math.random() * 500);
    }

    function showEventCatcherUserMessage(json) {
        if (json.t == "s") {
            var points = json.d[5];
            var passedTestCount = json.d[7];
            var judgedTestCount = json.d[8];
            var verdict = preparedVerdictFormats[json.d[12]];
            var verdictPrototypeDiv = $(".verdictPrototypeDiv");
            verdictPrototypeDiv.html(verdict);
            if (judgedTestCount != null && judgedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-judged").text(judgedTestCount);
            }
            if (passedTestCount != null && passedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-passed").text(passedTestCount);
            }
            if (points != null && points != undefined) {
                verdictPrototypeDiv.find(".verdict-format-points").text(points);
            }
            Codeforces.showMessage(verdictPrototypeDiv.text());
        }
    }

    $(".clickable-title").each(function() {
        var title = $(this).attr("data-title");
        if (title) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = title;
            $(this).attr("title", tmp.textContent || tmp.innerText || "");
        }
    });

    $(".clickable-title").click(function() {
        var title = $(this).attr("data-title");
        if (title) {
            Codeforces.alert(title);
        } else {
            Codeforces.alert($(this).attr("title"));
        }
    }).css("position", "relative").css("bottom", "3px");

        Codeforces.showDelayedMessage();

    Codeforces.reformatTimes();

    //Codeforces.initializePubSub();
    if (window.codeforcesOptions.subscribeServerUrl) {
        window.eventCatcher = new EventCatcher(
            window.codeforcesOptions.subscribeServerUrl,
            [
                Codeforces.getGlobalChannel(),
                Codeforces.getUserChannel(),
                Codeforces.getUserShowMessageChannel(),
                Codeforces.getContestChannel(),
                Codeforces.getParticipantChannel(),
                Codeforces.getTalkChannel()
            ]
        );

        if (Codeforces.getParticipantChannel()) {
            window.eventCatcher.subscribe(Codeforces.getParticipantChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getContestChannel()) {
            window.eventCatcher.subscribe(Codeforces.getContestChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getGlobalChannel()) {
            window.eventCatcher.subscribe(Codeforces.getGlobalChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserShowMessageChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserShowMessageChannel(), function(json) {
                showEventCatcherUserMessage(json);
            });
        }
    }

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>


<div id="body">
<div style="width: 950px; margin: 0 auto;" class="compact-problemset">
    <div id="header" style="position: relative; margin: 0;">
        <div style="float:left;">
                  <a href="/"><img height="65" style="height: 65px;" src="//codeforces.org/s/36856/images/codeforces-sponsored-by-ton.png" alt="Codeforces"/></a>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="//codeforces.org/s/36856/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="//codeforces.org/s/36856/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <br style="clear: both;"/>

    <div style="text-align: center; font-size: 1.8rem; margin-bottom: 0.5em;"
         class="caption">2019-2020 ICPC, Asia Jakarta Regional Contest (Online Mirror, ICPC Rules, Teams Preferred)</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

    <div class="problem-frames">
        <div
                    style="margin-bottom: 2em;"
        >

    <style>
        #facebox .content:has(.diff-popup) {
            width: 90vw;
            max-width: 120rem !important;
        }

        .testCaseMarker {
            position: absolute;
            font-weight: bold;
            font-size: 1rem;
        }

        .diff-popup {
            width: 90vw;
            max-width: 120rem !important;
            display: none;
            overflow: auto;
        }

        .input-output-copier {
            font-size: 1.2rem;
            float: right;
            color: #888 !important;
            cursor: pointer;
            border: 1px solid rgb(185, 185, 185);
            padding: 3px;
            margin: 1px;
            line-height: 1.1rem;
            text-transform: none;
        }

        .input-output-copier:hover {
            background-color: #def;
        }

        .test-explanation textarea {
            width: 100%;
            height: 1.5em;
        }

        .pending-submission-message {
            color: darkorange !important;
        }
    </style>
    <script>
        const OPENING_SPACE = String.fromCharCode(1001);
        const CLOSING_SPACE = String.fromCharCode(1002);

        const nodeToText = function (node, pre) {
            let result = [];

            if (node.tagName === "SCRIPT" || node.tagName === "math"
                || (node.classList && node.classList.contains("input-output-copier")))
                return [];

            if (node.tagName === "NOBR") {
                result.push(OPENING_SPACE);
            }

            if (node.nodeType === Node.TEXT_NODE) {
                let s = node.textContent;
                if (!pre) {
                    s = s.replace(/\s+/g, " ");
                }
                if (s.length > 0) {
                    result.push(s);
                }
            }

            if (pre && node.tagName === "BR") {
                result.push("\n");
            }

            node.childNodes.forEach(function (child) {
                result.push(nodeToText(child, node.tagName === "PRE").join(""));
            });

            if (node.tagName === "DIV"
                || node.tagName === "P"
                || node.tagName === "PRE"
                || node.tagName === "UL"
                || node.tagName === "LI"
            ) {
                result.push("\n");
            }

            if (node.tagName === "NOBR") {
                result.push(CLOSING_SPACE);
            }

            return result;
        }

        const isSpecial = function (c) {
            return c === ',' || c === '.' || c === ';' || c === ')' || c === ' ';
        }

        const convertStatementToText = function(statmentNode) {
            const text = nodeToText(statmentNode, false).join("").replace(/ +/g, " ").replace(/\n\n+/g, "\n\n");
            let result = [];
            for (let i = 0; i < text.length; i++) {
                const c = text.charAt(i);
                if (c === OPENING_SPACE) {
                    if (!((i > 0 && text.charAt(i - 1) === '(') || (result.length > 0 && result[result.length - 1] === ' '))) {
                        result.push('+');
                    }
                } else if (c === CLOSING_SPACE) {
                    if (!(i + 1 < text.length && isSpecial(text.charAt(i + 1)))) {
                        result.push('-');
                    }
                } else {
                    result.push(c);
                }
            }
            return result.join("").split("\n").map(value => value.trim()).join("\n");
        };
    </script>
    <div class="diff-popup">
    </div>

<div class="problemindexholder" problemindex="A" data-uuid="ps_cb6961396ae9958d061e6f5f7972e8ffd803ffb3">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A. Copying Homework</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Danang and Darto are classmates. They are given homework to create a permutation of $$$N$$$ integers from $$$1$$$ to $$$N$$$. Danang has completed the homework and created a permutation $$$A$$$ of $$$N$$$ integers. Darto wants to copy Danang's homework, but Danang asks Darto to change it up a bit so it does not look obvious that Darto copied.</p><p>The difference of two permutations of $$$N$$$ integers $$$A$$$ and $$$B$$$, denoted by $$$diff(A, B)$$$, is the sum of the absolute difference of $$$A_i$$$ and $$$B_i$$$ for all $$$i$$$. In other words, $$$diff(A, B) = \Sigma_{i=1}^N |A_i - B_i|$$$. Darto would like to create a permutation of $$$N$$$ integers that maximizes its difference with $$$A$$$. Formally, he wants to find a permutation of $$$N$$$ integers $$$B_{max}$$$ such that $$$diff(A, B_{max}) \ge diff(A, B')$$$ for all permutation of $$$N$$$ integers $$$B'$$$.</p><p>Darto needs your help! Since the teacher giving the homework is lenient, any permutation of $$$N$$$ integers $$$B$$$ is considered different with $$$A$$$ if the difference of $$$A$$$ and $$$B$$$ is at least $$$N$$$. Therefore, you are allowed to return any permutation of $$$N$$$ integers $$$B$$$ such that $$$diff(A, B) \ge N$$$.</p><p>Of course, you can still return $$$B_{max}$$$ if you want, since it can be proven that $$$diff(A, B_{max}) \ge N$$$ for any permutation $$$A$$$ and $$$N &gt; 1$$$. This also proves that there exists a solution for any permutation of $$$N$$$ integers $$$A$$$. If there is more than one valid solution, you can output any of them.</p></div><div class="input-specification"><div class="section-title">Input</div><p>Input begins with a line containing an integer: $$$N$$$ ($$$2 \le N \le 100\,000$$$) representing the size of Danang's permutation. The next line contains $$$N$$$ integers: $$$A_i$$$ ($$$1 \le A_i \le N$$$) representing Danang's permutation. It is guaranteed that all elements in $$$A$$$ are distinct.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Output in a line $$$N$$$ integers (each separated by a single space) representing the permutation of $$$N$$$ integers $$$B$$$ such that $$$diff(A, B) \ge N$$$. As a reminder, all elements in the permutation must be between $$$1$$$ to $$$N$$$ and distinct.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
4
1 3 2 4
</pre></div><div class="output"><div class="title">Output</div><pre>
4 2 3 1
</pre></div><div class="input"><div class="title">Input</div><pre>
2
2 1
</pre></div><div class="output"><div class="title">Output</div><pre>
1 2
</pre></div></div></div><div class="note"><div class="section-title">Note</div><p><span class="tex-font-style-it">Explanation for the sample input/output #1</span></p><p>With $$$A = [1, 3, 2, 4]$$$ and $$$B = [4, 2, 3, 1]$$$, $$$diff(A, B) = |1 - 4| + |3 - 2| + |2 - 3| + |4 - 1| = 3 + 1 + 1 + 3 = 8$$$. Since $$$8 \ge 4$$$, $$$[4, 2, 3, 1]$$$ is one of the valid output for this sample.</p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=A]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/36856");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {
        window.changedTests = new Set();

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");



        String.prototype.replaceAll = function (search, replace) {
            return this.split(search).join(replace);
        };

        $(".sample-test .title").each(function () {
            const preId = ("id" + Math.random()).replaceAll(".", "0");
            const cpyId = ("id" + Math.random()).replaceAll(".", "0");

            $(this).parent().find("pre").attr("id", preId);
            const $copy = $("<div title='Copy' data-clipboard-target='#" + preId + "' id='" + cpyId + "' class='input-output-copier'>Copy</div>");
            $(this).append($copy);

            const clipboard = new Clipboard('#' + cpyId, {
                text: function (trigger) {
                    const pre = document.querySelector('#' + preId);
                    const lines = pre.querySelectorAll(".test-example-line");
                    return Codeforces.filterClipboardText(pre.innerText, lines.length);
                }
            });

            const isInput = $(this).parent().hasClass("input");

            clipboard.on('success', function (e) {
                if (isInput) {
                    Codeforces.showMessage("The example input has been copied into the clipboard");
                } else {
                    Codeforces.showMessage("The example output has been copied into the clipboard");
                }
                e.clearSelection();
            });
        });

        $(".test-form-item input").change(function () {
            addPendingSubmissionMessage($($(this).closest("form")), "You changed the answer, do not forget to submit it if you want to save the changes");
            const index = $(this).closest(".problemindexholder").attr("problemindex");
            let test = "";
            $(this).closest("form input").each(function () {
                const test_ = $(this).attr("name");
                if (test_ && test_.substring(0, 4) === "test") {
                    test = test_;
                }
            });
            if (index.length > 0 && test.length > 0) {
                const indexTest = index + "::" + test;
                window.changedTests.add(indexTest);
            }
        });

        $(window).on('beforeunload', function () {
            if (window.changedTests.size > 0) {
                return 'Dialog text here';
            }
        });

        autosize($('.test-explanation textarea'));

        $(".test-example-line").hover(function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        let top = 1E20;
                        let left = 1E20;
                        let problem = $(this).closest(".problemindexholder");
                        $(this).closest(".input").find("." + clazz).css("background-color", "#FFFDE7").each(function() {
                            top = Math.min(top, $(this).offset().top);
                            left = Math.min(left, $(this).offset().left);
                        });
                        let testCaseMarker = problem.find(".testCaseMarker_" + end);
                        if (testCaseMarker.length === 0) {
                            const html = "<div class=\"testCaseMarker testCaseMarker_" + end + " notice\"></div>";
                            problem.append($(html));
                            testCaseMarker = problem.find(".testCaseMarker_" + end);
                        }
                        if (testCaseMarker) {
                            testCaseMarker.show()
                                    .offset({top, left: left - 20})
                                    .text(end);
                        }
                    }
                }
            });
        }, function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        $("." + clazz).css("background-color", "");
                        $(this).closest(".problemindexholder").find(".testCaseMarker_" + end).hide();
                    }
                }
            });
        });

    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="B" data-uuid="ps_c4c3d783f18fead5d65119ba7f899a97b6a151f0">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B. Cleaning Robots</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>The new ICPC town has $$$N$$$ junctions (numbered from $$$1$$$ to $$$N$$$) which are connected by $$$N-1$$$ roads. It is possible from one junction to go to any other junctions by going through one or more roads. To make sure all the junctions are well-maintained, the government environment agency is planning to deploy their newest advanced cleaning robots. In addition to its cleaning ability, each robot is also equipped with a movement ability such that it can move from one junction to any other junctions connected by roads. However, as you might have guessed, such robots are not cheap. Therefore, the agency is considering the following deployment plan.</p><p>Let $$$T_k$$$ be the set of junctions which should be cleaned by the $$$k^{th}$$$ robot (also known as, the robot's task), and $$$|T_k| \ge 1$$$ be the number of junctions in $$$T_k$$$. The junctions in $$$T_k$$$ form a <span class="tex-font-style-bf">path</span>, i.e. there exists a sequence of $$$v_1, v_2, \dots, v_{|T_k|}$$$ where $$$v_i \in T_k$$$ and $$$v_i \neq v_j$$$ for all $$$i \neq j$$$ such that each adjacent junction in this sequence is connected by a road. The union of $$$T$$$ for all robots is equal to the set of all junctions in ICPC town. On the other hand, no two robots share a common junction, i.e. $$$T_i \cap T_j = \emptyset$$$ if $$$i \neq j$$$.</p><p>To avoid complaints from citizens for an inefficient operation, the deployment plan should be <span class="tex-font-style-it">irreducible</span>; in other words, there should be no two robots, $$$i$$$ and $$$j$$$, such that $$$T_i \cup T_j$$$ forms a (longer) path. Note that the agency does not care whether the number of robots being used is minimized as long as all the tasks are irreducible.</p><p>Your task in this problem is to count the number of feasible deployment plan given the town's layout. A plan is feasible if and only if it satisfies all the above-mentioned requirements.</p><p>For example, let $$$N = 6$$$ and the roads are $$$\{(1,3),(2,3),(3,4),(4,5),(4,6)\}$$$. There are $$$5$$$ feasible deployment plans as shown in the following figure. </p><p><img class="tex-graphics" src="https://espresso.codeforces.com/dab516f76817fccd8bc49fd80a6193f5bda535e8.png" style="max-width: 100.0%;max-height: 100.0%;" /></p><ul> <li> The first plan uses $$$2$$$ robots (labeled as A and B in the figure) to clean $$$\{1,2,3\}$$$ and $$$\{4,5,6\}$$$. </li><li> The second plan uses $$$3$$$ robots (labeled as A, B, and C in the figure) to clean $$$\{1,3,4,6\}$$$, $$$\{2\}$$$, and $$$\{5\}$$$. </li><li> The third plan uses $$$3$$$ robots to clean $$$\{1,3,4,5\}$$$, $$$\{2\}$$$, and $$$\{6\}$$$. </li><li> The fourth plan uses $$$3$$$ robots to clean $$$\{1\}$$$, $$$\{2,3,4,6\}$$$, and $$$\{5\}$$$. </li><li> The fifth plan uses $$$3$$$ robots to clean $$$\{1\}$$$, $$$\{2,3,4,5\}$$$, and $$$\{6\}$$$. </li></ul> No other plans are feasible in this case. For example, the plan $$$\{\{1,3\},\{2\},\{4,5,6\}\}$$$ is not feasible as the task $$$\{1,3\}$$$ and $$$\{2\}$$$ can be combined into a longer path $$$\{1,3,2\}$$$. The plan $$$\{\{1,2,3,4\},\{5\},\{6\}\}$$$ is also not feasible as $$$\{1,2,3,4\}$$$ is not a path.</div><div class="input-specification"><div class="section-title">Input</div><p>Input begins with a line containing an integer: $$$N$$$ ($$$1 \le N \le 100\,000$$$) representing the number of junctions. The next $$$N-1$$$ lines each contains two integers: $$$u_i$$$ $$$v_i$$$ ($$$1 \le u_i &lt; v_i \le N$$$) representing a road connecting junction $$$u_i$$$ and junction $$$v_i$$$. It is guaranteed that it is possible from one junction to go to any other junctions by going through one or more roads.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Output in a line an integer representing the number of feasible deployment plans. As this output can be large, you need to modulo the output by $$$1\,000\,000\,007$$$.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
6
1 3
2 3
3 4
4 5
4 6
</pre></div><div class="output"><div class="title">Output</div><pre>
5
</pre></div><div class="input"><div class="title">Input</div><pre>
5
1 2
2 3
2 4
4 5
</pre></div><div class="output"><div class="title">Output</div><pre>
3
</pre></div></div></div><div class="note"><div class="section-title">Note</div><p><span class="tex-font-style-it">Explanation for the sample input/output #1</span></p><p>This is the example from the problem description.</p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=B]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/36856");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="C" data-uuid="ps_6a49eb0fa369a5b9c776b7e95e4b7f880521dd0a">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C. Even Path</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Pathfinding is a task of finding a route between two points. It often appears in many problems. For example, in a GPS navigation software where a driver can query for a suggested route, or in a robot motion planning where it should find a valid sequence of movements to do some tasks, or in a simple maze solver where it should find a valid path from one point to another point. This problem is related to solving a maze.</p><p>The maze considered in this problem is in the form of a matrix of integers $$$A$$$ of $$$N \times N$$$. The value of each cell is generated from a given array $$$R$$$ and $$$C$$$ of $$$N$$$ integers each. Specifically, the value on the $$$i^{th}$$$ row and $$$j^{th}$$$ column, cell $$$(i,j)$$$, is equal to $$$R_i + C_j$$$. Note that all indexes in this problem are from $$$1$$$ to $$$N$$$.</p><p>A path in this maze is defined as a sequence of cells $$$(r_1,c_1), (r_2,c_2), \dots, (r_k,c_k)$$$ such that $$$|r_i - r_{i+1}| + |c_i - c_{i+1}| = 1$$$ for all $$$1 \le i &lt; k$$$. In other words, each adjacent cell differs only by $$$1$$$ row or only by $$$1$$$ column. An <span class="tex-font-style-bf">even path</span> in this maze is defined as a path in which all the cells in the path contain only even numbers.</p><p>Given a tuple $$$\langle r_a,c_a,r_b,c_b \rangle$$$ as a query, your task is to determine whether there exists an even path from cell $$$(r_a,c_a)$$$ to cell $$$(r_b,c_b)$$$. To simplify the problem, it is guaranteed that both cell $$$(r_a,c_a)$$$ and cell $$$(r_b,c_b)$$$ contain even numbers.</p><p>For example, let $$$N = 5$$$, $$$R = \{6, 2, 7, 8, 3\}$$$, and $$$C = \{3, 4, 8, 5, 1\}$$$. The following figure depicts the matrix $$$A$$$ of $$$5 \times 5$$$ which is generated from the given array $$$R$$$ and $$$C$$$.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/c10525231f8641e4bdc38734cfe29cebd84a0e4e.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>Let us consider several queries: </p><ul> <li> $$$\langle 2, 2, 1, 3 \rangle$$$: There is an even path from cell $$$(2,2)$$$ to cell $$$(1,3)$$$, e.g., $$$(2,2), (2,3), (1,3)$$$. Of course, $$$(2,2), (1,2), (1,3)$$$ is also a valid even path. </li><li> $$$\langle 4, 2, 4, 3 \rangle$$$: There is an even path from cell $$$(4,2)$$$ to cell $$$(4,3)$$$, namely $$$(4,2), (4,3)$$$. </li><li> $$$\langle 5, 1, 3, 4 \rangle$$$: There is no even path from cell $$$(5,1)$$$ to cell $$$(3,4)$$$. Observe that the only two neighboring cells of $$$(5,1)$$$ are cell $$$(5,2)$$$ and cell $$$(4,1)$$$, and both of them contain odd numbers (<span class="tex-font-style-tt">7</span> and <span class="tex-font-style-tt">11</span>, respectively), thus, there cannot be any even path originating from cell $$$(5,1)$$$. </li></ul></div><div class="input-specification"><div class="section-title">Input</div><p>Input begins with a line containing two integers: $$$N$$$ $$$Q$$$ ($$$2 \le N \le 100\,000$$$; $$$1 \le Q \le 100\,000$$$) representing the size of the maze and the number of queries, respectively. The next line contains $$$N$$$ integers: $$$R_i$$$ ($$$0 \le R_i \le 10^6$$$) representing the array $$$R$$$. The next line contains $$$N$$$ integers: $$$C_i$$$ ($$$0 \le C_i \le 10^6$$$) representing the array $$$C$$$. The next $$$Q$$$ lines each contains four integers: $$$r_a$$$ $$$c_a$$$ $$$r_b$$$ $$$c_b$$$ ($$$1 \le r_a, c_a, r_b, c_b \le N$$$) representing a query of $$$\langle r_a, c_a, r_b, c_b \rangle$$$. It is guaranteed that $$$(r_a,c_a)$$$ and $$$(r_b,c_b)$$$ are two different cells in the maze and both of them contain even numbers.</p></div><div class="output-specification"><div class="section-title">Output</div><p>For each query in the same order as input, output in a line a string &quot;<span class="tex-font-style-tt">YES</span>&quot; (without quotes) or &quot;<span class="tex-font-style-tt">NO</span>&quot; (without quotes) whether there exists an even path from cell $$$(r_a,c_a)$$$ to cell $$$(r_b,c_b)$$$.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
5 3
6 2 7 8 3
3 4 8 5 1
2 2 1 3
4 2 4 3
5 1 3 4
</pre></div><div class="output"><div class="title">Output</div><pre>
YES
YES
NO
</pre></div><div class="input"><div class="title">Input</div><pre>
3 2
30 40 49
15 20 25
2 2 3 3
1 2 2 2
</pre></div><div class="output"><div class="title">Output</div><pre>
NO
YES
</pre></div></div></div><div class="note"><div class="section-title">Note</div><p><span class="tex-font-style-it">Explanation for the sample input/output #1</span></p><p>This is the example from the problem description.</p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=C]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/36856");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="D" data-uuid="ps_508e086166ff20257d6906a15eb57858cc9a0b4b">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. Find String in a Grid</div><div class="time-limit"><div class="property-title">time limit per test</div>5 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>You have a grid $$$G$$$ containing $$$R$$$ rows (numbered from $$$1$$$ to $$$R$$$, top to bottom) and $$$C$$$ columns (numbered from $$$1$$$ to $$$C$$$, left to right) of uppercase characters. The character in the $$$r^{th}$$$ row and the $$$c^{th}$$$ column is denoted by $$$G_{r, c}$$$. You also have $$$Q$$$ strings containing uppercase characters. For each of the string, you want to find the number of occurrences of the string in the grid.</p><p>An occurrence of string $$$S$$$ in the grid is counted if $$$S$$$ can be constructed by starting at one of the cells in the grid, going right $$$0$$$ or more times, and then going down $$$0$$$ or more times. Two occurrences are different if the set of cells used to construct the string is different. Formally, for each string $$$S$$$, you would like to count the number of tuples $$$\langle r, c, \Delta r, \Delta c \rangle$$$ such that: </p><ul> <li> $$$1 \le r \le R$$$ and $$$r \le r + \Delta r \le R$$$ </li><li> $$$1 \le c \le C$$$ and $$$c \le c + \Delta c \le C$$$ </li><li> $$$S = G_{r, c} G_{r, c + 1} \dots G_{r, c + \Delta c} G_{r + 1, c + \Delta c} \dots G_{r + \Delta r, c + \Delta c}$$$ </li></ul></div><div class="input-specification"><div class="section-title">Input</div><p>Input begins with a line containing three integers: $$$R$$$ $$$C$$$ $$$Q$$$ ($$$1 \le R, C \le 500$$$; $$$1 \le Q \le 200\,000$$$) representing the size of the grid and the number of strings, respectively. The next $$$R$$$ lines each contains $$$C$$$ uppercase characters representing the grid. The $$$c^{th}$$$ character on the $$$r^{th}$$$ line is $$$G_{r, c}$$$. The next $$$Q$$$ lines each contains a string $$$S$$$ containing uppercase characters. The length of this string is a positive integer not more than $$$200\,000$$$. The sum of the length of all $$$Q$$$ strings combined is not more than $$$200\,000$$$.</p></div><div class="output-specification"><div class="section-title">Output</div><p>For each query in the same order as input, output in a line an integer representing the number of occurrences of the string in the grid.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
3 3 5
ABC
BCD
DAB
ABC
BC
BD
AC
A
</pre></div><div class="output"><div class="title">Output</div><pre>
2
3
1
0
2
</pre></div><div class="input"><div class="title">Input</div><pre>
2 3 3
AAA
AAA
A
AAA
AAAAA
</pre></div><div class="output"><div class="title">Output</div><pre>
6
4
0
</pre></div></div></div><div class="note"><div class="section-title">Note</div><p><span class="tex-font-style-it">Explanation for the sample input/output #1</span></p><ul> <li> There are $$$2$$$ occurrences of &quot;<span class="tex-font-style-tt">ABC</span>&quot;, represented by the tuples $$$\langle 1, 1, 1, 1 \rangle$$$ and $$$\langle 1, 1, 0, 2 \rangle$$$. </li><li> There are $$$3$$$ occurrences of &quot;<span class="tex-font-style-tt">BC</span>&quot;, represented by the tuples $$$\langle 1, 2, 0, 1 \rangle$$$, $$$\langle 1, 2, 1, 0 \rangle$$$, and $$$\langle 2, 1, 0, 1 \rangle$$$. </li><li> There is $$$1$$$ occurrence of &quot;<span class="tex-font-style-tt">BD</span>&quot;, represented by the tuple $$$\langle 2, 1, 1, 0 \rangle$$$. </li><li> There is no occurrence of &quot;<span class="tex-font-style-tt">AC</span>&quot;. </li><li> There are $$$2$$$ occurrences of &quot;<span class="tex-font-style-tt">A</span>&quot;, represented by the tuples $$$\langle 1, 1, 0, 0 \rangle$$$ and $$$\langle 3, 2, 0, 0 \rangle$$$. </li></ul></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=D]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/36856");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="E" data-uuid="ps_b82d4ab216940557fa201a04b58aeeb5ae1f765f">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. Songwriter</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Andi is a mathematician, a computer scientist, and a songwriter. After spending so much time writing songs, he finally writes a catchy melody that he thought as his best creation. However, the singer who will sing the song/melody has a unique vocal range, thus, an adjustment may be needed.</p><p>A melody is defined as a sequence of $$$N$$$ notes which are represented by integers. Let $$$A$$$ be the original melody written by Andi. Andi needs to adjust $$$A$$$ into a new melody $$$B$$$ such that for every $$$i$$$ where $$$1 \le i &lt; N$$$: </p><ul> <li> If $$$A_i &lt; A_{i+1}$$$, then $$$B_i &lt; B_{i+1}$$$. </li><li> If $$$A_i = A_{i+1}$$$, then $$$B_i = B_{i+1}$$$. </li><li> If $$$A_i &gt; A_{i+1}$$$, then $$$B_i &gt; B_{i+1}$$$. </li><li> $$$|B_i - B_{i+1}| \le K$$$, i.e. the difference between two successive notes is no larger than $$$K$$$. </li></ul> Moreover, the singer also requires that all notes are within her vocal range, i.e. $$$L \le B_i \le R$$$ for all $$$1 \le i \le N$$$.<p>Help Andi to determine whether such $$$B$$$ exists, and find the lexicographically smallest $$$B$$$ if it exists. A melody $$$X$$$ is lexicographically smaller than melody $$$Y$$$ if and only if there exists $$$j$$$ ($$$1 \le j \le N$$$) such that $$$X_i = Y_i$$$ for all $$$i &lt; j$$$ and $$$X_{j} &lt; Y_{j}$$$.</p><p>For example, consider a melody $$$A = \{1,3,5,6,7,8,9,10,3,7,8,9,10,11,12,12\}$$$ as shown in the following figure. The diagonal arrow up in the figure implies that $$$A_i &lt; A_{i+1}$$$, the straight right arrow implies that $$$A_i = A_{i+1}$$$, and the diagonal arrow down implies that $$$A_i &gt; A_{i+1}$$$.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/62fe7e8f17171773573e792972950f1d32517b8e.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>Supposed we want to make a new melody with $$$L = 1$$$, $$$R = 8$$$, and $$$K = 6$$$. The new melody $$$B = \{1,2,3,4,5,6,7,8,2,3,4,5,6,7,8,8\}$$$ as shown in the figure satisfies all the requirements, and it is the lexicographically smallest possible.</p></div><div class="input-specification"><div class="section-title">Input</div><p>Input begins with a line containing four integers: $$$N$$$ $$$L$$$ $$$R$$$ $$$K$$$ ($$$1 \le N \le 100\,000$$$; $$$1 \le L \le R \le 10^9$$$; $$$1 \le K \le 10^9$$$) representing the number of notes in the melody, the vocal range ($$$L$$$ and $$$R$$$), and the maximum difference between two successive notes in the new melody, respectively. The next line contains $$$N$$$ integers: $$$A_i$$$ ($$$1 \le A_i \le 10^9$$$) representing the original melody.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Output in a line $$$N$$$ integers (each separated by a single space) representing the lexicographically smallest melody satisfying all the requirements, or output <span class="tex-font-style-tt">-1</span> if there is no melody satisfying all the requirements. Note that it might be possible that the lexicographically smallest melody which satisfies all the requirements to be the same as the original melody.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
16 1 8 6
1 3 5 6 7 8 9 10 3 7 8 9 10 11 12 12
</pre></div><div class="output"><div class="title">Output</div><pre>
1 2 3 4 5 6 7 8 2 3 4 5 6 7 8 8
</pre></div><div class="input"><div class="title">Input</div><pre>
16 1 8 6
1 3 5 6 7 8 9 10 3 7 8 9 10 11 12 13
</pre></div><div class="output"><div class="title">Output</div><pre>
-1
</pre></div><div class="input"><div class="title">Input</div><pre>
16 1 10 10
1 3 5 6 7 8 9 10 3 7 8 9 1 11 12 13
</pre></div><div class="output"><div class="title">Output</div><pre>
1 2 3 4 5 6 7 8 1 2 3 4 1 2 3 4
</pre></div></div></div><div class="note"><div class="section-title">Note</div><p><span class="tex-font-style-it">Explanation for the sample input/output #1</span></p><p>This is the example from the problem description.</p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=E]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/36856");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="F" data-uuid="ps_1e3b821892058581e44310f97ccd4e29f852d78c">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">F. Regular Forestation</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>A forestation is an act of planting a bunch of trees to grow a forest, usually to replace a forest that had been cut down. Strangely enough, graph theorists have another idea on how to make a forest, i.e. by cutting down a tree!</p><p>A tree is a graph of $$$N$$$ nodes connected by $$$N - 1$$$ edges. Let $$$u$$$ be a node in a tree $$$U$$$ which degree is at least $$$2$$$ (i.e. directly connected to at least $$$2$$$ other nodes in $$$U$$$). If we remove $$$u$$$ from $$$U$$$, then we will get two or more disconnected (smaller) trees, or also known as forest by graph theorists. In this problem, we are going to investigate a special forestation of a tree done by graph theorists.</p><p>Let $$$V(S)$$$ be the set of nodes in a tree $$$S$$$ and $$$V(T)$$$ be the set of nodes in a tree $$$T$$$. Tree $$$S$$$ and tree $$$T$$$ are <span class="tex-font-style-bf">identical</span> if there exists a bijection $$$f : V(S) \rightarrow V(T)$$$ such that for all pairs of nodes $$$(s_i, s_j)$$$ in $$$V(S)$$$, $$$s_i$$$ and $$$s_j$$$ is connected by an edge in $$$S$$$ if and only if node $$$f(s_i)$$$ and $$$f(s_j)$$$ is connected by an edge in $$$T$$$. Note that $$$f(s) = t$$$ implies node $$$s$$$ in $$$S$$$ corresponds to node $$$t$$$ in $$$T$$$.</p><p>We call a node $$$u$$$ in a tree $$$U$$$ as a good cutting point if and only if the removal of $$$u$$$ from $$$U$$$ causes two or more disconnected trees, and all those disconnected trees are pairwise identical.</p><p>Given a tree $$$U$$$, your task is to determine whether there exists a good cutting point in $$$U$$$. If there is such a node, then you should output the maximum number of disconnected trees that can be obtained by removing exactly one good cutting point.</p><p>For example, consider the following tree of $$$13$$$ nodes.</p><p><img class="tex-graphics" src="https://espresso.codeforces.com/828f21035ef2c5c2d653418cc12568e344c547c6.png" style="max-width: 100.0%;max-height: 100.0%;" /></p><p>There is exactly one good cutting point in this tree, i.e. node $$$4$$$. Observe that by removing node $$$4$$$, we will get three identical trees (in this case, line graphs), i.e. $$$\{5, 1, 7, 13\}$$$, $$$\{8, 2, 11, 6\}$$$, and $$$\{3, 12, 9, 10\}$$$, which are denoted by $$$A$$$, $$$B$$$, and $$$C$$$ respectively in the figure. </p><ul> <li> The bijection function between $$$A$$$ and $$$B$$$: $$$f(5) = 8$$$, $$$f(1) = 2$$$, $$$f(7) = 11$$$, and $$$f(13) = 6$$$. </li><li> The bijection function between $$$A$$$ and $$$C$$$: $$$f(5) = 3$$$, $$$f(1) = 12$$$, $$$f(7) = 9$$$, and $$$f(13) = 10$$$. </li><li> The bijection function between $$$B$$$ and $$$C$$$: $$$f(8) = 3$$$, $$$f(2) = 12$$$, $$$f(11) = 9$$$, and $$$f(6) = 10$$$. </li></ul> Of course, there exists other bijection functions for those trees.</div><div class="input-specification"><div class="section-title">Input</div><p>Input begins with a line containting an integer: $$$N$$$ ($$$3 \le N \le 4000$$$) representing the number of nodes in the given tree. The next $$$N - 1$$$ lines each contains two integers: $$$a_i$$$ $$$b_i$$$ ($$$1 \le a_i &lt; b_i \le N$$$) representing an edge $$$(a_i,b_i)$$$ in the given tree. It is guaranteed that any two nodes in the given tree are connected to each other by a sequence of edges.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Output in a line an integer representing the maximum number of disconnected trees that can be obtained by removing exactly one good cutting point, or output <span class="tex-font-style-tt">-1</span> if there is no such good cutting point.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
13
1 5
1 7
2 4
2 8
2 11
3 12
4 7
4 12
6 11
7 13
9 10
9 12
</pre></div><div class="output"><div class="title">Output</div><pre>
3
</pre></div><div class="input"><div class="title">Input</div><pre>
6
1 2
1 3
2 4
3 5
3 6
</pre></div><div class="output"><div class="title">Output</div><pre>
-1
</pre></div></div></div><div class="note"><div class="section-title">Note</div><p><span class="tex-font-style-it">Explanation for the sample input/output #1</span></p><p>This is the example from the problem description.</p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=F]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/36856");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="G" data-uuid="ps_972d2a30c7f274703351bd440d3de395cb74d07a">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">G. Performance Review</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Randall is a software engineer at a company with $$$N$$$ employees. Every year, the company re-evaluates its employees. At the end of every year, the company replaces its several worst-performing employees and replaces with the same number of new employees, so that the company keeps having $$$N$$$ employees. Each person has a constant performance and can be represented by an integer (higher integer means better performance), and no two people have the same performance.</p><p>The performance of the initial employees are represented by an array of integers $$$A = [A_1, A_2, \dots, A_N]$$$ where $$$A_i$$$ is the performance of the $$$i^{th}$$$ employee. Randall is employee $$$1$$$, so his performance is $$$A_1$$$. We will consider the first $$$M$$$ years. At the end of the $$$i^{th}$$$ year, the company replaces its $$$R_i$$$ worst-performing employees and replaces with $$$R_i$$$ new employees. The performance of these new employees are represented by an array of integers $$$B_i = [(B_i)_1, (B_i)_2, \dots, (B_i)_{R_i}]$$$ where $$$(B_i)_j$$$ is the performance of the $$$j^{th}$$$ new employee.</p><p>He will consider $$$Q$$$ scenarios. On the $$$i^{th}$$$ scenario, he will change the value of $$$(B_{X_i})_{Y_i}$$$ to $$$Z_i$$$. For each scenario, Randall is wondering whether he will still be in the company after $$$M$$$ years. Note that the changes in each scenario are kept for the subsequent scenarios.</p></div><div class="input-specification"><div class="section-title">Input</div><p>Input begins with a line containing three integers: $$$N$$$ $$$M$$$ $$$Q$$$ ($$$2 \le N \le 100\,000$$$; $$$1 \le M, Q \le 100\,000$$$) representing the number of employees, the number of years to be considered, and the number of scenarios, respectively. The next line contains $$$N$$$ integers: $$$A_i$$$ ($$$0 \le A_i \le 10^9$$$) representing the performance of the initial employees. The next $$$M$$$ lines each contains several integers: $$$R_i$$$ $$$(B_i)_1$$$, $$$(B_i)_2$$$, $$$\cdots$$$, $$$(B_i)_{R_i}$$$ ($$$1 \le R_i &lt; N$$$; $$$0 \le (B_i)_j \le 10^9$$$) representing the number of employees replaced and the performance of the new employees, respectively. It is guaranteed that the sum of $$$R_i$$$ does not exceed $$$10^6$$$. The next $$$Q$$$ lines each contains three integers: $$$X_i$$$ $$$Y_i$$$ $$$Z_i$$$ ($$$1 \le X_i \le M$$$; $$$1 \le Y_i \le R_{(X_i)}$$$; $$$0 \le Z_i \le 10^9$$$) representing a scenario. It is guaranteed that all integers in all $$$A_i$$$, $$$(B_i)_j$$$, and $$$Z_i$$$ (combined together) are distinct.</p></div><div class="output-specification"><div class="section-title">Output</div><p>For each scenario in the same order as input, output in a line an integer $$$0$$$ if Randall will not be in the company after $$$M$$$ years, or $$$1$$$ if Randall will still be in the company after $$$M$$$ years.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
5 3 3
50 40 30 20 10
4 1 2 3 100
1 4
2 6 7
1 3 300
2 1 400
2 1 5
</pre></div><div class="output"><div class="title">Output</div><pre>
1
0
1
</pre></div></div></div><div class="note"><div class="section-title">Note</div><p><span class="tex-font-style-it">Explanation for the sample input/output #1</span></p><p>Randall performance is represented by $$$50$$$. For the first scenario, the value of $$$(B_1)_3$$$ is updated to $$$300$$$, causes the following: </p><ul> <li> Initially, the performance of the employees is $$$[50, 40, 30, 20, 10]$$$. </li><li> At the end of the first year, $$$4$$$ worst-performing employees are replaced by employees with performance $$$[300, 100, 2, 1]$$$. Therefore, the performance of the employees is $$$[300, 100, 50, 2, 1]$$$. </li><li> At the end of the second year, the performance of the employees is $$$[300, 100, 50, 4, 2]$$$. </li><li> At the end of the third year, the performance of the employees is $$$[300, 100, 50, 7, 6]$$$. </li></ul> Therefore, Randall will still be in the company after $$$3$$$ years.<p>For the second scenario, the value of $$$(B_2)_1$$$ is updated to $$$400$$$, causes the following: </p><ul> <li> Initially, the performance of the employees is $$$[50, 40, 30, 20, 10]$$$. </li><li> At the end of the first year, the performance of the employees is $$$[300, 100, 50, 2, 1]$$$. Recall that the change in the first scenario is kept for this scenario as well. </li><li> At the end of the second year, the performance of the employees is $$$[400, 300, 100, 50, 2]$$$. </li><li> At the end of the third year, the performance of the employees is $$$[400, 300, 100, 7, 6]$$$. </li></ul> Therefore, Randall will not be in the company after $$$3$$$ years.</div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=G]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/36856");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="H" data-uuid="ps_7d7ea1a5832a42c74c777f54459f8b1af7e40833">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">H. Twin Buildings</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>As you might already know, space has always been a problem in ICPC Jakarta. To cope with this, ICPC Jakarta is planning to build <span class="tex-font-style-bf">two</span> new buildings. These buildings should have a shape of a rectangle of the same size. Now, their problem is to find land to build the buildings.</p><p>There are $$$N$$$ lands available for sale. The $$$i^{th}$$$ land has a rectangular shape of size $$$L_i \times W_i$$$. For a good feng shui, the building's side should be parallel to the land's sides.</p><p>One way is to build the two buildings on two different lands, one on each land (not necessarily with the same orientation). A building of size $$$A \times B$$$ can be build on the $$$i^{th}$$$ land if and only if at least one of the following is satisfied: </p><ul> <li> $$$A \le L_i$$$ and $$$B \le W_i$$$, or </li><li> $$$A \le W_i$$$ and $$$B \le L_i$$$. </li></ul> Alternatively, it is also possible to build two buildings of $$$A \times B$$$ on the $$$i^{th}$$$ land with the same orientation. Formally, it is possible to build two buildings of $$$A \times B$$$ on the $$$i^{th}$$$ land if and only if at least one of the following is satisfied: <ul> <li> $$$A \times 2 \le L_i$$$ and $$$B \le W_i$$$, or </li><li> $$$A \times 2 \le W_i$$$ and $$$B \le L_i$$$, or </li><li> $$$A \le L_i$$$ and $$$B \times 2 \le W_i$$$, or </li><li> $$$A \le W_i$$$ and $$$B \times 2 \le L_i$$$. </li></ul><p>Your task in this problem is to help ICPC Jakarta to figure out the largest possible buildings they can build given $$$N$$$ available lands. Note that ICPC Jakarta has to build two buildings of $$$A \times B$$$; output the largest possible for $$$A \times B$$$.</p></div><div class="input-specification"><div class="section-title">Input</div><p>Input begins with a line containing an integer: $$$N$$$ ($$$1 \le N \le 100\,000$$$) representing the number of available lands. The next $$$N$$$ lines each contains two integers: $$$L_i$$$ $$$W_i$$$ ($$$1 \le L_i, W_i \le 10^9$$$) representing the size of the land.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Output in a line a number representing the largest building that ICPC Jakarta can build with exactly one decimal point (see sample input/output for clarity).</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
2
5 5
3 4
</pre></div><div class="output"><div class="title">Output</div><pre>
12.5
</pre></div><div class="input"><div class="title">Input</div><pre>
2
2 5
4 3
</pre></div><div class="output"><div class="title">Output</div><pre>
8.0
</pre></div><div class="input"><div class="title">Input</div><pre>
3
10 1
9 8
7 6
</pre></div><div class="output"><div class="title">Output</div><pre>
42.0
</pre></div></div></div><div class="note"><div class="section-title">Note</div><p><span class="tex-font-style-it">Explanation for the sample input/output #1</span></p><p>Two buildings of $$$2.5 \times 5$$$ can be built both on the first land.</p><p><span class="tex-font-style-it">Explanation for the sample input/output #2</span></p><p>Two buildings of $$$2 \times 4$$$ can be built each on the first and second lands.</p><p><span class="tex-font-style-it">Explanation for the sample input/output #3</span></p><p>Two buildings of $$$7 \times 6$$$ can be built each on the second and third lands.</p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=H]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/36856");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="I" data-uuid="ps_b19a66b383b8acb29dafe9025130b23ee2563d47">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">I. Mission Possible</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Allen, a government secret service, has been assigned to infiltrate a mafia secret base to uncover crucial information regarding the mafia's operations.</p><p>The secret base is a rectangular bounded by $$$(x_L,y_L)$$$, $$$(x_L,y_R)$$$, $$$(x_R,y_L)$$$, and $$$(x_R,y_R)$$$ in a Cartesian coordinate system where $$$x_L &lt; x_R$$$ and $$$y_L &lt; y_R$$$. There are $$$N$$$ sensors placed inside the secret base. The $$$i^{th}$$$ sensor is located at $$$(x_i, y_i)$$$ and has an effective sensing radius of $$$r_i$$$ which can detect any person who is <span class="tex-font-style-bf">strictly</span> within the radius of $$$r_i$$$ from $$$(x_i, y_i)$$$. In other words, the $$$i^{th}$$$ sensor can detect a person at location $$$(x_a, y_a)$$$ if and only if the Euclidean distance of $$$(x_i, y_i)$$$ and $$$(x_a, y_a)$$$ is strictly less than $$$r_i$$$. It is also known that the Euclidean distance of any two sensors $$$i$$$ and $$$j$$$ is strictly larger than $$$r_i + r_j$$$. Note that the Euclidean distance of two points, $$$(x_a, y_a)$$$ and $$$(x_b, y_b)$$$, is $$$\sqrt{|x_a - x_b|^2 + |y_a - y_b|^2}$$$.</p><p>Allen begins his infiltration mission at location $$$(x_s, y_s)$$$, and his target is located at $$$(x_t, y_t)$$$. Allen has the power to run extremely fast in a straight line while he needs to spend extra time to change his running trajectory (to adjust his footing). Although he is a fast runner, he still needs to make sure that none of the sensors detect him while he is running, i.e. there is no point in his running trajectory which is strictly within a sensor effective sensing radius.</p><p>Let $$$P = \{(x_{p_1}, y_{p_1}), \dots, (x_{p_{|P|}}, y_{p_{|P|}})\}$$$ be the set of locations where Allen changes his running trajectory, thus, Allen's running trajectory with $$$P$$$ is $$$(x_s, y_s) \rightarrow (x_{p_1}, y_{p_1}) \rightarrow \dots \rightarrow (x_{p_{|P|}}, y_{p_{|P|}}) \rightarrow (x_t, y_t)$$$ where $$$(x_a,y_a) \rightarrow (x_b,y_b)$$$ implies that Allen is running from $$$(x_a,y_a)$$$ to $$$(x_b,y_b)$$$ in a straight line. The set $$$P$$$ is feasible if and only if with $$$P$$$, Allen is not detected by any sensor and is not running out of the secret base (although, Allen is allowed to run along the secret base perimeter). Note that $$$x_p$$$ and $$$y_p$$$, $$$(x_p,y_p) \in P$$$, are not necessarily integers; they can be <span class="tex-font-style-bf">real numbers</span>.</p><p>Your task in this problem is to find any one feasible $$$P$$$ which contains no more than $$$1000$$$ points.</p></div><div class="input-specification"><div class="section-title">Input</div><p>Input begins with a line containing five integers: $$$N$$$ $$$x_L$$$ $$$y_L$$$ $$$x_R$$$ $$$y_R$$$ ($$$0 \le N \le 50$$$; $$$0 \le x_L &lt; x_R \le 1000$$$; $$$0 \le y_L &lt; y_R \le 1000$$$) representing the number of sensors and the secret base ($$$x_L$$$, $$$y_L$$$, $$$x_R$$$, $$$y_R$$$), respectively. The next line contains two integers: $$$x_s$$$ $$$y_s$$$ ($$$x_L &lt; x_s &lt; x_R$$$; $$$y_L &lt; y_s &lt; y_R$$$) representing Allen's initial location. The next line contains two integers: $$$x_t$$$ $$$y_t$$$ ($$$x_L &lt; x_t &lt; x_R$$$; $$$y_L &lt; y_t &lt; y_R$$$) representing Allen's target location. It is guaranteed that $$$x_s \ne x_t$$$ or $$$y_s \ne y_t$$$. The next $$$N$$$ lines each contains three integers: $$$x_i$$$ $$$y_i$$$ $$$r_i$$$ ($$$x_L &lt; x_i - r_i &lt; x_i + r_i &lt; x_R$$$; $$$y_L &lt; y_i - r_i &lt; y_i + r_i &lt; y_R$$$; $$$1 \le r_i \le 1000$$$) representing a sensor at location $$$(x_i, y_i)$$$ with an effective sensing radius of $$$r_i$$$. It is guaranteed that the Euclidean distance of any two sensors $$$i$$$ and $$$j$$$ is larger than $$$r_i + r_j$$$. It is also guaranteed that the Euclidean distance of $$$(x_s,y_s)$$$ and $$$(x_t,y_t)$$$ to any sensor $$$i$$$ is larger than $$$r_i$$$.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Output in a line an integer representing the size of a feasible $$$P$$$. The next $$$|P|$$$ lines each contains two real numbers (separated by a single space); the $$$j^{th}$$$ line contains $$$x_j$$$ $$$y_j$$$ representing the $$$j^{th}$$$ point in $$$P$$$. You may output any feasible $$$P$$$ with no more than $$$1000$$$ points.</p><p>Due to the nature of the output (floating point), let us define an epsilon $$$\epsilon$$$ to be $$$10^{-6}$$$ to verify the output. Consider $$$Q_1 = (x_s, y_s)$$$, $$$Q_{j+1} = P_j$$$ for all $$$1 \le j \le |P|$$$, and $$$Q_{|P|+2} = (x_t, y_t)$$$. Then, $$$P$$$ is considered correct if and only if $$$P$$$ contains no more than $$$1000$$$ points and all of the following are satisfied: </p><ul> <li> $$$x_L - \epsilon \le x_{p_k} \le x_R + \epsilon$$$ and $$$y_L - \epsilon \le y_{p_k} \le y_R + \epsilon$$$ for all $$$1 \le k \le |P|$$$ (Allen is not running out of the secret base). </li><li> For all $$$1 \le k &lt; |Q|$$$, let $$$S_k$$$ be the line segment connecting $$$Q_k$$$ and $$$Q_{k+1}$$$ (Allen is running in straight line). For all $$$1 \le i \le N$$$, let $$$(x_{k,i},y_{k,i})$$$ be the point along $$$S_k$$$ that is the closest to the $$$i^{th}$$$ sensor's location, $$$(x_i,y_i)$$$. Let $$$d_{k,i}$$$ be the Euclidean distance between $$$(x_{k,i},y_{k,i})$$$ and $$$(x_i,y_i)$$$. Then, the constraint $$$r_i \le d_{k,i} + \epsilon$$$ should be satisfied (Allen is not detected by any sensor). </li><li> All points in $$$Q$$$ are distinct. Two points, $$$(x_a,y_a)$$$ and $$$(x_b,y_b)$$$, are considered distinct if and only if $$$|x_a - x_b| &gt; \epsilon$$$ or $$$|y_a - y_b| &gt; \epsilon$$$. </li></ul></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
3 2 2 50 26
4 14
48 14
15 13 7
36 16 6
46 18 3
</pre></div><div class="output"><div class="title">Output</div><pre>
2
13.25 23.1234567
36.591003 7.1
</pre></div><div class="input"><div class="title">Input</div><pre>
1 0 0 1000 1000
100 501
900 501
500 251 250
</pre></div><div class="output"><div class="title">Output</div><pre>
0
</pre></div></div></div><div class="note"><div class="section-title">Note</div><p><span class="tex-font-style-it">Explanation for the sample input/output #1</span></p><p><img class="tex-graphics" src="https://espresso.codeforces.com/8536495fe705f75c24c97cad7d663da82176bdec.png" style="max-width: 100.0%;max-height: 100.0%;" /></p><p>The figure above shows the $$$P$$$ from the sample output. Note that there exists a feasible $$$P$$$ with only one point in this sample, although you are not required to find such $$$P$$$.</p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=I]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/36856");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="J" data-uuid="ps_7ad9871ffbb34f0fc5701ff0191d36820718e4ec">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">J. Tiling Terrace</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Talia has just bought an abandoned house in the outskirt of Jakarta. The house has a nice and long yard which can be represented as a one-dimensional grid containing $$$1 \times N$$$ cells. To beautify the house, Talia is going to build a terrace on the yard by tiling the cells. Each cell on the yard contains either soil (represented by the character '<span class="tex-font-style-tt">.</span>') or rock (represented by the character '<span class="tex-font-style-tt">#</span>'), and there are at most $$$50$$$ cells containing rocks.</p><p>Being a superstitious person, Talia wants to tile the terrace with mystical tiles that have the power to repel ghosts. There are three types of mystical tiles: </p><ul> <li> Type-1: Covers $$$1 \times 1$$$ cell and can only be placed on a soil cell (&quot;<span class="tex-font-style-tt">.</span>&quot;). </li><li> Type-2: Covers $$$1 \times 2$$$ cells and can only be placed on two consecutive soil cells (&quot;<span class="tex-font-style-tt">..</span>&quot;). </li><li> Type-3: Covers $$$1 \times 3$$$ cells and can only be placed on consecutive soil-rock-soil cells (&quot;<span class="tex-font-style-tt">.#.</span>&quot;). </li></ul><p>Each tile of Type-1, Type-2, and Type-3 has the power to repel $$$G_1$$$, $$$G_2$$$, and $$$G_3$$$ ghosts per day, respectively. There are also some mystical rules which must be followed for the power to be effective: </p><ul> <li> There should be no overlapping tiles, i.e. each cell is covered by at most one tile. </li><li> There should be at most $$$K$$$ tiles of Type-1, while there are no limitations for tiles of Type-2 and Type-3. </li></ul><p>Talia is scared of ghosts, thus, the terrace (which is tiled by mystical tiles) should be able to repel as many ghosts as possible. Help Talia to find the maximum number of ghosts that can be repelled per day by the terrace. Note that Talia <span class="tex-font-style-bf">does not need</span> to tile all the cells on the yard as long as the number of ghosts that can be repelled by the terrace is maximum.</p></div><div class="input-specification"><div class="section-title">Input</div><p>Input begins with a line containing five integers: $$$N$$$ $$$K$$$ $$$G_1$$$ $$$G_2$$$ $$$G_3$$$ ($$$1 \le N \le 100\,000$$$; $$$0 \le K \le N$$$; $$$0 \le G_1, G_2, G_3 \le 1000$$$) representing the number of cells, the maximum number of tiles of Type-1, the number of ghosts repelled per day by a tile of Type-1, the number of ghosts repelled per day by a tile of Type-2, and the number of ghosts repelled by a tile of Type-3, respectively. The next line contains a string of $$$N$$$ characters representing the yard. Each character in the string is either '<span class="tex-font-style-tt">.</span>' which represents a soil cell or '#' which represents a rock cell. There are at most $$$50$$$ rock cells.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Output in a line an integer representing the maximum number of ghosts that can be repelled per day.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
6 4 10 25 40
..#...
</pre></div><div class="output"><div class="title">Output</div><pre>
75
</pre></div><div class="input"><div class="title">Input</div><pre>
6 4 10 100 40
..#...
</pre></div><div class="output"><div class="title">Output</div><pre>
210
</pre></div><div class="input"><div class="title">Input</div><pre>
7 2 30 10 100
..#...#
</pre></div><div class="output"><div class="title">Output</div><pre>
160
</pre></div></div></div><div class="note"><div class="section-title">Note</div><p><span class="tex-font-style-it">Explanation for the sample input/output #1</span></p><p>Let &quot;<span class="tex-font-style-tt">A</span>&quot; be a tile of Type-1, &quot;<span class="tex-font-style-tt">BB</span>&quot; be a tile of Type-2, and &quot;<span class="tex-font-style-tt">CCC</span>&quot; be a tile of Type-3. The tiling &quot;<span class="tex-font-style-tt">ACCCBB</span>&quot; in this case produces the maximum number of ghosts that can be repelled, i.e. $$$10 + 40 + 25 = 75$$$</p><p><span class="tex-font-style-it">Explanation for the sample input/output #2</span></p><p>This sample input has the same yard with the previous sample input, but each tile of Type-2 can repel more ghosts per day. The tiling &quot;<span class="tex-font-style-tt">BB#BBA</span>&quot; or &quot;<span class="tex-font-style-tt">BB#ABB</span>&quot; produces the maximum number of ghosts that can be repelled, i.e. $$$100 + 100 + 10 = 210$$$. Observe that the third cell is left untiled.</p><p><span class="tex-font-style-it">Explanation for the sample input/output #3</span></p><p>The tiling &quot;<span class="tex-font-style-tt">ACCCA.#</span>&quot;, &quot;<span class="tex-font-style-tt">ACCC.A#</span>&quot;, or &quot;<span class="tex-font-style-tt">.CCCAA#</span>&quot; produces the maximum number of ghosts that can be repelled, i.e. $$$30 + 100 + 30 = 160$$$. Observe that there is no way to tile the last cell.</p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=J]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/36856");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="K" data-uuid="ps_d4f20b058537ed95d396027ccc130f4dbbcab924">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">K. Addition Robot</div><div class="time-limit"><div class="property-title">time limit per test</div>3 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Adding two numbers several times is a time-consuming task, so you want to build a robot. The robot should have a string $$$S = S_1 S_2 \dots S_N$$$ of $$$N$$$ characters on its memory that represents addition instructions. Each character of the string, $$$S_i$$$, is either '<span class="tex-font-style-tt">A</span>' or '<span class="tex-font-style-tt">B</span>'.</p><p>You want to be able to give $$$Q$$$ commands to the robot, each command is either of the following types: </p><ul> <li> 1 $$$L$$$ $$$R$$$. The robot should toggle all the characters of $$$S_i$$$ where $$$L \le i \le R$$$. Toggling a character means changing it to '<span class="tex-font-style-tt">A</span>' if it was previously '<span class="tex-font-style-tt">B</span>', or changing it to '<span class="tex-font-style-tt">B</span>' if it was previously '<span class="tex-font-style-tt">A</span>'. </li><li> 2 $$$L$$$ $$$R$$$ $$$A$$$ $$$B$$$. The robot should call $$$f(L, R, A, B)$$$ and return two integers as defined in the following pseudocode: <pre class="lstlisting"><code class="prettyprint">    function f(L, R, A, B):<br />      FOR i from L to R<br />        if S[i] = 'A'<br />          A = A + B<br />        else<br />          B = A + B<br />      return (A, B)<br />  </code></pre> </li></ul><p>You want to implement the robot's expected behavior.</p></div><div class="input-specification"><div class="section-title">Input</div><p>Input begins with a line containing two integers: $$$N$$$ $$$Q$$$ ($$$1 \le N, Q \le 100\,000$$$) representing the number of characters in the robot's memory and the number of commands, respectively. The next line contains a string $$$S$$$ containing $$$N$$$ characters (each either '<span class="tex-font-style-tt">A</span>' or '<span class="tex-font-style-tt">B</span>') representing the initial string in the robot's memory. The next $$$Q$$$ lines each contains a command of the following types. </p><ul> <li> 1 $$$L$$$ $$$R$$$ ($$$1 \le L \le R \le N$$$) </li><li> 2 $$$L$$$ $$$R$$$ $$$A$$$ $$$B$$$ ($$$1 \le L \le R \le N$$$; $$$0 \le A, B \le 10^9$$$) </li></ul> There is at least one command of the second type.</div><div class="output-specification"><div class="section-title">Output</div><p>For each command of the second type in the same order as input, output in a line two integers (separated by a single space), the value of $$$A$$$ and $$$B$$$ returned by $$$f(L, R, A, B)$$$, respectively. As this output can be large, you need to modulo the output by $$$1\,000\,000\,007$$$.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
5 3
ABAAA
2 1 5 1 1
1 3 5
2 2 5 0 1000000000
</pre></div><div class="output"><div class="title">Output</div><pre>
11 3
0 1000000000
</pre></div></div></div><div class="note"><div class="section-title">Note</div><p><span class="tex-font-style-it">Explanation for the sample input/output #1</span></p><p>For the first command, calling $$$f(L, R, A, B)$$$ causes the following: </p><ul> <li> Initially, $$$A = 1$$$ and $$$B = 1$$$. </li><li> At the end of $$$i = 1$$$, $$$A = 2$$$ and $$$B = 1$$$. </li><li> At the end of $$$i = 2$$$, $$$A = 2$$$ and $$$B = 3$$$. </li><li> At the end of $$$i = 3$$$, $$$A = 5$$$ and $$$B = 3$$$. </li><li> At the end of $$$i = 4$$$, $$$A = 8$$$ and $$$B = 3$$$. </li><li> At the end of $$$i = 5$$$, $$$A = 11$$$ and $$$B = 3$$$. </li></ul> Therefore, $$$f(L, R, A, B)$$$ will return $$$(11, 3)$$$.<p>For the second command, string $$$S$$$ will be updated to &quot;<span class="tex-font-style-tt">ABBBB</span>&quot;.</p><p>For the third command, the value of $$$A$$$ will always be $$$0$$$ and the value of $$$B$$$ will always be $$$1\,000\,000\,000$$$. Therefore, $$$f(L, R, A, B)$$$ will return $$$(0, 1\,000\,000\,000)$$$.</p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=K]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/36856");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 1em;"
        >


<div class="problemindexholder" problemindex="L" data-uuid="ps_7ee9de0a5cff94b8695cb2f4fed9b34e889c7cab">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">L. Road Construction</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>There are $$$N$$$ cities in the country of Numbata, numbered from $$$1$$$ to $$$N$$$. Currently, there is no road connecting them. Therefore, each of these $$$N$$$ cities proposes a road candidate to be constructed.</p><p>City $$$i$$$ likes to connect with city $$$A_i$$$, so city $$$i$$$ proposes to add a direct bidirectional road connecting city $$$i$$$ and city $$$A_i$$$. It is guaranteed that no two cities like to connect with each other. In other words, there is no pair of integers $$$i$$$ and $$$j$$$ where $$$A_i = j$$$ and $$$A_j = i$$$. It is also guaranteed that any pair of cities are connected by a sequence of road proposals. In other words, if all proposed roads are constructed, then any pair of cities are connected by a sequence of constructed road.</p><p>City $$$i$$$ also prefers the road to be constructed using a specific material. Each material can be represented by an integer (for example, $$$0$$$ for asphalt, $$$1$$$ for wood, etc.). The material that can be used for the road connecting city $$$i$$$ and city $$$A_i$$$ is represented by an array $$$B_i$$$ containing $$$M_i$$$ integers: $$$[(B_i)_1, (B_i)_2, \dots, (B_i)_{M_i}]$$$. This means that the road connecting city $$$i$$$ and city $$$A_i$$$ can be constructed with either of the material in $$$B_i$$$.</p><p>There are $$$K$$$ workers to construct the roads. Each worker is only familiar with one material, thus can only construct a road with a specific material. In particular, the $$$i^{th}$$$ worker can only construct a road with material $$$C_i$$$. Each worker can only construct at most one road. You want to assign each worker to construct a road such that any pair of cities are connected by a sequence of constructed road.</p></div><div class="input-specification"><div class="section-title">Input</div><p>Input begins with a line containing two integers: $$$N$$$ $$$K$$$ ($$$3 \le N \le 2000$$$; $$$1 \le K \le 2000$$$) representing the number of cities and the number of workers, respectively. The next $$$N$$$ lines each contains several integers: $$$A_i$$$ $$$M_i$$$ $$$(B_i)_1$$$, $$$(B_i)_2$$$, $$$\cdots$$$, $$$(B_i)_{M_i}$$$ ($$$1 \le A_i \le N$$$; $$$A_i \ne i$$$; $$$1 \le M_i \le 10\,000$$$; $$$0 \le (B_i)_1 &lt; (B_i)_2 &lt; \dots &lt; (B_i)_{M_i} \le 10^9$$$) representing the bidirectional road that city $$$i$$$ likes to construct. It is guaranteed that the sum of $$$M_i$$$ does not exceed $$$10\,000$$$. It is also guaranteed that no two cities like to connect with each other and any pair of cities are connected by a sequence of road proposals. The next line contains $$$K$$$ integers: $$$C_i$$$ ($$$0 \le C_i \le 10^9$$$) representing the material that is familiarized by the workers.</p></div><div class="output-specification"><div class="section-title">Output</div><p>If it is not possible to assign each worker to construct a road such that any pair of cities are connected by a sequence of constructed road, simply output <span class="tex-font-style-tt">-1</span> in a line. Otherwise, for each worker in the same order as input, output in a line two integers (separated by a single space): $$$u$$$ and $$$v$$$ in any order. This means that the worker constructs a direct bidirectional road connecting city $$$u$$$ and $$$v$$$. If the worker does not construct any road, output &quot;<span class="tex-font-style-tt">0 0</span>&quot; (without quotes) instead. Each pair of cities can only be assigned to at most one worker. You may output any assignment as long as any pair of cities are connected by a sequence of constructed road.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
4 5
2 2 1 2
3 2 2 3
4 2 3 4
2 2 4 5
1 2 3 4 5
</pre></div><div class="output"><div class="title">Output</div><pre>
1 2
2 3
3 4
0 0
4 2
</pre></div><div class="input"><div class="title">Input</div><pre>
4 5
2 2 10 20
3 2 2 3
4 2 3 4
2 2 4 5
1 2 3 4 5
</pre></div><div class="output"><div class="title">Output</div><pre>
-1
</pre></div></div></div><div class="note"><div class="section-title">Note</div><p><span class="tex-font-style-it">Explanation for the sample input/output #1</span></p><p>We can assign the workers to construct the following roads: </p><ul> <li> The first worker constructs a road connecting city $$$1$$$ and city $$$2$$$. </li><li> The second worker constructs a road connecting city $$$2$$$ and city $$$3$$$. </li><li> The third worker constructs a road connecting city $$$3$$$ and city $$$4$$$. </li><li> The fourth worker does not construct any road. </li><li> The fifth worker constructs a road connecting city $$$4$$$ and city $$$2$$$. </li></ul> Therefore, any pair of cities are now connected by a sequence of constructed road.<p><span class="tex-font-style-it">Explanation for the sample input/output #2</span></p><p>There is no worker that can construct a road connecting city $$$1$$$, thus city $$$1$$$ is certainly isolated.</p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=L]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/36856");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
    </div>

    <div id="footer">
        <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2024 Mike Mirzayanov</div>
        <div>The only programming contests Web 2.0 platform</div>

    </div>

</div>
</div>
    <script type="application/javascript">
        if ('serviceWorker' in navigator && 'fetch' in window && 'caches' in window) {
            navigator.serviceWorker.register('/service-worker-36856.js')
                .then(function (registration) {
                    console.log('Service worker registered: ', registration);
                })
                .catch(function (error) {
                    console.log('Registration failed: ', error);
                });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8a1863e28a7a1cd6',t:'MTcyMDY5NjY3OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

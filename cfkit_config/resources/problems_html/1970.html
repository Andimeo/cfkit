
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-743380-5"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-743380-5');
        </script>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="ba51be1193641bf608b3d4d1341915b3"/>
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01"/>

    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery-1.8.3.js"></script>
    <script type="application/javascript">
        window.locale = "en";
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }

        /* Protection against trailing dot in domain. */
        let hostLength = window.location.host.length;
        if (hostLength > 1 && window.location.host[hostLength - 1] === '.') {
            window.location = window.location.protocol + "//" + window.location.host.substring(0, hostLength - 1);
        }
    </script>

    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="j3">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="//codeforces.org/s/60067/images/codeforces-sponsored-by-ton.png" />
    <link rel="image_src" href="//codeforces.org/s/60067/images/codeforces-sponsored-by-ton.png" />
    <meta property="og:title" content="Problems - Codeforces"/>
    <meta property="og:description" content=""/>
    
    <meta property="og:site_name" content="Codeforces"/>
    
    
    
    
    
    
    <meta name="utc_offset" content="+03:00"/>
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Problems - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community" />
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup" />
    <meta name="robots" content="index, follow" />

    <link rel="stylesheet" href="//codeforces.org/s/60067/css/font-awesome.min.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/line-awesome.min.css" type="text/css" charset="utf-8" />

        <link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>


    <link rel="apple-touch-icon" sizes="57x57" href="//codeforces.org/s/60067/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="//codeforces.org/s/60067/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="//codeforces.org/s/60067/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="//codeforces.org/s/60067/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="//codeforces.org/s/60067/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="//codeforces.org/s/60067/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="//codeforces.org/s/60067/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="//codeforces.org/s/60067/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="//codeforces.org/s/60067/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="//codeforces.org/s/60067/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="//codeforces.org/s/60067/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="//codeforces.org/s/60067/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="//codeforces.org/s/60067/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="//codeforces.org/s/60067/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/prettify.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/clear.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/ttypography.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/problem-statement.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/second-level-menu.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/roundbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/datatable.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/table-form.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/topic.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/jquery.jgrowl.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/facebox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/jquery.wysiwyg.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/jquery.autocomplete.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/codeforces.datepick.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/colorbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/jquery.drafts.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/60067/css/community.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/60067/css/sidebar-menu.css" type="text/css" charset="utf-8" />

    <!-- MathJax -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    MathJax.Hub.Register.StartupHook("End", function () {
        Codeforces.runMathJaxListeners();
    });
    </script>
    <script type="text/javascript" async
            src="https://mathjax.codeforces.org/MathJax.js?config=TeX-AMS_HTML-full"
    >
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="//codeforces.org/s/60067/js/prettify/prettify.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/pushstream.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.easing.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.swipe.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.hotkeys.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/facebox.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/controls/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/controls/wysiwyg.table.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/controls/wysiwyg.image.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/controls/wysiwyg.link.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.datepick.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.drafts.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/clipboard.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/autosize.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/sjcl.js"></script>
    <script type="text/javascript" src="/scripts/68aa7efc4fbbd6282d910ae57877f8bf/en/codeforces-options.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/codeforces.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/EventCatcher.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/preparedVerdictFormats-en.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/confetti.min.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="//codeforces.org/s/60067/markitup/skins/markitup/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/markitup/sets/markdown/style.css" type="text/css" charset="utf-8" />


    <script type="text/javascript" src="//codeforces.org/s/60067/markitup/jquery.markitup.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/markitup/sets/markdown/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->




</head>
<body class=" "><span style='display:none;' class='csrf-token' data-csrf='ba51be1193641bf608b3d4d1341915b3'>&nbsp;</span>

<!-- .notificationTextCleaner used in Codeforces.showAnnouncements() -->
<div class="notificationTextCleaner" style="font-size: 0"></div>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 3.0rem;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    String.prototype.hashCode = function() {
        var hash = 0, i, chr;
        if (this.length === 0) return hash;
        for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };

    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile === "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>





    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 700
        });
    }, 100);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


    function showAnnouncements(json) {
        //info("j=" + JSON.stringify(json));

        if (json.t != "a") {
            return;
        }

        setTimeout(function() {
            Codeforces.showAnnouncements(json.d, "en");
        }, Math.random() * 500);
    }

    function showEventCatcherUserMessage(json) {
        if (json.t == "s") {
            var points = json.d[5];
            var passedTestCount = json.d[7];
            var judgedTestCount = json.d[8];
            var verdict = preparedVerdictFormats[json.d[12]];
            var verdictPrototypeDiv = $(".verdictPrototypeDiv");
            verdictPrototypeDiv.html(verdict);
            if (judgedTestCount != null && judgedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-judged").text(judgedTestCount);
            }
            if (passedTestCount != null && passedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-passed").text(passedTestCount);
            }
            if (points != null && points != undefined) {
                verdictPrototypeDiv.find(".verdict-format-points").text(points);
            }
            Codeforces.showMessage(verdictPrototypeDiv.text());
        }
    }

    $(".clickable-title").each(function() {
        var title = $(this).attr("data-title");
        if (title) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = title;
            $(this).attr("title", tmp.textContent || tmp.innerText || "");
        }
    });

    $(".clickable-title").click(function() {
        var title = $(this).attr("data-title");
        if (title) {
            Codeforces.alert(title);
        } else {
            Codeforces.alert($(this).attr("title"));
        }
    }).css("position", "relative").css("bottom", "3px");

        Codeforces.showDelayedMessage();

    Codeforces.reformatTimes();

    //Codeforces.initializePubSub();
    if (window.codeforcesOptions.subscribeServerUrl) {
        window.eventCatcher = new EventCatcher(
            window.codeforcesOptions.subscribeServerUrl,
            [
                Codeforces.getGlobalChannel(),
                Codeforces.getUserChannel(),
                Codeforces.getUserShowMessageChannel(),
                Codeforces.getContestChannel(),
                Codeforces.getParticipantChannel(),
                Codeforces.getTalkChannel()
            ]
        );

        if (Codeforces.getParticipantChannel()) {
            window.eventCatcher.subscribe(Codeforces.getParticipantChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getContestChannel()) {
            window.eventCatcher.subscribe(Codeforces.getContestChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getGlobalChannel()) {
            window.eventCatcher.subscribe(Codeforces.getGlobalChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserShowMessageChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserShowMessageChannel(), function(json) {
                showEventCatcherUserMessage(json);
            });
        }
    }

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>


<div id="body">
<div style="width: 950px; margin: 0 auto;" class="compact-problemset">
    <div id="header" style="position: relative; margin: 0;">
        <div style="float:left;">
                  <a href="/"><img height="65" style="height: 65px;" src="//codeforces.org/s/60067/images/codeforces-sponsored-by-ton.png" alt="Codeforces"/></a>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="//codeforces.org/s/60067/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="//codeforces.org/s/60067/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <br style="clear: both;"/>

    <div style="text-align: center; font-size: 1.8rem; margin-bottom: 0.5em;"
         class="caption">Helvetic Coding Contest 2024 online mirror (teams allowed, unrated)</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

    <div class="problem-frames">
        <div
                    style="margin-bottom: 2em;"
        >

    <style>
        #facebox .content:has(.diff-popup) {
            width: 90vw;
            max-width: 120rem !important;
        }

        .testCaseMarker {
            position: absolute;
            font-weight: bold;
            font-size: 1rem;
        }

        .diff-popup {
            width: 90vw;
            max-width: 120rem !important;
            display: none;
            overflow: auto;
        }

        .input-output-copier {
            font-size: 1.2rem;
            float: right;
            color: #888 !important;
            cursor: pointer;
            border: 1px solid rgb(185, 185, 185);
            padding: 3px;
            margin: 1px;
            line-height: 1.1rem;
            text-transform: none;
        }

        .input-output-copier:hover {
            background-color: #def;
        }

        .test-explanation textarea {
            width: 100%;
            height: 1.5em;
        }

        .pending-submission-message {
            color: darkorange !important;
        }
    </style>
    <script>
        const OPENING_SPACE = String.fromCharCode(1001);
        const CLOSING_SPACE = String.fromCharCode(1002);

        const nodeToText = function (node, pre) {
            let result = [];

            if (node.tagName === "SCRIPT" || node.tagName === "math"
                || (node.classList && node.classList.contains("input-output-copier")))
                return [];

            if (node.tagName === "NOBR") {
                result.push(OPENING_SPACE);
            }

            if (node.nodeType === Node.TEXT_NODE) {
                let s = node.textContent;
                if (!pre) {
                    s = s.replace(/\s+/g, " ");
                }
                if (s.length > 0) {
                    result.push(s);
                }
            }

            if (pre && node.tagName === "BR") {
                result.push("\n");
            }

            node.childNodes.forEach(function (child) {
                result.push(nodeToText(child, node.tagName === "PRE").join(""));
            });

            if (node.tagName === "DIV"
                || node.tagName === "P"
                || node.tagName === "PRE"
                || node.tagName === "UL"
                || node.tagName === "LI"
            ) {
                result.push("\n");
            }

            if (node.tagName === "NOBR") {
                result.push(CLOSING_SPACE);
            }

            return result;
        }

        const isSpecial = function (c) {
            return c === ',' || c === '.' || c === ';' || c === ')' || c === ' ';
        }

        const convertStatementToText = function(statmentNode) {
            const text = nodeToText(statmentNode, false).join("").replace(/ +/g, " ").replace(/\n\n+/g, "\n\n");
            let result = [];
            for (let i = 0; i < text.length; i++) {
                const c = text.charAt(i);
                if (c === OPENING_SPACE) {
                    if (!((i > 0 && text.charAt(i - 1) === '(') || (result.length > 0 && result[result.length - 1] === ' '))) {
                        result.push('+');
                    }
                } else if (c === CLOSING_SPACE) {
                    if (!(i + 1 < text.length && isSpecial(text.charAt(i + 1)))) {
                        result.push('-');
                    }
                } else {
                    result.push(c);
                }
            }
            return result.join("").split("\n").map(value => value.trim()).join("\n");
        };
    </script>
    <div class="diff-popup">
    </div>

<div class="problemindexholder" problemindex="A1" data-uuid="ps_65e774d78e6163de34688e27d8822697e5b4773b">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A1. Balanced Shuffle (Easy)</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>A <span class="tex-font-style-it">parentheses sequence</span> is a string consisting of characters &quot;<span class="tex-font-style-tt">(</span>&quot; and &quot;<span class="tex-font-style-tt">)</span>&quot;, for example &quot;<span class="tex-font-style-tt">(()((</span>&quot;.</p><p>A <span class="tex-font-style-it">balanced parentheses sequence</span> is a parentheses sequence which can become a valid mathematical expression after inserting numbers and operations into it, for example &quot;<span class="tex-font-style-tt">(()(()))</span>&quot;.</p><p>The <span class="tex-font-style-it">balance</span> of a parentheses sequence is defined as the number of opening parentheses &quot;<span class="tex-font-style-tt">(</span>&quot; minus the number of closing parentheses &quot;<span class="tex-font-style-tt">)</span>&quot;. For example, the balance of the sequence &quot;<span class="tex-font-style-tt">(()((</span>&quot; is 3.</p><p>A balanced parentheses sequence can also be defined as a parentheses sequence with balance 0 such that each of its prefixes has a non-negative balance.</p><p>We define the <span class="tex-font-style-it">balanced shuffle</span> operation that takes a parentheses sequence and returns a parentheses sequence as follows: first, for every character of the input sequence, we compute the balance of the prefix of the sequence <span class="tex-font-style-it">before</span> that character and write those down in a table together with the positions of the characters in the input sequence, for example:</p><p><table class="tex-tabular"><tbody><tr><td class="tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-bottom">Prefix balance</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">0</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">1</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">2</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">1</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">2</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">3</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">2</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-bottom">1</td></tr><tr><td class="tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">Position</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">1</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">2</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">3</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">4</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">5</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">6</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">7</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-top tex-tabular-border-bottom">8</td></tr><tr><td class="tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top">Character</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">(</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">(</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">)</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">(</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">(</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">)</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">)</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-top"><span class="tex-font-style-tt">)</span></td></tr></tbody></table></p><p>Then, we sort the columns of this table in <span class="tex-font-style-it">increasing</span> order of prefix balance, breaking ties in <span class="tex-font-style-it">decreasing</span> order of position. In the above example, we get:</p><p><table class="tex-tabular"><tbody><tr><td class="tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-bottom">Prefix balance</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">0</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">1</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">1</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">1</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">2</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">2</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">2</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-bottom">3</td></tr><tr><td class="tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">Position</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">1</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">8</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">4</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">2</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">7</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">5</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">3</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-top tex-tabular-border-bottom">6</td></tr><tr><td class="tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top">Character</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">(</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">)</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">(</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">(</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">)</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">(</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">)</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-top"><span class="tex-font-style-tt">)</span></td></tr></tbody></table></p><p>The last row of this table forms another parentheses sequence, in this case &quot;<span class="tex-font-style-tt">()(()())</span>&quot;. This sequence is called the result of applying the balanced shuffle operation to the input sequence, or in short just the balanced shuffle of the input sequence.</p><p>You are given a balanced parentheses sequence. Print its balanced shuffle.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The only line of input contains a string $$$s$$$ consisting only of characters &quot;<span class="tex-font-style-tt">(</span>&quot; and &quot;<span class="tex-font-style-tt">)</span>&quot;. This string is guaranteed to be a non-empty balanced parentheses sequence with its length not exceeding $$$500\,000$$$.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print the parentheses sequence $$$t$$$ — the balanced shuffle of $$$s$$$.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
(()(()))
</pre></div><div class="output"><div class="title">Output</div><pre>
()(()())
</pre></div></div></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=A1]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {
        window.changedTests = new Set();

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");



        String.prototype.replaceAll = function (search, replace) {
            return this.split(search).join(replace);
        };

        $(".sample-test .title").each(function () {
            const preId = ("id" + Math.random()).replaceAll(".", "0");
            const cpyId = ("id" + Math.random()).replaceAll(".", "0");

            $(this).parent().find("pre").attr("id", preId);
            const $copy = $("<div title='Copy' data-clipboard-target='#" + preId + "' id='" + cpyId + "' class='input-output-copier'>Copy</div>");
            $(this).append($copy);

            const clipboard = new Clipboard('#' + cpyId, {
                text: function (trigger) {
                    const pre = document.querySelector('#' + preId);
                    const lines = pre.querySelectorAll(".test-example-line");
                    return Codeforces.filterClipboardText(pre.innerText, lines.length);
                }
            });

            const isInput = $(this).parent().hasClass("input");

            clipboard.on('success', function (e) {
                if (isInput) {
                    Codeforces.showMessage("The example input has been copied into the clipboard");
                } else {
                    Codeforces.showMessage("The example output has been copied into the clipboard");
                }
                e.clearSelection();
            });
        });

        $(".test-form-item input").change(function () {
            addPendingSubmissionMessage($($(this).closest("form")), "You changed the answer, do not forget to submit it if you want to save the changes");
            const index = $(this).closest(".problemindexholder").attr("problemindex");
            let test = "";
            $(this).closest("form input").each(function () {
                const test_ = $(this).attr("name");
                if (test_ && test_.substring(0, 4) === "test") {
                    test = test_;
                }
            });
            if (index.length > 0 && test.length > 0) {
                const indexTest = index + "::" + test;
                window.changedTests.add(indexTest);
            }
        });

        $(window).on('beforeunload', function () {
            if (window.changedTests.size > 0) {
                return 'Dialog text here';
            }
        });

        autosize($('.test-explanation textarea'));

        $(".test-example-line").hover(function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        let top = 1E20;
                        let left = 1E20;
                        let problem = $(this).closest(".problemindexholder");
                        $(this).closest(".input").find("." + clazz).css("background-color", "#FFFDE7").each(function() {
                            top = Math.min(top, $(this).offset().top);
                            left = Math.min(left, $(this).offset().left);
                        });
                        let testCaseMarker = problem.find(".testCaseMarker_" + end);
                        if (testCaseMarker.length === 0) {
                            const html = "<div class=\"testCaseMarker testCaseMarker_" + end + " notice\"></div>";
                            problem.append($(html));
                            testCaseMarker = problem.find(".testCaseMarker_" + end);
                        }
                        if (testCaseMarker) {
                            testCaseMarker.show()
                                    .offset({top, left: left - 20})
                                    .text(end);
                        }
                    }
                }
            });
        }, function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        $("." + clazz).css("background-color", "");
                        $(this).closest(".problemindexholder").find(".testCaseMarker_" + end).hide();
                    }
                }
            });
        });

    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="A2" data-uuid="ps_97227a8dfa8dedb3df4c26dbf4197b5a0dfbe8a3">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A2. Balanced Unshuffle (Medium)</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p><span class="tex-font-style-bf">The differences with the easy version of this problem are highlighted in bold.</span></p><p>A <span class="tex-font-style-it">parentheses sequence</span> is a string consisting of characters &quot;<span class="tex-font-style-tt">(</span>&quot; and &quot;<span class="tex-font-style-tt">)</span>&quot;, for example &quot;<span class="tex-font-style-tt">(()((</span>&quot;.</p><p>A <span class="tex-font-style-it">balanced parentheses sequence</span> is a parentheses sequence which can become a valid mathematical expression after inserting numbers and operations into it, for example &quot;<span class="tex-font-style-tt">(()(()))</span>&quot;.</p><p>The <span class="tex-font-style-it">balance</span> of a parentheses sequence is defined as the number of opening parentheses &quot;<span class="tex-font-style-tt">(</span>&quot; minus the number of closing parentheses &quot;<span class="tex-font-style-tt">)</span>&quot;. For example, the balance of the sequence &quot;<span class="tex-font-style-tt">(()((</span>&quot; is 3.</p><p>A balanced parentheses sequence can also be defined as a parentheses sequence with balance 0 such that each of its prefixes has a non-negative balance.</p><p>We define the <span class="tex-font-style-it">balanced shuffle</span> operation that takes a parentheses sequence and returns a parentheses sequence as follows: first, for every character of the input sequence, we compute the balance of the prefix of the sequence <span class="tex-font-style-it">before</span> that character and write those down in a table together with the positions of the characters in the input sequence, for example:</p><p><table class="tex-tabular"><tbody><tr><td class="tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-bottom">Prefix balance</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">0</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">1</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">2</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">1</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">2</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">3</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">2</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-bottom">1</td></tr><tr><td class="tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">Position</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">1</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">2</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">3</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">4</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">5</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">6</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">7</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-top tex-tabular-border-bottom">8</td></tr><tr><td class="tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top">Character</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">(</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">(</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">)</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">(</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">(</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">)</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">)</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-top"><span class="tex-font-style-tt">)</span></td></tr></tbody></table></p><p>Then, we sort the columns of this table in <span class="tex-font-style-it">increasing</span> order of prefix balance, breaking ties in <span class="tex-font-style-it">decreasing</span> order of position. In the above example, we get:</p><p><table class="tex-tabular"><tbody><tr><td class="tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-bottom">Prefix balance</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">0</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">1</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">1</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">1</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">2</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">2</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">2</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-bottom">3</td></tr><tr><td class="tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">Position</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">1</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">8</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">4</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">2</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">7</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">5</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">3</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-top tex-tabular-border-bottom">6</td></tr><tr><td class="tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top">Character</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">(</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">)</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">(</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">(</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">)</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">(</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">)</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-top"><span class="tex-font-style-tt">)</span></td></tr></tbody></table></p><p>The last row of this table forms another parentheses sequence, in this case &quot;<span class="tex-font-style-tt">()(()())</span>&quot;. This sequence is called the result of applying the balanced shuffle operation to the input sequence, or in short just the balanced shuffle of the input sequence.</p><p><span class="tex-font-style-bf">Surprisingly, it turns out that the balanced shuffle of any balanced parentheses sequence is always another balanced parentheses sequence (we will omit the proof for brevity). Even more surprisingly, the balanced shuffles of two different balanced parentheses sequences are always different, therefore the balanced shuffle operation is a bijection on the set of balanced parentheses sequences of any given length (we will omit this proof, too).</span></p><p><span class="tex-font-style-bf">You are given a balanced parentheses sequence. Find its preimage: the balanced parentheses sequence the balanced shuffle of which is equal to the given sequence.</span></p></div><div class="input-specification"><div class="section-title">Input</div><p>The only line of input contains a string $$$s$$$ consisting only of characters &quot;<span class="tex-font-style-tt">(</span>&quot; and &quot;<span class="tex-font-style-tt">)</span>&quot;. This string is guaranteed to be a non-empty balanced parentheses sequence with its <span class="tex-font-style-bf">length not exceeding $$$1\,000$$$</span>.</p></div><div class="output-specification"><div class="section-title">Output</div><p><span class="tex-font-style-bf">Print the balanced parentheses sequence $$$t$$$ such that the balanced shuffle of $$$t$$$ is equal to $$$s$$$. It is guaranteed that the answer always exists and is unique.</span></p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
()(()())
</pre></div><div class="output"><div class="title">Output</div><pre>
(()(()))
</pre></div></div></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=A2]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="A3" data-uuid="ps_34d88b093c0558d717b2185f2ae15b51554ed473">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A3. Balanced Unshuffle (Hard)</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p><span class="tex-font-style-bf">The only difference with the medium version is the maximum length of the input.</span></p><p>A <span class="tex-font-style-it">parentheses sequence</span> is a string consisting of characters &quot;<span class="tex-font-style-tt">(</span>&quot; and &quot;<span class="tex-font-style-tt">)</span>&quot;, for example &quot;<span class="tex-font-style-tt">(()((</span>&quot;.</p><p>A <span class="tex-font-style-it">balanced parentheses sequence</span> is a parentheses sequence which can become a valid mathematical expression after inserting numbers and operations into it, for example &quot;<span class="tex-font-style-tt">(()(()))</span>&quot;.</p><p>The <span class="tex-font-style-it">balance</span> of a parentheses sequence is defined as the number of opening parentheses &quot;<span class="tex-font-style-tt">(</span>&quot; minus the number of closing parentheses &quot;<span class="tex-font-style-tt">)</span>&quot;. For example, the balance of the sequence &quot;<span class="tex-font-style-tt">(()((</span>&quot; is 3.</p><p>A balanced parentheses sequence can also be defined as a parentheses sequence with balance 0 such that each of its prefixes has a non-negative balance.</p><p>We define the <span class="tex-font-style-it">balanced shuffle</span> operation that takes a parentheses sequence and returns a parentheses sequence as follows: first, for every character of the input sequence, we compute the balance of the prefix of the sequence <span class="tex-font-style-it">before</span> that character and write those down in a table together with the positions of the characters in the input sequence, for example:</p><p><table class="tex-tabular"><tbody><tr><td class="tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-bottom">Prefix balance</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">0</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">1</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">2</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">1</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">2</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">3</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">2</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-bottom">1</td></tr><tr><td class="tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">Position</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">1</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">2</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">3</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">4</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">5</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">6</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">7</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-top tex-tabular-border-bottom">8</td></tr><tr><td class="tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top">Character</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">(</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">(</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">)</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">(</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">(</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">)</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">)</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-top"><span class="tex-font-style-tt">)</span></td></tr></tbody></table></p><p>Then, we sort the columns of this table in <span class="tex-font-style-it">increasing</span> order of prefix balance, breaking ties in <span class="tex-font-style-it">decreasing</span> order of position. In the above example, we get:</p><p><table class="tex-tabular"><tbody><tr><td class="tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-bottom">Prefix balance</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">0</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">1</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">1</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">1</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">2</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">2</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom">2</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-bottom">3</td></tr><tr><td class="tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">Position</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">1</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">8</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">4</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">2</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">7</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">5</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">3</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-top tex-tabular-border-bottom">6</td></tr><tr><td class="tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top">Character</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">(</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">)</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">(</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">(</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">)</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">(</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top"><span class="tex-font-style-tt">)</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-top"><span class="tex-font-style-tt">)</span></td></tr></tbody></table></p><p>The last row of this table forms another parentheses sequence, in this case &quot;<span class="tex-font-style-tt">()(()())</span>&quot;. This sequence is called the result of applying the balanced shuffle operation to the input sequence, or in short just the balanced shuffle of the input sequence.</p><p>Surprisingly, it turns out that the balanced shuffle of any balanced parentheses sequence is always another balanced parentheses sequence (we will omit the proof for brevity). Even more surprisingly, the balanced shuffles of two different balanced parentheses sequences are always different, therefore the balanced shuffle operation is a bijection on the set of balanced parentheses sequences of any given length (we will omit this proof, too).</p><p>You are given a balanced parentheses sequence. Find its preimage: the balanced parentheses sequence the balanced shuffle of which is equal to the given sequence.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The only line of input contains a string $$$s$$$ consisting only of characters &quot;<span class="tex-font-style-tt">(</span>&quot; and &quot;<span class="tex-font-style-tt">)</span>&quot;. This string is guaranteed to be a non-empty balanced parentheses sequence with its <span class="tex-font-style-bf">length not exceeding $$$500\,000$$$</span>.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print the balanced parentheses sequence $$$t$$$ such that the balanced shuffle of $$$t$$$ is equal to $$$s$$$. It is guaranteed that the answer always exists and is unique.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
()(()())
</pre></div><div class="output"><div class="title">Output</div><pre>
(()(()))
</pre></div></div></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=A3]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="B1" data-uuid="ps_011bbaa2e8ec8074eecbbb7d5ac9be0431f9e00a">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B1. Exact Neighbours (Easy)</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p><span class="tex-font-style-bf">The only difference between this and the hard version is that all $$$a_{i}$$$ are even.</span></p><p>After some recent attacks on Hogwarts Castle by the Death Eaters, the Order of the Phoenix has decided to station $$$n$$$ members in Hogsmead Village. The houses will be situated on a picturesque $$$n\times n$$$ square field. Each wizard will have their own house, and every house will belong to some wizard. Each house will take up the space of one square.</p><p>However, as you might know wizards are very superstitious. During the weekends, each wizard $$$i$$$ will want to visit the house that is exactly $$$a_{i}$$$ $$$(0 \leq a_{i} \leq n)$$$ away from their own house. The roads in the village are built horizontally and vertically, so the distance between points $$$(x_{i}, y_{i})$$$ and $$$(x_{j}, y_{j})$$$ on the $$$n\times n$$$ field is $$$ |x_{i} - x_{j}| + |y_{i} - y_{j}|$$$. The wizards know and trust each other, so one wizard can visit another wizard's house when the second wizard is away. The houses to be built will be big enough for all $$$n$$$ wizards to simultaneously visit any house.</p><p>Apart from that, each wizard is mandated to have a view of the Hogwarts Castle in the north and the Forbidden Forest in the south, so the house of no other wizard should block the view. In terms of the village, it means that in each column of the $$$n\times n$$$ field, there can be at most one house, i.e. if the $$$i$$$-th house has coordinates $$$(x_{i}, y_{i})$$$, then $$$x_{i} \neq x_{j}$$$ for all $$$i \neq j$$$.</p><p>The Order of the Phoenix doesn't yet know if it is possible to place $$$n$$$ houses in such a way that will satisfy the visit and view requirements of all $$$n$$$ wizards, so they are asking for your help in designing such a plan.</p><p>If it is possible to have a correct placement, where for the $$$i$$$-th wizard there is a house that is $$$a_{i}$$$ away from it and the house of the $$$i$$$-th wizard is the only house in their column, output <span class="tex-font-style-tt">YES</span>, the position of houses for each wizard, and to the house of which wizard should each wizard go during the weekends.</p><p>If it is impossible to have a correct placement, output <span class="tex-font-style-tt">NO</span>.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains $$$n$$$ ($$$2 \leq n \leq 2\cdot 10^{5}$$$), the number of houses to be built.</p><p>The second line contains $$$n$$$ integers $$$a_{1}, \ldots, a_{n}$$$ $$$(0 \leq a_{i} \leq n)$$$. All $$$a_{i}$$$ are even.</p></div><div class="output-specification"><div class="section-title">Output</div><p>If there exists such a placement, output <span class="tex-font-style-tt">YES</span> on the first line; otherwise, output <span class="tex-font-style-tt">NO</span>.</p><p>If the answer is <span class="tex-font-style-tt">YES</span>, output $$$n + 1$$$ more lines describing the placement.</p><p>The next $$$n$$$ lines should contain the positions of the houses $$$1 \leq x_{i}, y_{i} \leq n$$$ for each wizard.</p><p>The $$$i$$$-th element of the last line should contain the index of the wizard, the house of which is exactly $$$a_{i}$$$ away from the house of the $$$i$$$-th wizard. If there are multiple such wizards, you can output any.</p><p>If there are multiple house placement configurations, you can output any.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
4
0 4 2 4</pre></div><div class="output"><div class="title">Output</div><pre>
YES
4 4
1 3
2 4
3 1
1 1 1 3</pre></div></div></div><div class="note"><div class="section-title">Note</div><p>For the sample, the house of the 1st wizard is located at $$$(4, 4)$$$, of the 2nd at $$$(1, 3)$$$, of the 3rd at $$$(2, 4)$$$, of the 4th at $$$(3, 1)$$$.</p><p>The distance from the house of the 1st wizard to the house of the 1st wizard is $$$|4 - 4| + |4 - 4| = 0$$$.</p><p>The distance from the house of the 2nd wizard to the house of the 1st wizard is $$$|1 - 4| + |3 - 4| = 4$$$.</p><p>The distance from the house of the 3rd wizard to the house of the 1st wizard is $$$|2 - 4| + |4 - 4| = 2$$$.</p><p>The distance from the house of the 4th wizard to the house of the 3rd wizard is $$$|3 - 2| + |1 - 4| = 4$$$.</p><p>The view and the distance conditions are satisfied for all houses, so the placement is correct.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/ddce45085204f6f73f5d168a9e6342ca5c4803e1.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=B1]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="B2" data-uuid="ps_1565b577cf455d0951454985bbc4bde5ee5be272">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B2. Exact Neighbours (Medium)</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p><span class="tex-font-style-bf">The only difference between this and the hard version is that $$$a_{1} = 0$$$.</span></p><p>After some recent attacks on Hogwarts Castle by the Death Eaters, the Order of the Phoenix has decided to station $$$n$$$ members in Hogsmead Village. The houses will be situated on a picturesque $$$n\times n$$$ square field. Each wizard will have their own house, and every house will belong to some wizard. Each house will take up the space of one square.</p><p>However, as you might know wizards are very superstitious. During the weekends, each wizard $$$i$$$ will want to visit the house that is exactly $$$a_{i}$$$ $$$(0 \leq a_{i} \leq n)$$$ away from their own house. The roads in the village are built horizontally and vertically, so the distance between points $$$(x_{i}, y_{i})$$$ and $$$(x_{j}, y_{j})$$$ on the $$$n\times n$$$ field is $$$ |x_{i} - x_{j}| + |y_{i} - y_{j}|$$$. The wizards know and trust each other, so one wizard can visit another wizard's house when the second wizard is away. The houses to be built will be big enough for all $$$n$$$ wizards to simultaneously visit any house.</p><p>Apart from that, each wizard is mandated to have a view of the Hogwarts Castle in the north and the Forbidden Forest in the south, so the house of no other wizard should block the view. In terms of the village, it means that in each column of the $$$n\times n$$$ field, there can be at most one house, i.e. if the $$$i$$$-th house has coordinates $$$(x_{i}, y_{i})$$$, then $$$x_{i} \neq x_{j}$$$ for all $$$i \neq j$$$.</p><p>The Order of the Phoenix doesn't yet know if it is possible to place $$$n$$$ houses in such a way that will satisfy the visit and view requirements of all $$$n$$$ wizards, so they are asking for your help in designing such a plan.</p><p>If it is possible to have a correct placement, where for the $$$i$$$-th wizard there is a house that is $$$a_{i}$$$ away from it and the house of the $$$i$$$-th wizard is the only house in their column, output <span class="tex-font-style-tt">YES</span>, the position of houses for each wizard, and to the house of which wizard should each wizard go during the weekends.</p><p>If it is impossible to have a correct placement, output <span class="tex-font-style-tt">NO</span>.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains $$$n$$$ ($$$2 \leq n \leq 2\cdot 10^{5}$$$), the number of houses to be built.</p><p>The second line contains $$$n$$$ integers $$$a_{1}, \ldots, a_{n}$$$ $$$(0 \leq a_{i} \leq n)$$$, $$$a_{1} = 0$$$.</p></div><div class="output-specification"><div class="section-title">Output</div><p>If there exists such a placement, output <span class="tex-font-style-tt">YES</span> on the first line; otherwise, output <span class="tex-font-style-tt">NO</span>.</p><p>If the answer is <span class="tex-font-style-tt">YES</span>, output $$$n + 1$$$ more lines describing the placement.</p><p>The next $$$n$$$ lines should contain the positions of the houses $$$1 \leq x_{i}, y_{i} \leq n$$$ for each wizard.</p><p>The $$$i$$$-th element of the last line should contain the index of the wizard, the house of which is exactly $$$a_{i}$$$ away from the house of the $$$i$$$-th wizard. If there are multiple such wizards, you can output any.</p><p>If there are multiple house placement configurations, you can output any.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
4
0 4 2 4
</pre></div><div class="output"><div class="title">Output</div><pre>
YES
4 4
1 3
2 4
3 1
1 1 1 3</pre></div><div class="input"><div class="title">Input</div><pre>
4
0 1 3 1
</pre></div><div class="output"><div class="title">Output</div><pre>
YES
1 1
2 1
4 1
3 1
1 1 1 3</pre></div></div></div><div class="note"><div class="section-title">Note</div><p>For the sample, the house of the 1st wizard is located at $$$(4, 4)$$$, of the 2nd at $$$(1, 3)$$$, of the 3rd at $$$(2, 4)$$$, of the 4th at $$$(3, 1)$$$.</p><p>The distance from the house of the 1st wizard to the house of the 1st wizard is $$$|4 - 4| + |4 - 4| = 0$$$.</p><p>The distance from the house of the 2nd wizard to the house of the 1st wizard is $$$|1 - 4| + |3 - 4| = 4$$$.</p><p>The distance from the house of the 3rd wizard to the house of the 1st wizard is $$$|2 - 4| + |4 - 4| = 2$$$.</p><p>The distance from the house of the 4th wizard to the house of the 3rd wizard is $$$|3 - 2| + |1 - 4| = 4$$$.</p><p>The view and the distance conditions are satisfied for all houses, so the placement is correct.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/ddce45085204f6f73f5d168a9e6342ca5c4803e1.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=B2]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="B3" data-uuid="ps_8378eaaad5b3d13503ee0136ff6fc15bdcf39eb5">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B3. Exact Neighbours (Hard)</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>After some recent attacks on Hogwarts Castle by the Death Eaters, the Order of the Phoenix has decided to station $$$n$$$ members in Hogsmead Village. The houses will be situated on a picturesque $$$n\times n$$$ square field. Each wizard will have their own house, and every house will belong to some wizard. Each house will take up the space of one square.</p><p>However, as you might know wizards are very superstitious. During the weekends, each wizard $$$i$$$ will want to visit the house that is exactly $$$a_{i}$$$ $$$(0 \leq a_{i} \leq n)$$$ away from their own house. The roads in the village are built horizontally and vertically, so the distance between points $$$(x_{i}, y_{i})$$$ and $$$(x_{j}, y_{j})$$$ on the $$$n\times n$$$ field is $$$ |x_{i} - x_{j}| + |y_{i} - y_{j}|$$$. The wizards know and trust each other, so one wizard can visit another wizard's house when the second wizard is away. The houses to be built will be big enough for all $$$n$$$ wizards to simultaneously visit any house.</p><p>Apart from that, each wizard is mandated to have a view of the Hogwarts Castle in the north and the Forbidden Forest in the south, so the house of no other wizard should block the view. In terms of the village, it means that in each column of the $$$n\times n$$$ field, there can be at most one house, i.e. if the $$$i$$$-th house has coordinates $$$(x_{i}, y_{i})$$$, then $$$x_{i} \neq x_{j}$$$ for all $$$i \neq j$$$.</p><p>The Order of the Phoenix doesn't yet know if it is possible to place $$$n$$$ houses in such a way that will satisfy the visit and view requirements of all $$$n$$$ wizards, so they are asking for your help in designing such a plan.</p><p>If it is possible to have a correct placement, where for the $$$i$$$-th wizard there is a house that is $$$a_{i}$$$ away from it and the house of the $$$i$$$-th wizard is the only house in their column, output <span class="tex-font-style-tt">YES</span>, the position of houses for each wizard, and to the house of which wizard should each wizard go during the weekends.</p><p>If it is impossible to have a correct placement, output <span class="tex-font-style-tt">NO</span>.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains $$$n$$$ ($$$2 \leq n \leq 2\cdot 10^{5}$$$), the number of houses to be built.</p><p>The second line contains $$$n$$$ integers $$$a_{1}, \ldots, a_{n}$$$ $$$(0 \leq a_{i} \leq n)$$$</p></div><div class="output-specification"><div class="section-title">Output</div><p>If there exists such a placement, output <span class="tex-font-style-tt">YES</span> on the first line; otherwise, output <span class="tex-font-style-tt">NO</span>.</p><p>If the answer is <span class="tex-font-style-tt">YES</span>, output $$$n + 1$$$ more lines describing the placement.</p><p>The next $$$n$$$ lines should contain the positions of the houses $$$1 \leq x_{i}, y_{i} \leq n$$$ for each wizard.</p><p>The $$$i$$$-th element of the last line should contain the index of the wizard, the house of which is exactly $$$a_{i}$$$ away from the house of the $$$i$$$-th wizard. If there are multiple such wizards, you can output any.</p><p>If there are multiple house placement configurations, you can output any.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
4
0 4 2 4
</pre></div><div class="output"><div class="title">Output</div><pre>
YES
4 4
1 3
2 4
3 1
1 1 1 3</pre></div><div class="input"><div class="title">Input</div><pre>
4
1 3 0 1
</pre></div><div class="output"><div class="title">Output</div><pre>
YES
2 1
4 1
1 1
3 1
3 3 3 1</pre></div></div></div><div class="note"><div class="section-title">Note</div><p>For the sample, the house of the 1st wizard is located at $$$(4, 4)$$$, of the 2nd at $$$(1, 3)$$$, of the 3rd at $$$(2, 4)$$$, of the 4th at $$$(3, 1)$$$.</p><p>The distance from the house of the 1st wizard to the house of the 1st wizard is $$$|4 - 4| + |4 - 4| = 0$$$.</p><p>The distance from the house of the 2nd wizard to the house of the 1st wizard is $$$|1 - 4| + |3 - 4| = 4$$$.</p><p>The distance from the house of the 3rd wizard to the house of the 1st wizard is $$$|2 - 4| + |4 - 4| = 2$$$.</p><p>The distance from the house of the 4th wizard to the house of the 3rd wizard is $$$|3 - 2| + |1 - 4| = 4$$$.</p><p>The view and the distance conditions are satisfied for all houses, so the placement is correct.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/ddce45085204f6f73f5d168a9e6342ca5c4803e1.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=B3]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="C1" data-uuid="ps_687ca38b60ec67515cb64517ae5027715a6fcb86">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C1. Game on Tree (Easy)</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p><span class="tex-font-style-bf">This is the easy version of the problem. The difference in this version is that $$$t=1$$$ and we work on an array-like tree.</span></p><p>Ron and Hermione are playing a game on a tree of $$$n$$$ nodes that are initially inactive. This tree is special because it has exactly two leaves. It can thus be seen as an array. The game consists of $$$t$$$ rounds, each of which starts with a stone on exactly one node, which is considered as activated. A move consists of picking an inactive neighbor of the node with a stone on it and moving the stone there (thus activating this neighbor). Ron makes the first move, after which he alternates with Hermione until no valid move is available. The player that cannot make a move loses the round. If both players play optimally, who wins each round of this game? </p><p>Note that all the rounds are played with the same tree; only the starting node changes. Moreover, after each round, all active nodes are considered inactive again.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains integers $$$n$$$ ($$$2 \leq n \leq 2\times 10^5$$$), $$$t$$$ ($$$t=1$$$), the number of nodes in the tree and the number of rounds, respectively.</p><p>The next $$$n-1$$$ lines contain two integers $$$1 \leq u, v \leq n$$$ each, corresponding to an edge of the tree. It is guaranteed that the tree has exactly two leaves.</p><p>The next line contains $$$t$$$ integers $$$1 \leq u_1 , \dots, u_t \leq n$$$, corresponding to the node where the stone is initially put.</p></div><div class="output-specification"><div class="section-title">Output</div><p>The output consists of $$$t=1$$$ line which is either &quot;Ron&quot; or &quot;Hermione&quot;.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
<div class="test-example-line test-example-line-even test-example-line-0">3 1</div><div class="test-example-line test-example-line-even test-example-line-0">2 3</div><div class="test-example-line test-example-line-even test-example-line-0">3 1</div><div class="test-example-line test-example-line-even test-example-line-0">3</div></pre></div><div class="output"><div class="title">Output</div><pre>
Ron
</pre></div><div class="input"><div class="title">Input</div><pre>
<div class="test-example-line test-example-line-even test-example-line-0">5 1</div><div class="test-example-line test-example-line-even test-example-line-0">1 2</div><div class="test-example-line test-example-line-even test-example-line-0">2 3</div><div class="test-example-line test-example-line-even test-example-line-0">3 4</div><div class="test-example-line test-example-line-even test-example-line-0">4 5</div><div class="test-example-line test-example-line-even test-example-line-0">5</div></pre></div><div class="output"><div class="title">Output</div><pre>
Hermione
</pre></div></div></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=C1]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="C2" data-uuid="ps_451b79064e3e88db9628bac342356450fb83d5ca">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C2. Game on Tree (Medium)</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p><span class="tex-font-style-bf">This is the medium version of the problem. The difference in this version is that $$$t=1$$$ and we work on trees.</span></p><p>Ron and Hermione are playing a game on a tree of $$$n$$$ nodes that are initially inactive. The game consists of $$$t$$$ rounds, each of which starts with a stone on exactly one node, which is considered as activated. A move consists of picking an inactive neighbor of the node with a stone on it and moving the stone there (thus activating this neighbor). Ron makes the first move, after which he alternates with Hermione until no valid move is available. The player that cannot make a move loses the round. If both players play optimally, who wins each round of this game? </p><p>Note that all the rounds are played with the same tree; only the starting node changes. Moreover, after each round, all active nodes are considered inactive again.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains integers $$$n$$$ ($$$2 \leq n \leq 2\times 10^5$$$), $$$t$$$ ($$$t=1$$$), the number of nodes in the tree and the number of rounds, respectively.</p><p>The next $$$n-1$$$ lines contain two integers $$$1 \leq u, v \leq n$$$ each, corresponding to an edge of the tree.</p><p>The next line contains $$$t$$$ integers $$$1 \leq u_1 , \dots, u_t \leq n$$$, corresponding to the node where the stone is initially put.</p></div><div class="output-specification"><div class="section-title">Output</div><p>The output consists of $$$t=1$$$ line which is either &quot;Ron&quot; or &quot;Hermione&quot;.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
<div class="test-example-line test-example-line-even test-example-line-0">5 1</div><div class="test-example-line test-example-line-even test-example-line-0">1 2</div><div class="test-example-line test-example-line-even test-example-line-0">1 3</div><div class="test-example-line test-example-line-even test-example-line-0">3 4</div><div class="test-example-line test-example-line-even test-example-line-0">3 5</div><div class="test-example-line test-example-line-even test-example-line-0">1</div></pre></div><div class="output"><div class="title">Output</div><pre>
Ron
</pre></div></div></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=C2]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="C3" data-uuid="ps_f6eeb5c52dd3942b2c16a73c30fb2f2ed0b15dfe">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C3. Game on Tree (Hard)</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p><span class="tex-font-style-bf">This is the hard version of the problem. The only difference in this version is the constraint on $$$t$$$.</span></p><p>Ron and Hermione are playing a game on a tree of $$$n$$$ nodes that are initially inactive. The game consists of $$$t$$$ rounds, each of which starts with a stone on exactly one node, which is considered as activated. A move consists of picking an inactive neighbor of the node with a stone on it and moving the stone there (thus activating this neighbor). Ron makes the first move, after which he alternates with Hermione until no valid move is available. The player that cannot make a move loses the round. If both players play optimally, who wins each round of this game? </p><p>Note that all the rounds are played with the same tree; only the starting node changes. Moreover, after each round, all active nodes are considered inactive again.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains integers $$$n$$$ ($$$2 \leq n \leq 2\times 10^5$$$), $$$t$$$ ($$$1 \leq t \leq n$$$), the number of nodes in the tree and the number of rounds, respectively.</p><p>The next $$$n-1$$$ lines contain two integers $$$1 \leq u, v \leq n$$$ each, corresponding to an edge of the tree.</p><p>The next line contains $$$t$$$ integers $$$1 \leq u_1 , \dots , u_t \leq n$$$, corresponding to the node where the stone is initially put.</p></div><div class="output-specification"><div class="section-title">Output</div><p>The output consists of $$$t$$$ lines, each line being either &quot;Ron&quot; or &quot;Hermione&quot;.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
<div class="test-example-line test-example-line-even test-example-line-0">5 2</div><div class="test-example-line test-example-line-even test-example-line-0">1 2</div><div class="test-example-line test-example-line-even test-example-line-0">1 3</div><div class="test-example-line test-example-line-even test-example-line-0">3 4</div><div class="test-example-line test-example-line-even test-example-line-0">3 5</div><div class="test-example-line test-example-line-even test-example-line-0">1 2</div></pre></div><div class="output"><div class="title">Output</div><pre>
Ron
Ron
</pre></div><div class="input"><div class="title">Input</div><pre>
<div class="test-example-line test-example-line-even test-example-line-0">6 3</div><div class="test-example-line test-example-line-even test-example-line-0">1 2</div><div class="test-example-line test-example-line-even test-example-line-0">2 3</div><div class="test-example-line test-example-line-even test-example-line-0">1 4</div><div class="test-example-line test-example-line-even test-example-line-0">4 5</div><div class="test-example-line test-example-line-even test-example-line-0">4 6</div><div class="test-example-line test-example-line-even test-example-line-0">1 4 6</div></pre></div><div class="output"><div class="title">Output</div><pre>
Hermione
Ron
Hermione
</pre></div></div></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=C3]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="D1" data-uuid="ps_68af9246d6ca71891cf1a3185aed8e61364eec74">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D1. Arithmancy (Easy)</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Professor Vector is preparing to teach her Arithmancy class. She needs to prepare $$$n$$$ distinct <span class="tex-font-style-it">magic words</span> for the class. Each magic word is a string consisting of characters <span class="tex-font-style-tt">X</span> and <span class="tex-font-style-tt">O</span>. A <span class="tex-font-style-it">spell</span> is a string created by concatenating two magic words together. The <span class="tex-font-style-it">power</span> of a spell is equal to the number of its different non-empty substrings. For example, the power of the spell <span class="tex-font-style-tt">XOXO</span> is equal to 7, because it has 7 different substrings: <span class="tex-font-style-tt">X</span>, <span class="tex-font-style-tt">O</span>, <span class="tex-font-style-tt">XO</span>, <span class="tex-font-style-tt">OX</span>, <span class="tex-font-style-tt">XOX</span>, <span class="tex-font-style-tt">OXO</span> and <span class="tex-font-style-tt">XOXO</span>.</p><p>Each student will create their own spell by concatenating two magic words. Since the students are not very good at magic yet, they will choose each of the two words independently and uniformly at random from the $$$n$$$ words provided by Professor Vector. It is therefore also possible that the two words a student chooses are the same. Each student will then compute the power of their spell, and tell it to Professor Vector. In order to check their work, and of course to impress the students, Professor Vector needs to find out which two magic words and in which order were concatenated by each student.</p><p>Your program needs to perform the role of Professor Vector: first, create $$$n$$$ distinct magic words, and then handle multiple requests where it is given the spell power and needs to determine the indices of the two magic words, in the correct order, that were used to create the corresponding spell.</p></div><div><div class="section-title">Interaction</div><p><span class="tex-font-style-it">This is an interactive problem.</span></p><p>First, your program should read a single integer $$$n$$$ ($$$1 \le n \le 3$$$), the number of magic words to prepare. Then, it should print $$$n$$$ magic words it has created, one per line. The magic words must be distinct, each magic word must have at least 1 and at most $$$30\cdot n$$$ characters, and each character must be either <span class="tex-font-style-tt">X</span> or <span class="tex-font-style-tt">O</span>. We will denote the $$$i$$$-th magic word you printed as $$$w_i$$$ ($$$1 \le i \le n$$$).</p><p>Then, your program should read a single integer $$$q$$$ ($$$1 \le q \le 1000$$$), the number of students in the class. Then, it should repeat the following process $$$q$$$ times, one per student.</p><p>For the $$$j$$$-th student, it should first read a single integer $$$p_j$$$, the power of their spell. It is guaranteed that this number is computed by choosing two indices $$$u_j$$$ and $$$v_j$$$ independently and uniformly at random between 1 and $$$n$$$ inclusive, concatenating $$$w_{u_j}$$$ and $$$w_{v_j}$$$, and finding the number of different non-empty substrings of the resulting string. Then, your program must print the numbers $$$u_j$$$ and $$$v_j$$$, in this order ($$$1 \le u_j, v_j \le n$$$).</p><p>Note that it is not enough to find any two magic words that concatenate into a spell with the given power. You must find the exact words used by the student in the exact order.</p><p>Remember to flush the output stream after printing all magic words and after printing $$$u_j$$$ and $$$v_j$$$ for each student.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
2


2
15

11</pre></div><div class="output"><div class="title">Output</div><pre>

XOXO
X


1 1

2 1
</pre></div></div></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=D1]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="D2" data-uuid="ps_4cd017bfe5a3fb747b13c89077774fa48ecc1c1b">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D2. Arithmancy (Medium)</div><div class="time-limit"><div class="property-title">time limit per test</div>5 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p><span class="tex-font-style-bf">The only difference between the versions of this problem is the maximum value of $$$n$$$.</span></p><p>Professor Vector is preparing to teach her Arithmancy class. She needs to prepare $$$n$$$ distinct <span class="tex-font-style-it">magic words</span> for the class. Each magic word is a string consisting of characters <span class="tex-font-style-tt">X</span> and <span class="tex-font-style-tt">O</span>. A <span class="tex-font-style-it">spell</span> is a string created by concatenating two magic words together. The <span class="tex-font-style-it">power</span> of a spell is equal to the number of its different non-empty substrings. For example, the power of the spell <span class="tex-font-style-tt">XOXO</span> is equal to 7, because it has 7 different substrings: <span class="tex-font-style-tt">X</span>, <span class="tex-font-style-tt">O</span>, <span class="tex-font-style-tt">XO</span>, <span class="tex-font-style-tt">OX</span>, <span class="tex-font-style-tt">XOX</span>, <span class="tex-font-style-tt">OXO</span> and <span class="tex-font-style-tt">XOXO</span>.</p><p>Each student will create their own spell by concatenating two magic words. Since the students are not very good at magic yet, they will choose each of the two words independently and uniformly at random from the $$$n$$$ words provided by Professor Vector. It is therefore also possible that the two words a student chooses are the same. Each student will then compute the power of their spell, and tell it to Professor Vector. In order to check their work, and of course to impress the students, Professor Vector needs to find out which two magic words and in which order were concatenated by each student.</p><p>Your program needs to perform the role of Professor Vector: first, create $$$n$$$ distinct magic words, and then handle multiple requests where it is given the spell power and needs to determine the indices of the two magic words, in the correct order, that were used to create the corresponding spell.</p></div><div><div class="section-title">Interaction</div><p><span class="tex-font-style-it">This is an interactive problem.</span></p><p>First, your program should read a single integer $$$n$$$ ($$$1 \le n \le 30$$$), the number of magic words to prepare. Then, it should print $$$n$$$ magic words it has created, one per line. The magic words must be distinct, each magic word must have at least 1 and at most $$$30\cdot n$$$ characters, and each character must be either <span class="tex-font-style-tt">X</span> or <span class="tex-font-style-tt">O</span>. We will denote the $$$i$$$-th magic word you printed as $$$w_i$$$ ($$$1 \le i \le n$$$).</p><p>Then, your program should read a single integer $$$q$$$ ($$$1 \le q \le 1000$$$), the number of students in the class. Then, it should repeat the following process $$$q$$$ times, one per student.</p><p>For the $$$j$$$-th student, it should first read a single integer $$$p_j$$$, the power of their spell. It is guaranteed that this number is computed by choosing two indices $$$u_j$$$ and $$$v_j$$$ independently and uniformly at random between 1 and $$$n$$$ inclusive, concatenating $$$w_{u_j}$$$ and $$$w_{v_j}$$$, and finding the number of different non-empty substrings of the resulting string. Then, your program must print the numbers $$$u_j$$$ and $$$v_j$$$, in this order ($$$1 \le u_j, v_j \le n$$$).</p><p>Note that it is not enough to find any two magic words that concatenate into a spell with the given power. You must find the exact words used by the student in the exact order.</p><p>Remember to flush the output stream after printing all magic words and after printing $$$u_j$$$ and $$$v_j$$$ for each student.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
2


2
15

11</pre></div><div class="output"><div class="title">Output</div><pre>

XOXO
X


1 1

2 1
</pre></div></div></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=D2]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="D3" data-uuid="ps_cbd8ce6d5df32ebf2e393f0ca8fa846541611d7a">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D3. Arithmancy (Hard)</div><div class="time-limit"><div class="property-title">time limit per test</div>10 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p><span class="tex-font-style-bf">The only difference between the versions of this problem is the maximum value of $$$n$$$.</span></p><p>Professor Vector is preparing to teach her Arithmancy class. She needs to prepare $$$n$$$ distinct <span class="tex-font-style-it">magic words</span> for the class. Each magic word is a string consisting of characters <span class="tex-font-style-tt">X</span> and <span class="tex-font-style-tt">O</span>. A <span class="tex-font-style-it">spell</span> is a string created by concatenating two magic words together. The <span class="tex-font-style-it">power</span> of a spell is equal to the number of its different non-empty substrings. For example, the power of the spell <span class="tex-font-style-tt">XOXO</span> is equal to 7, because it has 7 different substrings: <span class="tex-font-style-tt">X</span>, <span class="tex-font-style-tt">O</span>, <span class="tex-font-style-tt">XO</span>, <span class="tex-font-style-tt">OX</span>, <span class="tex-font-style-tt">XOX</span>, <span class="tex-font-style-tt">OXO</span> and <span class="tex-font-style-tt">XOXO</span>.</p><p>Each student will create their own spell by concatenating two magic words. Since the students are not very good at magic yet, they will choose each of the two words independently and uniformly at random from the $$$n$$$ words provided by Professor Vector. It is therefore also possible that the two words a student chooses are the same. Each student will then compute the power of their spell, and tell it to Professor Vector. In order to check their work, and of course to impress the students, Professor Vector needs to find out which two magic words and in which order were concatenated by each student.</p><p>Your program needs to perform the role of Professor Vector: first, create $$$n$$$ distinct magic words, and then handle multiple requests where it is given the spell power and needs to determine the indices of the two magic words, in the correct order, that were used to create the corresponding spell.</p></div><div><div class="section-title">Interaction</div><p><span class="tex-font-style-it">This is an interactive problem.</span></p><p>First, your program should read a single integer $$$n$$$ ($$$1 \le n \le 1000$$$), the number of magic words to prepare. Then, it should print $$$n$$$ magic words it has created, one per line. The magic words must be distinct, each magic word must have at least 1 and at most $$$30\cdot n$$$ characters, and each character must be either <span class="tex-font-style-tt">X</span> or <span class="tex-font-style-tt">O</span>. We will denote the $$$i$$$-th magic word you printed as $$$w_i$$$ ($$$1 \le i \le n$$$).</p><p>Then, your program should read a single integer $$$q$$$ ($$$1 \le q \le 1000$$$), the number of students in the class. Then, it should repeat the following process $$$q$$$ times, one per student.</p><p>For the $$$j$$$-th student, it should first read a single integer $$$p_j$$$, the power of their spell. It is guaranteed that this number is computed by choosing two indices $$$u_j$$$ and $$$v_j$$$ independently and uniformly at random between 1 and $$$n$$$ inclusive, concatenating $$$w_{u_j}$$$ and $$$w_{v_j}$$$, and finding the number of different non-empty substrings of the resulting string. Then, your program must print the numbers $$$u_j$$$ and $$$v_j$$$, in this order ($$$1 \le u_j, v_j \le n$$$).</p><p>Note that it is not enough to find any two magic words that concatenate into a spell with the given power. You must find the exact words used by the student in the exact order.</p><p>Remember to flush the output stream after printing all magic words and after printing $$$u_j$$$ and $$$v_j$$$ for each student.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
2


2
15

11</pre></div><div class="output"><div class="title">Output</div><pre>

XOXO
X


1 1

2 1
</pre></div></div></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=D3]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="E1" data-uuid="ps_a9205c2a3b21d15366c90cac8d62ed7a5e31fa92">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E1. Trails (Easy)</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Harry Potter is hiking in the Alps surrounding Lake Geneva. In this area there are $$$m$$$ cabins, numbered 1 to $$$m$$$. Each cabin is connected, with one or more trails, to a central meeting point next to the lake. Each trail is either <span class="tex-font-style-underline">short</span> or <span class="tex-font-style-underline">long</span>. Cabin $$$i$$$ is connected with $$$s_i$$$ short trails and $$$l_i$$$ long trails to the lake.</p><p>Each day, Harry walks a trail from the cabin where he currently is to Lake Geneva, and then from there he walks a trail to any of the $$$m$$$ cabins (including the one he started in). However, as he has to finish the hike in a day, at least one of the two trails has to be short.</p><p>How many possible combinations of trails can Harry take if he starts in cabin 1 and walks for $$$n$$$ days?</p><p>Give the answer modulo $$$10^9 + 7$$$.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains the integers $$$m$$$ and $$$n$$$.</p><p>The second line contains $$$m$$$ integers, $$$s_1, \dots, s_m$$$, where $$$s_i$$$ is the number of short trails between cabin $$$i$$$ and Lake Geneva.</p><p>The third and last line contains $$$m$$$ integers, $$$l_1, \dots, l_m$$$, where $$$l_i$$$ is the number of long trails between cabin $$$i$$$ and Lake Geneva.</p><p>We have the following constraints:</p><p>$$$0 \le s_i, l_i \le 10^3$$$.</p><p>$$$1 \le m \le 10^2$$$.</p><p>$$$1 \le n \le 10^3$$$.</p></div><div class="output-specification"><div class="section-title">Output</div><p>The number of possible combinations of trails, modulo $$$10^9 + 7$$$.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
<div class="test-example-line test-example-line-even test-example-line-0">3 2</div><div class="test-example-line test-example-line-even test-example-line-0">1 0 1</div><div class="test-example-line test-example-line-even test-example-line-0">0 1 1</div></pre></div><div class="output"><div class="title">Output</div><pre>
18
</pre></div></div></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=E1]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="E2" data-uuid="ps_5f39e1c83fa55f209085543064f979ada52e50ec">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E2. Trails (Medium)</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Harry Potter is hiking in the Alps surrounding Lake Geneva. In this area there are $$$m$$$ cabins, numbered 1 to $$$m$$$. Each cabin is connected, with one or more trails, to a central meeting point next to the lake. Each trail is either <span class="tex-font-style-underline">short</span> or <span class="tex-font-style-underline">long</span>. Cabin $$$i$$$ is connected with $$$s_i$$$ short trails and $$$l_i$$$ long trails to the lake.</p><p>Each day, Harry walks a trail from the cabin where he currently is to Lake Geneva, and then from there he walks a trail to any of the $$$m$$$ cabins (including the one he started in). However, as he has to finish the hike in a day, at least one of the two trails has to be short.</p><p>How many possible combinations of trails can Harry take if he starts in cabin 1 and walks for $$$n$$$ days?</p><p>Give the answer modulo $$$10^9 + 7$$$.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains the integers $$$m$$$ and $$$n$$$.</p><p>The second line contains $$$m$$$ integers, $$$s_1, \dots, s_m$$$, where $$$s_i$$$ is the number of short trails between cabin $$$i$$$ and Lake Geneva.</p><p>The third and last line contains $$$m$$$ integers, $$$l_1, \dots, l_m$$$, where $$$l_i$$$ is the number of long trails between cabin $$$i$$$ and Lake Geneva.</p><p>We have the following constraints:</p><p>$$$0 \le s_i, l_i \le 10^3$$$.</p><p>$$$1 \le m \le 10^2$$$.</p><p>$$$1 \le n \le 10^9$$$.</p></div><div class="output-specification"><div class="section-title">Output</div><p>The number of possible combinations of trails, modulo $$$10^9 + 7$$$.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
<div class="test-example-line test-example-line-even test-example-line-0">3 2</div><div class="test-example-line test-example-line-even test-example-line-0">1 0 1</div><div class="test-example-line test-example-line-even test-example-line-0">0 1 1</div></pre></div><div class="output"><div class="title">Output</div><pre>
18
</pre></div></div></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=E2]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="E3" data-uuid="ps_5e741c19f1a30e57b2b39a1f7417b4ebc7dcb3da">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E3. Trails (Hard)</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Harry Potter is hiking in the Alps surrounding Lake Geneva. In this area there are $$$m$$$ cabins, numbered 1 to $$$m$$$. Each cabin is connected, with one or more trails, to a central meeting point next to the lake. Each trail is either <span class="tex-font-style-underline">short</span> or <span class="tex-font-style-underline">long</span>. Cabin $$$i$$$ is connected with $$$s_i$$$ short trails and $$$l_i$$$ long trails to the lake.</p><p>Each day, Harry walks a trail from the cabin where he currently is to Lake Geneva, and then from there he walks a trail to any of the $$$m$$$ cabins (including the one he started in). However, as he has to finish the hike in a day, at least one of the two trails has to be short.</p><p>How many possible combinations of trails can Harry take if he starts in cabin 1 and walks for $$$n$$$ days?</p><p>Give the answer modulo $$$10^9 + 7$$$.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains the integers $$$m$$$ and $$$n$$$.</p><p>The second line contains $$$m$$$ integers, $$$s_1, \dots, s_m$$$, where $$$s_i$$$ is the number of short trails between cabin $$$i$$$ and Lake Geneva.</p><p>The third and last line contains $$$m$$$ integers, $$$l_1, \dots, l_m$$$, where $$$l_i$$$ is the number of long trails between cabin $$$i$$$ and Lake Geneva.</p><p>We have the following constraints:</p><p>$$$0 \le s_i, l_i \le 10^3$$$.</p><p>$$$1 \le m \le 10^5$$$.</p><p>$$$1 \le n \le 10^9$$$.</p></div><div class="output-specification"><div class="section-title">Output</div><p>The number of possible combinations of trails, modulo $$$10^9 + 7$$$.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
<div class="test-example-line test-example-line-even test-example-line-0">3 2</div><div class="test-example-line test-example-line-even test-example-line-0">1 0 1</div><div class="test-example-line test-example-line-even test-example-line-0">0 1 1</div></pre></div><div class="output"><div class="title">Output</div><pre>
18
</pre></div></div></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=E3]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="F1" data-uuid="ps_2382e32bcec52662f7d98510e6940ac16da18706">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">F1. Playing Quidditch (Easy)</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>This afternoon, you decided to enjoy the first days of Spring by taking a walk outside. As you come near the Quidditch field, you hear screams. Once again, there is a conflict about the score: the two teams are convinced that they won the game! To prevent this problem from happening one more time, you decide to get involved in the refereeing of the matches.</p><p>Now, you will stay in the stadium to watch the game and count the score. At the end of the game, you will decide the winner.</p><p>Today, two teams are competing: the red Gryffindor (<span class="tex-font-style-tt">R</span>) and the blue Ravenclaw (<span class="tex-font-style-tt">B</span>) team. Each team is composed of $$$P$$$ players ($$$1 \leq P \leq 10$$$).</p><p>The field is a rectangle of $$$N$$$ lines and $$$M$$$ columns ($$$3 \leq N, M \leq 99$$$, $$$N$$$ and $$$M$$$ are odd). All the positions are integers, and several entities are allowed to be at the same position in the field. At the beginning of the game, the field contains goals for the two teams (each team can own between one and five goals), the players, and exactly one Quaffle. Other types of balls will be available in the harder versions of the problem.</p><p>A game is composed of $$$T$$$ steps ($$$0 \leq T \leq 10000$$$). At each step, one entity on the field (a player or a ball) performs one action. All entities can move. A player can also catch a ball or throw the Quaffle that it is carrying. To catch a ball, a player must be located on the same cell as it. The Quaffle does not perform any action while it is being carried; it only follows the movements of the player. If a player carrying the Quaffle decides to throw it, the Quaffle is simply put at the current position of the player.</p><p>To win a point, a player must leave the Quaffle at a goal of the other team. When it does, the team of the player wins one point, and the Quaffle instantly moves to the middle of the field (the cell at the $$$(M+1)/2$$$-th column of the $$$(N+1)/2$$$-th line of the field, starting from 1). There is no goal in the middle of the field. If a player puts the ball in its own goal, the other team wins the point.</p></div><div class="input-specification"><div class="section-title">Input</div><p>On the first line, the integers $$$N$$$ and $$$M$$$.</p><p>The description of the field follows: $$$N$$$ lines of $$$M$$$ pairs of characters separated by spaces. Each pair of characters represents a position on the field. It can be either: </p><ul> <li> <span class="tex-font-style-tt">..</span> to represent an empty cell </li><li> <span class="tex-font-style-tt">R0</span>, ..., <span class="tex-font-style-tt">R9</span>, <span class="tex-font-style-tt">B0</span>, ..., <span class="tex-font-style-tt">B9</span> to represent a player. The first character is the team of the player, and the second is the number of the player in the team. Each pair of characters is unique, but it is not guaranteed that all the pairs appear in the grid. </li><li> <span class="tex-font-style-tt">RG</span> or <span class="tex-font-style-tt">BG</span> to represent a goal. The blue team tries to put the ball in a red goal (<span class="tex-font-style-tt">RG</span>) while the red team tries to put the ball in a blue goal (<span class="tex-font-style-tt">BG</span>). </li><li> <span class="tex-font-style-tt">.Q</span> to represent the Quaffle, which is the ball that the players use to score goals. </li></ul><p>The next line contains $$$T$$$, the number of steps that compose the game. $$$T$$$ lines follow, each describing one action. It contains several pieces of information separated by a space. First, a pair of characters representing the entity that must perform the action. Second, the description of the action: </p><ul> <li> <span class="tex-font-style-tt">U</span>, <span class="tex-font-style-tt">D</span>, <span class="tex-font-style-tt">L</span>, <span class="tex-font-style-tt">R</span> indicate that the entity moves on the grid. It can move to the top of the grid (<span class="tex-font-style-tt">U</span>), to the bottom (<span class="tex-font-style-tt">D</span>), to the left (<span class="tex-font-style-tt">L</span>), or to the right (<span class="tex-font-style-tt">R</span>). Each entity moves by only one cell at a time. </li><li> <span class="tex-font-style-tt">C</span> indicates that the player catches the ball (only a player can catch a ball). Then, there is a space followed by a pair of characters: the description of the ball caught by the player. This information is needed since in the next versions of the problem, several balls may be in the same cell. </li><li> <span class="tex-font-style-tt">T</span> indicates that the player throws the Quaffle that it is carrying. </li></ul><p>All the actions performed by the entities are guaranteed to be valid: the players stay in the field, don't catch a ball if they are not in the same cell, don't release the Quaffle if they are not carrying it, ...</p></div><div class="output-specification"><div class="section-title">Output</div><p>You must output the description of the main events of the game, one event per line. More precisely:</p><ul> <li> Each time a team scores, you must print <span class="tex-font-style-tt">t RED GOAL</span> or <span class="tex-font-style-tt">t BLUE GOAL</span>, depending on the team who scored, where <span class="tex-font-style-tt">t</span> is the current time (the position of the action in the list of actions, starting from 0). In the case where a player scores in the wrong goal (a red player scores in the red goal, or a blue player scores in the blue goal), you must print the name of the team who wins one point, that is, the other team. </li></ul><p>The events must be printed in ascending order of <span class="tex-font-style-tt">t</span>.</p><p>At the end of the game, you must print the final score as: <span class="tex-font-style-tt">FINAL SCORE: r b</span>, where <span class="tex-font-style-tt">r</span> is the score of the red team and <span class="tex-font-style-tt">b</span> is the score of the blue team.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
<div class="test-example-line test-example-line-even test-example-line-0">5 5</div><div class="test-example-line test-example-line-even test-example-line-0">.. R1 .. B1 ..</div><div class="test-example-line test-example-line-even test-example-line-0">RG .. .. .. BG</div><div class="test-example-line test-example-line-even test-example-line-0">RG R0 .Q B0 BG</div><div class="test-example-line test-example-line-even test-example-line-0">RG .. .. .. BG</div><div class="test-example-line test-example-line-even test-example-line-0">.. R2 .. B2 ..</div><div class="test-example-line test-example-line-even test-example-line-0">13</div><div class="test-example-line test-example-line-even test-example-line-0">B2 U</div><div class="test-example-line test-example-line-even test-example-line-0">B2 U</div><div class="test-example-line test-example-line-even test-example-line-0">B2 L</div><div class="test-example-line test-example-line-even test-example-line-0">B2 C .Q</div><div class="test-example-line test-example-line-even test-example-line-0">B2 L</div><div class="test-example-line test-example-line-even test-example-line-0">B2 L</div><div class="test-example-line test-example-line-even test-example-line-0">B2 T</div><div class="test-example-line test-example-line-even test-example-line-0">R0 R</div><div class="test-example-line test-example-line-even test-example-line-0">R0 C .Q</div><div class="test-example-line test-example-line-even test-example-line-0">R0 D</div><div class="test-example-line test-example-line-even test-example-line-0">R0 R</div><div class="test-example-line test-example-line-even test-example-line-0">R0 R</div><div class="test-example-line test-example-line-even test-example-line-0">R0 T</div></pre></div><div class="output"><div class="title">Output</div><pre>
6 BLUE GOAL
12 RED GOAL
FINAL SCORE: 1 1
</pre></div><div class="input"><div class="title">Input</div><pre>
<div class="test-example-line test-example-line-even test-example-line-0">3 5</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. R0 .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">RG .. .Q .. BG</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. B0 .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">12</div><div class="test-example-line test-example-line-even test-example-line-0">R0 D</div><div class="test-example-line test-example-line-even test-example-line-0">R0 C .Q</div><div class="test-example-line test-example-line-even test-example-line-0">R0 R</div><div class="test-example-line test-example-line-even test-example-line-0">R0 T</div><div class="test-example-line test-example-line-even test-example-line-0">R0 D</div><div class="test-example-line test-example-line-even test-example-line-0">B0 R</div><div class="test-example-line test-example-line-even test-example-line-0">B0 U</div><div class="test-example-line test-example-line-even test-example-line-0">B0 C .Q</div><div class="test-example-line test-example-line-even test-example-line-0">B0 L</div><div class="test-example-line test-example-line-even test-example-line-0">B0 L</div><div class="test-example-line test-example-line-even test-example-line-0">B0 L</div><div class="test-example-line test-example-line-even test-example-line-0">B0 T</div></pre></div><div class="output"><div class="title">Output</div><pre>
11 BLUE GOAL
FINAL SCORE: 0 1
</pre></div><div class="input"><div class="title">Input</div><pre>
<div class="test-example-line test-example-line-even test-example-line-0">3 5</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. R0 .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">RG .. .Q .. BG</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. B0 .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">5</div><div class="test-example-line test-example-line-even test-example-line-0">R0 D</div><div class="test-example-line test-example-line-even test-example-line-0">R0 C .Q</div><div class="test-example-line test-example-line-even test-example-line-0">R0 L</div><div class="test-example-line test-example-line-even test-example-line-0">R0 L</div><div class="test-example-line test-example-line-even test-example-line-0">R0 T</div></pre></div><div class="output"><div class="title">Output</div><pre>
4 BLUE GOAL
FINAL SCORE: 0 1
</pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first example, a blue player goes to the middle of the grid, at the position of the Quaffle. He takes it, goes to the goal of the red team, and lets the ball there. He scores! The ball gets back to the middle of the field, a red player takes it and scores too.</p><p>In the second example, the red player takes the Quaffle, move it and throw it. The blue player catches the ball, goes to the red goal and scores.</p><p>In the third example, the red player takes the ball and scores in the goal of their own team: the blue team wins a point.</p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=F1]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="F2" data-uuid="ps_bb4a4b95e8c076e62027db63c2320dfdae45a168">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">F2. Playing Quidditch (Medium)</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>This afternoon, you decided to enjoy the first days of Spring by taking a walk outside. As you come near the Quidditch field, you hear screams. Once again, there is a conflict about the score: the two teams are convinced that they won the game! To prevent this problem from happening one more time, you decide to get involved in the refereeing of the matches.</p><p>Now, you will stay in the stadium to watch the game and count the score. At the end of the game, you will decide the winner.</p><p>Today, two teams are competing: the red Gryffindor (<span class="tex-font-style-tt">R</span>) and the blue Ravenclaw (<span class="tex-font-style-tt">B</span>) team. Each team is composed of $$$P$$$ players ($$$1 \leq P \leq 10$$$).</p><p>The field is a rectangle of $$$N$$$ lines and $$$M$$$ columns ($$$3 \leq N, M \leq 99$$$, $$$N$$$ and $$$M$$$ are odd). All the positions are integers, and several entities are allowed to be at the same position in the field. At the beginning of the game, the field contains goals for the two teams (each team can own between one and five goals), the players, and exactly one Quaffle. <span class="tex-font-style-bf">In this version of the problem, one Bludger can be present.</span> An other type of ball will be available in the harder version of the problem.</p><p>A game is composed of $$$T$$$ steps ($$$0 \leq T \leq 10000$$$). At each step, one entity on the field (a player or a ball) performs one action. All entities can move. A player can also catch a ball or throw the Quaffle that it is carrying. To catch a ball, a player must be located on the same cell as it. The Quaffle does not perform any action while it is being carried; it only follows the movements of the player. If a player carrying the Quaffle decides to throw it, the Quaffle is simply put at the current position of the player. <span class="tex-font-style-bf">If a player is on the same cell as a Bludger (either after a movement from the player or the Bludger), the player is eliminated. If the player is eliminated while it is carrying the Quaffle, the Quaffle remains on the cell containing both the player and the Bludger after the move. It is guaranteed that this never occurs while the player is in a cell containing a goal.</span></p><p>To win a point, a player must leave the Quaffle at a goal of the other team. When it does, the team of the player wins one point, and the Quaffle instantly moves to the middle of the field (the cell at the $$$(M+1)/2$$$-th column of the $$$(N+1)/2$$$-th line of the field, starting from 1). There is no goal in the middle of the field. If a player puts the ball in its own goal, the other team wins the point.</p></div><div class="input-specification"><div class="section-title">Input</div><p>On the first line, the integers $$$N$$$ and $$$M$$$.</p><p>The description of the field follows: $$$N$$$ lines of $$$M$$$ pairs of characters separated by spaces. Each pair of characters represents a position on the field. It can be either: </p><ul> <li> <span class="tex-font-style-tt">..</span> to represent an empty cell </li><li> <span class="tex-font-style-tt">R0</span>, ..., <span class="tex-font-style-tt">R9</span>, <span class="tex-font-style-tt">B0</span>, ..., <span class="tex-font-style-tt">B9</span> to represent a player. The first character is the team of the player, and the second is the number of the player in the team. Each pair of characters is unique, but it is not guaranteed that all the pairs appear in the grid. </li><li> <span class="tex-font-style-tt">RG</span> or <span class="tex-font-style-tt">BG</span> to represent a goal. The blue team tries to put the ball in a red goal (<span class="tex-font-style-tt">RG</span>) while the red team tries to put the ball in a blue goal (<span class="tex-font-style-tt">BG</span>). </li><li> <span class="tex-font-style-tt">.Q</span> to represent the Quaffle, which is the ball that the players use to score goals. </li><li> <span class="tex-font-style-bf"><span class="tex-font-style-tt">.B</span> to represent a Bludger.</span> </li></ul><p>The next line contains $$$T$$$, the number of steps that compose the game. $$$T$$$ lines follow, each describing one action. It contains several pieces of information separated by a space. First, a pair of characters representing the entity that must perform the action. Second, the description of the action: </p><ul> <li> <span class="tex-font-style-tt">U</span>, <span class="tex-font-style-tt">D</span>, <span class="tex-font-style-tt">L</span>, <span class="tex-font-style-tt">R</span> indicate that the entity moves on the grid. It can move to the top of the grid (<span class="tex-font-style-tt">U</span>), to the bottom (<span class="tex-font-style-tt">D</span>), to the left (<span class="tex-font-style-tt">L</span>), or to the right (<span class="tex-font-style-tt">R</span>). Each entity moves by only one cell at a time. </li><li> <span class="tex-font-style-tt">C</span> indicates that the player catches the ball (only a player can catch a ball). Then, there is a space followed by a pair of characters: the description of the ball caught by the player. This information is needed since several balls can be in the same cell. </li><li> <span class="tex-font-style-tt">T</span> indicates that the player throws the Quaffle that it is carrying. </li></ul><p>All the actions performed by the entities are guaranteed to be valid: the players stay in the field, don't catch a ball if they are not in the same cell, don't release the Quaffle if they are not carrying it, ...</p></div><div class="output-specification"><div class="section-title">Output</div><p>You must output the description of the main events of the game, one event per line. More precisely:</p><ul> <li> Each time a team scores, you must print <span class="tex-font-style-tt">t RED GOAL</span> or <span class="tex-font-style-tt">t BLUE GOAL</span>, depending on the team who scored, where <span class="tex-font-style-tt">t</span> is the current time (the position of the action in the list of actions, starting from 0). In the case where a player scores in the wrong goal (a red player scores in the red goal, or a blue player scores in the blue goal), you must print the name of the team who wins one point, that is, the other team. </li><li> <span class="tex-font-style-bf">Each time a player is eliminated, you must print <span class="tex-font-style-tt">t p ELIMINATED</span>, where <span class="tex-font-style-tt">t</span> is the current time and <span class="tex-font-style-tt">p</span> is the player who is eliminated. The format to print the player is the same as in the input.</span> </li></ul><p>The events must be printed in ascending order of <span class="tex-font-style-tt">t</span>. <span class="tex-font-style-bf">If several players are eliminated at the same time, the events must be written in alphabetical order: <span class="tex-font-style-tt">B0</span>, ..., <span class="tex-font-style-tt">B9</span>, <span class="tex-font-style-tt">R0</span>, ... <span class="tex-font-style-tt">R9</span>.</span></p><p>At the end of the game, you must print the final score as: <span class="tex-font-style-tt">FINAL SCORE: r b</span>, where <span class="tex-font-style-tt">r</span> is the score of the red team and <span class="tex-font-style-tt">b</span> is the score of the blue team.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
<div class="test-example-line test-example-line-even test-example-line-0">3 5</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. R0 .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">RG .. .Q .. BG</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. B0 .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">12</div><div class="test-example-line test-example-line-even test-example-line-0">R0 D</div><div class="test-example-line test-example-line-even test-example-line-0">R0 C .Q</div><div class="test-example-line test-example-line-even test-example-line-0">R0 R</div><div class="test-example-line test-example-line-even test-example-line-0">R0 T</div><div class="test-example-line test-example-line-even test-example-line-0">R0 D</div><div class="test-example-line test-example-line-even test-example-line-0">B0 R</div><div class="test-example-line test-example-line-even test-example-line-0">B0 U</div><div class="test-example-line test-example-line-even test-example-line-0">B0 C .Q</div><div class="test-example-line test-example-line-even test-example-line-0">B0 L</div><div class="test-example-line test-example-line-even test-example-line-0">B0 L</div><div class="test-example-line test-example-line-even test-example-line-0">B0 L</div><div class="test-example-line test-example-line-even test-example-line-0">B0 T</div></pre></div><div class="output"><div class="title">Output</div><pre>
11 BLUE GOAL
FINAL SCORE: 0 1
</pre></div><div class="input"><div class="title">Input</div><pre>
<div class="test-example-line test-example-line-even test-example-line-0">3 5</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. R0 .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">RG .. .Q .. BG</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. B0 .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">5</div><div class="test-example-line test-example-line-even test-example-line-0">R0 D</div><div class="test-example-line test-example-line-even test-example-line-0">R0 C .Q</div><div class="test-example-line test-example-line-even test-example-line-0">R0 L</div><div class="test-example-line test-example-line-even test-example-line-0">R0 L</div><div class="test-example-line test-example-line-even test-example-line-0">R0 T</div></pre></div><div class="output"><div class="title">Output</div><pre>
4 BLUE GOAL
FINAL SCORE: 0 1
</pre></div><div class="input"><div class="title">Input</div><pre>
<div class="test-example-line test-example-line-even test-example-line-0">5 5</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. .. .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. .. .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">RG R0 .Q B0 BG</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. .. .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. .B .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">5</div><div class="test-example-line test-example-line-even test-example-line-0">.B L</div><div class="test-example-line test-example-line-even test-example-line-0">.B U</div><div class="test-example-line test-example-line-even test-example-line-0">.B U</div><div class="test-example-line test-example-line-even test-example-line-0">B0 L</div><div class="test-example-line test-example-line-even test-example-line-0">B0 L</div></pre></div><div class="output"><div class="title">Output</div><pre>
2 R0 ELIMINATED
4 B0 ELIMINATED
FINAL SCORE: 0 0
</pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first example, the red player takes the Quaffle, move it and throw it. The blue player catches the ball, goes to the red goal and scores.</p><p>In the second example, the red player takes the ball and scores in the goal of their own team: the blue team wins a point.</p><p>In the third example, the Bludger goes at the position of R0: R0 is eliminated. Then, B0 moves to the position of the Bludger: B0 is eliminated too.</p><p><span class="tex-font-style-it">You can find one more example in the easy version of the problem</span></p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=F2]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="F3" data-uuid="ps_b1dd08f38cdebef4ce858a1b78ab0abf62daa6cc">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">F3. Playing Quidditch (Hard)</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>This afternoon, you decided to enjoy the first days of Spring by taking a walk outside. As you come near the Quidditch field, you hear screams. Once again, there is a conflict about the score: the two teams are convinced that they won the game! To prevent this problem from happening one more time, you decide to get involved in the refereeing of the matches.</p><p>Now, you will stay in the stadium to watch the game and count the score. At the end of the game, you will decide the winner.</p><p>Today, two teams are competing: the red Gryffindor (<span class="tex-font-style-tt">R</span>) and the blue Ravenclaw (<span class="tex-font-style-tt">B</span>) team. Each team is composed of $$$P$$$ players ($$$1 \leq P \leq 10$$$).</p><p>The field is a rectangle of $$$N$$$ lines and $$$M$$$ columns ($$$3 \leq N, M \leq 99$$$, $$$N$$$ and $$$M$$$ are odd). All the positions are integers, and several entities are allowed to be at the same position in the field. At the beginning of the game, the field contains goals for the two teams (each team can own between one and five goals), the players, and exactly one Quaffle. In this version of the problem, one Bludger <span class="tex-font-style-bf">and a Golden Snitch</span> can be present.</p><p>A game is composed of $$$T$$$ steps ($$$0 \leq T \leq 10000$$$). At each step, one entity on the field (a player or a ball) performs one action. All entities can move. A player can also catch a ball or throw the Quaffle that it is carrying. To catch a ball, a player must be located on the same cell as it. The Quaffle does not perform any action while it is being carried; it only follows the movements of the player. If a player carrying the Quaffle decides to throw it, the Quaffle is simply put at the current position of the player. If a player is on the same cell as a Bludger (either after a movement from the player or the Bludger), the player is eliminated. If the player is eliminated while it is carrying the Quaffle, the Quaffle remains on the cell containing both the player and the Bludger after the move. It is guaranteed that this never occurs while the player is in a cell containing a goal.</p><p>To win a point, a player must leave the Quaffle at a goal of the other team. When it does, the team of the player wins one point, and the Quaffle instantly moves to the middle of the field (the cell at the $$$(M+1)/2$$$-th column of the $$$(N+1)/2$$$-th line of the field, starting from 1). There is no goal in the middle of the field. If a player puts the ball in its own goal, the other team wins the point. <span class="tex-font-style-bf">If a player catches the Golden Snitch, their team wins 10 points and the game is over.</span></p></div><div class="input-specification"><div class="section-title">Input</div><p>On the first line, the integers $$$N$$$ and $$$M$$$.</p><p>The description of the field follows: $$$N$$$ lines of $$$M$$$ pairs of characters separated by spaces. Each pair of characters represents a position on the field. It can be either: </p><ul> <li> <span class="tex-font-style-tt">..</span> to represent an empty cell </li><li> <span class="tex-font-style-tt">R0</span>, ..., <span class="tex-font-style-tt">R9</span>, <span class="tex-font-style-tt">B0</span>, ..., <span class="tex-font-style-tt">B9</span> to represent a player. The first character is the team of the player, and the second is the number of the player in the team. Each pair of characters is unique, but it is not guaranteed that all the pairs appear in the grid. </li><li> <span class="tex-font-style-tt">RG</span> or <span class="tex-font-style-tt">BG</span> to represent a goal. The blue team tries to put the ball in a red goal (<span class="tex-font-style-tt">RG</span>) while the red team tries to put the ball in a blue goal (<span class="tex-font-style-tt">BG</span>). </li><li> <span class="tex-font-style-tt">.Q</span> to represent the Quaffle, which is the ball that the players use to score goals. </li><li> <span class="tex-font-style-tt">.B</span> to represent the Bludger. </li><li> <span class="tex-font-style-bf"><span class="tex-font-style-tt">.S</span> to represent the Golden Snitch.</span> </li></ul><p>The next line contains $$$T$$$, the number of steps that compose the game. $$$T$$$ lines follow, each describing one action. It contains several pieces of information separated by a space. First, a pair of characters representing the entity that must perform the action. Second, the description of the action: </p><ul> <li> <span class="tex-font-style-tt">U</span>, <span class="tex-font-style-tt">D</span>, <span class="tex-font-style-tt">L</span>, <span class="tex-font-style-tt">R</span> indicate that the entity moves on the grid. It can move to the top of the grid (<span class="tex-font-style-tt">U</span>), to the bottom (<span class="tex-font-style-tt">D</span>), to the left (<span class="tex-font-style-tt">L</span>), or to the right (<span class="tex-font-style-tt">R</span>). Each entity moves by only one cell at a time. </li><li> <span class="tex-font-style-tt">C</span> indicates that the player catches the ball (only a player can catch a ball). Then, there is a space followed by a pair of characters: the description of the ball caught by the player. This information is needed since several balls can be in the same cell. </li><li> <span class="tex-font-style-tt">T</span> indicates that the player throws the Quaffle that it is carrying. </li></ul><p>All the actions performed by the entities are guaranteed to be valid: the players stay in the field, don't catch a ball if they are not in the same cell, don't release the Quaffle if they are not carrying it, ...</p></div><div class="output-specification"><div class="section-title">Output</div><p>You must output the description of the main events of the game, one event per line. More precisely:</p><ul> <li> Each time a team scores, you must print <span class="tex-font-style-tt">t RED GOAL</span> or <span class="tex-font-style-tt">t BLUE GOAL</span>, depending on the team who scored, where <span class="tex-font-style-tt">t</span> is the current time (the position of the action in the list of actions, starting from 0). In the case where a player scores in the wrong goal (a red player scores in the red goal, or a blue player scores in the blue goal), you must print the name of the team who wins one point, that is, the other team. </li><li> Each time a player is eliminated, you must print <span class="tex-font-style-tt">t p ELIMINATED</span>, where <span class="tex-font-style-tt">t</span> is the current time and <span class="tex-font-style-tt">p</span> is the player who is eliminated. The format to print the player is the same as in the input. </li><li> <span class="tex-font-style-bf">If the Golden Snitch is caught, you must print <span class="tex-font-style-tt">t RED CATCH GOLDEN SNITCH</span> or <span class="tex-font-style-tt">t BLUE CATCH GOLDEN SNITCH</span>, depending on the team who caught the Golden Snitch, where <span class="tex-font-style-tt">t</span> is the current time.</span> </li></ul><p>The events must be printed in ascending order of <span class="tex-font-style-tt">t</span>. If several players are eliminated at the same time, the events must be written is alphabetical order: <span class="tex-font-style-tt">B0</span>, ..., <span class="tex-font-style-tt">B9</span>, <span class="tex-font-style-tt">R0</span>, ... <span class="tex-font-style-tt">R9</span>.</p><p>At the end of the game, you must print the final score as: <span class="tex-font-style-tt">FINAL SCORE: r b</span>, where <span class="tex-font-style-tt">r</span> is the score of the red team and <span class="tex-font-style-tt">b</span> is the score of the blue team.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
<div class="test-example-line test-example-line-even test-example-line-0">3 5</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. R0 .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">RG .. .Q .. BG</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. B0 .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">12</div><div class="test-example-line test-example-line-even test-example-line-0">R0 D</div><div class="test-example-line test-example-line-even test-example-line-0">R0 C .Q</div><div class="test-example-line test-example-line-even test-example-line-0">R0 R</div><div class="test-example-line test-example-line-even test-example-line-0">R0 T</div><div class="test-example-line test-example-line-even test-example-line-0">R0 D</div><div class="test-example-line test-example-line-even test-example-line-0">B0 R</div><div class="test-example-line test-example-line-even test-example-line-0">B0 U</div><div class="test-example-line test-example-line-even test-example-line-0">B0 C .Q</div><div class="test-example-line test-example-line-even test-example-line-0">B0 L</div><div class="test-example-line test-example-line-even test-example-line-0">B0 L</div><div class="test-example-line test-example-line-even test-example-line-0">B0 L</div><div class="test-example-line test-example-line-even test-example-line-0">B0 T</div></pre></div><div class="output"><div class="title">Output</div><pre>
11 BLUE GOAL
FINAL SCORE: 0 1
</pre></div><div class="input"><div class="title">Input</div><pre>
<div class="test-example-line test-example-line-even test-example-line-0">3 5</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. R0 .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">RG .. .Q .. BG</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. B0 .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">5</div><div class="test-example-line test-example-line-even test-example-line-0">R0 D</div><div class="test-example-line test-example-line-even test-example-line-0">R0 C .Q</div><div class="test-example-line test-example-line-even test-example-line-0">R0 L</div><div class="test-example-line test-example-line-even test-example-line-0">R0 L</div><div class="test-example-line test-example-line-even test-example-line-0">R0 T</div></pre></div><div class="output"><div class="title">Output</div><pre>
4 BLUE GOAL
FINAL SCORE: 0 1
</pre></div><div class="input"><div class="title">Input</div><pre>
<div class="test-example-line test-example-line-even test-example-line-0">5 5</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. .. .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. .. .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">RG R0 .Q B0 BG</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. .. .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. .B .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">5</div><div class="test-example-line test-example-line-even test-example-line-0">.B L</div><div class="test-example-line test-example-line-even test-example-line-0">.B U</div><div class="test-example-line test-example-line-even test-example-line-0">.B U</div><div class="test-example-line test-example-line-even test-example-line-0">B0 L</div><div class="test-example-line test-example-line-even test-example-line-0">B0 L</div></pre></div><div class="output"><div class="title">Output</div><pre>
2 R0 ELIMINATED
4 B0 ELIMINATED
FINAL SCORE: 0 0
</pre></div><div class="input"><div class="title">Input</div><pre>
<div class="test-example-line test-example-line-even test-example-line-0">5 5</div><div class="test-example-line test-example-line-even test-example-line-0">.. R0 .S B0 ..</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. .. .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">RG .. .Q .. BG</div><div class="test-example-line test-example-line-even test-example-line-0">.. .. .. .. ..</div><div class="test-example-line test-example-line-even test-example-line-0">.. R1 .B B1 ..</div><div class="test-example-line test-example-line-even test-example-line-0">4</div><div class="test-example-line test-example-line-even test-example-line-0">.S D</div><div class="test-example-line test-example-line-even test-example-line-0">R0 D</div><div class="test-example-line test-example-line-even test-example-line-0">R0 R</div><div class="test-example-line test-example-line-even test-example-line-0">R0 C .S</div></pre></div><div class="output"><div class="title">Output</div><pre>
3 RED CATCH GOLDEN SNITCH
FINAL SCORE: 10 0
</pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first example, the red player takes the Quaffle, move it and throw it. The blue player catches the ball, goes to the red goal and scores.</p><p>In the second example, the red player takes the ball and scores in the goal of their own team: the blue team wins a point.</p><p>In the third example, the Bludger goes at the position of R0: R0 is eliminated. Then, B0 moves to the position of the Bludger: B0 is eliminated too.</p><p>In the fourth example, a red player catches the Golden Snitch. Their team wins 10 points, and the game ends.</p><p><span class="tex-font-style-it">You can find one more example in the easy version of the problem</span></p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=F3]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="G1" data-uuid="ps_274064395acca94f165f83838bb024f93c375024">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">G1. Min-Fund Prison (Easy)</div><div class="time-limit"><div class="property-title">time limit per test</div>1.5 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p><span class="tex-font-style-bf">In the easy version, $$$m = n-1$$$ and there exists a path between $$$u$$$ and $$$v$$$ for all $$$u, v$$$ ($$$1 \leq u, v \leq n$$$).</span></p><p>After a worker's strike organized by the Dementors asking for equal rights, the prison of Azkaban has suffered some damage. After settling the spirits, the Ministry of Magic is looking to renovate the prison to ensure that the Dementors are kept in check. The prison consists of $$$n$$$ prison cells and $$$m$$$ bi-directional corridors. The $$$i^{th}$$$ corridor is from cells $$$u_i$$$ to $$$v_i$$$. A subset of these cells $$$S$$$ is called a complex if any cell in $$$S$$$ is reachable from any other cell in $$$S$$$. Formally, a subset of cells $$$S$$$ is a complex if $$$x$$$ and $$$y$$$ are reachable from each other for all $$$x, y \in S$$$, using only cells from $$$S$$$ on the way. The funding required for a complex $$$S$$$ consisting of $$$k$$$ cells is defined as $$$k^2$$$.</p><p>As part of your <span class="tex-font-style-it">Intro to Magical Interior Design</span> course at Hogwarts, you have been tasked with designing the prison. The Ministry of Magic has asked that you divide the prison into $$$2$$$ complexes with $$$\textbf{exactly one corridor}$$$ connecting them, so that the Dementors can't organize union meetings. For this purpose, you are allowed to build bi-directional corridors. The funding required to build a corridor between any $$$2$$$ cells is $$$c$$$. </p><p>Due to budget cuts and the ongoing fight against the Death Eaters, you must find the $$$\textbf{minimum total funding}$$$ required to divide the prison as per the Ministry's requirements or $$$-1$$$ if no division is possible.</p><p>Note: The total funding is the sum of the funding required for the $$$2$$$ complexes and the corridors built. If after the division, the two complexes have $$$x$$$ and $$$y$$$ cells respectively and you have built a total of $$$a$$$ corridors, the total funding will be $$$x^2 + y^2 + c \times a$$$. Note that $$$x+y=n$$$.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains one integer $$$t$$$ ($$$1 \leq t \leq 10^5$$$) — the number of test cases. Then $$$t$$$ test cases follow.</p><p>The first line of each test case consists of three integers $$$n, m$$$ and $$$c$$$ ($$$2 \leq n \leq 10^5$$$, $$$m = n - 1$$$, $$$1 \leq c \leq 10^9$$$)</p><p>$$$m$$$ lines follow, each consisting of 2 integers — $$$u_i, v_i$$$ indicating a corridor is present between cells $$$u_i$$$ and $$$v_i$$$ ($$$1 \leq u_i, v_i \leq n$$$, $$$u_i \neq v_i$$$)</p><p>It is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$10^5$$$.</p><p>It is guaranteed that the sum of $$$m$$$ over all test cases does not exceed $$$5 \times 10^5$$$.</p><p>It is guaranteed that there exists at most one corridor between any two cells.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print the $$$\textbf{minimum funding}$$$ required to divide the prison as per the Ministry's requirements or $$$-1$$$ if no division is possible.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
2
2 1 3
1 2
8 7 76
3 1
3 2
2 4
2 5
4 6
4 7
7 8
</pre></div><div class="output"><div class="title">Output</div><pre>
2
32
</pre></div></div></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=G1]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="G2" data-uuid="ps_f50e2fbc028997d7218dada1c04b1160868d4210">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">G2. Min-Fund Prison (Medium)</div><div class="time-limit"><div class="property-title">time limit per test</div>1.5 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p><span class="tex-font-style-bf">In the medium version, $$$2 \leq \sum n \leq 300$$$ and $$$1 \leq \sum m \leq 300$$$</span></p><p>After a worker's strike organized by the Dementors asking for equal rights, the prison of Azkaban has suffered some damage. After settling the spirits, the Ministry of Magic is looking to renovate the prison to ensure that the Dementors are kept in check. The prison consists of $$$n$$$ prison cells and $$$m$$$ bi-directional corridors. The $$$i^{th}$$$ corridor is from cells $$$u_i$$$ to $$$v_i$$$. A subset of these cells $$$S$$$ is called a complex if any cell in $$$S$$$ is reachable from any other cell in $$$S$$$. Formally, a subset of cells $$$S$$$ is a complex if $$$x$$$ and $$$y$$$ are reachable from each other for all $$$x, y \in S$$$, using only cells from $$$S$$$ on the way. The funding required for a complex $$$S$$$ consisting of $$$k$$$ cells is defined as $$$k^2$$$.</p><p>As part of your <span class="tex-font-style-it">Intro to Magical Interior Design</span> course at Hogwarts, you have been tasked with designing the prison. The Ministry of Magic has asked that you divide the prison into $$$2$$$ complexes with $$$\textbf{exactly one corridor}$$$ connecting them, so that the Dementors can't organize union meetings. For this purpose, you are allowed to build bi-directional corridors. The funding required to build a corridor between any $$$2$$$ cells is $$$c$$$. </p><p>Due to budget cuts and the ongoing fight against the Death Eaters, you must find the $$$\textbf{minimum total funding}$$$ required to divide the prison as per the Ministry's requirements or $$$-1$$$ if no division is possible.</p><p>Note: The total funding is the sum of the funding required for the $$$2$$$ complexes and the corridors built. If after the division, the two complexes have $$$x$$$ and $$$y$$$ cells respectively and you have built a total of $$$a$$$ corridors, the total funding will be $$$x^2 + y^2 + c \times a$$$. Note that $$$x+y=n$$$.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains one integer $$$t$$$ ($$$1 \leq t \leq 300$$$) — the number of test cases. Then $$$t$$$ test cases follow.</p><p>The first line of each test case consists of three integers $$$n, m$$$ and $$$c$$$ ($$$2 \leq n \leq 300$$$, $$$1 \leq m \leq 300$$$, $$$1 \leq c \leq 10^9$$$)</p><p>$$$m$$$ lines follow, each consisting of 2 integers — $$$u_i, v_i$$$ indicating a corridor is present between cells $$$u_i$$$ and $$$v_i$$$ ($$$1 \leq u_i, v_i \leq n$$$, $$$u_i \neq v_i$$$)</p><p>It is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$300$$$.</p><p>It is guaranteed that the sum of $$$m$$$ over all test cases does not exceed $$$300$$$.</p><p>It is guaranteed that there exists at most one corridor between any two cells.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print the $$$\textbf{minimum funding}$$$ required to divide the prison as per the Ministry's requirements or $$$-1$$$ if no division is possible.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
4
4 6 5
4 3
2 3
2 4
1 2
4 1
3 1
6 6 2
1 4
2 5
3 6
1 5
3 5
6 5
6 5 7
1 4
2 5
3 6
3 5
6 5
7 5 4
1 4
3 6
3 5
6 5
2 7
</pre></div><div class="output"><div class="title">Output</div><pre>
-1
20
25
33
</pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first test case of the sample input, there is no way to divide the prison according to the Ministry's requirements.</p><p>In the second test case, consider the corridor between cells $$$1$$$ and $$$5$$$ as the connection between the $$$2$$$ complexes consisting of $$$\{2, 3, 5, 6\}$$$ and $$$\{1, 4\}$$$ cells respectively. There are no new corridors built. The total funding is $$$4^2 + 2^2 = 20$$$. You can verify this is the minimum funding required. <img class="tex-graphics" src="https://espresso.codeforces.com/4c979267eda0c2a17cebb21fa9fd90ce7cea8f0f.png" style="max-width: 100.0%;max-height: 100.0%;" /></p><p>In the third test case, build a corridor between $$$2$$$ and $$$4$$$. Consider the corridor between cells $$$1$$$ and $$$5$$$ as the connection between the $$$2$$$ complexes consisting of $$$\{3, 5, 6\}$$$ and $$$\{1, 2, 4\}$$$ cells respectively. The total funding is $$$3^2 + 3^2 + 7 \times 1 = 25$$$. You can verify this is the minimum funding required. <img class="tex-graphics" src="https://espresso.codeforces.com/2b5a587189133d1cfd40bfc8ae0c800e77a82bc3.png" style="max-width: 100.0%;max-height: 100.0%;" /></p><p>In the fourth test case, build a corridor between $$$2$$$ and $$$4$$$ and between $$$5$$$ and $$$7$$$. Consider the corridor between cells $$$5$$$ and $$$7$$$ as the connection between the $$$2$$$ complexes consisting of $$$\{1, 2, 4, 7\}$$$ and $$$\{3, 5, 6\}$$$ cells respectively. The total funding is $$$4^2 + 3^2 + 4 \times 2 = 33$$$. You can verify this is the minimum funding required. <img class="tex-graphics" src="https://espresso.codeforces.com/f9b632076e770b25d8404ec6870464de7e27c5d1.png" style="max-width: 100.0%;max-height: 100.0%;" /></p><p>Note for all test cases that there may be multiple ways to get the same funding but there is no other division which will have a more optimal minimum funding.</p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=G2]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 1em;"
        >


<div class="problemindexholder" problemindex="G3" data-uuid="ps_41dfa39e3685727494cf09b9a8af5955fcf82c7a">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">G3. Min-Fund Prison (Hard)</div><div class="time-limit"><div class="property-title">time limit per test</div>1.5 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p><span class="tex-font-style-bf">In the hard version, $$$2 \leq \sum n \leq 10^5$$$ and $$$1 \leq \sum m \leq 5 \times 10^{5}$$$</span></p><p>After a worker's strike organized by the Dementors asking for equal rights, the prison of Azkaban has suffered some damage. After settling the spirits, the Ministry of Magic is looking to renovate the prison to ensure that the Dementors are kept in check. The prison consists of $$$n$$$ prison cells and $$$m$$$ bi-directional corridors. The $$$i^{th}$$$ corridor is from cells $$$u_i$$$ to $$$v_i$$$. A subset of these cells $$$S$$$ is called a complex if any cell in $$$S$$$ is reachable from any other cell in $$$S$$$. Formally, a subset of cells $$$S$$$ is a complex if $$$x$$$ and $$$y$$$ are reachable from each other for all $$$x, y \in S$$$, using only cells from $$$S$$$ on the way. The funding required for a complex $$$S$$$ consisting of $$$k$$$ cells is defined as $$$k^2$$$.</p><p>As part of your <span class="tex-font-style-it">Intro to Magical Interior Design</span> course at Hogwarts, you have been tasked with designing the prison. The Ministry of Magic has asked that you divide the prison into $$$2$$$ complexes with $$$\textbf{exactly one corridor}$$$ connecting them, so that the Dementors can't organize union meetings. For this purpose, you are allowed to build bi-directional corridors. The funding required to build a corridor between any $$$2$$$ cells is $$$c$$$. </p><p>Due to budget cuts and the ongoing fight against the Death Eaters, you must find the $$$\textbf{minimum total funding}$$$ required to divide the prison as per the Ministry's requirements or $$$-1$$$ if no division is possible.</p><p>Note: The total funding is the sum of the funding required for the $$$2$$$ complexes and the corridors built. If after the division, the two complexes have $$$x$$$ and $$$y$$$ cells respectively and you have built a total of $$$a$$$ corridors, the total funding will be $$$x^2 + y^2 + c \times a$$$. Note that $$$x+y=n$$$.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains one integer $$$t$$$ ($$$1 \leq t \leq 10^5$$$) — the number of test cases. Then $$$t$$$ test cases follow.</p><p>The first line of each test case consists of three integers $$$n, m$$$ and $$$c$$$ ($$$2 \leq n \leq 10^5$$$, $$$1 \leq m \leq 5 \times 10^{5}$$$, $$$1 \leq c \leq 10^9$$$)</p><p>$$$m$$$ lines follow, each consisting of 2 integers — $$$u_i, v_i$$$ indicating a corridor is present between cells $$$u_i$$$ and $$$v_i$$$ ($$$1 \leq u_i, v_i \leq n$$$, $$$u_i \neq v_i$$$)</p><p>It is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$10^5$$$.</p><p>It is guaranteed that the sum of $$$m$$$ over all test cases does not exceed $$$5 \times 10^5$$$.</p><p>It is guaranteed that there exists at most one corridor between any two cells.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print the $$$\textbf{minimum funding}$$$ required to divide the prison as per the Ministry's requirements or $$$-1$$$ if no division is possible.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>
4
4 6 5
4 3
2 3
2 4
1 2
4 1
3 1
6 6 2
1 4
2 5
3 6
1 5
3 5
6 5
6 5 7
1 4
2 5
3 6
3 5
6 5
7 5 4
1 4
3 6
3 5
6 5
2 7
</pre></div><div class="output"><div class="title">Output</div><pre>
-1
20
25
33
</pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first test case of the sample input, there is no way to divide the prison according to the Ministry's requirements.</p><p>In the second test case, consider the corridor between cells $$$1$$$ and $$$5$$$ as the connection between the $$$2$$$ complexes consisting of $$$\{2, 3, 5, 6\}$$$ and $$$\{1, 4\}$$$ cells respectively. There are no new corridors built. The total funding is $$$4^2 + 2^2 = 20$$$. You can verify this is the minimum funding required. <img class="tex-graphics" src="https://espresso.codeforces.com/4c979267eda0c2a17cebb21fa9fd90ce7cea8f0f.png" style="max-width: 100.0%;max-height: 100.0%;" /></p><p>In the third test case, build a corridor between $$$2$$$ and $$$4$$$. Consider the corridor between cells $$$1$$$ and $$$5$$$ as the connection between the $$$2$$$ complexes consisting of $$$\{3, 5, 6\}$$$ and $$$\{1, 2, 4\}$$$ cells respectively. The total funding is $$$3^2 + 3^2 + 7 \times 1 = 25$$$. You can verify this is the minimum funding required. <img class="tex-graphics" src="https://espresso.codeforces.com/2b5a587189133d1cfd40bfc8ae0c800e77a82bc3.png" style="max-width: 100.0%;max-height: 100.0%;" /></p><p>In the fourth test case, build a corridor between $$$2$$$ and $$$4$$$ and between $$$5$$$ and $$$7$$$. Consider the corridor between cells $$$5$$$ and $$$7$$$ as the connection between the $$$2$$$ complexes consisting of $$$\{1, 2, 4, 7\}$$$ and $$$\{3, 5, 6\}$$$ cells respectively. The total funding is $$$4^2 + 3^2 + 4 \times 2 = 33$$$. You can verify this is the minimum funding required. <img class="tex-graphics" src="https://espresso.codeforces.com/f9b632076e770b25d8404ec6870464de7e27c5d1.png" style="max-width: 100.0%;max-height: 100.0%;" /></p><p>Note for all test cases that there may be multiple ways to get the same funding but there is no other division which will have a more optimal minimum funding.</p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=G3]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
    </div>

    <div id="footer">
        <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2024 Mike Mirzayanov</div>
        <div>The only programming contests Web 2.0 platform</div>

    </div>

</div>
</div>
    <script type="application/javascript">
        if ('serviceWorker' in navigator && 'fetch' in window && 'caches' in window) {
            navigator.serviceWorker.register('/service-worker-60067.js')
                .then(function (registration) {
                    console.log('Service worker registered: ', registration);
                })
                .catch(function (error) {
                    console.log('Registration failed: ', error);
                });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8a0fa2254c907787',t:'MTcyMDYwNDg1OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>


<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-743380-5"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-743380-5');
        </script>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="54ad59080aa5e020eb12478d1e529e3c"/>
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01"/>

    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery-1.8.3.js"></script>
    <script type="application/javascript">
        window.locale = "en";
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }

        /* Protection against trailing dot in domain. */
        let hostLength = window.location.host.length;
        if (hostLength > 1 && window.location.host[hostLength - 1] === '.') {
            window.location = window.location.protocol + "//" + window.location.host.substring(0, hostLength - 1);
        }
    </script>

    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="k1">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="//codeforces.org/s/64849/images/codeforces-sponsored-by-ton.png" />
    <link rel="image_src" href="//codeforces.org/s/64849/images/codeforces-sponsored-by-ton.png" />
    <meta property="og:title" content="Problems - Codeforces"/>
    <meta property="og:description" content=""/>
    
    <meta property="og:site_name" content="Codeforces"/>
    
    
    
    
    
    
    <meta name="utc_offset" content="+03:00"/>
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Problems - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community" />
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup" />
    <meta name="robots" content="index, follow" />

    <link rel="stylesheet" href="//codeforces.org/s/64849/css/font-awesome.min.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/line-awesome.min.css" type="text/css" charset="utf-8" />

        <link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>


    <link rel="apple-touch-icon" sizes="57x57" href="//codeforces.org/s/64849/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="//codeforces.org/s/64849/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="//codeforces.org/s/64849/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="//codeforces.org/s/64849/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="//codeforces.org/s/64849/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="//codeforces.org/s/64849/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="//codeforces.org/s/64849/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="//codeforces.org/s/64849/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="//codeforces.org/s/64849/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="//codeforces.org/s/64849/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="//codeforces.org/s/64849/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="//codeforces.org/s/64849/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="//codeforces.org/s/64849/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="//codeforces.org/s/64849/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/prettify.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/clear.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/ttypography.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/problem-statement.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/second-level-menu.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/roundbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/datatable.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/table-form.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/topic.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/jquery.jgrowl.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/facebox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/jquery.wysiwyg.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/jquery.autocomplete.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/codeforces.datepick.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/colorbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/jquery.drafts.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/64849/css/community.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/64849/css/sidebar-menu.css" type="text/css" charset="utf-8" />

    <!-- MathJax -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    MathJax.Hub.Register.StartupHook("End", function () {
        Codeforces.runMathJaxListeners();
    });
    </script>
    <script type="text/javascript" async
            src="https://mathjax.codeforces.org/MathJax.js?config=TeX-AMS_HTML-full"
    >
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="//codeforces.org/s/64849/js/prettify/prettify.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/pushstream.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.easing.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.swipe.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.hotkeys.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/facebox.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/controls/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/controls/wysiwyg.table.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/controls/wysiwyg.image.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/controls/wysiwyg.link.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.datepick.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.drafts.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/clipboard.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/autosize.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/sjcl.js"></script>
    <script type="text/javascript" src="/scripts/f8f695306b4bab3cbdd456143062ab76/en/codeforces-options.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/codeforces.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/EventCatcher.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/preparedVerdictFormats-en.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/confetti.min.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="//codeforces.org/s/64849/markitup/skins/markitup/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/markitup/sets/markdown/style.css" type="text/css" charset="utf-8" />


    <script type="text/javascript" src="//codeforces.org/s/64849/markitup/jquery.markitup.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/markitup/sets/markdown/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->




</head>
<body class=" "><span style='display:none;' class='csrf-token' data-csrf='54ad59080aa5e020eb12478d1e529e3c'>&nbsp;</span>

<!-- .notificationTextCleaner used in Codeforces.showAnnouncements() -->
<div class="notificationTextCleaner" style="font-size: 0"></div>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 3.0rem;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    String.prototype.hashCode = function() {
        var hash = 0, i, chr;
        if (this.length === 0) return hash;
        for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };

    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile === "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>





    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 700
        });
    }, 100);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


    function showAnnouncements(json) {
        //info("j=" + JSON.stringify(json));

        if (json.t != "a") {
            return;
        }

        setTimeout(function() {
            Codeforces.showAnnouncements(json.d, "en");
        }, Math.random() * 500);
    }

    function showEventCatcherUserMessage(json) {
        if (json.t == "s") {
            var points = json.d[5];
            var passedTestCount = json.d[7];
            var judgedTestCount = json.d[8];
            var verdict = preparedVerdictFormats[json.d[12]];
            var verdictPrototypeDiv = $(".verdictPrototypeDiv");
            verdictPrototypeDiv.html(verdict);
            if (judgedTestCount != null && judgedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-judged").text(judgedTestCount);
            }
            if (passedTestCount != null && passedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-passed").text(passedTestCount);
            }
            if (points != null && points != undefined) {
                verdictPrototypeDiv.find(".verdict-format-points").text(points);
            }
            Codeforces.showMessage(verdictPrototypeDiv.text());
        }
    }

    $(".clickable-title").each(function() {
        var title = $(this).attr("data-title");
        if (title) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = title;
            $(this).attr("title", tmp.textContent || tmp.innerText || "");
        }
    });

    $(".clickable-title").click(function() {
        var title = $(this).attr("data-title");
        if (title) {
            Codeforces.alert(title);
        } else {
            Codeforces.alert($(this).attr("title"));
        }
    }).css("position", "relative").css("bottom", "3px");

        Codeforces.showDelayedMessage();

    Codeforces.reformatTimes();

    //Codeforces.initializePubSub();
    if (window.codeforcesOptions.subscribeServerUrl) {
        window.eventCatcher = new EventCatcher(
            window.codeforcesOptions.subscribeServerUrl,
            [
                Codeforces.getGlobalChannel(),
                Codeforces.getUserChannel(),
                Codeforces.getUserShowMessageChannel(),
                Codeforces.getContestChannel(),
                Codeforces.getParticipantChannel(),
                Codeforces.getTalkChannel()
            ]
        );

        if (Codeforces.getParticipantChannel()) {
            window.eventCatcher.subscribe(Codeforces.getParticipantChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getContestChannel()) {
            window.eventCatcher.subscribe(Codeforces.getContestChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getGlobalChannel()) {
            window.eventCatcher.subscribe(Codeforces.getGlobalChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserShowMessageChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserShowMessageChannel(), function(json) {
                showEventCatcherUserMessage(json);
            });
        }
    }

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>


<div id="body">
<div style="width: 950px; margin: 0 auto;" class="compact-problemset">
    <div id="header" style="position: relative; margin: 0;">
        <div style="float:left;">
                  <a href="/"><img height="65" style="height: 65px;" src="//codeforces.org/s/64849/images/codeforces-sponsored-by-ton.png" alt="Codeforces"/></a>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="//codeforces.org/s/64849/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="//codeforces.org/s/64849/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <br style="clear: both;"/>

    <div style="text-align: center; font-size: 1.8rem; margin-bottom: 0.5em;"
         class="caption">Bubble Cup 8 - Finals [Online Mirror]</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

    <div class="problem-frames">
        <div
                    style="margin-bottom: 2em;"
        >

    <style>
        #facebox .content:has(.diff-popup) {
            width: 90vw;
            max-width: 120rem !important;
        }

        .testCaseMarker {
            position: absolute;
            font-weight: bold;
            font-size: 1rem;
        }

        .diff-popup {
            width: 90vw;
            max-width: 120rem !important;
            display: none;
            overflow: auto;
        }

        .input-output-copier {
            font-size: 1.2rem;
            float: right;
            color: #888 !important;
            cursor: pointer;
            border: 1px solid rgb(185, 185, 185);
            padding: 3px;
            margin: 1px;
            line-height: 1.1rem;
            text-transform: none;
        }

        .input-output-copier:hover {
            background-color: #def;
        }

        .test-explanation textarea {
            width: 100%;
            height: 1.5em;
        }

        .pending-submission-message {
            color: darkorange !important;
        }
    </style>
    <script>
        const OPENING_SPACE = String.fromCharCode(1001);
        const CLOSING_SPACE = String.fromCharCode(1002);

        const nodeToText = function (node, pre) {
            let result = [];

            if (node.tagName === "SCRIPT" || node.tagName === "math"
                || (node.classList && node.classList.contains("input-output-copier")))
                return [];

            if (node.tagName === "NOBR") {
                result.push(OPENING_SPACE);
            }

            if (node.nodeType === Node.TEXT_NODE) {
                let s = node.textContent;
                if (!pre) {
                    s = s.replace(/\s+/g, " ");
                }
                if (s.length > 0) {
                    result.push(s);
                }
            }

            if (pre && node.tagName === "BR") {
                result.push("\n");
            }

            node.childNodes.forEach(function (child) {
                result.push(nodeToText(child, node.tagName === "PRE").join(""));
            });

            if (node.tagName === "DIV"
                || node.tagName === "P"
                || node.tagName === "PRE"
                || node.tagName === "UL"
                || node.tagName === "LI"
            ) {
                result.push("\n");
            }

            if (node.tagName === "NOBR") {
                result.push(CLOSING_SPACE);
            }

            return result;
        }

        const isSpecial = function (c) {
            return c === ',' || c === '.' || c === ';' || c === ')' || c === ' ';
        }

        const convertStatementToText = function(statmentNode) {
            const text = nodeToText(statmentNode, false).join("").replace(/ +/g, " ").replace(/\n\n+/g, "\n\n");
            let result = [];
            for (let i = 0; i < text.length; i++) {
                const c = text.charAt(i);
                if (c === OPENING_SPACE) {
                    if (!((i > 0 && text.charAt(i - 1) === '(') || (result.length > 0 && result[result.length - 1] === ' '))) {
                        result.push('+');
                    }
                } else if (c === CLOSING_SPACE) {
                    if (!(i + 1 < text.length && isSpecial(text.charAt(i + 1)))) {
                        result.push('-');
                    }
                } else {
                    result.push(c);
                }
            }
            return result.join("").split("\n").map(value => value.trim()).join("\n");
        };
    </script>
    <div class="diff-popup">
    </div>

<div class="problemindexholder" problemindex="A" data-uuid="ps_21bea902692cf345b2b702d82c62295b3303dd3c">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A. Fibonotci</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Fibonotci sequence is an integer recursive sequence defined by the recurrence relation </p><center> <span class="tex-span"><i>F</i><sub class="lower-index"><i>n</i></sub> = <i>s</i><sub class="lower-index"><i>n</i> - 1</sub>·<i>F</i><sub class="lower-index"><i>n</i> - 1</sub> + <i>s</i><sub class="lower-index"><i>n</i> - 2</sub>·<i>F</i><sub class="lower-index"><i>n</i> - 2</sub></span> </center> with <center> <span class="tex-span"><i>F</i><sub class="lower-index">0</sub> = 0, <i>F</i><sub class="lower-index">1</sub> = 1</span> </center><p>Sequence <span class="tex-span"><i>s</i></span> is an infinite and almost cyclic sequence with a cycle of length <span class="tex-span"><i>N</i></span>. A sequence <span class="tex-span"><i>s</i></span> is called almost cyclic with a cycle of length <span class="tex-span"><i>N</i></span> if <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/abdce465bcf8d0d338a86425f5fa2335716b3d7a.png" style="max-width: 100.0%;max-height: 100.0%;" />, for <span class="tex-span"><i>i</i> ≥ <i>N</i></span>, except for a finite number of values <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span>, for which <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/d2ab32073499aaaf8b0d9c2b91c11a459e9232fd.png" style="max-width: 100.0%;max-height: 100.0%;" /> (<span class="tex-span"><i>i</i> ≥ <i>N</i></span>).</p><p>Following is an example of an almost cyclic sequence with a cycle of length 4: </p><center> s = (5,3,8,11,5,3,7,11,5,3,8,11,…) </center><p>Notice that the only value of <span class="tex-span"><i>s</i></span> for which the equality <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/cd0d4348232c2fbd13e29e43ab74867ddd55b748.png" style="max-width: 100.0%;max-height: 100.0%;" /> does not hold is <span class="tex-span"><i>s</i><sub class="lower-index">6</sub></span> (<span class="tex-span"><i>s</i><sub class="lower-index">6</sub> = 7</span> and <span class="tex-span"><i>s</i><sub class="lower-index">2</sub> = 8</span>). You are given <span class="tex-span"><i>s</i><sub class="lower-index">0</sub>, <i>s</i><sub class="lower-index">1</sub>, ...<i>s</i><sub class="lower-index"><i>N</i> - 1</sub></span> and all the values of sequence <span class="tex-span"><i>s</i></span> for which <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/d2ab32073499aaaf8b0d9c2b91c11a459e9232fd.png" style="max-width: 100.0%;max-height: 100.0%;" /> (<span class="tex-span"><i>i</i> ≥ <i>N</i></span>).</p><p>Find <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/0201bb0e22294177386737ca97362911941b14b8.png" style="max-width: 100.0%;max-height: 100.0%;" />.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains two numbers <span class="tex-span"><i>K</i></span> and <span class="tex-span"><i>P</i></span>. The second line contains a single number <span class="tex-span"><i>N</i></span>. The third line contains <span class="tex-span"><i>N</i></span> numbers separated by spaces, that represent the first <span class="tex-span"><i>N</i></span> numbers of the sequence <span class="tex-span"><i>s</i></span>. The fourth line contains a single number <span class="tex-span"><i>M</i></span>, the number of values of sequence <span class="tex-span"><i>s</i></span> for which <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/d2ab32073499aaaf8b0d9c2b91c11a459e9232fd.png" style="max-width: 100.0%;max-height: 100.0%;" />. Each of the following <span class="tex-span"><i>M</i></span> lines contains two numbers <span class="tex-span"><i>j</i></span> and <span class="tex-span"><i>v</i></span>, indicating that <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/564d9a2c078730cf3e878e777c1048b58dd9fa77.png" style="max-width: 100.0%;max-height: 100.0%;" /> and <span class="tex-span"><i>s</i><sub class="lower-index"><i>j</i></sub> = <i>v</i></span>. All j-s are distinct.</p><ul> <li> <span class="tex-span">1 ≤ <i>N</i>, <i>M</i> ≤ 50000</span> </li><li> <span class="tex-span">0 ≤ <i>K</i> ≤ 10<sup class="upper-index">18</sup></span> </li><li> <span class="tex-span">1 ≤ <i>P</i> ≤ 10<sup class="upper-index">9</sup></span> </li><li> <span class="tex-span">1 ≤ <i>s</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>, for all <span class="tex-span"><i>i</i> = 0, 1, ...<i>N</i> - 1</span> </li><li> <span class="tex-span"><i>N</i> ≤ <i>j</i> ≤ 10<sup class="upper-index">18</sup></span> </li><li> <span class="tex-span">1 ≤ <i>v</i> ≤ 10<sup class="upper-index">9</sup></span> </li><li> All values are integers </li></ul></div><div class="output-specification"><div class="section-title">Output</div><p>Output should contain a single integer equal to <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/0201bb0e22294177386737ca97362911941b14b8.png" style="max-width: 100.0%;max-height: 100.0%;" />.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>10 8<br />3<br />1 2 1<br />2<br />7 3<br />5 4<br /></pre></div><div class="output"><div class="title">Output</div><pre>4<br /></pre></div></div></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=A]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {
        window.changedTests = new Set();

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");



        String.prototype.replaceAll = function (search, replace) {
            return this.split(search).join(replace);
        };

        $(".sample-test .title").each(function () {
            const preId = ("id" + Math.random()).replaceAll(".", "0");
            const cpyId = ("id" + Math.random()).replaceAll(".", "0");

            $(this).parent().find("pre").attr("id", preId);
            const $copy = $("<div title='Copy' data-clipboard-target='#" + preId + "' id='" + cpyId + "' class='input-output-copier'>Copy</div>");
            $(this).append($copy);

            const clipboard = new Clipboard('#' + cpyId, {
                text: function (trigger) {
                    const pre = document.querySelector('#' + preId);
                    const lines = pre.querySelectorAll(".test-example-line");
                    return Codeforces.filterClipboardText(pre.innerText, lines.length);
                }
            });

            const isInput = $(this).parent().hasClass("input");

            clipboard.on('success', function (e) {
                if (isInput) {
                    Codeforces.showMessage("The example input has been copied into the clipboard");
                } else {
                    Codeforces.showMessage("The example output has been copied into the clipboard");
                }
                e.clearSelection();
            });
        });

        $(".test-form-item input").change(function () {
            addPendingSubmissionMessage($($(this).closest("form")), "You changed the answer, do not forget to submit it if you want to save the changes");
            const index = $(this).closest(".problemindexholder").attr("problemindex");
            let test = "";
            $(this).closest("form input").each(function () {
                const test_ = $(this).attr("name");
                if (test_ && test_.substring(0, 4) === "test") {
                    test = test_;
                }
            });
            if (index.length > 0 && test.length > 0) {
                const indexTest = index + "::" + test;
                window.changedTests.add(indexTest);
            }
        });

        $(window).on('beforeunload', function () {
            if (window.changedTests.size > 0) {
                return 'Dialog text here';
            }
        });

        autosize($('.test-explanation textarea'));

        $(".test-example-line").hover(function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        let top = 1E20;
                        let left = 1E20;
                        let problem = $(this).closest(".problemindexholder");
                        $(this).closest(".input").find("." + clazz).css("background-color", "#FFFDE7").each(function() {
                            top = Math.min(top, $(this).offset().top);
                            left = Math.min(left, $(this).offset().left);
                        });
                        let testCaseMarker = problem.find(".testCaseMarker_" + end);
                        if (testCaseMarker.length === 0) {
                            const html = "<div class=\"testCaseMarker testCaseMarker_" + end + " notice\"></div>";
                            problem.append($(html));
                            testCaseMarker = problem.find(".testCaseMarker_" + end);
                        }
                        if (testCaseMarker) {
                            testCaseMarker.show()
                                    .offset({top, left: left - 20})
                                    .text(end);
                        }
                    }
                }
            });
        }, function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        $("." + clazz).css("background-color", "");
                        $(this).closest(".problemindexholder").find(".testCaseMarker_" + end).hide();
                    }
                }
            });
        });

    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="B" data-uuid="ps_c8091f2a2a29c05ec889d045c61b2ac1eb95dcc7">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B. Bribes</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Ruritania is a country with a very badly maintained road network, which is not exactly good news for lorry drivers that constantly have to do deliveries. In fact, when roads are maintained, they become <span class="tex-font-style-bf">one-way</span>. It turns out that it is sometimes impossible to get from one town to another in a legal way – however, we know that all towns are <span class="tex-font-style-bf">reachable</span>, though <span class="tex-font-style-bf">illegally</span>!</p><p>Fortunately for us, the police tend to be very corrupt and they will allow a lorry driver to break the rules and drive in the wrong direction provided they receive ‘a small gift’. There is one patrol car for every road and they will request 1000 Ruritanian dinars when a driver drives in the wrong direction. However, being greedy, every time a patrol car notices the same driver breaking the rule, they will charge <span class="tex-font-style-bf">double</span> the amount of money they requested the previous time on that particular road.</p><p>Borna is a lorry driver that managed to figure out this bribing pattern. As part of his job, he has to make <span class="tex-span"><i>K</i></span> stops in some towns all over Ruritania and he has to make these stops in a certain order. There are <span class="tex-span"><i>N</i></span> towns (enumerated from 1 to <span class="tex-span"><i>N</i></span>) in Ruritania and Borna’s initial location is the capital city i.e. town 1. He happens to know which ones out of the <span class="tex-span"><i>N</i> - 1</span> roads in Ruritania are currently unidirectional, but he is unable to compute the least amount of money he needs to prepare for bribing the police. Help Borna by providing him with an answer and you will be richly rewarded.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains <span class="tex-span"><i>N</i></span>, the number of towns in Ruritania. The following <span class="tex-span"><i>N</i> - 1</span> lines contain information regarding individual roads between towns. A road is represented by a tuple of integers (<span class="tex-span"><i>a</i></span>,<span class="tex-span"><i>b</i></span>,<span class="tex-span"><i>x</i></span>), which are separated with a single whitespace character. The numbers <span class="tex-span"><i>a</i></span> and <span class="tex-span"><i>b</i></span> represent the cities connected by this particular road, and x is either 0 or 1: 0 means that the road is bidirectional, 1 means that only the <span class="tex-span"><i>a</i> → <i>b</i></span> direction is legal. The next line contains <span class="tex-span"><i>K</i></span>, the number of stops Borna has to make. The final line of input contains K positive integers <span class="tex-span"><i>s</i><sub class="lower-index">1</sub>, …, <i>s</i><sub class="lower-index"><i>K</i></sub></span>: the towns Borna has to visit.</p><ul> <li> <span class="tex-span">1 ≤ <i>N</i> ≤ 10<sup class="upper-index">5</sup></span> </li><li> <span class="tex-span">1 ≤ <i>K</i> ≤ 10<sup class="upper-index">6</sup></span> </li><li> <span class="tex-span">1 ≤ <i>a</i>, <i>b</i> ≤ <i>N</i></span> for all roads </li><li> <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/64f2634ec841af9f94da1975b6d207b9e2b0cc67.png" style="max-width: 100.0%;max-height: 100.0%;" /> for all roads </li><li> <span class="tex-span">1 ≤ <i>s</i><sub class="lower-index"><i>i</i></sub> ≤ <i>N</i></span> for all <span class="tex-span">1 ≤ <i>i</i> ≤ <i>K</i></span> </li></ul></div><div class="output-specification"><div class="section-title">Output</div><p>The output should contain a single number: the least amount of thousands of Ruritanian dinars Borna should allocate for bribes, modulo <span class="tex-span">10<sup class="upper-index">9</sup> + 7</span>.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>5<br />1 2 0<br />2 3 0<br />5 1 1<br />3 4 1<br />5<br />5 4 5 2 2<br /></pre></div><div class="output"><div class="title">Output</div><pre>4<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Borna first takes the route <span class="tex-span">1 → 5</span> and has to pay 1000 dinars. After that, he takes the route <span class="tex-span">5 → 1 → 2 → 3 → 4</span> and pays nothing this time. However, when he has to return via <span class="tex-span">4 → 3 → 2 → 1 → 5</span>, he needs to prepare 3000 (1000+2000) dinars. Afterwards, getting to 2 via <span class="tex-span">5 → 1 → 2</span> will cost him nothing. Finally, he doesn't even have to leave town 2 to get to 2, so there is no need to prepare any additional bribe money. Hence he has to prepare 4000 dinars in total.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=B]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="C" data-uuid="ps_db9f62c17aec584393e94a3efa6f5030095de53e">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C. Party</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>4 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p><span class="tex-font-style-it">Note the unusual memory limit for the problem</span>.</p><p>People working in MDCS (Microsoft Development Center Serbia) like partying. They usually go to night clubs on Friday and Saturday.</p><p>There are <span class="tex-span"><i>N</i></span> people working in MDCS and there are <span class="tex-span"><i>N</i></span> clubs in the city. Unfortunately, if there is more than one Microsoft employee in night club, level of coolness goes infinitely high and party is over, so club owners will never let more than one Microsoft employee enter their club in the same week (just to be sure).</p><p>You are organizing night life for Microsoft employees and you have statistics about how much every employee likes Friday and Saturday parties for all clubs.</p><p>You need to match people with clubs maximizing overall sum of their happiness (they are happy as much as they like the club), while <span class="tex-font-style-bf">half</span> of people should go clubbing on Friday and the other <span class="tex-font-style-bf">half</span> on Saturday.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains integer <span class="tex-span"><i>N</i></span> — number of employees in MDCS.</p><p>Then an <span class="tex-span"><i>N</i> × <i>N</i></span> matrix follows, where element in <span class="tex-span"><i>i</i></span>-th row and <span class="tex-span"><i>j</i></span>-th column is an integer number that represents how much <span class="tex-span"><i>i</i></span>-th person likes <span class="tex-span"><i>j</i></span>-th club’s <span class="tex-font-style-bf">Friday</span> party.</p><p>Then another <span class="tex-span"><i>N</i> × <i>N</i></span> matrix follows, where element in <span class="tex-span"><i>i</i></span>-th row and <span class="tex-span"><i>j</i></span>-th column is an integer number that represents how much <span class="tex-span"><i>i</i></span>-th person likes <span class="tex-span"><i>j</i></span>-th club’s <span class="tex-font-style-bf">Saturday</span> party.</p><ul> <li> <span class="tex-span">2 ≤ <i>N</i> ≤ 20</span> </li><li> <span class="tex-span"><i>N</i></span> is even </li><li> <span class="tex-span">0 ≤ </span> level of likeness <span class="tex-span"> ≤ 10<sup class="upper-index">6</sup></span> </li><li> All values are integers </li></ul></div><div class="output-specification"><div class="section-title">Output</div><p>Output should contain a single integer — maximum sum of happiness possible.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>4<br />1 2 3 4<br />2 3 4 1<br />3 4 1 2<br />4 1 2 3<br />5 8 7 1<br />6 9 81 3<br />55 78 1 6<br />1 1 1 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>167<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Here is how we matched people with clubs:</p><p>Friday: 1st person with 4th club (4 happiness) and 4th person with 1st club (4 happiness). </p><p>Saturday: 2nd person with 3rd club (81 happiness) and 3rd person with 2nd club (78 happiness).</p><p>4+4+81+78 = 167</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=C]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="D" data-uuid="ps_bfbb4fd034fcb664b7c3506680c97726cf34d4d7">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. Tablecity</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>There was a big bank robbery in Tablecity. In order to catch the thief, the President called none other than Albert – Tablecity’s Chief of Police. Albert does not know where the thief is located, but he does know how he moves.</p><p>Tablecity can be represented as <span class="tex-span">1000 × 2</span> grid, where every cell represents one district. Each district has its own unique name “<span class="tex-span">(<i>X</i>, <i>Y</i>)</span>”, where <span class="tex-span"><i>X</i></span> and <span class="tex-span"><i>Y</i></span> are the coordinates of the district in the grid. The thief’s movement is as </p><p>Every hour the thief will leave the district <span class="tex-span">(<i>X</i>, <i>Y</i>)</span> he is currently hiding in, and move to one of the districts: <span class="tex-span">(<i>X</i> - 1, <i>Y</i>)</span>, <span class="tex-span">(<i>X</i> + 1, <i>Y</i>)</span>, <span class="tex-span">(<i>X</i> - 1, <i>Y</i> - 1)</span>, <span class="tex-span">(<i>X</i> - 1, <i>Y</i> + 1)</span>, <span class="tex-span">(<i>X</i> + 1, <i>Y</i> - 1)</span>, <span class="tex-span">(<i>X</i> + 1, <i>Y</i> + 1)</span> as long as it exists in Tablecity. </p><p>Below is an example of thief’s possible movements if he is located in district (7,1):</p><p><img class="tex-graphics" src="https://espresso.codeforces.com/b027a25294a9843ae45355766323313b2cc23db0.png" style="max-width: 100.0%;max-height: 100.0%;" /></p><p>Albert has enough people so that <span class="tex-font-style-bf">every hour</span> he can pick any <span class="tex-font-style-bf">two</span> districts in Tablecity and fully investigate them, making sure that if the thief is located in one of them, he will get caught. Albert promised the President that the thief will be caught in <span class="tex-font-style-bf">no more</span> than 2015 hours and needs your help in order to achieve that.</p></div><div class="input-specification"><div class="section-title">Input</div><p>There is no input for this problem. </p></div><div class="output-specification"><div class="section-title">Output</div><p>The first line of output contains integer <span class="tex-span"><i>N</i></span> – duration of police search in hours. Each of the following <span class="tex-span"><i>N</i></span> lines contains exactly 4 integers <span class="tex-span"><i>X</i><sub class="lower-index"><i>i</i>1</sub></span>, <span class="tex-span"><i>Y</i><sub class="lower-index"><i>i</i>1</sub></span>, <span class="tex-span"><i>X</i><sub class="lower-index"><i>i</i>2</sub></span>, <span class="tex-span"><i>Y</i><sub class="lower-index"><i>i</i>2</sub></span> separated by spaces, that represent 2 districts (<span class="tex-span"><i>X</i><sub class="lower-index"><i>i</i>1</sub></span>, <span class="tex-span"><i>Y</i><sub class="lower-index"><i>i</i>1</sub></span>), (<span class="tex-span"><i>X</i><sub class="lower-index"><i>i</i>2</sub></span>, <span class="tex-span"><i>Y</i><sub class="lower-index"><i>i</i>2</sub></span>) which got investigated during i-th hour. Output is given in <span class="tex-font-style-bf">chronological</span> order (i-th line contains districts investigated during i-th hour) and should <span class="tex-font-style-bf">guarantee</span> that the thief is caught in no more than 2015 hours, <span class="tex-font-style-bf">regardless of thief’s initial position and movement</span>.</p><ul> <li> <span class="tex-span"><i>N</i> ≤ 2015</span> </li><li> <span class="tex-span">1 ≤ <i>X</i> ≤ 1000</span> </li><li> <span class="tex-span">1 ≤ <i>Y</i> ≤ 2</span> </li></ul></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>В этой задаче нет примеров ввода-вывода.<br />This problem doesn't have sample input and output.</pre></div><div class="output"><div class="title">Output</div><pre>Смотрите замечание ниже.<br />See the note below.</pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Let's consider the following output:</p><p>2</p><p>5 1 50 2</p><p>8 1 80 2</p><p>This output is not guaranteed to catch the thief and is not correct. It is given to you only to show the expected output format. There exists a combination of an initial position and a movement strategy such that the police will not catch the thief.</p><p>Consider the following initial position and thief’s movement:</p><p>In the first hour, the thief is located in district (1,1). Police officers will search districts (5,1) and (50,2) and will not find him.</p><p>At the start of the second hour, the thief moves to district (2,2). Police officers will search districts (8,1) and (80,2) and will not find him.</p><p>Since there is no further investigation by the police, the thief escaped!</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=D]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="E" data-uuid="ps_1c0eb510a82e77d4fbdafcde28f351e206b4b96d">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. Spectator Riots</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>It’s riot time on football stadium Ramacana! Raging fans have entered the field and the police find themselves in a difficult situation. The field can be represented as a square in the coordinate system defined by two diagonal vertices in (0,0) and (<span class="tex-span">10<sup class="upper-index">5</sup></span>, <span class="tex-span">10<sup class="upper-index">5</sup></span>). The sides of that square are also considered to be <span class="tex-font-style-bf">inside</span> the field, everything else is <span class="tex-font-style-bf">outside</span>.</p><p>In the beginning, there are <span class="tex-span"><i>N</i></span> fans on the field. For each fan we are given his speed, an integer <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span> as well as his integer coordinates (<span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub></span>). A fan with those coordinates might move and after one second he might be at any point (<span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub> + <i>p</i></span>, <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub> + <i>q</i></span>) where <span class="tex-span">0 ≤ |<i>p</i>| + |<i>q</i>| ≤ <i>v</i><sub class="lower-index"><i>i</i></sub></span>. <span class="tex-span"><i>p</i></span>, <span class="tex-span"><i>q</i></span> are both integers.</p><p>Points that go <span class="tex-font-style-bf">outside</span> of the square that represents the field are excluded and all others have equal probability of being the location of that specific fan after one second.</p><p>Andrej, a young and promising police officer, has sent a flying drone to take a photo of the riot from above. The drone’s camera works like this:</p><ol> <li> It selects three points with <span class="tex-font-style-bf">integer coordinates</span> such that there is a chance of a fan appearing there after one second. They must not be collinear or the camera won’t work. It is guaranteed that not all of the initial positions of fans will be on the same line. </li><li> Camera focuses those points and creates a circle that passes through those three points. A photo is taken after one second (one second after the initial state). </li><li> Everything that is on the circle or inside it at the moment of taking the photo (one second after focusing the points) will be on the photo. </li></ol><p>Your goal is to select those three points so that the expected number of fans seen on the photo is maximized. If there are more such selections, select those three points that give the circle with <span class="tex-font-style-bf">largest radius</span> among them. If there are still more suitable selections, <span class="tex-font-style-bf">any one</span> of them will be accepted. If your answer follows conditions above and radius of circle you return is smaller then the optimal one by 0.01, your output will be considered as correct.</p><p>No test will have optimal radius bigger than <span class="tex-span">10<sup class="upper-index">10</sup></span>.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains the number of fans on the field, <span class="tex-span"><i>N</i></span>. The next <span class="tex-span"><i>N</i></span> lines contain three integers: <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> ,<span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span>. They are the <span class="tex-span"><i>x</i></span>-coordinate, <span class="tex-span"><i>y</i></span>-coordinate and speed of fan <span class="tex-span"><i>i</i></span> at the beginning of the one second interval considered in the task.</p><ul> <li> <span class="tex-span">3 ≤ <i>N</i> ≤ 10<sup class="upper-index">5</sup></span> </li><li> <span class="tex-span">0 ≤ <i>x</i><sub class="lower-index"><i>i</i></sub>, <i>y</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">5</sup></span> </li><li> <span class="tex-span">0 ≤ <i>v</i><sub class="lower-index"><i>i</i></sub> ≤ 1000</span> </li><li> All numbers are integers </li></ul></div><div class="output-specification"><div class="section-title">Output</div><p>You need to output the three points that camera needs to select. Print them in three lines, with every line containing the <span class="tex-span"><i>x</i></span>-coordinate, then <span class="tex-span"><i>y</i></span>-coordinate, separated by a single space. The order of points does not matter.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3<br />1 1 1<br />1 1 1<br />1 2 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>2 2<br />2 1<br />1 0<br /></pre></div></div></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=E]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="F" data-uuid="ps_51076635732ed3936d7fbc2e4c33d83c021da9ae">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">F. Bulbo</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Bananistan is a beautiful banana republic. Beautiful women in beautiful dresses. Beautiful statues of beautiful warlords. Beautiful stars in beautiful nights.</p><p>In Bananistan people play this crazy game – Bulbo. There’s an array of bulbs and player at the position, which represents one of the bulbs. The distance between two neighboring bulbs is 1. Before each turn player can change his position with cost <span class="tex-span">|<i>pos</i><sub class="lower-index"><i>new</i></sub> - <i>pos</i><sub class="lower-index"><i>old</i></sub>|</span>. After that, a contiguous set of bulbs lights-up and player pays the cost that’s equal to the distance to the closest shining bulb. Then, all bulbs go dark again. The goal is to minimize your summed cost. I tell you, Bananistanians are spending their nights playing with bulbs.</p><p>Banana day is approaching, and you are hired to play the most beautiful Bulbo game ever. A huge array of bulbs is installed, and you know your initial position and all the light-ups in advance. You need to play the ideal game and impress Bananistanians, and their families.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains number of turns <span class="tex-span"><i>n</i></span> and initial position <span class="tex-span"><i>x</i></span>. Next <span class="tex-span"><i>n</i></span> lines contain two numbers <span class="tex-span"><i>l</i><sub class="lower-index"><i>start</i></sub></span> and <span class="tex-span"><i>l</i><sub class="lower-index"><i>end</i></sub></span>, which represent that all bulbs from interval <span class="tex-span">[<i>l</i><sub class="lower-index"><i>start</i></sub>, <i>l</i><sub class="lower-index"><i>end</i></sub>]</span> are shining this turn.</p><ul> <li> <span class="tex-span">1 ≤ <i>n</i> ≤ 5000</span> </li><li> <span class="tex-span">1 ≤ <i>x</i> ≤ 10<sup class="upper-index">9</sup></span> </li><li> <span class="tex-span">1 ≤ <i>l</i><sub class="lower-index"><i>start</i></sub> ≤ <i>l</i><sub class="lower-index"><i>end</i></sub> ≤ 10<sup class="upper-index">9</sup></span> </li></ul></div><div class="output-specification"><div class="section-title">Output</div><p>Output should contain a single number which represents the best result (minimum cost) that could be obtained by playing this Bulbo game.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>5 4<br />2 7<br />9 16<br />8 10<br />9 17<br />1 6<br /></pre></div><div class="output"><div class="title">Output</div><pre>8<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Before 1. turn move to position 5</p><p>Before 2. turn move to position 9</p><p>Before 5. turn move to position 8</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=F]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="G" data-uuid="ps_111f9d8bd9922205eb0bf068df3be8915f2c9096">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">G. Run for beer</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>People in BubbleLand like to drink beer. Little do you know, beer here is so good and strong that every time you drink it your speed goes 10 times slower than before you drank it.</p><p>Birko lives in city Beergrade, but wants to go to city Beerburg. You are given a road map of BubbleLand and you need to find the fastest way for him. When he starts his journey in Beergrade his speed is 1. When he comes to a new city he always tries a glass of local beer, which divides his speed by 10. </p><p>The question here is what the minimal time for him to reach Beerburg is. If there are several paths with the same minimal time, pick the one that has least roads on it. If there is still more than one path, pick any.</p><p>It is guaranteed that there will be at least one path from Beergrade to Beerburg.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of input contains integer <span class="tex-span"><i>N</i></span> — the number of cities in Bubbleland and integer <span class="tex-span"><i>M</i></span> — the number of roads in this country. Cities are enumerated from 0 to <span class="tex-span"><i>N</i> - 1</span>, with city 0 being Beergrade, and city <span class="tex-span"><i>N</i> - 1</span> being Beerburg. Each of the following <span class="tex-span"><i>M</i></span> lines contains three integers <span class="tex-span"><i>a</i></span>, <span class="tex-span"><i>b</i></span> (<span class="tex-span"><i>a</i> ≠ <i>b</i></span>) and <span class="tex-span"><i>len</i></span>. These numbers indicate that there is a bidirectional road between cities <span class="tex-span"><i>a</i></span> and <span class="tex-span"><i>b</i></span> with length <span class="tex-span"><i>len</i></span>. </p><ul> <li> <span class="tex-span">2 ≤ <i>N</i> ≤ 10<sup class="upper-index">5</sup></span> </li><li> <span class="tex-span">1 ≤ <i>M</i> ≤ 10<sup class="upper-index">5</sup></span> </li><li> <span class="tex-span">0 ≤ <i>len</i> ≤ 9</span> </li><li> There is at most one road between two cities </li></ul></div><div class="output-specification"><div class="section-title">Output</div><p>The first line of output should contain minimal time needed to go from Beergrade to Beerburg.</p><p>The second line of the output should contain the number of cities on the path from Beergrade to Beerburg that takes minimal time. </p><p>The third line of output should contain the numbers of cities on this path in the order they are visited, separated by spaces.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>8 10<br />0 1 1<br />1 2 5<br />2 7 6<br />0 3 2<br />3 7 3<br />0 4 0<br />4 5 0<br />5 7 2<br />0 6 0<br />6 7 7<br /></pre></div><div class="output"><div class="title">Output</div><pre>32<br />3<br />0 3 7<br /></pre></div></div></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=G]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="H" data-uuid="ps_845e61c128b1d1fd1f7c52770760fba52b0388ad">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">H. Bots</div><div class="time-limit"><div class="property-title">time limit per test</div>1.5 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Sasha and Ira are two best friends. But they aren’t just friends, they are software engineers and experts in artificial intelligence. They are developing an algorithm for two bots playing a two-player game. The game is cooperative and turn based. In each turn, one of the players makes a move (it doesn’t matter which player, it's possible that players turns do not alternate). </p><p>Algorithm for bots that Sasha and Ira are developing works by keeping track of the state the game is in. Each time either bot makes a move, the state changes. And, since the game is very dynamic, it will never go back to the state it was already in at any point in the past.</p><p>Sasha and Ira are perfectionists and want their algorithm to have an optimal winning strategy. They have noticed that in the optimal winning strategy, both bots make exactly <span class="tex-span"><i>N</i></span> moves each. But, in order to find the optimal strategy, their algorithm needs to analyze all possible states of the game (they haven’t learned about alpha-beta pruning yet) and pick the best sequence of moves.</p><p>They are worried about the efficiency of their algorithm and are wondering what is the total number of states of the game that need to be analyzed? </p></div><div class="input-specification"><div class="section-title">Input</div><p>The first and only line contains integer N.</p><ul> <li> <span class="tex-span">1 ≤ <i>N</i> ≤ 10<sup class="upper-index">6</sup></span> </li></ul></div><div class="output-specification"><div class="section-title">Output</div><p>Output should contain a single integer – number of possible states modulo <span class="tex-span">10<sup class="upper-index">9</sup> + 7</span>.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>2<br /></pre></div><div class="output"><div class="title">Output</div><pre>19<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Start: Game is in state A. </p><ul> <li> Turn 1: Either bot can make a move (first bot is red and second bot is blue), so there are two possible states after the first turn – B and C. </li><li> Turn 2: In both states B and C, either bot can again make a turn, so the list of possible states is expanded to include D, E, F and G. </li><li> Turn 3: Red bot already did N=2 moves when in state D, so it cannot make any more moves there. It can make moves when in state E, F and G, so states I, K and M are added to the list. Similarly, blue bot cannot make a move when in state G, but can when in D, E and F, so states H, J and L are added. </li><li> Turn 4: Red bot already did N=2 moves when in states H, I and K, so it can only make moves when in J, L and M, so states P, R and S are added. Blue bot cannot make a move when in states J, L and M, but only when in H, I and K, so states N, O and Q are added. </li></ul><p>Overall, there are 19 possible states of the game their algorithm needs to analyze.</p><p><img class="tex-graphics" src="https://espresso.codeforces.com/3d9ef2ab59018319b986a58a65362116fa5be88d.png" style="max-width: 100.0%;max-height: 100.0%;" /></p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=H]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 1em;"
        >


<div class="problemindexholder" problemindex="I" data-uuid="ps_253ba83af3b7f53c47556f98df52643160477070">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">I. Robots protection</div><div class="time-limit"><div class="property-title">time limit per test</div>1.5 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>512 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Company &quot;Robots industries&quot; produces robots for territory protection. Robots protect triangle territories — right isosceles triangles with catheti parallel to North-South and East-West directions.</p><p>Owner of some land buys and sets robots on his territory to protect it. From time to time, businessmen want to build offices on that land and want to know how many robots will guard it. You are to handle these queries. </p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains integer <span class="tex-span"><i>N</i></span> — width and height of the land, and integer <span class="tex-span"><i>Q</i></span> — number of queries to handle.</p><p>Next <span class="tex-span"><i>Q</i></span> lines contain queries you need to process.</p><p>Two types of queries: </p><ol> <li> <span class="tex-span">1</span> <span class="tex-span"><i>dir</i></span> <span class="tex-span"><i>x</i></span> <span class="tex-span"><i>y</i></span> <span class="tex-span"><i>len</i></span> — add a robot to protect a triangle. Depending on the value of <span class="tex-span"><i>dir</i></span>, the values of <span class="tex-span"><i>x</i></span>, <span class="tex-span"><i>y</i></span> and <span class="tex-span"><i>len</i></span> represent a different triangle: <ul>  <li> <span class="tex-span"><i>dir</i> = 1</span>: Triangle is defined by the points <span class="tex-span">(<i>x</i>, <i>y</i>)</span>, <span class="tex-span">(<i>x</i> + <i>len</i>, <i>y</i>)</span>, <span class="tex-span">(<i>x</i>, <i>y</i> + <i>len</i>)</span>  </li><li> <span class="tex-span"><i>dir</i> = 2</span>: Triangle is defined by the points <span class="tex-span">(<i>x</i>, <i>y</i>)</span>, <span class="tex-span">(<i>x</i> + <i>len</i>, <i>y</i>)</span>, <span class="tex-span">(<i>x</i>, <i>y</i> - <i>len</i>)</span>  </li><li> <span class="tex-span"><i>dir</i> = 3</span>: Triangle is defined by the points <span class="tex-span">(<i>x</i>, <i>y</i>)</span>, <span class="tex-span">(<i>x</i> - <i>len</i>, <i>y</i>)</span>, <span class="tex-span">(<i>x</i>, <i>y</i> + <i>len</i>)</span>  </li><li> <span class="tex-span"><i>dir</i> = 4</span>: Triangle is defined by the points <span class="tex-span">(<i>x</i>, <i>y</i>)</span>, <span class="tex-span">(<i>x</i> - <i>len</i>, <i>y</i>)</span>, <span class="tex-span">(<i>x</i>, <i>y</i> - <i>len</i>)</span> </li></ul> </li><li> <span class="tex-span">2</span> <span class="tex-span"><i>x</i></span> <span class="tex-span"><i>y</i></span> — output how many robots guard this point (robot guards a point if the point is inside or on the border of its triangle) </li></ol><ul> <li> <span class="tex-span">1 ≤ <i>N</i> ≤ 5000</span> </li><li> <span class="tex-span">1 ≤ <i>Q</i> ≤ 10<sup class="upper-index">5</sup></span> </li><li> <span class="tex-span">1 ≤ <i>dir</i> ≤ 4</span> </li><li> All points of triangles are within range <span class="tex-span">[1, <i>N</i>]</span> </li><li> All numbers are positive integers </li></ul></div><div class="output-specification"><div class="section-title">Output</div><p>For each second type query output how many robots guard this point. Each answer should be in a separate line.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>17 10<br />1 1 3 2 4<br />1 3 10 3 7<br />1 2 6 8 2<br />1 3 9 4 2<br />2 4 4<br />1 4 15 10 6<br />2 7 7<br />2 9 4<br />2 12 2<br />2 13 8<br /></pre></div><div class="output"><div class="title">Output</div><pre>2<br />2<br />2<br />0<br />1<br /></pre></div></div></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=I]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
    </div>

    <div id="footer">
        <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2024 Mike Mirzayanov</div>
        <div>The only programming contests Web 2.0 platform</div>

    </div>

</div>
</div>
    <script type="application/javascript">
        if ('serviceWorker' in navigator && 'fetch' in window && 'caches' in window) {
            navigator.serviceWorker.register('/service-worker-64849.js')
                .then(function (registration) {
                    console.log('Service worker registered: ', registration);
                })
                .catch(function (error) {
                    console.log('Registration failed: ', error);
                });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8a014107fdf27781',t:'MTcyMDQ1NDA3OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

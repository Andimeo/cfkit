
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-743380-5"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-743380-5');
        </script>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="3716e8611df8c8a899928178ab3f1719"/>
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01"/>

    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery-1.8.3.js"></script>
    <script type="application/javascript">
        window.locale = "en";
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }

        /* Protection against trailing dot in domain. */
        let hostLength = window.location.host.length;
        if (hostLength > 1 && window.location.host[hostLength - 1] === '.') {
            window.location = window.location.protocol + "//" + window.location.host.substring(0, hostLength - 1);
        }
    </script>

    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="k1">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="//codeforces.org/s/64849/images/codeforces-sponsored-by-ton.png" />
    <link rel="image_src" href="//codeforces.org/s/64849/images/codeforces-sponsored-by-ton.png" />
    <meta property="og:title" content="Problems - Codeforces"/>
    <meta property="og:description" content=""/>
    
    <meta property="og:site_name" content="Codeforces"/>
    
    
    
    
    
    
    <meta name="utc_offset" content="+03:00"/>
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Problems - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community" />
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup" />
    <meta name="robots" content="index, follow" />

    <link rel="stylesheet" href="//codeforces.org/s/64849/css/font-awesome.min.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/line-awesome.min.css" type="text/css" charset="utf-8" />

        <link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>


    <link rel="apple-touch-icon" sizes="57x57" href="//codeforces.org/s/64849/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="//codeforces.org/s/64849/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="//codeforces.org/s/64849/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="//codeforces.org/s/64849/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="//codeforces.org/s/64849/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="//codeforces.org/s/64849/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="//codeforces.org/s/64849/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="//codeforces.org/s/64849/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="//codeforces.org/s/64849/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="//codeforces.org/s/64849/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="//codeforces.org/s/64849/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="//codeforces.org/s/64849/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="//codeforces.org/s/64849/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="//codeforces.org/s/64849/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/prettify.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/clear.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/ttypography.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/problem-statement.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/second-level-menu.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/roundbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/datatable.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/table-form.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/topic.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/jquery.jgrowl.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/facebox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/jquery.wysiwyg.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/jquery.autocomplete.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/codeforces.datepick.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/colorbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/jquery.drafts.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/64849/css/community.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/64849/css/sidebar-menu.css" type="text/css" charset="utf-8" />

    <!-- MathJax -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    MathJax.Hub.Register.StartupHook("End", function () {
        Codeforces.runMathJaxListeners();
    });
    </script>
    <script type="text/javascript" async
            src="https://mathjax.codeforces.org/MathJax.js?config=TeX-AMS_HTML-full"
    >
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="//codeforces.org/s/64849/js/prettify/prettify.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/pushstream.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.easing.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.swipe.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.hotkeys.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/facebox.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/controls/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/controls/wysiwyg.table.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/controls/wysiwyg.image.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/controls/wysiwyg.link.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.datepick.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.drafts.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/clipboard.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/autosize.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/sjcl.js"></script>
    <script type="text/javascript" src="/scripts/f8f695306b4bab3cbdd456143062ab76/en/codeforces-options.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/codeforces.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/EventCatcher.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/preparedVerdictFormats-en.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/confetti.min.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="//codeforces.org/s/64849/markitup/skins/markitup/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/markitup/sets/markdown/style.css" type="text/css" charset="utf-8" />


    <script type="text/javascript" src="//codeforces.org/s/64849/markitup/jquery.markitup.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/markitup/sets/markdown/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->




</head>
<body class=" "><span style='display:none;' class='csrf-token' data-csrf='3716e8611df8c8a899928178ab3f1719'>&nbsp;</span>

<!-- .notificationTextCleaner used in Codeforces.showAnnouncements() -->
<div class="notificationTextCleaner" style="font-size: 0"></div>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 3.0rem;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    String.prototype.hashCode = function() {
        var hash = 0, i, chr;
        if (this.length === 0) return hash;
        for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };

    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile === "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>





    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 700
        });
    }, 100);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


    function showAnnouncements(json) {
        //info("j=" + JSON.stringify(json));

        if (json.t != "a") {
            return;
        }

        setTimeout(function() {
            Codeforces.showAnnouncements(json.d, "en");
        }, Math.random() * 500);
    }

    function showEventCatcherUserMessage(json) {
        if (json.t == "s") {
            var points = json.d[5];
            var passedTestCount = json.d[7];
            var judgedTestCount = json.d[8];
            var verdict = preparedVerdictFormats[json.d[12]];
            var verdictPrototypeDiv = $(".verdictPrototypeDiv");
            verdictPrototypeDiv.html(verdict);
            if (judgedTestCount != null && judgedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-judged").text(judgedTestCount);
            }
            if (passedTestCount != null && passedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-passed").text(passedTestCount);
            }
            if (points != null && points != undefined) {
                verdictPrototypeDiv.find(".verdict-format-points").text(points);
            }
            Codeforces.showMessage(verdictPrototypeDiv.text());
        }
    }

    $(".clickable-title").each(function() {
        var title = $(this).attr("data-title");
        if (title) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = title;
            $(this).attr("title", tmp.textContent || tmp.innerText || "");
        }
    });

    $(".clickable-title").click(function() {
        var title = $(this).attr("data-title");
        if (title) {
            Codeforces.alert(title);
        } else {
            Codeforces.alert($(this).attr("title"));
        }
    }).css("position", "relative").css("bottom", "3px");

        Codeforces.showDelayedMessage();

    Codeforces.reformatTimes();

    //Codeforces.initializePubSub();
    if (window.codeforcesOptions.subscribeServerUrl) {
        window.eventCatcher = new EventCatcher(
            window.codeforcesOptions.subscribeServerUrl,
            [
                Codeforces.getGlobalChannel(),
                Codeforces.getUserChannel(),
                Codeforces.getUserShowMessageChannel(),
                Codeforces.getContestChannel(),
                Codeforces.getParticipantChannel(),
                Codeforces.getTalkChannel()
            ]
        );

        if (Codeforces.getParticipantChannel()) {
            window.eventCatcher.subscribe(Codeforces.getParticipantChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getContestChannel()) {
            window.eventCatcher.subscribe(Codeforces.getContestChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getGlobalChannel()) {
            window.eventCatcher.subscribe(Codeforces.getGlobalChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserShowMessageChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserShowMessageChannel(), function(json) {
                showEventCatcherUserMessage(json);
            });
        }
    }

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>


<div id="body">
<div style="width: 950px; margin: 0 auto;" class="compact-problemset">
    <div id="header" style="position: relative; margin: 0;">
        <div style="float:left;">
                  <a href="/"><img height="65" style="height: 65px;" src="//codeforces.org/s/64849/images/codeforces-sponsored-by-ton.png" alt="Codeforces"/></a>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="//codeforces.org/s/64849/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="//codeforces.org/s/64849/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <br style="clear: both;"/>

    <div style="text-align: center; font-size: 1.8rem; margin-bottom: 0.5em;"
         class="caption">Codeforces Round 248 (Div. 1)</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

    <div class="problem-frames">
        <div
                    style="margin-bottom: 2em;"
        >

    <style>
        #facebox .content:has(.diff-popup) {
            width: 90vw;
            max-width: 120rem !important;
        }

        .testCaseMarker {
            position: absolute;
            font-weight: bold;
            font-size: 1rem;
        }

        .diff-popup {
            width: 90vw;
            max-width: 120rem !important;
            display: none;
            overflow: auto;
        }

        .input-output-copier {
            font-size: 1.2rem;
            float: right;
            color: #888 !important;
            cursor: pointer;
            border: 1px solid rgb(185, 185, 185);
            padding: 3px;
            margin: 1px;
            line-height: 1.1rem;
            text-transform: none;
        }

        .input-output-copier:hover {
            background-color: #def;
        }

        .test-explanation textarea {
            width: 100%;
            height: 1.5em;
        }

        .pending-submission-message {
            color: darkorange !important;
        }
    </style>
    <script>
        const OPENING_SPACE = String.fromCharCode(1001);
        const CLOSING_SPACE = String.fromCharCode(1002);

        const nodeToText = function (node, pre) {
            let result = [];

            if (node.tagName === "SCRIPT" || node.tagName === "math"
                || (node.classList && node.classList.contains("input-output-copier")))
                return [];

            if (node.tagName === "NOBR") {
                result.push(OPENING_SPACE);
            }

            if (node.nodeType === Node.TEXT_NODE) {
                let s = node.textContent;
                if (!pre) {
                    s = s.replace(/\s+/g, " ");
                }
                if (s.length > 0) {
                    result.push(s);
                }
            }

            if (pre && node.tagName === "BR") {
                result.push("\n");
            }

            node.childNodes.forEach(function (child) {
                result.push(nodeToText(child, node.tagName === "PRE").join(""));
            });

            if (node.tagName === "DIV"
                || node.tagName === "P"
                || node.tagName === "PRE"
                || node.tagName === "UL"
                || node.tagName === "LI"
            ) {
                result.push("\n");
            }

            if (node.tagName === "NOBR") {
                result.push(CLOSING_SPACE);
            }

            return result;
        }

        const isSpecial = function (c) {
            return c === ',' || c === '.' || c === ';' || c === ')' || c === ' ';
        }

        const convertStatementToText = function(statmentNode) {
            const text = nodeToText(statmentNode, false).join("").replace(/ +/g, " ").replace(/\n\n+/g, "\n\n");
            let result = [];
            for (let i = 0; i < text.length; i++) {
                const c = text.charAt(i);
                if (c === OPENING_SPACE) {
                    if (!((i > 0 && text.charAt(i - 1) === '(') || (result.length > 0 && result[result.length - 1] === ' '))) {
                        result.push('+');
                    }
                } else if (c === CLOSING_SPACE) {
                    if (!(i + 1 < text.length && isSpecial(text.charAt(i + 1)))) {
                        result.push('-');
                    }
                } else {
                    result.push(c);
                }
            }
            return result.join("").split("\n").map(value => value.trim()).join("\n");
        };
    </script>
    <div class="diff-popup">
    </div>

<div class="problemindexholder" problemindex="A" data-uuid="ps_4f72f79a9652df276549ea3bb7bc7e93ad2d2c6c">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A. Ryouko's Memory Note</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Ryouko is an extremely forgetful girl, she could even forget something that has just happened. So in order to remember, she takes a notebook with her, called <span class="tex-font-style-it">Ryouko's Memory Note</span>. She writes what she sees and what she hears on the notebook, and the notebook became her memory.</p><p>Though Ryouko is forgetful, she is also born with superb analyzing abilities. However, analyzing depends greatly on gathered information, in other words, memory. So she has to shuffle through her notebook whenever she needs to analyze, which is tough work.</p><p>Ryouko's notebook consists of <span class="tex-span"><i>n</i></span> pages, numbered from 1 to <span class="tex-span"><i>n</i></span>. To make life (and this problem) easier, we consider that to turn from page <span class="tex-span"><i>x</i></span> to page <span class="tex-span"><i>y</i></span>, <span class="tex-span">|<i>x</i> - <i>y</i>|</span> pages should be turned. During analyzing, Ryouko needs <span class="tex-span"><i>m</i></span> pieces of information, the <span class="tex-span"><i>i</i></span>-th piece of information is on page <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>. Information must be read from the notebook in order, so the total number of pages that Ryouko needs to turn is <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/b19a52472036d57233f58883f6dcf82d27f98e8e.png" style="max-width: 100.0%;max-height: 100.0%;" />.</p><p>Ryouko wants to decrease the number of pages that need to be turned. In order to achieve this, she can merge two pages of her notebook. If Ryouko merges page <span class="tex-span"><i>x</i></span> to page <span class="tex-span"><i>y</i></span>, she would copy all the information on page <span class="tex-span"><i>x</i></span> to <span class="tex-span"><i>y</i> (1 ≤ <i>x</i>, <i>y</i> ≤ <i>n</i>)</span>, and consequently, all elements in sequence <span class="tex-span"><i>a</i></span> that was <span class="tex-span"><i>x</i></span> would become <span class="tex-span"><i>y</i></span>. Note that <span class="tex-span"><i>x</i></span> can be equal to <span class="tex-span"><i>y</i></span>, in which case no changes take place.</p><p>Please tell Ryouko the minimum number of pages that she needs to turn. Note she can apply the described operation at most once before the reading. Note that the answer can exceed 32-bit integers.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of input contains two integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>m</i> (1 ≤ <i>n</i>, <i>m</i> ≤ 10<sup class="upper-index">5</sup>)</span>.</p><p>The next line contains <span class="tex-span"><i>m</i></span> integers separated by spaces: <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>m</i></sub></span> <span class="tex-span">(1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i>)</span>.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print a single integer — the minimum number of pages Ryouko needs to turn.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>4 6<br />1 2 3 4 3 2<br /></pre></div><div class="output"><div class="title">Output</div><pre>3<br /></pre></div><div class="input"><div class="title">Input</div><pre>10 5<br />9 4 3 8 8<br /></pre></div><div class="output"><div class="title">Output</div><pre>6<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample, the optimal solution is to merge page 4 to 3, after merging sequence <span class="tex-span"><i>a</i></span> becomes <span class="tex-span">{1, 2, 3, 3, 3, 2}</span>, so the number of pages Ryouko needs to turn is <span class="tex-span">|1 - 2| + |2 - 3| + |3 - 3| + |3 - 3| + |3 - 2| = 3</span>.</p><p>In the second sample, optimal solution is achieved by merging page 9 to 4.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=A]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {
        window.changedTests = new Set();

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");



        String.prototype.replaceAll = function (search, replace) {
            return this.split(search).join(replace);
        };

        $(".sample-test .title").each(function () {
            const preId = ("id" + Math.random()).replaceAll(".", "0");
            const cpyId = ("id" + Math.random()).replaceAll(".", "0");

            $(this).parent().find("pre").attr("id", preId);
            const $copy = $("<div title='Copy' data-clipboard-target='#" + preId + "' id='" + cpyId + "' class='input-output-copier'>Copy</div>");
            $(this).append($copy);

            const clipboard = new Clipboard('#' + cpyId, {
                text: function (trigger) {
                    const pre = document.querySelector('#' + preId);
                    const lines = pre.querySelectorAll(".test-example-line");
                    return Codeforces.filterClipboardText(pre.innerText, lines.length);
                }
            });

            const isInput = $(this).parent().hasClass("input");

            clipboard.on('success', function (e) {
                if (isInput) {
                    Codeforces.showMessage("The example input has been copied into the clipboard");
                } else {
                    Codeforces.showMessage("The example output has been copied into the clipboard");
                }
                e.clearSelection();
            });
        });

        $(".test-form-item input").change(function () {
            addPendingSubmissionMessage($($(this).closest("form")), "You changed the answer, do not forget to submit it if you want to save the changes");
            const index = $(this).closest(".problemindexholder").attr("problemindex");
            let test = "";
            $(this).closest("form input").each(function () {
                const test_ = $(this).attr("name");
                if (test_ && test_.substring(0, 4) === "test") {
                    test = test_;
                }
            });
            if (index.length > 0 && test.length > 0) {
                const indexTest = index + "::" + test;
                window.changedTests.add(indexTest);
            }
        });

        $(window).on('beforeunload', function () {
            if (window.changedTests.size > 0) {
                return 'Dialog text here';
            }
        });

        autosize($('.test-explanation textarea'));

        $(".test-example-line").hover(function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        let top = 1E20;
                        let left = 1E20;
                        let problem = $(this).closest(".problemindexholder");
                        $(this).closest(".input").find("." + clazz).css("background-color", "#FFFDE7").each(function() {
                            top = Math.min(top, $(this).offset().top);
                            left = Math.min(left, $(this).offset().left);
                        });
                        let testCaseMarker = problem.find(".testCaseMarker_" + end);
                        if (testCaseMarker.length === 0) {
                            const html = "<div class=\"testCaseMarker testCaseMarker_" + end + " notice\"></div>";
                            problem.append($(html));
                            testCaseMarker = problem.find(".testCaseMarker_" + end);
                        }
                        if (testCaseMarker) {
                            testCaseMarker.show()
                                    .offset({top, left: left - 20})
                                    .text(end);
                        }
                    }
                }
            });
        }, function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        $("." + clazz).css("background-color", "");
                        $(this).closest(".problemindexholder").find(".testCaseMarker_" + end).hide();
                    }
                }
            });
        });

    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="B" data-uuid="ps_0fb78a6ff33b2852f42c8481ce6cb3f15a814011">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B. Nanami's Digital Board</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Nanami is an expert at playing games. This day, Nanami's good friend Hajime invited her to watch a game of baseball. Unwilling as she was, she followed him to the stadium. But Nanami had no interest in the game, so she looked around to see if there was something that might interest her. That's when she saw the digital board at one end of the stadium.</p><p>The digital board is <span class="tex-span"><i>n</i></span> pixels in height and <span class="tex-span"><i>m</i></span> pixels in width, every pixel is either light or dark. The pixels are described by its coordinate. The <span class="tex-span"><i>j</i></span>-th pixel of the <span class="tex-span"><i>i</i></span>-th line is pixel <span class="tex-span">(<i>i</i>, <i>j</i>)</span>. The board displays messages by switching a combination of pixels to light, and the rest to dark. Nanami notices that the state of the pixels on the board changes from time to time. At certain times, certain pixels on the board may switch from light to dark, or from dark to light.</p><p>Nanami wonders, what is the area of the biggest light block such that a specific pixel is on its side. A light block is a sub-rectangle of the board, in which all pixels are light. Pixel <span class="tex-span">(<i>i</i>, <i>j</i>)</span> belongs to a side of sub-rectangle with <span class="tex-span">(<i>x</i><sub class="lower-index">1</sub>, <i>y</i><sub class="lower-index">1</sub>)</span> and <span class="tex-span">(<i>x</i><sub class="lower-index">2</sub>, <i>y</i><sub class="lower-index">2</sub>)</span> as its upper-left and lower-right vertex if and only if it satisfies the logical condition: </p><center>((<span class="tex-span"><i>i</i> = <i>x</i><sub class="lower-index">1</sub></span> or <span class="tex-span"><i>i</i> = <i>x</i><sub class="lower-index">2</sub></span>) and (<span class="tex-span"><i>y</i><sub class="lower-index">1</sub> ≤ <i>j</i> ≤ <i>y</i><sub class="lower-index">2</sub></span>)) or ((<span class="tex-span"><i>j</i> = <i>y</i><sub class="lower-index">1</sub></span> or <span class="tex-span"><i>j</i> = <i>y</i><sub class="lower-index">2</sub></span>) and (<span class="tex-span"><i>x</i><sub class="lower-index">1</sub> ≤ <i>i</i> ≤ <i>x</i><sub class="lower-index">2</sub></span>)).</center><p>Nanami has all the history of changing pixels, also she has some questions of the described type, can you answer them?</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains three space-separated integers <span class="tex-span"><i>n</i></span>, <span class="tex-span"><i>m</i></span> and <span class="tex-span"><i>q</i> (1 ≤ <i>n</i>, <i>m</i>, <i>q</i> ≤ 1000)</span> — the height and width of the digital board, and the number of operations.</p><p>Then follow <span class="tex-span"><i>n</i></span> lines, each line containing <span class="tex-span"><i>m</i></span> space-separated integers. The <span class="tex-span"><i>j</i></span>-th integer of the <span class="tex-span"><i>i</i></span>-th line is <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i>, <i>j</i></sub></span> — the initial state of pixel <span class="tex-span">(<i>i</i>, <i>j</i>)</span>.</p><ul> <li> If <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i>, <i>j</i></sub> = 0</span>, pixel <span class="tex-span">(<i>i</i>, <i>j</i>)</span> is initially dark. </li><li> If <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i>, <i>j</i></sub> = 1</span>, pixel <span class="tex-span">(<i>i</i>, <i>j</i>)</span> is initially light. </li></ul><p>Then follow <span class="tex-span"><i>q</i></span> lines, each line containing three space-separated integers <span class="tex-span"><i>op</i></span>, <span class="tex-span"><i>x</i></span>, and <span class="tex-span"><i>y</i> (1 ≤ <i>op</i> ≤ 2; 1 ≤ <i>x</i> ≤ <i>n</i>; 1 ≤ <i>y</i> ≤ <i>m</i>)</span>, describing an operation.</p><ul> <li> If <span class="tex-span"><i>op</i> = 1</span>, the pixel at <span class="tex-span">(<i>x</i>, <i>y</i>)</span> changes its state (from light to dark or from dark to light). </li><li> If <span class="tex-span"><i>op</i> = 2</span>, Nanami queries the biggest light block with pixel <span class="tex-span">(<i>x</i>, <i>y</i>)</span> on its side. </li></ul></div><div class="output-specification"><div class="section-title">Output</div><p>For each query, print a single line containing one integer — the answer to Nanami's query.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3 4 5<br />0 1 1 0<br />1 0 0 1<br />0 1 1 0<br />2 2 2<br />2 1 2<br />1 2 2<br />1 2 3<br />2 2 2<br /></pre></div><div class="output"><div class="title">Output</div><pre>0<br />2<br />6<br /></pre></div><div class="input"><div class="title">Input</div><pre>3 3 4<br />1 1 1<br />1 1 1<br />1 1 1<br />2 2 2<br />1 2 2<br />2 1 1<br />2 2 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>6<br />3<br />3<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Consider the first sample.</p><p>The first query specifies pixel <span class="tex-span">(2, 2)</span>, which is dark itself, so there are no valid light blocks, thus the answer is 0.</p><p>The second query specifies pixel <span class="tex-span">(1, 2)</span>. The biggest light block is the block with <span class="tex-span">(1, 2)</span> as its upper-left vertex and <span class="tex-span">(1, 3)</span> as its lower-right vertex.</p><p>The last query specifies pixel <span class="tex-span">(2, 2)</span>, which became light in the third operation. The biggest light block is the block with <span class="tex-span">(1, 2)</span> as its upper-left vertex and <span class="tex-span">(3, 3)</span> as its lower-right vertex.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=B]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="C" data-uuid="ps_7a7993923286361cfeade69b749c64236c766c76">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C. Tachibana Kanade's Tofu</div><div class="time-limit"><div class="property-title">time limit per test</div>5 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>512 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Tachibana Kanade likes Mapo Tofu very much. One day, the canteen cooked all kinds of tofu to sell, but not all tofu is Mapo Tofu, only those spicy enough can be called Mapo Tofu.</p><p>Each piece of tofu in the canteen is given a <span class="tex-span"><i>m</i></span>-based number, all numbers are in the range <span class="tex-span">[<i>l</i>, <i>r</i>]</span> (<span class="tex-span"><i>l</i></span> and <span class="tex-span"><i>r</i></span> being <span class="tex-span"><i>m</i></span>-based numbers), and for every <span class="tex-span"><i>m</i></span>-based integer in the range <span class="tex-span">[<i>l</i>, <i>r</i>]</span>, there exists a piece of tofu with that number.</p><p>To judge what tofu is Mapo Tofu, Tachibana Kanade chose <span class="tex-span"><i>n</i></span> <span class="tex-span"><i>m</i></span>-based number strings, and assigned a value to each string. If a string appears in the number of a tofu, the value of the string will be added to the value of that tofu. If a string appears multiple times, then the value is also added that many times. Initially the value of each tofu is zero.</p><p>Tachibana Kanade considers tofu with values no more than <span class="tex-span"><i>k</i></span> to be Mapo Tofu. So now Tachibana Kanade wants to know, how many pieces of tofu are Mapo Tofu?</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains three integers <span class="tex-span"><i>n</i></span>, <span class="tex-span"><i>m</i></span> and <span class="tex-span"><i>k</i> (1 ≤ <i>n</i> ≤ 200; 2 ≤ <i>m</i> ≤ 20; 1 ≤ <i>k</i> ≤ 500)</span>. Where <span class="tex-span"><i>n</i></span> denotes the number of strings, <span class="tex-span"><i>m</i></span> denotes the base used, and <span class="tex-span"><i>k</i></span> denotes the limit of the value for Mapo Tofu.</p><p>The second line represents the number <span class="tex-span"><i>l</i></span>. The first integer in the line is <span class="tex-span"><i>len</i></span> <span class="tex-span">(1 ≤ <i>len</i> ≤ 200)</span>, describing the length (number of digits in base <span class="tex-span"><i>m</i></span>) of <span class="tex-span"><i>l</i></span>. Then follow <span class="tex-span"><i>len</i></span> integers <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>len</i></sub> (0 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> &lt; <i>m</i>; <i>a</i><sub class="lower-index">1</sub> &gt; 0)</span> separated by spaces, representing the digits of <span class="tex-span"><i>l</i></span>, with <span class="tex-span"><i>a</i><sub class="lower-index">1</sub></span> being the highest digit and <span class="tex-span"><i>a</i><sub class="lower-index"><i>len</i></sub></span> being the lowest digit.</p><p>The third line represents the number <span class="tex-span"><i>r</i></span> in the same format as <span class="tex-span"><i>l</i></span>. It is guaranteed that <span class="tex-span">1 ≤ <i>l</i> ≤ <i>r</i></span>.</p><p>Then follow <span class="tex-span"><i>n</i></span> lines, each line describing a number string. The <span class="tex-span"><i>i</i></span>-th line contains the <span class="tex-span"><i>i</i></span>-th number string and <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span> — the value of the <span class="tex-span"><i>i</i></span>-th string (<span class="tex-span">1 ≤ <i>v</i><sub class="lower-index"><i>i</i></sub> ≤ 200</span>). All number strings are described in almost the same format as <span class="tex-span"><i>l</i></span>, the only difference is number strings may contain necessary leading zeros (see the first example). The sum of the lengths of all number strings does not exceed <span class="tex-span">200</span>.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Output the number of pieces of Mapo Tofu modulo <span class="tex-span">1000000007</span> <span class="tex-span">(10<sup class="upper-index">9</sup> + 7)</span>. The answer should be a decimal integer.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>2 10 1<br />1 1<br />3 1 0 0<br />1 1 1<br />1 0 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>97<br /></pre></div><div class="input"><div class="title">Input</div><pre>2 10 12<br />2 5 9<br />6 6 3 5 4 9 7<br />2 0 6 1<br />3 6 7 2 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>635439<br /></pre></div><div class="input"><div class="title">Input</div><pre>4 2 6<br />6 1 0 1 1 1 0<br />6 1 1 0 1 0 0<br />1 1 2<br />3 0 1 0 5<br />4 0 1 1 0 4<br />3 1 0 1 2<br /></pre></div><div class="output"><div class="title">Output</div><pre>2<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample, 10, 11 and 100 are the only three decimal numbers in <span class="tex-span">[1, 100]</span> with a value greater than 1. Here the value of 1 is 1 but not 2, since numbers cannot contain leading zeros and thus cannot be written as &quot;<span class="tex-font-style-tt">01</span>&quot;.</p><p>In the second sample, no numbers in the given interval have a value greater than 12.</p><p>In the third sample, 110000 and 110001 are the only two binary numbers in the given interval with a value no greater than 6.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=C]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="D" data-uuid="ps_9b57b2193256bc1b28f9369978d3636d256e4ae5">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. Nanami's Power Plant</div><div class="time-limit"><div class="property-title">time limit per test</div>5 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>512 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Nanami likes playing games, and is also really good at it. This day she was playing a new game which involved operating a power plant. Nanami's job is to control the generators in the plant and produce maximum output.</p><p>There are <span class="tex-span"><i>n</i></span> generators in the plant. Each generator should be set to a generating level. Generating level is an integer (possibly zero or negative), the generating level of the <span class="tex-span"><i>i</i></span>-th generator should be between <span class="tex-span"><i>l</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>r</i><sub class="lower-index"><i>i</i></sub></span> (both inclusive). The output of a generator can be calculated using a certain quadratic function <span class="tex-span"><i>f</i>(<i>x</i>)</span>, where <span class="tex-span"><i>x</i></span> is the generating level of the generator. Each generator has its own function, the function of the <span class="tex-span"><i>i</i></span>-th generator is denoted as <span class="tex-span"><i>f</i><sub class="lower-index"><i>i</i></sub>(<i>x</i>)</span>.</p><p>However, there are <span class="tex-span"><i>m</i></span> further restrictions to the generators. Let the generating level of the <span class="tex-span"><i>i</i></span>-th generator be <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span>. Each restriction is of the form <span class="tex-span"><i>x</i><sub class="lower-index"><i>u</i></sub> ≤ <i>x</i><sub class="lower-index"><i>v</i></sub> + <i>d</i></span>, where <span class="tex-span"><i>u</i></span> and <span class="tex-span"><i>v</i></span> are IDs of two different generators and <span class="tex-span"><i>d</i></span> is an integer.</p><p>Nanami found the game tedious but giving up is against her creed. So she decided to have a program written to calculate the answer for her (the maximum total output of generators). Somehow, this became your job.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains two integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>m</i> (1 ≤ <i>n</i> ≤ 50; 0 ≤ <i>m</i> ≤ 100)</span> — the number of generators and the number of restrictions.</p><p>Then follow <span class="tex-span"><i>n</i></span> lines, each line contains three integers <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span>, and <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub> (|<i>a</i><sub class="lower-index"><i>i</i></sub>| ≤ 10; |<i>b</i><sub class="lower-index"><i>i</i></sub>|, |<i>c</i><sub class="lower-index"><i>i</i></sub>| ≤ 1000)</span> — the coefficients of the function <span class="tex-span"><i>f</i><sub class="lower-index"><i>i</i></sub>(<i>x</i>)</span>. That is, <span class="tex-span"><i>f</i><sub class="lower-index"><i>i</i></sub>(<i>x</i>) = <i>a</i><sub class="lower-index"><i>i</i></sub><i>x</i><sup class="upper-index">2</sup> + <i>b</i><sub class="lower-index"><i>i</i></sub><i>x</i> + <i>c</i><sub class="lower-index"><i>i</i></sub></span>.</p><p>Then follow another <span class="tex-span"><i>n</i></span> lines, each line contains two integers <span class="tex-span"><i>l</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>r</i><sub class="lower-index"><i>i</i></sub> ( - 100 ≤ <i>l</i><sub class="lower-index"><i>i</i></sub> ≤ <i>r</i><sub class="lower-index"><i>i</i></sub> ≤ 100)</span>.</p><p>Then follow <span class="tex-span"><i>m</i></span> lines, each line contains three integers <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span>, and <span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub> (1 ≤ <i>u</i><sub class="lower-index"><i>i</i></sub>, <i>v</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i>; <i>u</i><sub class="lower-index"><i>i</i></sub> ≠ <i>v</i><sub class="lower-index"><i>i</i></sub>; |<i>d</i><sub class="lower-index"><i>i</i></sub>| ≤ 200)</span>, describing a restriction. The <span class="tex-span"><i>i</i></span>-th restriction is <span class="tex-span"><i>x</i><sub class="lower-index"><i>u</i><sub class="lower-index"><i>i</i></sub></sub> ≤ <i>x</i><sub class="lower-index"><i>v</i><sub class="lower-index"><i>i</i></sub></sub> + <i>d</i><sub class="lower-index"><i>i</i></sub></span>.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print a single line containing a single integer — the maximum output of all the generators. It is guaranteed that there exists at least one valid configuration.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3 3<br />0 1 0<br />0 1 1<br />0 1 2<br />0 3<br />1 2<br />-100 100<br />1 2 0<br />2 3 0<br />3 1 0<br /></pre></div><div class="output"><div class="title">Output</div><pre>9<br /></pre></div><div class="input"><div class="title">Input</div><pre>5 8<br />1 -8 20<br />2 -4 0<br />-1 10 -10<br />0 1 0<br />0 -1 1<br />1 9<br />1 4<br />0 10<br />3 11<br />7 9<br />2 1 3<br />1 2 3<br />2 3 3<br />3 2 3<br />3 4 3<br />4 3 3<br />4 5 3<br />5 4 3<br /></pre></div><div class="output"><div class="title">Output</div><pre>46<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample, <span class="tex-span"><i>f</i><sub class="lower-index">1</sub>(<i>x</i>) = <i>x</i></span>, <span class="tex-span"><i>f</i><sub class="lower-index">2</sub>(<i>x</i>) = <i>x</i> + 1</span>, and <span class="tex-span"><i>f</i><sub class="lower-index">3</sub>(<i>x</i>) = <i>x</i> + 2</span>, so we are to maximize the sum of the generating levels. The restrictions are <span class="tex-span"><i>x</i><sub class="lower-index">1</sub> ≤ <i>x</i><sub class="lower-index">2</sub></span>, <span class="tex-span"><i>x</i><sub class="lower-index">2</sub> ≤ <i>x</i><sub class="lower-index">3</sub></span>, and <span class="tex-span"><i>x</i><sub class="lower-index">3</sub> ≤ <i>x</i><sub class="lower-index">1</sub></span>, which gives us <span class="tex-span"><i>x</i><sub class="lower-index">1</sub> = <i>x</i><sub class="lower-index">2</sub> = <i>x</i><sub class="lower-index">3</sub></span>. The optimal configuration is <span class="tex-span"><i>x</i><sub class="lower-index">1</sub> = <i>x</i><sub class="lower-index">2</sub> = <i>x</i><sub class="lower-index">3</sub> = 2</span>, which produces an output of 9.</p><p>In the second sample, restrictions are equal to <span class="tex-span">|<i>x</i><sub class="lower-index"><i>i</i></sub> - <i>x</i><sub class="lower-index"><i>i</i> + 1</sub>| ≤ 3</span> for <span class="tex-span">1 ≤ <i>i</i> &lt; <i>n</i></span>. One of the optimal configurations is <span class="tex-span"><i>x</i><sub class="lower-index">1</sub> = 1</span>, <span class="tex-span"><i>x</i><sub class="lower-index">2</sub> = 4</span>, <span class="tex-span"><i>x</i><sub class="lower-index">3</sub> = 5</span>, <span class="tex-span"><i>x</i><sub class="lower-index">4</sub> = 8</span> and <span class="tex-span"><i>x</i><sub class="lower-index">5</sub> = 7</span>.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=D]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 1em;"
        >


<div class="problemindexholder" problemindex="E" data-uuid="ps_f0aed8d19e6ae417b738cd428bb5f6be5a40b2de">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. Furukawa Nagisa's Tree</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>512 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>One day, Okazaki Tomoya has bought a tree for Furukawa Nagisa's birthday. The tree is so strange that every node of the tree has a value. The value of the <span class="tex-span"><i>i</i></span>-th node is <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span>. Now Furukawa Nagisa and Okazaki Tomoya want to play a game on the tree.</p><p>Let <span class="tex-span">(<i>s</i>, <i>e</i>)</span> be the path from node <span class="tex-span"><i>s</i></span> to node <span class="tex-span"><i>e</i></span>, we can write down the sequence of the values of nodes on path <span class="tex-span">(<i>s</i>, <i>e</i>)</span>, and denote this sequence as <span class="tex-span"><i>S</i>(<i>s</i>, <i>e</i>)</span>. We define the value of the sequence <span class="tex-span"><i>G</i>(<i>S</i>(<i>s</i>, <i>e</i>))</span> as follows. Suppose that the sequence is <span class="tex-span"><i>z</i><sub class="lower-index">0</sub>, <i>z</i><sub class="lower-index">1</sub>...<i>z</i><sub class="lower-index"><i>l</i> - 1</sub></span>, where <span class="tex-span"><i>l</i></span> is the length of the sequence. We define <span class="tex-span"><i>G</i>(<i>S</i>(<i>s</i>, <i>e</i>)) = <i>z</i><sub class="lower-index">0</sub> × <i>k</i><sup class="upper-index">0</sup> + <i>z</i><sub class="lower-index">1</sub> × <i>k</i><sup class="upper-index">1</sup> + ... + <i>z</i><sub class="lower-index"><i>l</i> - 1</sub> × <i>k</i><sup class="upper-index"><i>l</i> - 1</sup></span>. If the path <span class="tex-span">(<i>s</i>, <i>e</i>)</span> satisfies <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/7e205062e8989369119736897f4080a27f10031d.png" style="max-width: 100.0%;max-height: 100.0%;" />, then the path <span class="tex-span">(<i>s</i>, <i>e</i>)</span> belongs to Furukawa Nagisa, otherwise it belongs to Okazaki Tomoya.</p><p>Calculating who has more paths is too easy, so they want to play something more difficult. Furukawa Nagisa thinks that if paths <span class="tex-span">(<i>p</i><sub class="lower-index">1</sub>, <i>p</i><sub class="lower-index">2</sub>)</span> and <span class="tex-span">(<i>p</i><sub class="lower-index">2</sub>, <i>p</i><sub class="lower-index">3</sub>)</span> belong to her, then path <span class="tex-span">(<i>p</i><sub class="lower-index">1</sub>, <i>p</i><sub class="lower-index">3</sub>)</span> belongs to her as well. Also, she thinks that if paths <span class="tex-span">(<i>p</i><sub class="lower-index">1</sub>, <i>p</i><sub class="lower-index">2</sub>)</span> and <span class="tex-span">(<i>p</i><sub class="lower-index">2</sub>, <i>p</i><sub class="lower-index">3</sub>)</span> belong to Okazaki Tomoya, then path <span class="tex-span">(<i>p</i><sub class="lower-index">1</sub>, <i>p</i><sub class="lower-index">3</sub>)</span> belongs to Okazaki Tomoya as well. But in fact, this conclusion isn't always right. So now Furukawa Nagisa wants to know how many triplets <span class="tex-span">(<i>p</i><sub class="lower-index">1</sub>, <i>p</i><sub class="lower-index">2</sub>, <i>p</i><sub class="lower-index">3</sub>)</span> are correct for the conclusion, and this is your task.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains four integers <span class="tex-span"><i>n</i></span>, <span class="tex-span"><i>y</i></span>, <span class="tex-span"><i>k</i></span> and <span class="tex-span"><i>x</i> (1 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup>; 2 ≤ <i>y</i> ≤ 10<sup class="upper-index">9</sup>; 1 ≤ <i>k</i> &lt; <i>y</i>; 0 ≤ <i>x</i> &lt; <i>y</i>)</span> — <span class="tex-span"><i>n</i></span> being the number of nodes on the tree. It is guaranteed that <span class="tex-span"><i>y</i></span> is a prime number.</p><p>The second line contains <span class="tex-span"><i>n</i></span> integers, the <span class="tex-span"><i>i</i></span>-th integer is <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub> (0 ≤ <i>v</i><sub class="lower-index"><i>i</i></sub> &lt; <i>y</i>)</span>.</p><p>Then follow <span class="tex-span"><i>n</i> - 1</span> lines, each line contains two integers, denoting an edge of the tree. The nodes of the tree are numbered from 1 to <span class="tex-span"><i>n</i></span>.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Output a single integer — the number of triplets that are correct for Furukawa Nagisa's conclusion.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>1 2 1 0<br />1<br /></pre></div><div class="output"><div class="title">Output</div><pre>1<br /></pre></div><div class="input"><div class="title">Input</div><pre>3 5 2 1<br />4 3 1<br />1 2<br />2 3<br /></pre></div><div class="output"><div class="title">Output</div><pre>14<br /></pre></div><div class="input"><div class="title">Input</div><pre>8 13 8 12<br />0 12 7 4 12 0 8 12<br />1 8<br />8 4<br />4 6<br />6 2<br />2 3<br />8 5<br />2 7<br /></pre></div><div class="output"><div class="title">Output</div><pre>341<br /></pre></div></div></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=E]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
    </div>

    <div id="footer">
        <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2024 Mike Mirzayanov</div>
        <div>The only programming contests Web 2.0 platform</div>

    </div>

</div>
</div>
    <script type="application/javascript">
        if ('serviceWorker' in navigator && 'fetch' in window && 'caches' in window) {
            navigator.serviceWorker.register('/service-worker-64849.js')
                .then(function (registration) {
                    console.log('Service worker registered: ', registration);
                })
                .catch(function (error) {
                    console.log('Registration failed: ', error);
                });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8a0088b5589c7787',t:'MTcyMDQ0NjUyOS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

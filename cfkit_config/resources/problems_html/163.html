
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-743380-5"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-743380-5');
        </script>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="ff2d555d8a607ceb2bc8a81ec9f0e1f5"/>
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01"/>

    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery-1.8.3.js"></script>
    <script type="application/javascript">
        window.locale = "en";
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }

        /* Protection against trailing dot in domain. */
        let hostLength = window.location.host.length;
        if (hostLength > 1 && window.location.host[hostLength - 1] === '.') {
            window.location = window.location.protocol + "//" + window.location.host.substring(0, hostLength - 1);
        }
    </script>

    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="j2">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="//codeforces.org/s/49284/images/codeforces-sponsored-by-ton.png" />
    <link rel="image_src" href="//codeforces.org/s/49284/images/codeforces-sponsored-by-ton.png" />
    <meta property="og:title" content="Problems - Codeforces"/>
    <meta property="og:description" content=""/>
    
    <meta property="og:site_name" content="Codeforces"/>
    
    
    
    
    
    
    <meta name="utc_offset" content="+03:00"/>
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Problems - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community" />
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup" />
    <meta name="robots" content="index, follow" />

    <link rel="stylesheet" href="//codeforces.org/s/49284/css/font-awesome.min.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/line-awesome.min.css" type="text/css" charset="utf-8" />

        <link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>


    <link rel="apple-touch-icon" sizes="57x57" href="//codeforces.org/s/49284/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="//codeforces.org/s/49284/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="//codeforces.org/s/49284/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="//codeforces.org/s/49284/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="//codeforces.org/s/49284/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="//codeforces.org/s/49284/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="//codeforces.org/s/49284/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="//codeforces.org/s/49284/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="//codeforces.org/s/49284/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="//codeforces.org/s/49284/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="//codeforces.org/s/49284/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="//codeforces.org/s/49284/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="//codeforces.org/s/49284/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="//codeforces.org/s/49284/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/prettify.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/clear.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/ttypography.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/problem-statement.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/second-level-menu.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/roundbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/datatable.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/table-form.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/topic.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/jquery.jgrowl.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/facebox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/jquery.wysiwyg.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/jquery.autocomplete.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/codeforces.datepick.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/colorbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/jquery.drafts.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/49284/css/community.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/49284/css/sidebar-menu.css" type="text/css" charset="utf-8" />

    <!-- MathJax -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    MathJax.Hub.Register.StartupHook("End", function () {
        Codeforces.runMathJaxListeners();
    });
    </script>
    <script type="text/javascript" async
            src="https://mathjax.codeforces.org/MathJax.js?config=TeX-AMS_HTML-full"
    >
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="//codeforces.org/s/49284/js/prettify/prettify.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/pushstream.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.easing.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.swipe.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.hotkeys.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/facebox.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/controls/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/controls/wysiwyg.table.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/controls/wysiwyg.image.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/controls/wysiwyg.link.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.datepick.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.drafts.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/clipboard.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/autosize.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/sjcl.js"></script>
    <script type="text/javascript" src="/scripts/7fbe203c3ac496959a36220db411efde/en/codeforces-options.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/codeforces.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/EventCatcher.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/preparedVerdictFormats-en.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/confetti.min.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="//codeforces.org/s/49284/markitup/skins/markitup/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/markitup/sets/markdown/style.css" type="text/css" charset="utf-8" />


    <script type="text/javascript" src="//codeforces.org/s/49284/markitup/jquery.markitup.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/markitup/sets/markdown/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->




</head>
<body class=" "><span style='display:none;' class='csrf-token' data-csrf='ff2d555d8a607ceb2bc8a81ec9f0e1f5'>&nbsp;</span>

<!-- .notificationTextCleaner used in Codeforces.showAnnouncements() -->
<div class="notificationTextCleaner" style="font-size: 0"></div>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 3.0rem;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    String.prototype.hashCode = function() {
        var hash = 0, i, chr;
        if (this.length === 0) return hash;
        for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };

    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile === "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>





    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 700
        });
    }, 100);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


    function showAnnouncements(json) {
        //info("j=" + JSON.stringify(json));

        if (json.t != "a") {
            return;
        }

        setTimeout(function() {
            Codeforces.showAnnouncements(json.d, "en");
        }, Math.random() * 500);
    }

    function showEventCatcherUserMessage(json) {
        if (json.t == "s") {
            var points = json.d[5];
            var passedTestCount = json.d[7];
            var judgedTestCount = json.d[8];
            var verdict = preparedVerdictFormats[json.d[12]];
            var verdictPrototypeDiv = $(".verdictPrototypeDiv");
            verdictPrototypeDiv.html(verdict);
            if (judgedTestCount != null && judgedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-judged").text(judgedTestCount);
            }
            if (passedTestCount != null && passedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-passed").text(passedTestCount);
            }
            if (points != null && points != undefined) {
                verdictPrototypeDiv.find(".verdict-format-points").text(points);
            }
            Codeforces.showMessage(verdictPrototypeDiv.text());
        }
    }

    $(".clickable-title").each(function() {
        var title = $(this).attr("data-title");
        if (title) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = title;
            $(this).attr("title", tmp.textContent || tmp.innerText || "");
        }
    });

    $(".clickable-title").click(function() {
        var title = $(this).attr("data-title");
        if (title) {
            Codeforces.alert(title);
        } else {
            Codeforces.alert($(this).attr("title"));
        }
    }).css("position", "relative").css("bottom", "3px");

        Codeforces.showDelayedMessage();

    Codeforces.reformatTimes();

    //Codeforces.initializePubSub();
    if (window.codeforcesOptions.subscribeServerUrl) {
        window.eventCatcher = new EventCatcher(
            window.codeforcesOptions.subscribeServerUrl,
            [
                Codeforces.getGlobalChannel(),
                Codeforces.getUserChannel(),
                Codeforces.getUserShowMessageChannel(),
                Codeforces.getContestChannel(),
                Codeforces.getParticipantChannel(),
                Codeforces.getTalkChannel()
            ]
        );

        if (Codeforces.getParticipantChannel()) {
            window.eventCatcher.subscribe(Codeforces.getParticipantChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getContestChannel()) {
            window.eventCatcher.subscribe(Codeforces.getContestChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getGlobalChannel()) {
            window.eventCatcher.subscribe(Codeforces.getGlobalChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserShowMessageChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserShowMessageChannel(), function(json) {
                showEventCatcherUserMessage(json);
            });
        }
    }

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>


<div id="body">
<div style="width: 950px; margin: 0 auto;" class="compact-problemset">
    <div id="header" style="position: relative; margin: 0;">
        <div style="float:left;">
            <div style="padding-top:1em;">
<a href="//codeforces.com/vkcup2012"><img src="//stat.codeforces.com/images/vkcup2012-2.png"/>
</a>
</div>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="//codeforces.org/s/49284/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="//codeforces.org/s/49284/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <br style="clear: both;"/>

    <div style="text-align: center; font-size: 1.8rem; margin-bottom: 0.5em;"
         class="caption">VK Cup 2012 Round 2</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

    <div class="problem-frames">
        <div
                    style="margin-bottom: 2em;"
        >

    <style>
        #facebox .content:has(.diff-popup) {
            width: 90vw;
            max-width: 120rem !important;
        }

        .testCaseMarker {
            position: absolute;
            font-weight: bold;
            font-size: 1rem;
        }

        .diff-popup {
            width: 90vw;
            max-width: 120rem !important;
            display: none;
            overflow: auto;
        }

        .input-output-copier {
            font-size: 1.2rem;
            float: right;
            color: #888 !important;
            cursor: pointer;
            border: 1px solid rgb(185, 185, 185);
            padding: 3px;
            margin: 1px;
            line-height: 1.1rem;
            text-transform: none;
        }

        .input-output-copier:hover {
            background-color: #def;
        }

        .test-explanation textarea {
            width: 100%;
            height: 1.5em;
        }

        .pending-submission-message {
            color: darkorange !important;
        }
    </style>
    <script>
        const OPENING_SPACE = String.fromCharCode(1001);
        const CLOSING_SPACE = String.fromCharCode(1002);

        const nodeToText = function (node, pre) {
            let result = [];

            if (node.tagName === "SCRIPT" || node.tagName === "math"
                || (node.classList && node.classList.contains("input-output-copier")))
                return [];

            if (node.tagName === "NOBR") {
                result.push(OPENING_SPACE);
            }

            if (node.nodeType === Node.TEXT_NODE) {
                let s = node.textContent;
                if (!pre) {
                    s = s.replace(/\s+/g, " ");
                }
                if (s.length > 0) {
                    result.push(s);
                }
            }

            if (pre && node.tagName === "BR") {
                result.push("\n");
            }

            node.childNodes.forEach(function (child) {
                result.push(nodeToText(child, node.tagName === "PRE").join(""));
            });

            if (node.tagName === "DIV"
                || node.tagName === "P"
                || node.tagName === "PRE"
                || node.tagName === "UL"
                || node.tagName === "LI"
            ) {
                result.push("\n");
            }

            if (node.tagName === "NOBR") {
                result.push(CLOSING_SPACE);
            }

            return result;
        }

        const isSpecial = function (c) {
            return c === ',' || c === '.' || c === ';' || c === ')' || c === ' ';
        }

        const convertStatementToText = function(statmentNode) {
            const text = nodeToText(statmentNode, false).join("").replace(/ +/g, " ").replace(/\n\n+/g, "\n\n");
            let result = [];
            for (let i = 0; i < text.length; i++) {
                const c = text.charAt(i);
                if (c === OPENING_SPACE) {
                    if (!((i > 0 && text.charAt(i - 1) === '(') || (result.length > 0 && result[result.length - 1] === ' '))) {
                        result.push('+');
                    }
                } else if (c === CLOSING_SPACE) {
                    if (!(i + 1 < text.length && isSpecial(text.charAt(i + 1)))) {
                        result.push('-');
                    }
                } else {
                    result.push(c);
                }
            }
            return result.join("").split("\n").map(value => value.trim()).join("\n");
        };
    </script>
    <div class="diff-popup">
    </div>

<div class="problemindexholder" problemindex="A" data-uuid="ps_477c619cdfcf9adea2b6391d076f9cf70072de78">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A. Substring and Subsequence</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>One day Polycarpus got hold of two non-empty strings <span class="tex-span"><i>s</i></span> and <span class="tex-span"><i>t</i></span>, consisting of lowercase Latin letters. Polycarpus is quite good with strings, so he immediately wondered, how many different pairs of &quot;<span class="tex-span"><i>x</i></span> <span class="tex-span"><i>y</i></span>&quot; are there, such that <span class="tex-span"><i>x</i></span> is a substring of string <span class="tex-span"><i>s</i></span>, <span class="tex-span"><i>y</i></span> is a subsequence of string <span class="tex-span"><i>t</i></span>, and the content of <span class="tex-span"><i>x</i></span> and <span class="tex-span"><i>y</i></span> is the same. Two pairs are considered different, if they contain different substrings of string <span class="tex-span"><i>s</i></span> or different subsequences of string <span class="tex-span"><i>t</i></span>. Read the whole statement to understand the definition of different substrings and subsequences.</p><p>The <span class="tex-font-style-it">length</span> of string <span class="tex-span"><i>s</i></span> is the number of characters in it. If we denote the length of the string <span class="tex-span"><i>s</i></span> as <span class="tex-span">|<i>s</i>|</span>, we can write the string as <span class="tex-span"><i>s</i> = <i>s</i><sub class="lower-index">1</sub><i>s</i><sub class="lower-index">2</sub>... <i>s</i><sub class="lower-index">|<i>s</i>|</sub></span>.</p><p>A <span class="tex-font-style-it">substring</span> of <span class="tex-span"><i>s</i></span> is a non-empty string <span class="tex-span"><i>x</i> = <i>s</i>[<i>a</i>... <i>b</i>] = <i>s</i><sub class="lower-index"><i>a</i></sub><i>s</i><sub class="lower-index"><i>a</i> + 1</sub>... <i>s</i><sub class="lower-index"><i>b</i></sub></span> (<span class="tex-span">1 ≤ <i>a</i> ≤ <i>b</i> ≤ |<i>s</i>|</span>). For example, &quot;<span class="tex-font-style-tt">code</span>&quot; and &quot;<span class="tex-font-style-tt">force</span>&quot; are substrings or &quot;<span class="tex-font-style-tt">codeforces</span>&quot;, while &quot;<span class="tex-font-style-tt">coders</span>&quot; is not. Two substrings <span class="tex-span"><i>s</i>[<i>a</i>... <i>b</i>]</span> and <span class="tex-span"><i>s</i>[<i>c</i>... <i>d</i>]</span> are considered to be <span class="tex-font-style-it">different</span> if <span class="tex-span"><i>a</i> ≠ <i>c</i></span> or <span class="tex-span"><i>b</i> ≠ <i>d</i></span>. For example, if <span class="tex-span"><i>s</i></span>=&quot;<span class="tex-font-style-tt">codeforces</span>&quot;, <span class="tex-span"><i>s</i>[2...2]</span> and <span class="tex-span"><i>s</i>[6...6]</span> are different, though their content is the same.</p><p>A <span class="tex-font-style-it">subsequence</span> of <span class="tex-span"><i>s</i></span> is a non-empty string <span class="tex-span"><i>y</i> = <i>s</i>[<i>p</i><sub class="lower-index">1</sub><i>p</i><sub class="lower-index">2</sub>... <i>p</i><sub class="lower-index">|<i>y</i>|</sub>] = <i>s</i><sub class="lower-index"><i>p</i><sub class="lower-index">1</sub></sub><i>s</i><sub class="lower-index"><i>p</i><sub class="lower-index">2</sub></sub>... <i>s</i><sub class="lower-index"><i>p</i><sub class="lower-index">|<i>y</i>|</sub></sub></span> (<span class="tex-span">1 ≤ <i>p</i><sub class="lower-index">1</sub> &lt; <i>p</i><sub class="lower-index">2</sub> &lt; ... &lt; <i>p</i><sub class="lower-index">|<i>y</i>|</sub> ≤ |<i>s</i>|</span>). For example, &quot;<span class="tex-font-style-tt">coders</span>&quot; is a subsequence of &quot;<span class="tex-font-style-tt">codeforces</span>&quot;. Two subsequences <span class="tex-span"><i>u</i> = <i>s</i>[<i>p</i><sub class="lower-index">1</sub><i>p</i><sub class="lower-index">2</sub>... <i>p</i><sub class="lower-index">|<i>u</i>|</sub>]</span> and <span class="tex-span"><i>v</i> = <i>s</i>[<i>q</i><sub class="lower-index">1</sub><i>q</i><sub class="lower-index">2</sub>... <i>q</i><sub class="lower-index">|<i>v</i>|</sub>]</span> are considered <span class="tex-font-style-it">different</span> if the sequences <span class="tex-span"><i>p</i></span> and <span class="tex-span"><i>q</i></span> are different.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The input consists of two lines. The first of them contains <span class="tex-span"><i>s</i></span> (<span class="tex-span">1 ≤ |<i>s</i>| ≤ 5000</span>), and the second one contains <span class="tex-span"><i>t</i></span> (<span class="tex-span">1 ≤ |<i>t</i>| ≤ 5000</span>). Both strings consist of lowercase Latin letters.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print a single number — the number of different pairs &quot;<span class="tex-span"><i>x</i></span> <span class="tex-span"><i>y</i></span>&quot; such that <span class="tex-span"><i>x</i></span> is a substring of string <span class="tex-span"><i>s</i></span>, <span class="tex-span"><i>y</i></span> is a subsequence of string <span class="tex-span"><i>t</i></span>, and the content of <span class="tex-span"><i>x</i></span> and <span class="tex-span"><i>y</i></span> is the same. As the answer can be rather large, print it modulo <span class="tex-span">1000000007</span> <span class="tex-span">(10<sup class="upper-index">9</sup> + 7)</span>.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>aa<br />aa<br /></pre></div><div class="output"><div class="title">Output</div><pre>5<br /></pre></div><div class="input"><div class="title">Input</div><pre>codeforces<br />forceofcode<br /></pre></div><div class="output"><div class="title">Output</div><pre>60<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Let's write down all pairs &quot;<span class="tex-span"><i>x</i></span> <span class="tex-span"><i>y</i></span>&quot; that form the answer in the first sample: &quot;<span class="tex-span"><i>s</i>[1...1]</span> <span class="tex-span"><i>t</i>[1]</span>&quot;, &quot;<span class="tex-span"><i>s</i>[2...2]</span> <span class="tex-span"><i>t</i>[1]</span>&quot;, &quot;<span class="tex-span"><i>s</i>[1...1]</span> <span class="tex-span"><i>t</i>[2]</span>&quot;,&quot;<span class="tex-span"><i>s</i>[2...2]</span> <span class="tex-span"><i>t</i>[2]</span>&quot;, &quot;<span class="tex-span"><i>s</i>[1...2]</span> <span class="tex-span"><i>t</i>[1 2]</span>&quot;.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=A]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/49284");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {
        window.changedTests = new Set();

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");



        String.prototype.replaceAll = function (search, replace) {
            return this.split(search).join(replace);
        };

        $(".sample-test .title").each(function () {
            const preId = ("id" + Math.random()).replaceAll(".", "0");
            const cpyId = ("id" + Math.random()).replaceAll(".", "0");

            $(this).parent().find("pre").attr("id", preId);
            const $copy = $("<div title='Copy' data-clipboard-target='#" + preId + "' id='" + cpyId + "' class='input-output-copier'>Copy</div>");
            $(this).append($copy);

            const clipboard = new Clipboard('#' + cpyId, {
                text: function (trigger) {
                    const pre = document.querySelector('#' + preId);
                    const lines = pre.querySelectorAll(".test-example-line");
                    return Codeforces.filterClipboardText(pre.innerText, lines.length);
                }
            });

            const isInput = $(this).parent().hasClass("input");

            clipboard.on('success', function (e) {
                if (isInput) {
                    Codeforces.showMessage("The example input has been copied into the clipboard");
                } else {
                    Codeforces.showMessage("The example output has been copied into the clipboard");
                }
                e.clearSelection();
            });
        });

        $(".test-form-item input").change(function () {
            addPendingSubmissionMessage($($(this).closest("form")), "You changed the answer, do not forget to submit it if you want to save the changes");
            const index = $(this).closest(".problemindexholder").attr("problemindex");
            let test = "";
            $(this).closest("form input").each(function () {
                const test_ = $(this).attr("name");
                if (test_ && test_.substring(0, 4) === "test") {
                    test = test_;
                }
            });
            if (index.length > 0 && test.length > 0) {
                const indexTest = index + "::" + test;
                window.changedTests.add(indexTest);
            }
        });

        $(window).on('beforeunload', function () {
            if (window.changedTests.size > 0) {
                return 'Dialog text here';
            }
        });

        autosize($('.test-explanation textarea'));

        $(".test-example-line").hover(function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        let top = 1E20;
                        let left = 1E20;
                        let problem = $(this).closest(".problemindexholder");
                        $(this).closest(".input").find("." + clazz).css("background-color", "#FFFDE7").each(function() {
                            top = Math.min(top, $(this).offset().top);
                            left = Math.min(left, $(this).offset().left);
                        });
                        let testCaseMarker = problem.find(".testCaseMarker_" + end);
                        if (testCaseMarker.length === 0) {
                            const html = "<div class=\"testCaseMarker testCaseMarker_" + end + " notice\"></div>";
                            problem.append($(html));
                            testCaseMarker = problem.find(".testCaseMarker_" + end);
                        }
                        if (testCaseMarker) {
                            testCaseMarker.show()
                                    .offset({top, left: left - 20})
                                    .text(end);
                        }
                    }
                }
            });
        }, function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        $("." + clazz).css("background-color", "");
                        $(this).closest(".problemindexholder").find(".testCaseMarker_" + end).hide();
                    }
                }
            });
        });

    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="B" data-uuid="ps_ae0eead43725e3376dbe95fd131dfa3ef55dedb7">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B. Lemmings</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>As you know, lemmings like jumping. For the next spectacular group jump <span class="tex-span"><i>n</i></span> lemmings gathered near a high rock with <span class="tex-span"><i>k</i></span> comfortable ledges on it. The first ledge is situated at the height of <span class="tex-span"><i>h</i></span> meters, the second one is at the height of <span class="tex-span">2<i>h</i></span> meters, and so on (the <span class="tex-span"><i>i</i></span>-th ledge is at the height of <span class="tex-span"><i>i</i>·<i>h</i></span> meters). The lemmings are going to jump at sunset, and there's not much time left.</p><p>Each lemming is characterized by its climbing speed of <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span> meters per minute and its weight <span class="tex-span"><i>m</i><sub class="lower-index"><i>i</i></sub></span>. This means that the <span class="tex-span"><i>i</i></span>-th lemming can climb to the <span class="tex-span"><i>j</i></span>-th ledge in <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/7b77043fa78e710a6e67692ae13a7ab726fac683.png" style="max-width: 100.0%;max-height: 100.0%;" /> minutes.</p><p>To make the jump beautiful, heavier lemmings should jump from higher ledges: if a lemming of weight <span class="tex-span"><i>m</i><sub class="lower-index"><i>i</i></sub></span> jumps from ledge <span class="tex-span"><i>i</i></span>, and a lemming of weight <span class="tex-span"><i>m</i><sub class="lower-index"><i>j</i></sub></span> jumps from ledge <span class="tex-span"><i>j</i></span> (for <span class="tex-span"><i>i</i> &lt; <i>j</i></span>), then the inequation <span class="tex-span"><i>m</i><sub class="lower-index"><i>i</i></sub> ≤ <i>m</i><sub class="lower-index"><i>j</i></sub></span> should be fulfilled.</p><p>Since there are <span class="tex-span"><i>n</i></span> lemmings and only <span class="tex-span"><i>k</i></span> ledges (<span class="tex-span"><i>k</i> ≤ <i>n</i></span>), the <span class="tex-span"><i>k</i></span> lemmings that will take part in the jump need to be chosen. The chosen lemmings should be distributed on the ledges from <span class="tex-span">1</span> to <span class="tex-span"><i>k</i></span>, one lemming per ledge. The lemmings are to be arranged in the order of non-decreasing weight with the increasing height of the ledge. In addition, each lemming should have enough time to get to his ledge, that is, the time of his climb should not exceed <span class="tex-span"><i>t</i></span> minutes. The lemmings climb to their ledges all at the same time and they do not interfere with each other.</p><p>Find the way to arrange the lemmings' jump so that time <span class="tex-span"><i>t</i></span> is minimized.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains space-separated integers <span class="tex-span"><i>n</i></span>, <span class="tex-span"><i>k</i></span> and <span class="tex-span"><i>h</i></span> (<span class="tex-span">1 ≤ <i>k</i> ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup></span>, <span class="tex-span">1 ≤ <i>h</i> ≤ 10<sup class="upper-index">4</sup></span>) — the total number of lemmings, the number of ledges and the distance between adjacent ledges.</p><p>The second line contains <span class="tex-span"><i>n</i></span> space-separated integers <span class="tex-span"><i>m</i><sub class="lower-index">1</sub>, <i>m</i><sub class="lower-index">2</sub>, ..., <i>m</i><sub class="lower-index"><i>n</i></sub></span> (<span class="tex-span">1 ≤ <i>m</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>), where <span class="tex-span"><i>m</i><sub class="lower-index"><i>i</i></sub></span> is the weight of <span class="tex-span"><i>i</i></span>-th lemming.</p><p>The third line contains <span class="tex-span"><i>n</i></span> space-separated integers <span class="tex-span"><i>v</i><sub class="lower-index">1</sub>, <i>v</i><sub class="lower-index">2</sub>, ..., <i>v</i><sub class="lower-index"><i>n</i></sub></span> (<span class="tex-span">1 ≤ <i>v</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>), where <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span> is the speed of <span class="tex-span"><i>i</i></span>-th lemming.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print <span class="tex-span"><i>k</i></span> different numbers from <span class="tex-span">1</span> to <span class="tex-span"><i>n</i></span> — the numbers of the lemmings who go to ledges at heights <span class="tex-span"><i>h</i>, 2<i>h</i>, ..., <i>kh</i></span>, correspondingly, if the jump is organized in an optimal way. If there are multiple ways to select the lemmings, pick any of them.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>5 3 2<br />1 2 3 2 1<br />1 2 1 2 10<br /></pre></div><div class="output"><div class="title">Output</div><pre>5 2 4<br /></pre></div><div class="input"><div class="title">Input</div><pre>5 3 10<br />3 4 3 2 1<br />5 4 3 2 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>4 3 1<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Let's consider the first sample case. The fifth lemming (speed 10) gets to the ledge at height 2 in <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/215e7035e1b836a262740867b9bbd824fd3c66fe.png" style="max-width: 100.0%;max-height: 100.0%;" /> minutes; the second lemming (speed 2) gets to the ledge at height 4 in 2 minutes; the fourth lemming (speed 2) gets to the ledge at height 6 in 3 minutes. All lemmings manage to occupy their positions in 3 minutes. </p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=B]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/49284");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="C" data-uuid="ps_97a771017dcc78194d4ce00c94d766807da6e0f5">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C. Conveyor</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Anton came to a chocolate factory. There he found a working conveyor and decided to run on it from the beginning to the end.</p><p>The conveyor is a looped belt with a total length of <span class="tex-span">2<i>l</i></span> meters, of which <span class="tex-span"><i>l</i></span> meters are located on the surface and are arranged in a straight line. The part of the belt which turns at any moment (the part which emerges from under the floor to the surface and returns from the surface under the floor) is assumed to be negligibly short.</p><p>The belt is moving uniformly at speed <span class="tex-span"><i>v</i><sub class="lower-index">1</sub></span> meters per second. Anton will be moving on it in the same direction at the constant speed of <span class="tex-span"><i>v</i><sub class="lower-index">2</sub></span> meters per second, so his speed relatively to the floor will be <span class="tex-span"><i>v</i><sub class="lower-index">1</sub> + <i>v</i><sub class="lower-index">2</sub></span> meters per second. Anton will neither stop nor change the speed or the direction of movement.</p><p>Here and there there are chocolates stuck to the belt (<span class="tex-span"><i>n</i></span> chocolates). They move together with the belt, and do not come off it. Anton is keen on the chocolates, but he is more keen to move forward. So he will pick up all the chocolates he will pass by, but nothing more. If a chocolate is at the beginning of the belt at the moment when Anton starts running, he will take it, and if a chocolate is at the end of the belt at the moment when Anton comes off the belt, he will leave it.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/25c963e2118eca1c6cb553acfb18babf5bed3882.png" style="max-width: 100.0%;max-height: 100.0%;" />   <span class="tex-font-size-script"> The figure shows an example with two chocolates. One is located   in the position <span class="tex-span"><i>a</i><sub class="lower-index">1</sub> = <i>l</i> - <i>d</i></span>, and is now on the top half of the belt, the second one   is in the position <span class="tex-span"><i>a</i><sub class="lower-index">2</sub> = 2<i>l</i> - <i>d</i></span>, and is now on the bottom half of the belt. </span> </center><p>You are given the positions of the chocolates relative to the initial start position of the belt <span class="tex-span">0 ≤ <i>a</i><sub class="lower-index">1</sub> &lt; <i>a</i><sub class="lower-index">2</sub> &lt; ... &lt; <i>a</i><sub class="lower-index"><i>n</i></sub> &lt; 2<i>l</i></span>. The positions on the belt from <span class="tex-span">0</span> to <span class="tex-span"><i>l</i></span> correspond to the top, and from <span class="tex-span"><i>l</i></span> to <span class="tex-span">2<i>l</i></span> — to the the bottom half of the belt (see example). All coordinates are given in meters.</p><p>Anton begins to run along the belt at a random moment of time. This means that all possible positions of the belt at the moment he starts running are equiprobable. For each <span class="tex-span"><i>i</i></span> from <span class="tex-span">0</span> to <span class="tex-span"><i>n</i></span> calculate the probability that Anton will pick up exactly <span class="tex-span"><i>i</i></span> chocolates.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains space-separated integers <span class="tex-span"><i>n</i></span>, <span class="tex-span"><i>l</i></span>, <span class="tex-span"><i>v</i><sub class="lower-index">1</sub></span> and <span class="tex-span"><i>v</i><sub class="lower-index">2</sub></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup></span>, <span class="tex-span">1 ≤ <i>l</i>, <i>v</i><sub class="lower-index">1</sub>, <i>v</i><sub class="lower-index">2</sub> ≤ 10<sup class="upper-index">9</sup></span>) — the number of the chocolates, the length of the conveyor's visible part, the conveyor's speed and Anton's speed.</p><p>The second line contains a sequence of space-separated integers <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>n</i></sub></span> (<span class="tex-span">0 ≤ <i>a</i><sub class="lower-index">1</sub> &lt; <i>a</i><sub class="lower-index">2</sub> &lt; ... &lt; <i>a</i><sub class="lower-index"><i>n</i></sub> &lt; 2<i>l</i></span>) — the coordinates of the chocolates.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print <span class="tex-span"><i>n</i> + 1</span> numbers (one per line): the probabilities that Anton picks up exactly <span class="tex-span"><i>i</i></span> chocolates, for each <span class="tex-span"><i>i</i></span> from <span class="tex-span">0</span> (the first line) to <span class="tex-span"><i>n</i></span> (the last line). The answer will be considered correct if each number will have absolute or relative error of at most than <span class="tex-span">10<sup class="upper-index"> - 9</sup></span>.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>1 1 1 1<br />0<br /></pre></div><div class="output"><div class="title">Output</div><pre>0.75000000000000000000<br />0.25000000000000000000<br /></pre></div><div class="input"><div class="title">Input</div><pre>2 3 1 2<br />2 5<br /></pre></div><div class="output"><div class="title">Output</div><pre>0.33333333333333331000<br />0.66666666666666663000<br />0.00000000000000000000<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample test Anton can pick up a chocolate if by the moment he starts running its coordinate is less than 0.5; but if by the moment the boy starts running the chocolate's coordinate is greater than or equal to 0.5, then Anton won't be able to pick it up. As all positions of the belt are equiprobable, the probability of picking up the chocolate equals <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/55d1d7955c1e59f407eb6baa7601582a54eeac4f.png" style="max-width: 100.0%;max-height: 100.0%;" />, and the probability of not picking it up equals <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/0e79ad74cc0314b318cc094369c845c55b37c9ef.png" style="max-width: 100.0%;max-height: 100.0%;" />.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=C]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/49284");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="D" data-uuid="ps_5f6f1412226d0a4549ec7756721f106236ece1ed">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. Large Refrigerator</div><div class="time-limit"><div class="property-title">time limit per test</div>5 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Vasya wants to buy a new refrigerator. He believes that a refrigerator should be a rectangular parallelepiped with integer edge lengths. Vasya calculated that for daily use he will need a refrigerator with volume of at least <span class="tex-span"><i>V</i></span>. Moreover, Vasya is a minimalist by nature, so the volume should be no more than <span class="tex-span"><i>V</i></span>, either — why take up extra space in the apartment? Having made up his mind about the volume of the refrigerator, Vasya faced a new challenge — for a fixed volume of <span class="tex-span"><i>V</i></span> the refrigerator must have the minimum surface area so that it is easier to clean.</p><p>The volume and the surface area of a refrigerator with edges <span class="tex-span"><i>a</i></span>, <span class="tex-span"><i>b</i></span>, <span class="tex-span"><i>c</i></span> are equal to <span class="tex-span"><i>V</i> = <i>abc</i></span> and <span class="tex-span"><i>S</i> = 2(<i>ab</i> + <i>bc</i> + <i>ca</i>)</span>, correspondingly.</p><p>Given the volume <span class="tex-span"><i>V</i></span>, help Vasya find the integer lengths for the refrigerator's edges <span class="tex-span"><i>a</i></span>, <span class="tex-span"><i>b</i></span>, <span class="tex-span"><i>c</i></span> so that the refrigerator's volume equals <span class="tex-span"><i>V</i></span> and its surface area <span class="tex-span"><i>S</i></span> is minimized.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains a single integer <span class="tex-span"><i>t</i></span> (<span class="tex-span">1 ≤ <i>t</i> ≤ 500</span>) — the number of data sets.</p><p>The description of <span class="tex-span"><i>t</i></span> data sets follows. Each set consists of a single integer <span class="tex-span"><i>V</i></span> (<span class="tex-span">2 ≤ <i>V</i> ≤ 10<sup class="upper-index">18</sup></span>), given by its factorization as follows.</p><p>Let <span class="tex-span"><i>V</i></span> = <span class="tex-span"><i>p</i><sub class="lower-index">1</sub><sup class="upper-index"><i>a</i><sub class="lower-index">1</sub></sup><i>p</i><sub class="lower-index">2</sub><sup class="upper-index"><i>a</i><sub class="lower-index">2</sub></sup>... <i>p</i><sub class="lower-index"><i>k</i></sub><sup class="upper-index"><i>a</i><sub class="lower-index"><i>k</i></sub></sup></span>, where <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub></span> are different prime numbers and <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> are positive integer powers. </p><p>Then the first line describing a data set contains a single positive integer <span class="tex-span"><i>k</i></span> — the number of different prime divisors of <span class="tex-span"><i>V</i></span>. Next <span class="tex-span"><i>k</i></span> lines contain prime numbers <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub></span> and their powers <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>, separated by spaces. All <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub></span> are different, all <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub> &gt; 0</span>.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print <span class="tex-span"><i>t</i></span> lines, on the <span class="tex-span"><i>i</i></span>-th line print the answer to the <span class="tex-span"><i>i</i></span>-th data set as four space-separated integers: the minimum possible surface area <span class="tex-span"><i>S</i></span> and the corresponding edge lengths <span class="tex-span"><i>a</i></span>, <span class="tex-span"><i>b</i></span>, <span class="tex-span"><i>c</i></span>. If there are multiple variants of the lengths of edges that give the minimum area, you are allowed to print any of them. You can print the lengths of the fridge's edges in any order.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3<br />1<br />2 3<br />1<br />17 1<br />3<br />3 1<br />2 3<br />5 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>24 2 2 2<br />70 1 1 17<br />148 4 6 5<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first data set of the sample the fridge's volume <span class="tex-span"><i>V</i> = 2<sup class="upper-index">3</sup> = 8</span>, and the minimum surface area will be produced by the edges of equal length.</p><p>In the second data set the volume <span class="tex-span"><i>V</i> = 17</span>, and it can be produced by only one set of integer lengths.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=D]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/49284");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 1em;"
        >


<div class="problemindexholder" problemindex="E" data-uuid="ps_89ed105c3f03d245bcd4cfb3688d89618ce67efe">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. e-Government</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>The best programmers of Embezzland compete to develop a part of the project called &quot;e-Government&quot; — the system of automated statistic collecting and press analysis.</p><p>We know that any of the <span class="tex-span"><i>k</i></span> citizens can become a member of the Embezzland government. The citizens' surnames are <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>k</i></sub></span>. All surnames are different. Initially all <span class="tex-span"><i>k</i></span> citizens from this list are members of the government. The system should support the following options:</p><ul> <li> Include citizen <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> to the government. </li><li> Exclude citizen <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> from the government. </li><li> Given a newspaper article text, calculate how politicized it is. To do this, for every active government member the system counts the number of times his surname occurs in the text as a substring. All occurrences are taken into consideration, including the intersecting ones. The degree of politicization of a text is defined as the sum of these values for all active government members. </li></ul><p>Implement this system.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains space-separated integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>k</i></span> (<span class="tex-span">1 ≤ <i>n</i>, <i>k</i> ≤ 10<sup class="upper-index">5</sup></span>) — the number of queries to the system and the number of potential government members.</p><p>Next <span class="tex-span"><i>k</i></span> lines contain the surnames <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>k</i></sub></span>, one per line. All surnames are pairwise different.</p><p>Next <span class="tex-span"><i>n</i></span> lines contain queries to the system, one per line. Each query consists of a character that determines an operation and the operation argument, written consecutively without a space.</p><p>Operation &quot;include in the government&quot; corresponds to the character &quot;<span class="tex-font-style-tt">+</span>&quot;, operation &quot;exclude&quot; corresponds to &quot;<span class="tex-font-style-tt">-</span>&quot;. An argument of those operations is an integer between <span class="tex-span">1</span> and <span class="tex-span"><i>k</i></span> — the index of the citizen involved in the operation. Any citizen can be included and excluded from the government an arbitrary number of times in any order. Including in the government a citizen who is already there or excluding the citizen who isn't there changes nothing.</p><p>The operation &quot;calculate politicization&quot; corresponds to character &quot;<span class="tex-font-style-tt">?</span>&quot;. Its argument is a text.</p><p>All strings — surnames and texts — are non-empty sequences of lowercase Latin letters. The total length of all surnames doesn't exceed <span class="tex-span">10<sup class="upper-index">6</sup></span>, the total length of all texts doesn't exceed <span class="tex-span">10<sup class="upper-index">6</sup></span>.</p></div><div class="output-specification"><div class="section-title">Output</div><p>For any &quot;calculate politicization&quot; operation print on a separate line the degree of the politicization of the given text. Print nothing for other operations.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>7 3<br />a<br />aa<br />ab<br />?aaab<br />-2<br />?aaab<br />-3<br />?aaab<br />+2<br />?aabbaa<br /></pre></div><div class="output"><div class="title">Output</div><pre>6<br />4<br />3<br />6<br /></pre></div></div></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=E]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/49284");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
    </div>

    <div id="footer">
        <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2024 Mike Mirzayanov</div>
        <div>The only programming contests Web 2.0 platform</div>

    </div>

</div>
</div>
    <script type="application/javascript">
        if ('serviceWorker' in navigator && 'fetch' in window && 'caches' in window) {
            navigator.serviceWorker.register('/service-worker-49284.js')
                .then(function (registration) {
                    console.log('Service worker registered: ', registration);
                })
                .catch(function (error) {
                    console.log('Registration failed: ', error);
                });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'89f7672acc0e7781',t:'MTcyMDM1MDc4My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

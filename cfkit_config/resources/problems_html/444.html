
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-743380-5"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-743380-5');
        </script>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="0768081e73842b3aa77b3ef271fd961f"/>
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01"/>

    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery-1.8.3.js"></script>
    <script type="application/javascript">
        window.locale = "en";
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }

        /* Protection against trailing dot in domain. */
        let hostLength = window.location.host.length;
        if (hostLength > 1 && window.location.host[hostLength - 1] === '.') {
            window.location = window.location.protocol + "//" + window.location.host.substring(0, hostLength - 1);
        }
    </script>

    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="k1">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="//codeforces.org/s/64849/images/codeforces-sponsored-by-ton.png" />
    <link rel="image_src" href="//codeforces.org/s/64849/images/codeforces-sponsored-by-ton.png" />
    <meta property="og:title" content="Problems - Codeforces"/>
    <meta property="og:description" content=""/>
    
    <meta property="og:site_name" content="Codeforces"/>
    
    
    
    
    
    
    <meta name="utc_offset" content="+03:00"/>
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Problems - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community" />
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup" />
    <meta name="robots" content="index, follow" />

    <link rel="stylesheet" href="//codeforces.org/s/64849/css/font-awesome.min.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/line-awesome.min.css" type="text/css" charset="utf-8" />

        <link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>


    <link rel="apple-touch-icon" sizes="57x57" href="//codeforces.org/s/64849/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="//codeforces.org/s/64849/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="//codeforces.org/s/64849/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="//codeforces.org/s/64849/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="//codeforces.org/s/64849/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="//codeforces.org/s/64849/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="//codeforces.org/s/64849/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="//codeforces.org/s/64849/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="//codeforces.org/s/64849/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="//codeforces.org/s/64849/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="//codeforces.org/s/64849/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="//codeforces.org/s/64849/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="//codeforces.org/s/64849/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="//codeforces.org/s/64849/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/prettify.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/clear.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/ttypography.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/problem-statement.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/second-level-menu.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/roundbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/datatable.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/table-form.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/topic.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/jquery.jgrowl.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/facebox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/jquery.wysiwyg.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/jquery.autocomplete.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/codeforces.datepick.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/colorbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/jquery.drafts.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/64849/css/community.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/64849/css/sidebar-menu.css" type="text/css" charset="utf-8" />

    <!-- MathJax -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    MathJax.Hub.Register.StartupHook("End", function () {
        Codeforces.runMathJaxListeners();
    });
    </script>
    <script type="text/javascript" async
            src="https://mathjax.codeforces.org/MathJax.js?config=TeX-AMS_HTML-full"
    >
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="//codeforces.org/s/64849/js/prettify/prettify.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/pushstream.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.easing.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.swipe.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.hotkeys.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/facebox.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/controls/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/controls/wysiwyg.table.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/controls/wysiwyg.image.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/controls/wysiwyg.link.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.datepick.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.drafts.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/clipboard.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/autosize.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/sjcl.js"></script>
    <script type="text/javascript" src="/scripts/f8f695306b4bab3cbdd456143062ab76/en/codeforces-options.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/codeforces.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/EventCatcher.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/preparedVerdictFormats-en.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/confetti.min.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="//codeforces.org/s/64849/markitup/skins/markitup/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/markitup/sets/markdown/style.css" type="text/css" charset="utf-8" />


    <script type="text/javascript" src="//codeforces.org/s/64849/markitup/jquery.markitup.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/markitup/sets/markdown/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->




</head>
<body class=" "><span style='display:none;' class='csrf-token' data-csrf='0768081e73842b3aa77b3ef271fd961f'>&nbsp;</span>

<!-- .notificationTextCleaner used in Codeforces.showAnnouncements() -->
<div class="notificationTextCleaner" style="font-size: 0"></div>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 3.0rem;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    String.prototype.hashCode = function() {
        var hash = 0, i, chr;
        if (this.length === 0) return hash;
        for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };

    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile === "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>





    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 700
        });
    }, 100);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


    function showAnnouncements(json) {
        //info("j=" + JSON.stringify(json));

        if (json.t != "a") {
            return;
        }

        setTimeout(function() {
            Codeforces.showAnnouncements(json.d, "en");
        }, Math.random() * 500);
    }

    function showEventCatcherUserMessage(json) {
        if (json.t == "s") {
            var points = json.d[5];
            var passedTestCount = json.d[7];
            var judgedTestCount = json.d[8];
            var verdict = preparedVerdictFormats[json.d[12]];
            var verdictPrototypeDiv = $(".verdictPrototypeDiv");
            verdictPrototypeDiv.html(verdict);
            if (judgedTestCount != null && judgedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-judged").text(judgedTestCount);
            }
            if (passedTestCount != null && passedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-passed").text(passedTestCount);
            }
            if (points != null && points != undefined) {
                verdictPrototypeDiv.find(".verdict-format-points").text(points);
            }
            Codeforces.showMessage(verdictPrototypeDiv.text());
        }
    }

    $(".clickable-title").each(function() {
        var title = $(this).attr("data-title");
        if (title) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = title;
            $(this).attr("title", tmp.textContent || tmp.innerText || "");
        }
    });

    $(".clickable-title").click(function() {
        var title = $(this).attr("data-title");
        if (title) {
            Codeforces.alert(title);
        } else {
            Codeforces.alert($(this).attr("title"));
        }
    }).css("position", "relative").css("bottom", "3px");

        Codeforces.showDelayedMessage();

    Codeforces.reformatTimes();

    //Codeforces.initializePubSub();
    if (window.codeforcesOptions.subscribeServerUrl) {
        window.eventCatcher = new EventCatcher(
            window.codeforcesOptions.subscribeServerUrl,
            [
                Codeforces.getGlobalChannel(),
                Codeforces.getUserChannel(),
                Codeforces.getUserShowMessageChannel(),
                Codeforces.getContestChannel(),
                Codeforces.getParticipantChannel(),
                Codeforces.getTalkChannel()
            ]
        );

        if (Codeforces.getParticipantChannel()) {
            window.eventCatcher.subscribe(Codeforces.getParticipantChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getContestChannel()) {
            window.eventCatcher.subscribe(Codeforces.getContestChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getGlobalChannel()) {
            window.eventCatcher.subscribe(Codeforces.getGlobalChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserShowMessageChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserShowMessageChannel(), function(json) {
                showEventCatcherUserMessage(json);
            });
        }
    }

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>


<div id="body">
<div style="width: 950px; margin: 0 auto;" class="compact-problemset">
    <div id="header" style="position: relative; margin: 0;">
        <div style="float:left;">
                  <a href="/"><img height="65" style="height: 65px;" src="//codeforces.org/s/64849/images/codeforces-sponsored-by-ton.png" alt="Codeforces"/></a>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="//codeforces.org/s/64849/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="//codeforces.org/s/64849/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <br style="clear: both;"/>

    <div style="text-align: center; font-size: 1.8rem; margin-bottom: 0.5em;"
         class="caption">Codeforces Round 254 (Div. 1)</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

    <div class="problem-frames">
        <div
                    style="margin-bottom: 2em;"
        >

    <style>
        #facebox .content:has(.diff-popup) {
            width: 90vw;
            max-width: 120rem !important;
        }

        .testCaseMarker {
            position: absolute;
            font-weight: bold;
            font-size: 1rem;
        }

        .diff-popup {
            width: 90vw;
            max-width: 120rem !important;
            display: none;
            overflow: auto;
        }

        .input-output-copier {
            font-size: 1.2rem;
            float: right;
            color: #888 !important;
            cursor: pointer;
            border: 1px solid rgb(185, 185, 185);
            padding: 3px;
            margin: 1px;
            line-height: 1.1rem;
            text-transform: none;
        }

        .input-output-copier:hover {
            background-color: #def;
        }

        .test-explanation textarea {
            width: 100%;
            height: 1.5em;
        }

        .pending-submission-message {
            color: darkorange !important;
        }
    </style>
    <script>
        const OPENING_SPACE = String.fromCharCode(1001);
        const CLOSING_SPACE = String.fromCharCode(1002);

        const nodeToText = function (node, pre) {
            let result = [];

            if (node.tagName === "SCRIPT" || node.tagName === "math"
                || (node.classList && node.classList.contains("input-output-copier")))
                return [];

            if (node.tagName === "NOBR") {
                result.push(OPENING_SPACE);
            }

            if (node.nodeType === Node.TEXT_NODE) {
                let s = node.textContent;
                if (!pre) {
                    s = s.replace(/\s+/g, " ");
                }
                if (s.length > 0) {
                    result.push(s);
                }
            }

            if (pre && node.tagName === "BR") {
                result.push("\n");
            }

            node.childNodes.forEach(function (child) {
                result.push(nodeToText(child, node.tagName === "PRE").join(""));
            });

            if (node.tagName === "DIV"
                || node.tagName === "P"
                || node.tagName === "PRE"
                || node.tagName === "UL"
                || node.tagName === "LI"
            ) {
                result.push("\n");
            }

            if (node.tagName === "NOBR") {
                result.push(CLOSING_SPACE);
            }

            return result;
        }

        const isSpecial = function (c) {
            return c === ',' || c === '.' || c === ';' || c === ')' || c === ' ';
        }

        const convertStatementToText = function(statmentNode) {
            const text = nodeToText(statmentNode, false).join("").replace(/ +/g, " ").replace(/\n\n+/g, "\n\n");
            let result = [];
            for (let i = 0; i < text.length; i++) {
                const c = text.charAt(i);
                if (c === OPENING_SPACE) {
                    if (!((i > 0 && text.charAt(i - 1) === '(') || (result.length > 0 && result[result.length - 1] === ' '))) {
                        result.push('+');
                    }
                } else if (c === CLOSING_SPACE) {
                    if (!(i + 1 < text.length && isSpecial(text.charAt(i + 1)))) {
                        result.push('-');
                    }
                } else {
                    result.push(c);
                }
            }
            return result.join("").split("\n").map(value => value.trim()).join("\n");
        };
    </script>
    <div class="diff-popup">
    </div>

<div class="problemindexholder" problemindex="A" data-uuid="ps_a2e3ab523fc46501a5b837d4cff50114477a5f2a">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A. DZY Loves Physics</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p><span class="tex-font-style-it">DZY loves Physics, and he enjoys calculating density.</span></p><p>Almost everything has density, even a graph. We define the density of a non-directed graph (nodes and edges of the graph have some values) as follows: </p><center class="tex-equation"><img align="middle" class="tex-formula" src="https://espresso.codeforces.com/ddc049109c41af6c53df4e3447546ae396059ce4.png" style="max-width: 100.0%;max-height: 100.0%;" /></center> where <span class="tex-span"><i>v</i></span> is the sum of the values of the nodes, <span class="tex-span"><i>e</i></span> is the sum of the values of the edges.<p>Once DZY got a graph <span class="tex-span"><i>G</i></span>, now he wants to find a connected induced subgraph <span class="tex-span"><i>G</i>'</span> of the graph, such that the density of <span class="tex-span"><i>G</i>'</span> is as large as possible.</p><p>An induced subgraph <span class="tex-span"><i>G</i>'(<i>V</i>', <i>E</i>')</span> of a graph <span class="tex-span"><i>G</i>(<i>V</i>, <i>E</i>)</span> is a graph that satisfies:</p><ul> <li> <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/46e20b4dfc895713f2da511b00037f3b583b7786.png" style="max-width: 100.0%;max-height: 100.0%;" />; </li><li> edge <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/3323e65c2bb0e7b15e71bc8acf5bbdd103bbd406.png" style="max-width: 100.0%;max-height: 100.0%;" /> if and only if <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/ff784919ccab7c1de161efd8c454dd842ca9a194.png" style="max-width: 100.0%;max-height: 100.0%;" />, and edge <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/5bd600027111301384bc3bf759bd32d812f393dd.png" style="max-width: 100.0%;max-height: 100.0%;" />; </li><li> the value of an edge in <span class="tex-span"><i>G</i>'</span> is the same as the value of the corresponding edge in <span class="tex-span"><i>G</i></span>, so as the value of a node. </li></ul><p>Help DZY to find the induced subgraph with maximum density. Note that the induced subgraph you choose must be connected.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/7984f09d2d85f523cdd77ca2f971f95d612ec2e9.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains two space-separated integers <span class="tex-span"><i>n</i> (1 ≤ <i>n</i> ≤ 500)</span>, <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/bed2d5acbcccaf59b2f85a26a90ab00d2b92e1c4.png" style="max-width: 100.0%;max-height: 100.0%;" />. Integer <span class="tex-span"><i>n</i></span> represents the number of nodes of the graph <span class="tex-span"><i>G</i></span>, <span class="tex-span"><i>m</i></span> represents the number of edges.</p><p>The second line contains <span class="tex-span"><i>n</i></span> space-separated integers <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub> (1 ≤ <i>x</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">6</sup>)</span>, where <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> represents the value of the <span class="tex-span"><i>i</i></span>-th node. Consider the graph nodes are numbered from <span class="tex-span">1</span> to <span class="tex-span"><i>n</i></span>.</p><p>Each of the next <span class="tex-span"><i>m</i></span> lines contains three space-separated integers <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub>, <i>c</i><sub class="lower-index"><i>i</i></sub> (1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> &lt; <i>b</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i>; 1 ≤ <i>c</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">3</sup>)</span>, denoting an edge between node <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> with value <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span>. The graph won't contain multiple edges.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Output a real number denoting the answer, with an absolute or relative error of at most <span class="tex-span">10<sup class="upper-index"> - 9</sup></span>.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>1 0<br />1<br /></pre></div><div class="output"><div class="title">Output</div><pre>0.000000000000000<br /></pre></div><div class="input"><div class="title">Input</div><pre>2 1<br />1 2<br />1 2 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>3.000000000000000<br /></pre></div><div class="input"><div class="title">Input</div><pre>5 6<br />13 56 73 98 17<br />1 2 56<br />1 3 29<br />1 4 42<br />2 3 95<br />2 4 88<br />3 4 63<br /></pre></div><div class="output"><div class="title">Output</div><pre>2.965517241379311<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample, you can only choose an empty subgraph, or the subgraph containing only node <span class="tex-span">1</span>.</p><p>In the second sample, choosing the whole graph is optimal.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=A]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {
        window.changedTests = new Set();

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");



        String.prototype.replaceAll = function (search, replace) {
            return this.split(search).join(replace);
        };

        $(".sample-test .title").each(function () {
            const preId = ("id" + Math.random()).replaceAll(".", "0");
            const cpyId = ("id" + Math.random()).replaceAll(".", "0");

            $(this).parent().find("pre").attr("id", preId);
            const $copy = $("<div title='Copy' data-clipboard-target='#" + preId + "' id='" + cpyId + "' class='input-output-copier'>Copy</div>");
            $(this).append($copy);

            const clipboard = new Clipboard('#' + cpyId, {
                text: function (trigger) {
                    const pre = document.querySelector('#' + preId);
                    const lines = pre.querySelectorAll(".test-example-line");
                    return Codeforces.filterClipboardText(pre.innerText, lines.length);
                }
            });

            const isInput = $(this).parent().hasClass("input");

            clipboard.on('success', function (e) {
                if (isInput) {
                    Codeforces.showMessage("The example input has been copied into the clipboard");
                } else {
                    Codeforces.showMessage("The example output has been copied into the clipboard");
                }
                e.clearSelection();
            });
        });

        $(".test-form-item input").change(function () {
            addPendingSubmissionMessage($($(this).closest("form")), "You changed the answer, do not forget to submit it if you want to save the changes");
            const index = $(this).closest(".problemindexholder").attr("problemindex");
            let test = "";
            $(this).closest("form input").each(function () {
                const test_ = $(this).attr("name");
                if (test_ && test_.substring(0, 4) === "test") {
                    test = test_;
                }
            });
            if (index.length > 0 && test.length > 0) {
                const indexTest = index + "::" + test;
                window.changedTests.add(indexTest);
            }
        });

        $(window).on('beforeunload', function () {
            if (window.changedTests.size > 0) {
                return 'Dialog text here';
            }
        });

        autosize($('.test-explanation textarea'));

        $(".test-example-line").hover(function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        let top = 1E20;
                        let left = 1E20;
                        let problem = $(this).closest(".problemindexholder");
                        $(this).closest(".input").find("." + clazz).css("background-color", "#FFFDE7").each(function() {
                            top = Math.min(top, $(this).offset().top);
                            left = Math.min(left, $(this).offset().left);
                        });
                        let testCaseMarker = problem.find(".testCaseMarker_" + end);
                        if (testCaseMarker.length === 0) {
                            const html = "<div class=\"testCaseMarker testCaseMarker_" + end + " notice\"></div>";
                            problem.append($(html));
                            testCaseMarker = problem.find(".testCaseMarker_" + end);
                        }
                        if (testCaseMarker) {
                            testCaseMarker.show()
                                    .offset({top, left: left - 20})
                                    .text(end);
                        }
                    }
                }
            });
        }, function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        $("." + clazz).css("background-color", "");
                        $(this).closest(".problemindexholder").find(".testCaseMarker_" + end).hide();
                    }
                }
            });
        });

    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="B" data-uuid="ps_774890b2e621c4479a9833999ea83cd0dd87896b">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B. DZY Loves FFT</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p><span class="tex-font-style-it">DZY loves Fast Fourier Transformation, and he enjoys using it.</span></p><p>Fast Fourier Transformation is an algorithm used to calculate convolution. Specifically, if <span class="tex-span"><i>a</i></span>, <span class="tex-span"><i>b</i></span> and <span class="tex-span"><i>c</i></span> are sequences with length <span class="tex-span"><i>n</i></span>, which are indexed from <span class="tex-span">0</span> to <span class="tex-span"><i>n</i> - 1</span>, and</p><center class="tex-equation"><img align="middle" class="tex-formula" src="https://espresso.codeforces.com/954d85f8c44a768d0814c95b7202d2f2d8b5fc92.png" style="max-width: 100.0%;max-height: 100.0%;" /></center><p>We can calculate <span class="tex-span"><i>c</i></span> fast using Fast Fourier Transformation.</p><p>DZY made a little change on this formula. Now</p><center class="tex-equation"><img align="middle" class="tex-formula" src="https://espresso.codeforces.com/09afa7cc3a89ee532dca56e03f335bb766d7af37.png" style="max-width: 100.0%;max-height: 100.0%;" /></center><p>To make things easier, <span class="tex-span"><i>a</i></span> is a permutation of integers from <span class="tex-span">1</span> to <span class="tex-span"><i>n</i></span>, and <span class="tex-span"><i>b</i></span> is a sequence only containing <span class="tex-span">0</span> and <span class="tex-span">1</span>. Given <span class="tex-span"><i>a</i></span> and <span class="tex-span"><i>b</i></span>, DZY needs your help to calculate <span class="tex-span"><i>c</i></span>.</p><p>Because he is naughty, DZY provides a special way to get <span class="tex-span"><i>a</i></span> and <span class="tex-span"><i>b</i></span>. What you need is only three integers <span class="tex-span"><i>n</i></span>, <span class="tex-span"><i>d</i></span>, <span class="tex-span"><i>x</i></span>. After getting them, use the code below to generate <span class="tex-span"><i>a</i></span> and <span class="tex-span"><i>b</i></span>.</p><pre class="verbatim"><br />//x is 64-bit variable;<br />function getNextX() {<br />    x = (x * 37 + 10007) % 1000000007;<br />    return x;<br />}<br />function initAB() {<br />    for(i = 0; i &lt; n; i = i + 1){<br />        a[i] = i + 1;<br />    }<br />    for(i = 0; i &lt; n; i = i + 1){<br />        swap(a[i], a[getNextX() % (i + 1)]);<br />    }<br />    for(i = 0; i &lt; n; i = i + 1){<br />        if (i &lt; d)<br />            b[i] = 1;<br />        else<br />            b[i] = 0;<br />    }<br />    for(i = 0; i &lt; n; i = i + 1){<br />        swap(b[i], b[getNextX() % (i + 1)]);<br />    }<br />}<br /><br /></pre><p>Operation <span class="tex-font-style-tt">x % y</span> denotes remainder after division <span class="tex-span"><i>x</i></span> by <span class="tex-span"><i>y</i></span>. Function <span class="tex-font-style-tt">swap(x, y)</span> swaps two values <span class="tex-span"><i>x</i></span> and <span class="tex-span"><i>y</i></span>.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The only line of input contains three space-separated integers <span class="tex-span"><i>n</i>, <i>d</i>, <i>x</i> (1 ≤ <i>d</i> ≤ <i>n</i> ≤ 100000; 0 ≤ <i>x</i> ≤ 1000000006)</span>. Because DZY is naughty, <span class="tex-span"><i>x</i></span> can't be equal to <span class="tex-span">27777500</span>.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Output <span class="tex-span"><i>n</i></span> lines, the <span class="tex-span"><i>i</i></span>-th line should contain an integer <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i> - 1</sub></span>.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3 1 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>1<br />3<br />2<br /></pre></div><div class="input"><div class="title">Input</div><pre>5 4 2<br /></pre></div><div class="output"><div class="title">Output</div><pre>2<br />2<br />4<br />5<br />5<br /></pre></div><div class="input"><div class="title">Input</div><pre>5 4 3<br /></pre></div><div class="output"><div class="title">Output</div><pre>5<br />5<br />5<br />5<br />4<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample, <span class="tex-span"><i>a</i></span> is <span class="tex-span">[1 3 2]</span>, <span class="tex-span"><i>b</i></span> is <span class="tex-span">[1 0 0]</span>, so <span class="tex-span"><i>c</i><sub class="lower-index">0</sub> = <i>max</i>(1·1) = 1</span>, <span class="tex-span"><i>c</i><sub class="lower-index">1</sub> = <i>max</i>(1·0, 3·1) = 3</span>, <span class="tex-span"><i>c</i><sub class="lower-index">2</sub> = <i>max</i>(1·0, 3·0, 2·1) = 2</span>.</p><p>In the second sample, <span class="tex-span"><i>a</i></span> is <span class="tex-span">[2 1 4 5 3]</span>, <span class="tex-span"><i>b</i></span> is <span class="tex-span">[1 1 1 0 1]</span>.</p><p>In the third sample, <span class="tex-span"><i>a</i></span> is <span class="tex-span">[5 2 1 4 3]</span>, <span class="tex-span"><i>b</i></span> is <span class="tex-span">[1 1 1 1 0]</span>.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=B]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="C" data-uuid="ps_21a2f2886fef538555c7401ece0e345ef29c0259">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C. DZY Loves Colors</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p><span class="tex-font-style-it">DZY loves colors, and he enjoys painting.</span></p><p>On a colorful day, DZY gets a colorful ribbon, which consists of <span class="tex-span"><i>n</i></span> units (they are numbered from <span class="tex-span">1</span> to <span class="tex-span"><i>n</i></span> from left to right). The color of the <span class="tex-span"><i>i</i></span>-th unit of the ribbon is <span class="tex-span"><i>i</i></span> at first. It is colorful enough, but we still consider that the colorfulness of each unit is <span class="tex-span">0</span> at first.</p><p>DZY loves painting, we know. He takes up a paintbrush with color <span class="tex-span"><i>x</i></span> and uses it to draw a line on the ribbon. In such a case some contiguous units are painted. Imagine that the color of unit <span class="tex-span"><i>i</i></span> currently is <span class="tex-span"><i>y</i></span>. When it is painted by this paintbrush, the color of the unit becomes <span class="tex-span"><i>x</i></span>, and the colorfulness of the unit increases by <span class="tex-span">|<i>x</i> - <i>y</i>|</span>.</p><p>DZY wants to perform <span class="tex-span"><i>m</i></span> operations, each operation can be one of the following:</p><ol> <li> Paint all the units with numbers between <span class="tex-span"><i>l</i></span> and <span class="tex-span"><i>r</i></span> (both inclusive) with color <span class="tex-span"><i>x</i></span>. </li><li> Ask the sum of colorfulness of the units between <span class="tex-span"><i>l</i></span> and <span class="tex-span"><i>r</i></span> (both inclusive). </li></ol><p>Can you help DZY?</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains two space-separated integers <span class="tex-span"><i>n</i>, <i>m</i> (1 ≤ <i>n</i>, <i>m</i> ≤ 10<sup class="upper-index">5</sup>)</span>.</p><p>Each of the next <span class="tex-span"><i>m</i></span> lines begins with a integer <span class="tex-span"><i>type</i> (1 ≤ <i>type</i> ≤ 2)</span>, which represents the type of this operation.</p><p>If <span class="tex-span"><i>type</i> = 1</span>, there will be <span class="tex-span">3</span> more integers <span class="tex-span"><i>l</i>, <i>r</i>, <i>x</i> (1 ≤ <i>l</i> ≤ <i>r</i> ≤ <i>n</i>; 1 ≤ <i>x</i> ≤ 10<sup class="upper-index">8</sup>)</span> in this line, describing an operation <span class="tex-span">1</span>.</p><p>If <span class="tex-span"><i>type</i> = 2</span>, there will be <span class="tex-span">2</span> more integers <span class="tex-span"><i>l</i>, <i>r</i> (1 ≤ <i>l</i> ≤ <i>r</i> ≤ <i>n</i>)</span> in this line, describing an operation <span class="tex-span">2</span>.</p></div><div class="output-specification"><div class="section-title">Output</div><p>For each operation <span class="tex-span">2</span>, print a line containing the answer — sum of colorfulness.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3 3<br />1 1 2 4<br />1 2 3 5<br />2 1 3<br /></pre></div><div class="output"><div class="title">Output</div><pre>8<br /></pre></div><div class="input"><div class="title">Input</div><pre>3 4<br />1 1 3 4<br />2 1 1<br />2 2 2<br />2 3 3<br /></pre></div><div class="output"><div class="title">Output</div><pre>3<br />2<br />1<br /></pre></div><div class="input"><div class="title">Input</div><pre>10 6<br />1 1 5 3<br />1 2 7 9<br />1 10 10 11<br />1 3 8 12<br />1 1 10 3<br />2 1 10<br /></pre></div><div class="output"><div class="title">Output</div><pre>129<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample, the color of each unit is initially <span class="tex-span">[1, 2, 3]</span>, and the colorfulness is <span class="tex-span">[0, 0, 0]</span>.</p><p>After the first operation, colors become <span class="tex-span">[4, 4, 3]</span>, colorfulness become <span class="tex-span">[3, 2, 0]</span>.</p><p>After the second operation, colors become <span class="tex-span">[4, 5, 5]</span>, colorfulness become <span class="tex-span">[3, 3, 2]</span>.</p><p>So the answer to the only operation of type <span class="tex-span">2</span> is <span class="tex-span">8</span>.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=C]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="D" data-uuid="ps_e7e6cb91d7245cdd56db2c7890f3ba2c25e58fd9">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. DZY Loves Strings</div><div class="time-limit"><div class="property-title">time limit per test</div>3 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p><span class="tex-font-style-it">DZY loves strings, and he enjoys collecting them.</span></p><p>In China, many people like to use strings containing their names' initials, for example: <span class="tex-font-style-tt">xyz</span>, <span class="tex-font-style-tt">jcvb</span>, <span class="tex-font-style-tt">dzy</span>, <span class="tex-font-style-tt">dyh</span>.</p><p>Once DZY found a lucky string <span class="tex-span"><i>s</i></span>. A lot of pairs of good friends came to DZY when they heard about the news. The first member of the <span class="tex-span"><i>i</i></span>-th pair has name <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>, the second one has name <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span>. Each pair wondered if there is a substring of the lucky string containing both of their names. If so, they want to find the one with minimum length, which can give them good luck and make their friendship last forever.</p><p>Please help DZY for each pair find the minimum length of the substring of <span class="tex-span"><i>s</i></span> that contains both <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span>, or point out that such substring doesn't exist.</p><p>A substring of <span class="tex-span"><i>s</i></span> is a string <span class="tex-span"><i>s</i><sub class="lower-index"><i>l</i></sub><i>s</i><sub class="lower-index"><i>l</i> + 1</sub>... <i>s</i><sub class="lower-index"><i>r</i></sub></span> for some integers <span class="tex-span"><i>l</i>, <i>r</i></span> <span class="tex-span">(1 ≤ <i>l</i> ≤ <i>r</i> ≤ |<i>s</i>|)</span>. The length of such the substring is <span class="tex-span">(<i>r</i> - <i>l</i> + 1)</span>.</p><p>A string <span class="tex-span"><i>p</i></span> contains some another string <span class="tex-span"><i>q</i></span> if there is a substring of <span class="tex-span"><i>p</i></span> equal to <span class="tex-span"><i>q</i></span>.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains a string <span class="tex-span"><i>s</i></span> <span class="tex-span">(1 ≤ |<i>s</i>| ≤ 50000)</span>.</p><p>The second line contains a non-negative integer <span class="tex-span"><i>q</i></span> <span class="tex-span">(0 ≤ <i>q</i> ≤ 100000)</span> — the number of pairs. Each of the next <span class="tex-span"><i>q</i></span> lines describes a pair, the line contains two space-separated strings <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span">(1 ≤ |<i>a</i><sub class="lower-index"><i>i</i></sub>|, |<i>b</i><sub class="lower-index"><i>i</i></sub>| ≤ 4)</span>.</p><p>It is guaranteed that all the strings only consist of lowercase English letters.</p></div><div class="output-specification"><div class="section-title">Output</div><p>For each pair, print a line containing a single integer — the minimum length of the required substring. If there is no such substring, output <span class="tex-font-style-tt">-1</span>.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>xudyhduxyz<br />3<br />xyz xyz<br />dyh xyz<br />dzy xyz<br /></pre></div><div class="output"><div class="title">Output</div><pre>3<br />8<br />-1<br /></pre></div><div class="input"><div class="title">Input</div><pre>abcabd<br />3<br />a c<br />ab abc<br />ab d<br /></pre></div><div class="output"><div class="title">Output</div><pre>2<br />3<br />3<br /></pre></div><div class="input"><div class="title">Input</div><pre>baabcabaaa<br />2<br />abca baa<br />aa aba<br /></pre></div><div class="output"><div class="title">Output</div><pre>6<br />4<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>The shortest substrings in the first sample are: <span class="tex-font-style-tt">xyz</span>, <span class="tex-font-style-tt">dyhduxyz</span>.</p><p>The shortest substrings in the second sample are: <span class="tex-font-style-tt">ca</span>, <span class="tex-font-style-tt">abc</span> and <span class="tex-font-style-tt">abd</span>.</p><p>The shortest substrings in the third sample are: <span class="tex-font-style-tt">baabca</span> and <span class="tex-font-style-tt">abaa</span>.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=D]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 1em;"
        >


<div class="problemindexholder" problemindex="E" data-uuid="ps_c7544b7d711fa2692d1243e8d5e9513dc163ac84">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. DZY Loves Planting</div><div class="time-limit"><div class="property-title">time limit per test</div>3 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p><span class="tex-font-style-it">DZY loves planting, and he enjoys solving tree problems.</span></p><p>DZY has a weighted tree (connected undirected graph without cycles) containing <span class="tex-span"><i>n</i></span> nodes (they are numbered from <span class="tex-span">1</span> to <span class="tex-span"><i>n</i></span>). He defines the function <span class="tex-span"><i>g</i>(<i>x</i>, <i>y</i>)</span> <span class="tex-span">(1 ≤ <i>x</i>, <i>y</i> ≤ <i>n</i>)</span> as the longest edge in the shortest path between nodes <span class="tex-span"><i>x</i></span> and <span class="tex-span"><i>y</i></span>. Specially <span class="tex-span"><i>g</i>(<i>z</i>, <i>z</i>) = 0</span> for every <span class="tex-span"><i>z</i></span>.</p><p>For every integer sequence <span class="tex-span"><i>p</i><sub class="lower-index">1</sub>, <i>p</i><sub class="lower-index">2</sub>, ..., <i>p</i><sub class="lower-index"><i>n</i></sub></span> <span class="tex-span">(1 ≤ <i>p</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i>)</span>, DZY defines <span class="tex-span"><i>f</i>(<i>p</i>)</span> as <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/43f9546e58d8d927384c8167f4683c5de48d9760.png" style="max-width: 100.0%;max-height: 100.0%;" />. </p><p>DZY wants to find such a sequence <span class="tex-span"><i>p</i></span> that <span class="tex-span"><i>f</i>(<i>p</i>)</span> has maximum possible value. But there is one more restriction: the element <span class="tex-span"><i>j</i></span> can appear in <span class="tex-span"><i>p</i></span> at most <span class="tex-span"><i>x</i><sub class="lower-index"><i>j</i></sub></span> times.</p><p>Please, find the maximum possible <span class="tex-span"><i>f</i>(<i>p</i>)</span> under the described restrictions.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains an integer <span class="tex-span"><i>n</i> (1 ≤ <i>n</i> ≤ 3000)</span>.</p><p>Each of the next <span class="tex-span"><i>n</i> - 1</span> lines contains three integers <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub>, <i>c</i><sub class="lower-index"><i>i</i></sub> (1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i>; 1 ≤ <i>c</i><sub class="lower-index"><i>i</i></sub> ≤ 10000)</span>, denoting an edge between <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> with length <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span>. It is guaranteed that these edges form a tree.</p><p>Each of the next <span class="tex-span"><i>n</i></span> lines describes an element of sequence <span class="tex-span"><i>x</i></span>. The <span class="tex-span"><i>j</i></span>-th line contains an integer <span class="tex-span"><i>x</i><sub class="lower-index"><i>j</i></sub> (1 ≤ <i>x</i><sub class="lower-index"><i>j</i></sub> ≤ <i>n</i>)</span>.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print a single integer representing the answer.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>4<br />1 2 1<br />2 3 2<br />3 4 3<br />1<br />1<br />1<br />1<br /></pre></div><div class="output"><div class="title">Output</div><pre>2<br /></pre></div><div class="input"><div class="title">Input</div><pre>4<br />1 2 1<br />2 3 2<br />3 4 3<br />4<br />4<br />4<br />4<br /></pre></div><div class="output"><div class="title">Output</div><pre>3<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample, one of the optimal <span class="tex-span"><i>p</i></span> is <span class="tex-span">[4, 3, 2, 1]</span>.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=E]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
    </div>

    <div id="footer">
        <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2024 Mike Mirzayanov</div>
        <div>The only programming contests Web 2.0 platform</div>

    </div>

</div>
</div>
    <script type="application/javascript">
        if ('serviceWorker' in navigator && 'fetch' in window && 'caches' in window) {
            navigator.serviceWorker.register('/service-worker-64849.js')
                .then(function (registration) {
                    console.log('Service worker registered: ', registration);
                })
                .catch(function (error) {
                    console.log('Registration failed: ', error);
                });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8a008c4ffe20777e',t:'MTcyMDQ0NjY3Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

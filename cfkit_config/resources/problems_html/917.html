
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-743380-5"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-743380-5');
        </script>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="3ecf5198b6a57f0716c9c1b0bc685a57"/>
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01"/>

    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery-1.8.3.js"></script>
    <script type="application/javascript">
        window.locale = "en";
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }

        /* Protection against trailing dot in domain. */
        let hostLength = window.location.host.length;
        if (hostLength > 1 && window.location.host[hostLength - 1] === '.') {
            window.location = window.location.protocol + "//" + window.location.host.substring(0, hostLength - 1);
        }
    </script>

    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="j3">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="//codeforces.org/s/60067/images/codeforces-sponsored-by-ton.png" />
    <link rel="image_src" href="//codeforces.org/s/60067/images/codeforces-sponsored-by-ton.png" />
    <meta property="og:title" content="Problems - Codeforces"/>
    <meta property="og:description" content=""/>
    
    <meta property="og:site_name" content="Codeforces"/>
    
    
    
    
    
    
    <meta name="utc_offset" content="+03:00"/>
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Problems - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community" />
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup" />
    <meta name="robots" content="index, follow" />

    <link rel="stylesheet" href="//codeforces.org/s/60067/css/font-awesome.min.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/line-awesome.min.css" type="text/css" charset="utf-8" />

        <link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>


    <link rel="apple-touch-icon" sizes="57x57" href="//codeforces.org/s/60067/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="//codeforces.org/s/60067/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="//codeforces.org/s/60067/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="//codeforces.org/s/60067/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="//codeforces.org/s/60067/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="//codeforces.org/s/60067/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="//codeforces.org/s/60067/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="//codeforces.org/s/60067/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="//codeforces.org/s/60067/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="//codeforces.org/s/60067/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="//codeforces.org/s/60067/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="//codeforces.org/s/60067/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="//codeforces.org/s/60067/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="//codeforces.org/s/60067/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/prettify.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/clear.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/ttypography.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/problem-statement.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/second-level-menu.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/roundbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/datatable.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/table-form.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/topic.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/jquery.jgrowl.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/facebox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/jquery.wysiwyg.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/jquery.autocomplete.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/codeforces.datepick.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/colorbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/css/jquery.drafts.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/60067/css/community.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/60067/css/sidebar-menu.css" type="text/css" charset="utf-8" />

    <!-- MathJax -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    MathJax.Hub.Register.StartupHook("End", function () {
        Codeforces.runMathJaxListeners();
    });
    </script>
    <script type="text/javascript" async
            src="https://mathjax.codeforces.org/MathJax.js?config=TeX-AMS_HTML-full"
    >
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="//codeforces.org/s/60067/js/prettify/prettify.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/pushstream.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.easing.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.swipe.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.hotkeys.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/facebox.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/controls/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/controls/wysiwyg.table.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/controls/wysiwyg.image.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/controls/wysiwyg.link.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.datepick.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/jquery.drafts.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/clipboard.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/autosize.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/sjcl.js"></script>
    <script type="text/javascript" src="/scripts/68aa7efc4fbbd6282d910ae57877f8bf/en/codeforces-options.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/codeforces.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/EventCatcher.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/preparedVerdictFormats-en.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/js/confetti.min.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="//codeforces.org/s/60067/markitup/skins/markitup/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/60067/markitup/sets/markdown/style.css" type="text/css" charset="utf-8" />


    <script type="text/javascript" src="//codeforces.org/s/60067/markitup/jquery.markitup.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/60067/markitup/sets/markdown/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->




</head>
<body class=" "><span style='display:none;' class='csrf-token' data-csrf='3ecf5198b6a57f0716c9c1b0bc685a57'>&nbsp;</span>

<!-- .notificationTextCleaner used in Codeforces.showAnnouncements() -->
<div class="notificationTextCleaner" style="font-size: 0"></div>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 3.0rem;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    String.prototype.hashCode = function() {
        var hash = 0, i, chr;
        if (this.length === 0) return hash;
        for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };

    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile === "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>





    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 700
        });
    }, 100);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


    function showAnnouncements(json) {
        //info("j=" + JSON.stringify(json));

        if (json.t != "a") {
            return;
        }

        setTimeout(function() {
            Codeforces.showAnnouncements(json.d, "en");
        }, Math.random() * 500);
    }

    function showEventCatcherUserMessage(json) {
        if (json.t == "s") {
            var points = json.d[5];
            var passedTestCount = json.d[7];
            var judgedTestCount = json.d[8];
            var verdict = preparedVerdictFormats[json.d[12]];
            var verdictPrototypeDiv = $(".verdictPrototypeDiv");
            verdictPrototypeDiv.html(verdict);
            if (judgedTestCount != null && judgedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-judged").text(judgedTestCount);
            }
            if (passedTestCount != null && passedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-passed").text(passedTestCount);
            }
            if (points != null && points != undefined) {
                verdictPrototypeDiv.find(".verdict-format-points").text(points);
            }
            Codeforces.showMessage(verdictPrototypeDiv.text());
        }
    }

    $(".clickable-title").each(function() {
        var title = $(this).attr("data-title");
        if (title) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = title;
            $(this).attr("title", tmp.textContent || tmp.innerText || "");
        }
    });

    $(".clickable-title").click(function() {
        var title = $(this).attr("data-title");
        if (title) {
            Codeforces.alert(title);
        } else {
            Codeforces.alert($(this).attr("title"));
        }
    }).css("position", "relative").css("bottom", "3px");

        Codeforces.showDelayedMessage();

    Codeforces.reformatTimes();

    //Codeforces.initializePubSub();
    if (window.codeforcesOptions.subscribeServerUrl) {
        window.eventCatcher = new EventCatcher(
            window.codeforcesOptions.subscribeServerUrl,
            [
                Codeforces.getGlobalChannel(),
                Codeforces.getUserChannel(),
                Codeforces.getUserShowMessageChannel(),
                Codeforces.getContestChannel(),
                Codeforces.getParticipantChannel(),
                Codeforces.getTalkChannel()
            ]
        );

        if (Codeforces.getParticipantChannel()) {
            window.eventCatcher.subscribe(Codeforces.getParticipantChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getContestChannel()) {
            window.eventCatcher.subscribe(Codeforces.getContestChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getGlobalChannel()) {
            window.eventCatcher.subscribe(Codeforces.getGlobalChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserShowMessageChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserShowMessageChannel(), function(json) {
                showEventCatcherUserMessage(json);
            });
        }
    }

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>


<div id="body">
<div style="width: 950px; margin: 0 auto;" class="compact-problemset">
    <div id="header" style="position: relative; margin: 0;">
        <div style="float:left;">
                  <a href="/"><img height="65" style="height: 65px;" src="//codeforces.org/s/60067/images/codeforces-sponsored-by-ton.png" alt="Codeforces"/></a>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="//codeforces.org/s/60067/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="//codeforces.org/s/60067/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <br style="clear: both;"/>

    <div style="text-align: center; font-size: 1.8rem; margin-bottom: 0.5em;"
         class="caption">Codeforces Round 459 (Div. 1)</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

    <div class="problem-frames">
        <div
                    style="margin-bottom: 2em;"
        >

    <style>
        #facebox .content:has(.diff-popup) {
            width: 90vw;
            max-width: 120rem !important;
        }

        .testCaseMarker {
            position: absolute;
            font-weight: bold;
            font-size: 1rem;
        }

        .diff-popup {
            width: 90vw;
            max-width: 120rem !important;
            display: none;
            overflow: auto;
        }

        .input-output-copier {
            font-size: 1.2rem;
            float: right;
            color: #888 !important;
            cursor: pointer;
            border: 1px solid rgb(185, 185, 185);
            padding: 3px;
            margin: 1px;
            line-height: 1.1rem;
            text-transform: none;
        }

        .input-output-copier:hover {
            background-color: #def;
        }

        .test-explanation textarea {
            width: 100%;
            height: 1.5em;
        }

        .pending-submission-message {
            color: darkorange !important;
        }
    </style>
    <script>
        const OPENING_SPACE = String.fromCharCode(1001);
        const CLOSING_SPACE = String.fromCharCode(1002);

        const nodeToText = function (node, pre) {
            let result = [];

            if (node.tagName === "SCRIPT" || node.tagName === "math"
                || (node.classList && node.classList.contains("input-output-copier")))
                return [];

            if (node.tagName === "NOBR") {
                result.push(OPENING_SPACE);
            }

            if (node.nodeType === Node.TEXT_NODE) {
                let s = node.textContent;
                if (!pre) {
                    s = s.replace(/\s+/g, " ");
                }
                if (s.length > 0) {
                    result.push(s);
                }
            }

            if (pre && node.tagName === "BR") {
                result.push("\n");
            }

            node.childNodes.forEach(function (child) {
                result.push(nodeToText(child, node.tagName === "PRE").join(""));
            });

            if (node.tagName === "DIV"
                || node.tagName === "P"
                || node.tagName === "PRE"
                || node.tagName === "UL"
                || node.tagName === "LI"
            ) {
                result.push("\n");
            }

            if (node.tagName === "NOBR") {
                result.push(CLOSING_SPACE);
            }

            return result;
        }

        const isSpecial = function (c) {
            return c === ',' || c === '.' || c === ';' || c === ')' || c === ' ';
        }

        const convertStatementToText = function(statmentNode) {
            const text = nodeToText(statmentNode, false).join("").replace(/ +/g, " ").replace(/\n\n+/g, "\n\n");
            let result = [];
            for (let i = 0; i < text.length; i++) {
                const c = text.charAt(i);
                if (c === OPENING_SPACE) {
                    if (!((i > 0 && text.charAt(i - 1) === '(') || (result.length > 0 && result[result.length - 1] === ' '))) {
                        result.push('+');
                    }
                } else if (c === CLOSING_SPACE) {
                    if (!(i + 1 < text.length && isSpecial(text.charAt(i + 1)))) {
                        result.push('-');
                    }
                } else {
                    result.push(c);
                }
            }
            return result.join("").split("\n").map(value => value.trim()).join("\n");
        };
    </script>
    <div class="diff-popup">
    </div>

<div class="problemindexholder" problemindex="A" data-uuid="ps_b974ffeb9f92c2095555e393077445416f5bf180">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A. The Monster</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>As Will is stuck in the Upside Down, he can still communicate with his mom, Joyce, through the Christmas lights (he can turn them on and off with his mind). He can't directly tell his mom where he is, because the monster that took him to the Upside Down will know and relocate him. </p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/4b9d293e3de0bf21cc35a670b21a3fba2aa3930e.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>Thus, he came up with a puzzle to tell his mom his coordinates. His coordinates are the answer to the following problem.</p><p>A string consisting only of parentheses ('<span class="tex-font-style-tt">(</span>' and '<span class="tex-font-style-tt">)</span>') is called a bracket sequence. Some bracket sequence are called correct bracket sequences. More formally:</p><ul> <li> Empty string is a correct bracket sequence. </li><li> if <span class="tex-span"><i>s</i></span> is a correct bracket sequence, then <span class="tex-span">(<i>s</i>)</span> is also a correct bracket sequence. </li><li> if <span class="tex-span"><i>s</i></span> and <span class="tex-span"><i>t</i></span> are correct bracket sequences, then <span class="tex-span"><i>st</i></span> (concatenation of <span class="tex-span"><i>s</i></span> and <span class="tex-span"><i>t</i></span>) is also a correct bracket sequence. </li></ul><p>A string consisting of parentheses and question marks ('<span class="tex-font-style-tt">?</span>') is called pretty if and only if there's a way to replace each question mark with either '<span class="tex-font-style-tt">(</span>' or '<span class="tex-font-style-tt">)</span>' such that the resulting string is a <span class="tex-font-style-bf">non-empty</span> correct bracket sequence.</p><p>Will gave his mom a string <span class="tex-span"><i>s</i></span> consisting of parentheses and question marks (using Morse code through the lights) and his coordinates are the number of pairs of integers <span class="tex-span">(<i>l</i>, <i>r</i>)</span> such that <span class="tex-span">1 ≤ <i>l</i> ≤ <i>r</i> ≤ |<i>s</i>|</span> and the string <span class="tex-span"><i>s</i><sub class="lower-index"><i>l</i></sub><i>s</i><sub class="lower-index"><i>l</i> + 1</sub>... <i>s</i><sub class="lower-index"><i>r</i></sub></span> is pretty, where <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span> is <span class="tex-span"><i>i</i></span>-th character of <span class="tex-span"><i>s</i></span>.</p><p>Joyce doesn't know anything about bracket sequences, so she asked for your help.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first and only line of input contains string <span class="tex-span"><i>s</i></span>, consisting only of characters '<span class="tex-font-style-tt">(</span>', '<span class="tex-font-style-tt">)</span>' and '<span class="tex-font-style-tt">?</span>' (<span class="tex-span">2 ≤ |<i>s</i>| ≤ 5000</span>).</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print the answer to Will's puzzle in the first and only line of output.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>((?))<br /></pre></div><div class="output"><div class="title">Output</div><pre>4<br /></pre></div><div class="input"><div class="title">Input</div><pre>??()??<br /></pre></div><div class="output"><div class="title">Output</div><pre>7<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>For the first sample testcase, the pretty substrings of <span class="tex-span"><i>s</i></span> are:</p><ol> <li> &quot;<span class="tex-font-style-tt">(?</span>&quot; which can be transformed to &quot;<span class="tex-font-style-tt">()</span>&quot;. </li><li> &quot;<span class="tex-font-style-tt">?)</span>&quot; which can be transformed to &quot;<span class="tex-font-style-tt">()</span>&quot;. </li><li> &quot;<span class="tex-font-style-tt">((?)</span>&quot; which can be transformed to &quot;<span class="tex-font-style-tt">(())</span>&quot;. </li><li> &quot;<span class="tex-font-style-tt">(?))</span>&quot; which can be transformed to &quot;<span class="tex-font-style-tt">(())</span>&quot;. </li></ol> <p>For the second sample testcase, the pretty substrings of <span class="tex-span"><i>s</i></span> are:</p><ol> <li> &quot;<span class="tex-font-style-tt">??</span>&quot; which can be transformed to &quot;<span class="tex-font-style-tt">()</span>&quot;. </li><li> &quot;<span class="tex-font-style-tt">()</span>&quot;. </li><li> &quot;<span class="tex-font-style-tt">??()</span>&quot; which can be transformed to &quot;<span class="tex-font-style-tt">()()</span>&quot;. </li><li> &quot;<span class="tex-font-style-tt">?()?</span>&quot; which can be transformed to &quot;<span class="tex-font-style-tt">(())</span>&quot;. </li><li> &quot;<span class="tex-font-style-tt">??</span>&quot; which can be transformed to &quot;<span class="tex-font-style-tt">()</span>&quot;. </li><li> &quot;<span class="tex-font-style-tt">()??</span>&quot; which can be transformed to &quot;<span class="tex-font-style-tt">()()</span>&quot;. </li><li> &quot;<span class="tex-font-style-tt">??()??</span>&quot; which can be transformed to &quot;<span class="tex-font-style-tt">()()()</span>&quot;. </li></ol></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=A]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {
        window.changedTests = new Set();

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");



        String.prototype.replaceAll = function (search, replace) {
            return this.split(search).join(replace);
        };

        $(".sample-test .title").each(function () {
            const preId = ("id" + Math.random()).replaceAll(".", "0");
            const cpyId = ("id" + Math.random()).replaceAll(".", "0");

            $(this).parent().find("pre").attr("id", preId);
            const $copy = $("<div title='Copy' data-clipboard-target='#" + preId + "' id='" + cpyId + "' class='input-output-copier'>Copy</div>");
            $(this).append($copy);

            const clipboard = new Clipboard('#' + cpyId, {
                text: function (trigger) {
                    const pre = document.querySelector('#' + preId);
                    const lines = pre.querySelectorAll(".test-example-line");
                    return Codeforces.filterClipboardText(pre.innerText, lines.length);
                }
            });

            const isInput = $(this).parent().hasClass("input");

            clipboard.on('success', function (e) {
                if (isInput) {
                    Codeforces.showMessage("The example input has been copied into the clipboard");
                } else {
                    Codeforces.showMessage("The example output has been copied into the clipboard");
                }
                e.clearSelection();
            });
        });

        $(".test-form-item input").change(function () {
            addPendingSubmissionMessage($($(this).closest("form")), "You changed the answer, do not forget to submit it if you want to save the changes");
            const index = $(this).closest(".problemindexholder").attr("problemindex");
            let test = "";
            $(this).closest("form input").each(function () {
                const test_ = $(this).attr("name");
                if (test_ && test_.substring(0, 4) === "test") {
                    test = test_;
                }
            });
            if (index.length > 0 && test.length > 0) {
                const indexTest = index + "::" + test;
                window.changedTests.add(indexTest);
            }
        });

        $(window).on('beforeunload', function () {
            if (window.changedTests.size > 0) {
                return 'Dialog text here';
            }
        });

        autosize($('.test-explanation textarea'));

        $(".test-example-line").hover(function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        let top = 1E20;
                        let left = 1E20;
                        let problem = $(this).closest(".problemindexholder");
                        $(this).closest(".input").find("." + clazz).css("background-color", "#FFFDE7").each(function() {
                            top = Math.min(top, $(this).offset().top);
                            left = Math.min(left, $(this).offset().left);
                        });
                        let testCaseMarker = problem.find(".testCaseMarker_" + end);
                        if (testCaseMarker.length === 0) {
                            const html = "<div class=\"testCaseMarker testCaseMarker_" + end + " notice\"></div>";
                            problem.append($(html));
                            testCaseMarker = problem.find(".testCaseMarker_" + end);
                        }
                        if (testCaseMarker) {
                            testCaseMarker.show()
                                    .offset({top, left: left - 20})
                                    .text(end);
                        }
                    }
                }
            });
        }, function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        $("." + clazz).css("background-color", "");
                        $(this).closest(".problemindexholder").find(".testCaseMarker_" + end).hide();
                    }
                }
            });
        });

    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="B" data-uuid="ps_4c995b3b6991da90325c271d783f2f7d3b8bacd3">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B. MADMAX</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>As we all know, Max is the best video game player among her friends. Her friends were so jealous of hers, that they created an actual game just to prove that she's not the best at games. The game is played on a directed acyclic graph (a DAG) with <span class="tex-span"><i>n</i></span> vertices and <span class="tex-span"><i>m</i></span> edges. There's a character written on each edge, a lowercase English letter.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/f9ebcdf318eb077a2e812a25c049cf2fb61fe766.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>Max and Lucas are playing the game. Max goes first, then Lucas, then Max again and so on. Each player has a marble, initially located at some vertex. Each player in his/her turn should move his/her marble along some edge (a player can move the marble from vertex <span class="tex-span"><i>v</i></span> to vertex <span class="tex-span"><i>u</i></span> if there's an outgoing edge from <span class="tex-span"><i>v</i></span> to <span class="tex-span"><i>u</i></span>). If the player moves his/her marble from vertex <span class="tex-span"><i>v</i></span> to vertex <span class="tex-span"><i>u</i></span>, the &quot;character&quot; of that round is the character written on the edge from <span class="tex-span"><i>v</i></span> to <span class="tex-span"><i>u</i></span>. There's one additional rule; the ASCII code of character of round <span class="tex-span"><i>i</i></span> should be <span class="tex-font-style-bf">greater than or equal</span> to the ASCII code of character of round <span class="tex-span"><i>i</i> - 1</span> (for <span class="tex-span"><i>i</i> &gt; 1</span>). The rounds are numbered for both players together, i. e. Max goes in odd numbers, Lucas goes in even numbers. The player that can't make a move loses the game. The marbles may be at the same vertex at the same time.</p><p>Since the game could take a while and Lucas and Max have to focus on finding Dart, they don't have time to play. So they asked you, if they both play optimally, who wins the game?</p><p>You have to determine the winner of the game for all initial positions of the marbles.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of input contains two integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>m</i></span> (<span class="tex-span">2 ≤ <i>n</i> ≤ 100</span>, <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/37372be2fa973707a2359c140f9c1f1a0de5fb71.png" style="max-width: 100.0%;max-height: 100.0%;" />).</p><p>The next <span class="tex-span"><i>m</i></span> lines contain the edges. Each line contains two integers <span class="tex-span"><i>v</i></span>, <span class="tex-span"><i>u</i></span> and a lowercase English letter <span class="tex-span"><i>c</i></span>, meaning there's an edge from <span class="tex-span"><i>v</i></span> to <span class="tex-span"><i>u</i></span> written <span class="tex-span"><i>c</i></span> on it (<span class="tex-span">1 ≤ <i>v</i>, <i>u</i> ≤ <i>n</i></span>, <span class="tex-span"><i>v</i> ≠ <i>u</i></span>). There's at most one edge between any pair of vertices. It is guaranteed that the graph is acyclic.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print <span class="tex-span"><i>n</i></span> lines, a string of length <span class="tex-span"><i>n</i></span> in each one. The <span class="tex-span"><i>j</i></span>-th character in <span class="tex-span"><i>i</i></span>-th line should be 'A' if Max will win the game in case her marble is initially at vertex <span class="tex-span"><i>i</i></span> and Lucas's marble is initially at vertex <span class="tex-span"><i>j</i></span>, and 'B' otherwise.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>4 4<br />1 2 b<br />1 3 a<br />2 4 c<br />3 4 b<br /></pre></div><div class="output"><div class="title">Output</div><pre>BAAA<br />ABAA<br />BBBA<br />BBBB<br /></pre></div><div class="input"><div class="title">Input</div><pre>5 8<br />5 3 h<br />1 2 c<br />3 1 c<br />3 2 r<br />5 1 r<br />4 3 z<br />5 4 r<br />5 2 h<br /></pre></div><div class="output"><div class="title">Output</div><pre>BABBB<br />BBBBB<br />AABBB<br />AAABA<br />AAAAB<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Here's the graph in the first sample test case:</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/d748f2c28d5f2fb9d103a79f6196549f9d9a6acf.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>Here's the graph in the second sample test case:</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/129a4f2045f65dd0eaf5ccd5a6e9089ed96caac0.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=B]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="C" data-uuid="ps_69940fa1f9a49b3ca75d93b3b429c68287983c16">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C. Pollywog</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>As we all know, Dart is some kind of creature from Upside Down world. For simplicity, we call their kind <span class="tex-font-style-it">pollywogs</span>. Dart and <span class="tex-span"><i>x</i> - 1</span> other pollywogs are playing a game. There are <span class="tex-span"><i>n</i></span> stones in a row, numbered from <span class="tex-span">1</span> through <span class="tex-span"><i>n</i></span> from left to right. At most <span class="tex-span">1</span> pollywog may be sitting on each stone at a time. Initially, the pollywogs are sitting on the first <span class="tex-span"><i>x</i></span> stones (one pollywog on each stone).</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/d746add45f2265820a8f0e77d8904f5bb03dde9a.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>Dart and his friends want to end up on the last <span class="tex-span"><i>x</i></span> stones. At each second, the leftmost pollywog should jump to the right. A pollywog can jump at most <span class="tex-span"><i>k</i></span> stones; more specifically, a pollywog can jump from stone number <span class="tex-span"><i>i</i></span> to stones <span class="tex-span"><i>i</i> + 1, <i>i</i> + 2, ... <i>i</i> + <i>k</i></span>. A pollywog can't jump on an occupied stone. Jumping a distance <span class="tex-span"><i>i</i></span> takes <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> amounts of energy from the pollywog. </p><p>Also, <span class="tex-span"><i>q</i></span> stones are <span class="tex-font-style-it">special</span> Each time landing on a special stone <span class="tex-span"><i>p</i></span>, takes <span class="tex-span"><i>w</i><sub class="lower-index"><i>p</i></sub></span> amounts of energy (in addition to the energy for jump) from the pollywog. <span class="tex-span"><i>w</i><sub class="lower-index"><i>p</i></sub></span> could be negative, in this case, it means the pollywog absorbs <span class="tex-span">|<i>w</i><sub class="lower-index"><i>p</i></sub>|</span> amounts of energy.</p><p>Pollywogs want to spend as little energy as possible (this value could be negative). </p><p>They're just pollywogs, so they asked for your help. Tell them the total change in their energy, in case they move optimally.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of input contains four integers, <span class="tex-span"><i>x</i>, <i>k</i>, <i>n</i></span> and <span class="tex-span"><i>q</i></span> (<span class="tex-span">1 ≤ <i>x</i> ≤ <i>k</i> ≤ 8</span>, <span class="tex-span"><i>k</i> ≤ <i>n</i> ≤ 10<sup class="upper-index">8</sup></span>, <span class="tex-span">0 ≤ <i>q</i> ≤ <i>min</i>(25, <i>n</i> - <i>x</i>)</span>) — the number of pollywogs, the maximum length of jump, the number of stones and the number of special stones.</p><p>The next line contains <span class="tex-span"><i>k</i></span> integers, <span class="tex-span"><i>c</i><sub class="lower-index">1</sub>, <i>c</i><sub class="lower-index">2</sub>, ... <i>c</i><sub class="lower-index"><i>k</i></sub></span>, separated by spaces (<span class="tex-span">1 ≤ <i>c</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>) — the energetic costs of jumps.</p><p>The next <span class="tex-span"><i>q</i></span> lines contain description of the special stones. Each line contains two integers <span class="tex-span"><i>p</i></span> and <span class="tex-span"><i>w</i><sub class="lower-index"><i>p</i></sub></span> (<span class="tex-span"><i>x</i> + 1 ≤ <i>p</i> ≤ <i>n</i></span>, <span class="tex-span">|<i>w</i><sub class="lower-index"><i>p</i></sub>| ≤ 10<sup class="upper-index">9</sup></span>). All <span class="tex-span"><i>p</i></span> are distinct.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print the minimum amount of energy they need, in the first and only line of output.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>2 3 10 2<br />1 2 3<br />5 -10<br />6 1000<br /></pre></div><div class="output"><div class="title">Output</div><pre>6<br /></pre></div><div class="input"><div class="title">Input</div><pre>4 7 85 3<br />17 5 28 4 52 46 6<br />59 -76<br />33 -69<br />19 2018<br /></pre></div><div class="output"><div class="title">Output</div><pre>135<br /></pre></div></div></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=C]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="D" data-uuid="ps_22766124a9ecdefc5a00b74603c110020991bbdb">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. Stranger Trees</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Will shares a psychic connection with the Upside Down Monster, so everything the monster knows, Will knows. Suddenly, he started drawing, page after page, non-stop. Joyce, his mom, and Chief Hopper put the drawings together, and they realized, it's a labeled tree!</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/1c116a1f726c026673d4997f3fce49ed05fe4092.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>A tree is a connected acyclic graph. Will's tree has <span class="tex-span"><i>n</i></span> vertices. Joyce and Hopper don't know what that means, so they're investigating this tree and similar trees. For each <span class="tex-span"><i>k</i></span> such that <span class="tex-span">0 ≤ <i>k</i> ≤ <i>n</i> - 1</span>, they're going to investigate all labeled trees with <span class="tex-span"><i>n</i></span> vertices that share exactly <span class="tex-span"><i>k</i></span> edges with Will's tree. Two labeled trees are different if and only if there's a pair of vertices <span class="tex-span">(<i>v</i>, <i>u</i>)</span> such that there's an edge between <span class="tex-span"><i>v</i></span> and <span class="tex-span"><i>u</i></span> in one tree and not in the other one.</p><p>Hopper and Joyce want to know how much work they have to do, so they asked you to tell them the number of labeled trees with <span class="tex-span"><i>n</i></span> vertices that share exactly <span class="tex-span"><i>k</i></span> edges with Will's tree, for each <span class="tex-span"><i>k</i></span>. The answer could be very large, so they only asked you to tell them the answers modulo <span class="tex-span">1000000007 = 10<sup class="upper-index">9</sup> + 7</span>.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of input contains a single integer <span class="tex-span"><i>n</i></span> (<span class="tex-span">2 ≤ <i>n</i> ≤ 100</span>) — the size of the tree.</p><p>The next <span class="tex-span"><i>n</i> - 1</span> lines contain the edges of Will's tree. Each line contains two integers <span class="tex-span"><i>v</i></span> and <span class="tex-span"><i>u</i></span> (<span class="tex-span">1 ≤ <i>v</i>, <i>u</i> ≤ <i>n</i></span>, <span class="tex-span"><i>v</i> ≠ <i>u</i></span>), endpoints of an edge. It is guaranteed that the given graph is a tree.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print <span class="tex-span"><i>n</i></span> integers in one line. <span class="tex-span"><i>i</i></span>-th integer should be the number of the number of labeled trees with <span class="tex-span"><i>n</i></span> vertices that share exactly <span class="tex-span"><i>i</i> - 1</span> edges with Will's tree, modulo <span class="tex-span">1000 000 007 = 10<sup class="upper-index">9</sup> + 7</span>.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3<br />1 2<br />1 3<br /></pre></div><div class="output"><div class="title">Output</div><pre>0 2 1 </pre></div><div class="input"><div class="title">Input</div><pre>4<br />1 2<br />2 3<br />3 4<br /></pre></div><div class="output"><div class="title">Output</div><pre>1 7 7 1 </pre></div><div class="input"><div class="title">Input</div><pre>4<br />1 2<br />1 3<br />1 4<br /></pre></div><div class="output"><div class="title">Output</div><pre>0 9 6 1 </pre></div></div></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=D]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 1em;"
        >


<div class="problemindexholder" problemindex="E" data-uuid="ps_438d9ebaf7277f5b5429e6a9fb23c8b178344302">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. Upside Down</div><div class="time-limit"><div class="property-title">time limit per test</div>3 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>512 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>As we all know, Eleven has special abilities. Thus, Hopper convinced her to close the gate to the Upside Down World with her mind. Upside down monsters like to move between the worlds, so they are going to attack Hopper and Eleven in order to make them stop. The monsters live in the vines. The vines form a tree with <span class="tex-span"><i>n</i></span> vertices, numbered from <span class="tex-span">1</span> through <span class="tex-span"><i>n</i></span>. There's a lowercase English letter written in each tunnel (edge).</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/a64dc17c572bb1e99a35935761d00b7aa6999d3a.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>Upside down is a magical world. There are <span class="tex-span"><i>m</i></span> types of monsters in upside down, numbered from <span class="tex-span">1</span> through <span class="tex-span"><i>m</i></span>. Each type of monster has a special word that gives them powers. The special word of type <span class="tex-span"><i>i</i></span> is <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span>. There are <span class="tex-span"><i>q</i></span> monsters in upside down. Each one is at a junction (vertex) and is going to some other junction. If monster of type <span class="tex-span"><i>k</i></span> goes from junction <span class="tex-span"><i>i</i></span> to junction <span class="tex-span"><i>j</i></span>, the power it gains is the number of times it sees its special world (<span class="tex-span"><i>s</i><sub class="lower-index"><i>k</i></sub></span>) consecutively in the tunnels. More formally: </p><p>If <span class="tex-span"><i>f</i>(<i>i</i>, <i>j</i>)</span> is the string we get when we concatenate the letters written in the tunnels on the shortest path from <span class="tex-span"><i>i</i></span> to <span class="tex-span"><i>j</i></span>, then the power the monster gains is the number of occurrences of <span class="tex-span"><i>s</i><sub class="lower-index"><i>k</i></sub></span> in <span class="tex-span"><i>f</i>(<i>i</i>, <i>j</i>)</span>.</p><p>Hopper and Eleven want to get prepared, so for each monster, they want to know the power the monster gains after moving. </p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of input contains three integers, <span class="tex-span"><i>n</i>, <i>m</i></span> and <span class="tex-span"><i>q</i></span> (<span class="tex-span">2 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup></span>, <span class="tex-span">1 ≤ <i>m</i>, <i>q</i> ≤ 10<sup class="upper-index">5</sup></span>).</p><p>The next <span class="tex-span"><i>n</i> - 1</span> lines contain the tunnels (edges). Each line contains two integers <span class="tex-span"><i>v</i></span> and <span class="tex-span"><i>u</i></span> (<span class="tex-span">1 ≤ <i>v</i>, <i>u</i> ≤ <i>n</i></span>, <span class="tex-span"><i>v</i> ≠ <i>u</i></span>) and a lowercase English letter <span class="tex-span"><i>c</i></span>, meaning there's a tunnel connecting junctions <span class="tex-span"><i>v</i></span> and <span class="tex-span"><i>u</i></span> written <span class="tex-span"><i>c</i></span> in it. It is guaranteed that the given graph is a tree.</p><p>The next <span class="tex-span"><i>m</i></span> lines contain the special words. <span class="tex-span"><i>i</i></span>-th line of them contains a single string <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ |<i>s</i><sub class="lower-index"><i>i</i></sub>| ≤ 10<sup class="upper-index">5</sup></span>), consisting of lowercase English letters. It is guaranteed that <span class="tex-span">|<i>s</i><sub class="lower-index">1</sub>| + |<i>s</i><sub class="lower-index">2</sub>| + ... + |<i>s</i><sub class="lower-index"><i>m</i></sub>| ≤ 10<sup class="upper-index">5</sup></span>).</p><p>The next <span class="tex-span"><i>q</i></span> lines contain the monsters. Each line contains three integers <span class="tex-span"><i>i</i></span>, <span class="tex-span"><i>j</i></span> and <span class="tex-span"><i>k</i></span> (<span class="tex-span">1 ≤ <i>i</i>, <i>j</i> ≤ <i>n</i></span>, <span class="tex-span"><i>i</i> ≠ <i>j</i></span>, <span class="tex-span">1 ≤ <i>k</i> ≤ <i>m</i></span>), meaning a monster of type <span class="tex-span"><i>k</i></span> is going from junction number <span class="tex-span"><i>i</i></span> to junction number <span class="tex-span"><i>j</i></span>.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print <span class="tex-span"><i>q</i></span> lines. <span class="tex-span"><i>i</i></span>-th line should contain a single integer, the power the <span class="tex-span"><i>i</i></span>-th monster gains after moving.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>6 4 5<br />1 6 b<br />2 3 a<br />1 2 b<br />5 3 b<br />4 5 b<br />a<br />b<br />bb<br />aa<br />1 2 1<br />6 2 3<br />1 6 2<br />4 5 4<br />1 6 2<br /></pre></div><div class="output"><div class="title">Output</div><pre>0<br />1<br />1<br />0<br />1<br /></pre></div><div class="input"><div class="title">Input</div><pre>10 6 7<br />1 3 s<br />10 1 d<br />2 6 s<br />5 2 d<br />7 4 l<br />8 9 d<br />8 10 l<br />7 2 d<br />8 7 l<br />dl<br />dssld<br />d<br />d<br />l<br />sl<br />4 5 4<br />3 7 5<br />10 6 2<br />3 1 4<br />7 5 6<br />10 9 4<br />9 8 4<br /></pre></div><div class="output"><div class="title">Output</div><pre>2<br />2<br />0<br />0<br />0<br />1<br />1<br /></pre></div></div></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=E]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/60067");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
    </div>

    <div id="footer">
        <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2024 Mike Mirzayanov</div>
        <div>The only programming contests Web 2.0 platform</div>

    </div>

</div>
</div>
    <script type="application/javascript">
        if ('serviceWorker' in navigator && 'fetch' in window && 'caches' in window) {
            navigator.serviceWorker.register('/service-worker-60067.js')
                .then(function (registration) {
                    console.log('Service worker registered: ', registration);
                })
                .catch(function (error) {
                    console.log('Registration failed: ', error);
                });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8a0f7c122fe0777b',t:'MTcyMDYwMzI5Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>


<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-743380-5"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-743380-5');
        </script>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="ad15433c92b5c9011184f73d31018f93"/>
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01"/>

    <script type="text/javascript" src="//codeforces.org/s/55432/js/jquery-1.8.3.js"></script>
    <script type="application/javascript">
        window.locale = "en";
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }

        /* Protection against trailing dot in domain. */
        let hostLength = window.location.host.length;
        if (hostLength > 1 && window.location.host[hostLength - 1] === '.') {
            window.location = window.location.protocol + "//" + window.location.host.substring(0, hostLength - 1);
        }
    </script>

    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="k2">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="//codeforces.org/s/55432/images/codeforces-sponsored-by-ton.png" />
    <link rel="image_src" href="//codeforces.org/s/55432/images/codeforces-sponsored-by-ton.png" />
    <meta property="og:title" content="Problems - Codeforces"/>
    <meta property="og:description" content=""/>
    
    <meta property="og:site_name" content="Codeforces"/>
    
    
    
    
    
    
    <meta name="utc_offset" content="+03:00"/>
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Problems - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community" />
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup" />
    <meta name="robots" content="index, follow" />

    <link rel="stylesheet" href="//codeforces.org/s/55432/css/font-awesome.min.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/55432/css/line-awesome.min.css" type="text/css" charset="utf-8" />

        <link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>


    <link rel="apple-touch-icon" sizes="57x57" href="//codeforces.org/s/55432/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="//codeforces.org/s/55432/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="//codeforces.org/s/55432/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="//codeforces.org/s/55432/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="//codeforces.org/s/55432/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="//codeforces.org/s/55432/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="//codeforces.org/s/55432/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="//codeforces.org/s/55432/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="//codeforces.org/s/55432/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="//codeforces.org/s/55432/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="//codeforces.org/s/55432/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="//codeforces.org/s/55432/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="//codeforces.org/s/55432/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="//codeforces.org/s/55432/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="//codeforces.org/s/55432/css/prettify.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/55432/css/clear.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/55432/css/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/55432/css/ttypography.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/55432/css/problem-statement.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/55432/css/second-level-menu.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/55432/css/roundbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/55432/css/datatable.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/55432/css/table-form.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/55432/css/topic.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/55432/css/jquery.jgrowl.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/55432/css/facebox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/55432/css/jquery.wysiwyg.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/55432/css/jquery.autocomplete.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/55432/css/codeforces.datepick.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/55432/css/colorbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/55432/css/jquery.drafts.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/55432/css/community.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/55432/css/sidebar-menu.css" type="text/css" charset="utf-8" />

    <!-- MathJax -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    MathJax.Hub.Register.StartupHook("End", function () {
        Codeforces.runMathJaxListeners();
    });
    </script>
    <script type="text/javascript" async
            src="https://mathjax.codeforces.org/MathJax.js?config=TeX-AMS_HTML-full"
    >
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="//codeforces.org/s/55432/js/prettify/prettify.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/55432/js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/55432/js/pushstream.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/55432/js/jquery.easing.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/55432/js/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/55432/js/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/55432/js/jquery.swipe.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/55432/js/jquery.hotkeys.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/55432/js/facebox.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/55432/js/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/55432/js/controls/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/55432/js/controls/wysiwyg.table.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/55432/js/controls/wysiwyg.image.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/55432/js/controls/wysiwyg.link.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/55432/js/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/55432/js/jquery.datepick.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/55432/js/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/55432/js/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/55432/js/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/55432/js/jquery.drafts.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/55432/js/clipboard.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/55432/js/autosize.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/55432/js/sjcl.js"></script>
    <script type="text/javascript" src="/scripts/df490bc4069773cf9867c869007f2b79/en/codeforces-options.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/55432/js/codeforces.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/55432/js/EventCatcher.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/55432/js/preparedVerdictFormats-en.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/55432/js/confetti.min.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="//codeforces.org/s/55432/markitup/skins/markitup/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/55432/markitup/sets/markdown/style.css" type="text/css" charset="utf-8" />


    <script type="text/javascript" src="//codeforces.org/s/55432/markitup/jquery.markitup.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/55432/markitup/sets/markdown/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->




</head>
<body class=" "><span style='display:none;' class='csrf-token' data-csrf='ad15433c92b5c9011184f73d31018f93'>&nbsp;</span>

<!-- .notificationTextCleaner used in Codeforces.showAnnouncements() -->
<div class="notificationTextCleaner" style="font-size: 0"></div>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 3.0rem;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    String.prototype.hashCode = function() {
        var hash = 0, i, chr;
        if (this.length === 0) return hash;
        for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };

    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile === "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>





    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 700
        });
    }, 100);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


    function showAnnouncements(json) {
        //info("j=" + JSON.stringify(json));

        if (json.t != "a") {
            return;
        }

        setTimeout(function() {
            Codeforces.showAnnouncements(json.d, "en");
        }, Math.random() * 500);
    }

    function showEventCatcherUserMessage(json) {
        if (json.t == "s") {
            var points = json.d[5];
            var passedTestCount = json.d[7];
            var judgedTestCount = json.d[8];
            var verdict = preparedVerdictFormats[json.d[12]];
            var verdictPrototypeDiv = $(".verdictPrototypeDiv");
            verdictPrototypeDiv.html(verdict);
            if (judgedTestCount != null && judgedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-judged").text(judgedTestCount);
            }
            if (passedTestCount != null && passedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-passed").text(passedTestCount);
            }
            if (points != null && points != undefined) {
                verdictPrototypeDiv.find(".verdict-format-points").text(points);
            }
            Codeforces.showMessage(verdictPrototypeDiv.text());
        }
    }

    $(".clickable-title").each(function() {
        var title = $(this).attr("data-title");
        if (title) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = title;
            $(this).attr("title", tmp.textContent || tmp.innerText || "");
        }
    });

    $(".clickable-title").click(function() {
        var title = $(this).attr("data-title");
        if (title) {
            Codeforces.alert(title);
        } else {
            Codeforces.alert($(this).attr("title"));
        }
    }).css("position", "relative").css("bottom", "3px");

        Codeforces.showDelayedMessage();

    Codeforces.reformatTimes();

    //Codeforces.initializePubSub();
    if (window.codeforcesOptions.subscribeServerUrl) {
        window.eventCatcher = new EventCatcher(
            window.codeforcesOptions.subscribeServerUrl,
            [
                Codeforces.getGlobalChannel(),
                Codeforces.getUserChannel(),
                Codeforces.getUserShowMessageChannel(),
                Codeforces.getContestChannel(),
                Codeforces.getParticipantChannel(),
                Codeforces.getTalkChannel()
            ]
        );

        if (Codeforces.getParticipantChannel()) {
            window.eventCatcher.subscribe(Codeforces.getParticipantChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getContestChannel()) {
            window.eventCatcher.subscribe(Codeforces.getContestChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getGlobalChannel()) {
            window.eventCatcher.subscribe(Codeforces.getGlobalChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserShowMessageChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserShowMessageChannel(), function(json) {
                showEventCatcherUserMessage(json);
            });
        }
    }

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>


<div id="body">
<div style="width: 950px; margin: 0 auto;" class="compact-problemset">
    <div id="header" style="position: relative; margin: 0;">
        <div style="float:left;">
            <div style="padding:1em 0 0 2px;color:#C60C30;font-size:18px;font-weight:bold;">
<a href="/abbyycup30"><img src="http://www.abbyy.ru/images/logo.gif"/></a>
<span style="padding:1.5em;position:relative;bottom:7px;">ABBYY Cup 3.0 is waiting for you!</span>
</div>

        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="//codeforces.org/s/55432/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="//codeforces.org/s/55432/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <br style="clear: both;"/>

    <div style="text-align: center; font-size: 1.8rem; margin-bottom: 0.5em;"
         class="caption">ABBYY Cup 3.0 - Finals</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

    <div class="problem-frames">
        <div
                    style="margin-bottom: 2em;"
        >

    <style>
        #facebox .content:has(.diff-popup) {
            width: 90vw;
            max-width: 120rem !important;
        }

        .testCaseMarker {
            position: absolute;
            font-weight: bold;
            font-size: 1rem;
        }

        .diff-popup {
            width: 90vw;
            max-width: 120rem !important;
            display: none;
            overflow: auto;
        }

        .input-output-copier {
            font-size: 1.2rem;
            float: right;
            color: #888 !important;
            cursor: pointer;
            border: 1px solid rgb(185, 185, 185);
            padding: 3px;
            margin: 1px;
            line-height: 1.1rem;
            text-transform: none;
        }

        .input-output-copier:hover {
            background-color: #def;
        }

        .test-explanation textarea {
            width: 100%;
            height: 1.5em;
        }

        .pending-submission-message {
            color: darkorange !important;
        }
    </style>
    <script>
        const OPENING_SPACE = String.fromCharCode(1001);
        const CLOSING_SPACE = String.fromCharCode(1002);

        const nodeToText = function (node, pre) {
            let result = [];

            if (node.tagName === "SCRIPT" || node.tagName === "math"
                || (node.classList && node.classList.contains("input-output-copier")))
                return [];

            if (node.tagName === "NOBR") {
                result.push(OPENING_SPACE);
            }

            if (node.nodeType === Node.TEXT_NODE) {
                let s = node.textContent;
                if (!pre) {
                    s = s.replace(/\s+/g, " ");
                }
                if (s.length > 0) {
                    result.push(s);
                }
            }

            if (pre && node.tagName === "BR") {
                result.push("\n");
            }

            node.childNodes.forEach(function (child) {
                result.push(nodeToText(child, node.tagName === "PRE").join(""));
            });

            if (node.tagName === "DIV"
                || node.tagName === "P"
                || node.tagName === "PRE"
                || node.tagName === "UL"
                || node.tagName === "LI"
            ) {
                result.push("\n");
            }

            if (node.tagName === "NOBR") {
                result.push(CLOSING_SPACE);
            }

            return result;
        }

        const isSpecial = function (c) {
            return c === ',' || c === '.' || c === ';' || c === ')' || c === ' ';
        }

        const convertStatementToText = function(statmentNode) {
            const text = nodeToText(statmentNode, false).join("").replace(/ +/g, " ").replace(/\n\n+/g, "\n\n");
            let result = [];
            for (let i = 0; i < text.length; i++) {
                const c = text.charAt(i);
                if (c === OPENING_SPACE) {
                    if (!((i > 0 && text.charAt(i - 1) === '(') || (result.length > 0 && result[result.length - 1] === ' '))) {
                        result.push('+');
                    }
                } else if (c === CLOSING_SPACE) {
                    if (!(i + 1 < text.length && isSpecial(text.charAt(i + 1)))) {
                        result.push('-');
                    }
                } else {
                    result.push(c);
                }
            }
            return result.join("").split("\n").map(value => value.trim()).join("\n");
        };
    </script>
    <div class="diff-popup">
    </div>

<div class="problemindexholder" problemindex="A1" data-uuid="ps_0fa846a00d920822f327aaca1ff1583cecd80862">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A1. Oh Sweet Beaverette</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p><span class="tex-font-style-it"> — Oh my sweet Beaverette, would you fancy a walk along a wonderful woodland belt with me? </span> </p><p><span class="tex-font-style-it"> — Of course, my Smart Beaver! Let us enjoy the splendid view together. How about Friday night? </span></p><p>At this point the Smart Beaver got rushing. Everything should be perfect by Friday, so he needed to prepare the belt to the upcoming walk. He needed to cut down several trees.</p><p>Let's consider the woodland belt as a sequence of trees. Each tree <span class="tex-span"><i>i</i></span> is described by the esthetic appeal <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> — some trees are very esthetically pleasing, others are 'so-so', and some trees are positively ugly!</p><p>The Smart Beaver calculated that he needed the following effects to win the Beaverette's heart: </p><ul> <li> The first objective is to please the Beaverette: the sum of esthetic appeal of the remaining trees must be maximum possible; </li><li> the second objective is to surprise the Beaverette: the esthetic appeal of the first and the last trees in the resulting belt must be the same; </li><li> and of course, the walk should be successful: there must be at least two trees in the woodland belt left. </li></ul><p>Now help the Smart Beaver! Which trees does he need to cut down to win the Beaverette's heart?</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains a single integer <span class="tex-span"><i>n</i></span> — the initial number of trees in the woodland belt, <span class="tex-span">2 ≤ <i>n</i></span>. The second line contains space-separated integers <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> — the esthetic appeals of each tree. All esthetic appeals do not exceed <span class="tex-span">10<sup class="upper-index">9</sup></span> in their absolute value.</p><ul> <li> to get 30 points, you need to solve the problem with constraints: <span class="tex-span"><i>n</i> ≤ 100</span> (subproblem A1); </li><li> to get 100 points, you need to solve the problem with constraints: <span class="tex-span"><i>n</i> ≤ 3·10<sup class="upper-index">5</sup></span> (subproblems A1+A2). </li></ul></div><div class="output-specification"><div class="section-title">Output</div><p>In the first line print two integers — the total esthetic appeal of the woodland belt after the Smart Beaver's intervention and the number of the cut down trees <span class="tex-span"><i>k</i></span>.</p><p>In the next line print <span class="tex-span"><i>k</i></span> integers — the numbers of the trees the Beaver needs to cut down. Assume that the trees are numbered from 1 to <span class="tex-span"><i>n</i></span> from left to right.</p><p>If there are multiple solutions, print any of them. It is guaranteed that at least two trees have equal esthetic appeal.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>5<br />1 2 3 1 2<br /></pre></div><div class="output"><div class="title">Output</div><pre>8 1<br />1 </pre></div><div class="input"><div class="title">Input</div><pre>5<br />1 -2 3 1 -2<br /></pre></div><div class="output"><div class="title">Output</div><pre>5 2<br />2 5 </pre></div></div></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=A1]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/55432");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {
        window.changedTests = new Set();

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");



        String.prototype.replaceAll = function (search, replace) {
            return this.split(search).join(replace);
        };

        $(".sample-test .title").each(function () {
            const preId = ("id" + Math.random()).replaceAll(".", "0");
            const cpyId = ("id" + Math.random()).replaceAll(".", "0");

            $(this).parent().find("pre").attr("id", preId);
            const $copy = $("<div title='Copy' data-clipboard-target='#" + preId + "' id='" + cpyId + "' class='input-output-copier'>Copy</div>");
            $(this).append($copy);

            const clipboard = new Clipboard('#' + cpyId, {
                text: function (trigger) {
                    const pre = document.querySelector('#' + preId);
                    const lines = pre.querySelectorAll(".test-example-line");
                    return Codeforces.filterClipboardText(pre.innerText, lines.length);
                }
            });

            const isInput = $(this).parent().hasClass("input");

            clipboard.on('success', function (e) {
                if (isInput) {
                    Codeforces.showMessage("The example input has been copied into the clipboard");
                } else {
                    Codeforces.showMessage("The example output has been copied into the clipboard");
                }
                e.clearSelection();
            });
        });

        $(".test-form-item input").change(function () {
            addPendingSubmissionMessage($($(this).closest("form")), "You changed the answer, do not forget to submit it if you want to save the changes");
            const index = $(this).closest(".problemindexholder").attr("problemindex");
            let test = "";
            $(this).closest("form input").each(function () {
                const test_ = $(this).attr("name");
                if (test_ && test_.substring(0, 4) === "test") {
                    test = test_;
                }
            });
            if (index.length > 0 && test.length > 0) {
                const indexTest = index + "::" + test;
                window.changedTests.add(indexTest);
            }
        });

        $(window).on('beforeunload', function () {
            if (window.changedTests.size > 0) {
                return 'Dialog text here';
            }
        });

        autosize($('.test-explanation textarea'));

        $(".test-example-line").hover(function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        let top = 1E20;
                        let left = 1E20;
                        let problem = $(this).closest(".problemindexholder");
                        $(this).closest(".input").find("." + clazz).css("background-color", "#FFFDE7").each(function() {
                            top = Math.min(top, $(this).offset().top);
                            left = Math.min(left, $(this).offset().left);
                        });
                        let testCaseMarker = problem.find(".testCaseMarker_" + end);
                        if (testCaseMarker.length === 0) {
                            const html = "<div class=\"testCaseMarker testCaseMarker_" + end + " notice\"></div>";
                            problem.append($(html));
                            testCaseMarker = problem.find(".testCaseMarker_" + end);
                        }
                        if (testCaseMarker) {
                            testCaseMarker.show()
                                    .offset({top, left: left - 20})
                                    .text(end);
                        }
                    }
                }
            });
        }, function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        $("." + clazz).css("background-color", "");
                        $(this).closest(".problemindexholder").find(".testCaseMarker_" + end).hide();
                    }
                }
            });
        });

    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="A2" data-uuid="ps_0fa846a00d920822f327aaca1ff1583cecd80862">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A2. Oh Sweet Beaverette</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p><span class="tex-font-style-it"> — Oh my sweet Beaverette, would you fancy a walk along a wonderful woodland belt with me? </span> </p><p><span class="tex-font-style-it"> — Of course, my Smart Beaver! Let us enjoy the splendid view together. How about Friday night? </span></p><p>At this point the Smart Beaver got rushing. Everything should be perfect by Friday, so he needed to prepare the belt to the upcoming walk. He needed to cut down several trees.</p><p>Let's consider the woodland belt as a sequence of trees. Each tree <span class="tex-span"><i>i</i></span> is described by the esthetic appeal <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> — some trees are very esthetically pleasing, others are 'so-so', and some trees are positively ugly!</p><p>The Smart Beaver calculated that he needed the following effects to win the Beaverette's heart: </p><ul> <li> The first objective is to please the Beaverette: the sum of esthetic appeal of the remaining trees must be maximum possible; </li><li> the second objective is to surprise the Beaverette: the esthetic appeal of the first and the last trees in the resulting belt must be the same; </li><li> and of course, the walk should be successful: there must be at least two trees in the woodland belt left. </li></ul><p>Now help the Smart Beaver! Which trees does he need to cut down to win the Beaverette's heart?</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains a single integer <span class="tex-span"><i>n</i></span> — the initial number of trees in the woodland belt, <span class="tex-span">2 ≤ <i>n</i></span>. The second line contains space-separated integers <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> — the esthetic appeals of each tree. All esthetic appeals do not exceed <span class="tex-span">10<sup class="upper-index">9</sup></span> in their absolute value.</p><ul> <li> to get 30 points, you need to solve the problem with constraints: <span class="tex-span"><i>n</i> ≤ 100</span> (subproblem A1); </li><li> to get 100 points, you need to solve the problem with constraints: <span class="tex-span"><i>n</i> ≤ 3·10<sup class="upper-index">5</sup></span> (subproblems A1+A2). </li></ul></div><div class="output-specification"><div class="section-title">Output</div><p>In the first line print two integers — the total esthetic appeal of the woodland belt after the Smart Beaver's intervention and the number of the cut down trees <span class="tex-span"><i>k</i></span>.</p><p>In the next line print <span class="tex-span"><i>k</i></span> integers — the numbers of the trees the Beaver needs to cut down. Assume that the trees are numbered from 1 to <span class="tex-span"><i>n</i></span> from left to right.</p><p>If there are multiple solutions, print any of them. It is guaranteed that at least two trees have equal esthetic appeal.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>5<br />1 2 3 1 2<br /></pre></div><div class="output"><div class="title">Output</div><pre>8 1<br />1 </pre></div><div class="input"><div class="title">Input</div><pre>5<br />1 -2 3 1 -2<br /></pre></div><div class="output"><div class="title">Output</div><pre>5 2<br />2 5 </pre></div></div></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=A2]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/55432");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="B1" data-uuid="ps_0501b0b8c0411344586dd1b7a76c63d4501e046f">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B1. Shave Beaver!</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>The Smart Beaver has recently designed and built an innovative nanotechnologic all-purpose beaver mass shaving machine, &quot;Beavershave 5000&quot;. Beavershave 5000 can shave beavers by families! How does it work? Very easily!</p><p>There are <span class="tex-span"><i>n</i></span> beavers, each of them has a unique id from 1 to <span class="tex-span"><i>n</i></span>. Consider a permutation <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>n</i></sub></span> of <span class="tex-span"><i>n</i></span> these beavers. Beavershave 5000 needs one session to shave beavers with ids from <span class="tex-span"><i>x</i></span> to <span class="tex-span"><i>y</i></span> (inclusive) if and only if there are such indices <span class="tex-span"><i>i</i><sub class="lower-index">1</sub> &lt; <i>i</i><sub class="lower-index">2</sub> &lt; ... &lt; <i>i</i><sub class="lower-index"><i>k</i></sub></span>, that <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i><sub class="lower-index">1</sub></sub> = <i>x</i></span>, <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i><sub class="lower-index">2</sub></sub> = <i>x</i> + 1</span>, ..., <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i><sub class="lower-index"><i>k</i> - 1</sub></sub> = <i>y</i> - 1</span>, <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i><sub class="lower-index"><i>k</i></sub></sub> = <i>y</i></span>. And that is really convenient. For example, it needs one session to shave a permutation of beavers <span class="tex-span">1, 2, 3, ..., <i>n</i></span>.</p><p>If we can't shave beavers from <span class="tex-span"><i>x</i></span> to <span class="tex-span"><i>y</i></span> in one session, then we can split these beavers into groups <span class="tex-span">[<i>x</i>, <i>p</i><sub class="lower-index">1</sub>]</span>, <span class="tex-span">[<i>p</i><sub class="lower-index">1</sub> + 1, <i>p</i><sub class="lower-index">2</sub>]</span>, ..., <span class="tex-span">[<i>p</i><sub class="lower-index"><i>m</i></sub> + 1, <i>y</i>]</span> <span class="tex-span">(<i>x</i> ≤ <i>p</i><sub class="lower-index">1</sub> &lt; <i>p</i><sub class="lower-index">2</sub> &lt; ... &lt; <i>p</i><sub class="lower-index"><i>m</i></sub> &lt; <i>y</i>)</span>, in such a way that the machine can shave beavers in each group in one session. But then Beavershave 5000 needs <span class="tex-span"><i>m</i> + 1</span> working sessions to shave beavers from <span class="tex-span"><i>x</i></span> to <span class="tex-span"><i>y</i></span>.</p><p>All beavers are restless and they keep trying to swap. So if we consider the problem more formally, we can consider queries of two types: </p><ul> <li> what is the minimum number of sessions that Beavershave 5000 needs to shave beavers with ids from <span class="tex-span"><i>x</i></span> to <span class="tex-span"><i>y</i></span>, inclusive? </li><li> two beavers on positions <span class="tex-span"><i>x</i></span> and <span class="tex-span"><i>y</i></span> (the beavers <span class="tex-span"><i>a</i><sub class="lower-index"><i>x</i></sub></span> and <span class="tex-span"><i>a</i><sub class="lower-index"><i>y</i></sub></span>) swapped. </li></ul><p>You can assume that any beaver can be shaved any number of times.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains integer <span class="tex-span"><i>n</i></span> — the total number of beavers, <span class="tex-span">2 ≤ <i>n</i></span>. The second line contains <span class="tex-span"><i>n</i></span> space-separated integers — the initial beaver permutation.</p><p>The third line contains integer <span class="tex-span"><i>q</i></span> — the number of queries, <span class="tex-span">1 ≤ <i>q</i> ≤ 10<sup class="upper-index">5</sup></span>. The next <span class="tex-span"><i>q</i></span> lines contain the queries. Each query <span class="tex-span"><i>i</i></span> looks as <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub></span>, where <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub></span> is the query type (<span class="tex-span">1</span> is to shave beavers from <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> to <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub></span>, inclusive, <span class="tex-span">2</span> is to swap beavers on positions <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub></span>). All queries meet the condition: <span class="tex-span">1 ≤ <i>x</i><sub class="lower-index"><i>i</i></sub> &lt; <i>y</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i></span>.</p><ul> <li> to get 30 points, you need to solve the problem with constraints: <span class="tex-span"><i>n</i> ≤ 100</span> (subproblem B1); </li><li> to get 100 points, you need to solve the problem with constraints: <span class="tex-span"><i>n</i> ≤ 3·10<sup class="upper-index">5</sup></span> (subproblems B1+B2). </li></ul><p>Note that the number of queries <span class="tex-span"><i>q</i></span> is limited <span class="tex-span">1 ≤ <i>q</i> ≤ 10<sup class="upper-index">5</sup></span> in both subproblem B1 and subproblem B2.</p></div><div class="output-specification"><div class="section-title">Output</div><p>For each query with <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub> = 1</span>, print the minimum number of Beavershave 5000 sessions.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>5<br />1 3 4 2 5<br />6<br />1 1 5<br />1 3 4<br />2 2 3<br />1 1 5<br />2 1 5<br />1 1 5<br /></pre></div><div class="output"><div class="title">Output</div><pre>2<br />1<br />3<br />5<br /></pre></div></div></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=B1]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/55432");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="B2" data-uuid="ps_0501b0b8c0411344586dd1b7a76c63d4501e046f">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B2. Shave Beaver!</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>The Smart Beaver has recently designed and built an innovative nanotechnologic all-purpose beaver mass shaving machine, &quot;Beavershave 5000&quot;. Beavershave 5000 can shave beavers by families! How does it work? Very easily!</p><p>There are <span class="tex-span"><i>n</i></span> beavers, each of them has a unique id from 1 to <span class="tex-span"><i>n</i></span>. Consider a permutation <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>n</i></sub></span> of <span class="tex-span"><i>n</i></span> these beavers. Beavershave 5000 needs one session to shave beavers with ids from <span class="tex-span"><i>x</i></span> to <span class="tex-span"><i>y</i></span> (inclusive) if and only if there are such indices <span class="tex-span"><i>i</i><sub class="lower-index">1</sub> &lt; <i>i</i><sub class="lower-index">2</sub> &lt; ... &lt; <i>i</i><sub class="lower-index"><i>k</i></sub></span>, that <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i><sub class="lower-index">1</sub></sub> = <i>x</i></span>, <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i><sub class="lower-index">2</sub></sub> = <i>x</i> + 1</span>, ..., <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i><sub class="lower-index"><i>k</i> - 1</sub></sub> = <i>y</i> - 1</span>, <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i><sub class="lower-index"><i>k</i></sub></sub> = <i>y</i></span>. And that is really convenient. For example, it needs one session to shave a permutation of beavers <span class="tex-span">1, 2, 3, ..., <i>n</i></span>.</p><p>If we can't shave beavers from <span class="tex-span"><i>x</i></span> to <span class="tex-span"><i>y</i></span> in one session, then we can split these beavers into groups <span class="tex-span">[<i>x</i>, <i>p</i><sub class="lower-index">1</sub>]</span>, <span class="tex-span">[<i>p</i><sub class="lower-index">1</sub> + 1, <i>p</i><sub class="lower-index">2</sub>]</span>, ..., <span class="tex-span">[<i>p</i><sub class="lower-index"><i>m</i></sub> + 1, <i>y</i>]</span> <span class="tex-span">(<i>x</i> ≤ <i>p</i><sub class="lower-index">1</sub> &lt; <i>p</i><sub class="lower-index">2</sub> &lt; ... &lt; <i>p</i><sub class="lower-index"><i>m</i></sub> &lt; <i>y</i>)</span>, in such a way that the machine can shave beavers in each group in one session. But then Beavershave 5000 needs <span class="tex-span"><i>m</i> + 1</span> working sessions to shave beavers from <span class="tex-span"><i>x</i></span> to <span class="tex-span"><i>y</i></span>.</p><p>All beavers are restless and they keep trying to swap. So if we consider the problem more formally, we can consider queries of two types: </p><ul> <li> what is the minimum number of sessions that Beavershave 5000 needs to shave beavers with ids from <span class="tex-span"><i>x</i></span> to <span class="tex-span"><i>y</i></span>, inclusive? </li><li> two beavers on positions <span class="tex-span"><i>x</i></span> and <span class="tex-span"><i>y</i></span> (the beavers <span class="tex-span"><i>a</i><sub class="lower-index"><i>x</i></sub></span> and <span class="tex-span"><i>a</i><sub class="lower-index"><i>y</i></sub></span>) swapped. </li></ul><p>You can assume that any beaver can be shaved any number of times.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains integer <span class="tex-span"><i>n</i></span> — the total number of beavers, <span class="tex-span">2 ≤ <i>n</i></span>. The second line contains <span class="tex-span"><i>n</i></span> space-separated integers — the initial beaver permutation.</p><p>The third line contains integer <span class="tex-span"><i>q</i></span> — the number of queries, <span class="tex-span">1 ≤ <i>q</i> ≤ 10<sup class="upper-index">5</sup></span>. The next <span class="tex-span"><i>q</i></span> lines contain the queries. Each query <span class="tex-span"><i>i</i></span> looks as <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub></span>, where <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub></span> is the query type (<span class="tex-span">1</span> is to shave beavers from <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> to <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub></span>, inclusive, <span class="tex-span">2</span> is to swap beavers on positions <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub></span>). All queries meet the condition: <span class="tex-span">1 ≤ <i>x</i><sub class="lower-index"><i>i</i></sub> &lt; <i>y</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i></span>.</p><ul> <li> to get 30 points, you need to solve the problem with constraints: <span class="tex-span"><i>n</i> ≤ 100</span> (subproblem B1); </li><li> to get 100 points, you need to solve the problem with constraints: <span class="tex-span"><i>n</i> ≤ 3·10<sup class="upper-index">5</sup></span> (subproblems B1+B2). </li></ul><p>Note that the number of queries <span class="tex-span"><i>q</i></span> is limited <span class="tex-span">1 ≤ <i>q</i> ≤ 10<sup class="upper-index">5</sup></span> in both subproblem B1 and subproblem B2.</p></div><div class="output-specification"><div class="section-title">Output</div><p>For each query with <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub> = 1</span>, print the minimum number of Beavershave 5000 sessions.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>5<br />1 3 4 2 5<br />6<br />1 1 5<br />1 3 4<br />2 2 3<br />1 1 5<br />2 1 5<br />1 1 5<br /></pre></div><div class="output"><div class="title">Output</div><pre>2<br />1<br />3<br />5<br /></pre></div></div></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=B2]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/55432");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="C1" data-uuid="ps_0f3895c34ae15f6fa496204043daa8dfeefc1f80">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C1. The Great Julya Calendar</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Yet another Armageddon is coming! This time the culprit is the Julya tribe calendar. </p><p>The beavers in this tribe knew math very well. Smart Beaver, an archaeologist, got a sacred plate with a magic integer on it. The translation from Old Beaverish is as follows: </p><p>&quot;<span class="tex-font-style-it">May the Great Beaver bless you! May your chacres open and may your third eye never turn blind from beholding the Truth! Take the magic number, subtract a digit from it (the digit must occur in the number) and get a new magic number. Repeat this operation until a magic number equals zero. The Earth will stand on Three Beavers for the time, equal to the number of subtractions you perform!</span>&quot;</p><p>Distinct subtraction sequences can obviously get you different number of operations. But the Smart Beaver is ready to face the worst and is asking you to count the minimum number of operations he needs to reduce the magic number to zero.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The single line contains the magic integer <span class="tex-span"><i>n</i></span>, <span class="tex-span">0 ≤ <i>n</i></span>.</p><ul> <li> to get 20 points, you need to solve the problem with constraints: <span class="tex-span"><i>n</i> ≤ 10<sup class="upper-index">6</sup></span> (subproblem C1); </li><li> to get 40 points, you need to solve the problem with constraints: <span class="tex-span"><i>n</i> ≤ 10<sup class="upper-index">12</sup></span> (subproblems C1+C2); </li><li> to get 100 points, you need to solve the problem with constraints: <span class="tex-span"><i>n</i> ≤ 10<sup class="upper-index">18</sup></span> (subproblems C1+C2+C3). </li></ul></div><div class="output-specification"><div class="section-title">Output</div><p>Print a single integer — the minimum number of subtractions that turns the magic number to a zero.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>24<br /></pre></div><div class="output"><div class="title">Output</div><pre>5</pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first test sample the minimum number of operations can be reached by the following sequence of subtractions: </p><center> <span><span><span><span class="tex-span">24 → 20 → 18 → 10 → 9 → 0</span></span></span></span> </center></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=C1]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/55432");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="C2" data-uuid="ps_0f3895c34ae15f6fa496204043daa8dfeefc1f80">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C2. The Great Julya Calendar</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Yet another Armageddon is coming! This time the culprit is the Julya tribe calendar. </p><p>The beavers in this tribe knew math very well. Smart Beaver, an archaeologist, got a sacred plate with a magic integer on it. The translation from Old Beaverish is as follows: </p><p>&quot;<span class="tex-font-style-it">May the Great Beaver bless you! May your chacres open and may your third eye never turn blind from beholding the Truth! Take the magic number, subtract a digit from it (the digit must occur in the number) and get a new magic number. Repeat this operation until a magic number equals zero. The Earth will stand on Three Beavers for the time, equal to the number of subtractions you perform!</span>&quot;</p><p>Distinct subtraction sequences can obviously get you different number of operations. But the Smart Beaver is ready to face the worst and is asking you to count the minimum number of operations he needs to reduce the magic number to zero.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The single line contains the magic integer <span class="tex-span"><i>n</i></span>, <span class="tex-span">0 ≤ <i>n</i></span>.</p><ul> <li> to get 20 points, you need to solve the problem with constraints: <span class="tex-span"><i>n</i> ≤ 10<sup class="upper-index">6</sup></span> (subproblem C1); </li><li> to get 40 points, you need to solve the problem with constraints: <span class="tex-span"><i>n</i> ≤ 10<sup class="upper-index">12</sup></span> (subproblems C1+C2); </li><li> to get 100 points, you need to solve the problem with constraints: <span class="tex-span"><i>n</i> ≤ 10<sup class="upper-index">18</sup></span> (subproblems C1+C2+C3). </li></ul></div><div class="output-specification"><div class="section-title">Output</div><p>Print a single integer — the minimum number of subtractions that turns the magic number to a zero.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>24<br /></pre></div><div class="output"><div class="title">Output</div><pre>5</pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first test sample the minimum number of operations can be reached by the following sequence of subtractions: </p><center> <span><span><span><span class="tex-span">24 → 20 → 18 → 10 → 9 → 0</span></span></span></span> </center></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=C2]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/55432");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="C3" data-uuid="ps_0f3895c34ae15f6fa496204043daa8dfeefc1f80">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C3. The Great Julya Calendar</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Yet another Armageddon is coming! This time the culprit is the Julya tribe calendar. </p><p>The beavers in this tribe knew math very well. Smart Beaver, an archaeologist, got a sacred plate with a magic integer on it. The translation from Old Beaverish is as follows: </p><p>&quot;<span class="tex-font-style-it">May the Great Beaver bless you! May your chacres open and may your third eye never turn blind from beholding the Truth! Take the magic number, subtract a digit from it (the digit must occur in the number) and get a new magic number. Repeat this operation until a magic number equals zero. The Earth will stand on Three Beavers for the time, equal to the number of subtractions you perform!</span>&quot;</p><p>Distinct subtraction sequences can obviously get you different number of operations. But the Smart Beaver is ready to face the worst and is asking you to count the minimum number of operations he needs to reduce the magic number to zero.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The single line contains the magic integer <span class="tex-span"><i>n</i></span>, <span class="tex-span">0 ≤ <i>n</i></span>.</p><ul> <li> to get 20 points, you need to solve the problem with constraints: <span class="tex-span"><i>n</i> ≤ 10<sup class="upper-index">6</sup></span> (subproblem C1); </li><li> to get 40 points, you need to solve the problem with constraints: <span class="tex-span"><i>n</i> ≤ 10<sup class="upper-index">12</sup></span> (subproblems C1+C2); </li><li> to get 100 points, you need to solve the problem with constraints: <span class="tex-span"><i>n</i> ≤ 10<sup class="upper-index">18</sup></span> (subproblems C1+C2+C3). </li></ul></div><div class="output-specification"><div class="section-title">Output</div><p>Print a single integer — the minimum number of subtractions that turns the magic number to a zero.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>24<br /></pre></div><div class="output"><div class="title">Output</div><pre>5</pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first test sample the minimum number of operations can be reached by the following sequence of subtractions: </p><center> <span><span><span><span class="tex-span">24 → 20 → 18 → 10 → 9 → 0</span></span></span></span> </center></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=C3]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/55432");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="D1" data-uuid="ps_4d24b5257ac0c3fc9568ef2f5211c40809da3af8">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D1. Escaping on Beaveractor</div><div class="time-limit"><div class="property-title">time limit per test</div>6 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>512 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Don't put up with what you're sick of! The Smart Beaver decided to escape from the campus of Beaver Science Academy (BSA). BSA is a <span class="tex-span"><i>b</i> × <i>b</i></span> square on a plane. Each point <span class="tex-span"><i>x</i>, <i>y</i></span> <span class="tex-span">(0 ≤ <i>x</i>, <i>y</i> ≤ <i>b</i>)</span> belongs to BSA. To make the path quick and funny, the Beaver constructed a Beaveractor, an effective and comfortable types of transport.</p><p>The campus obeys traffic rules: there are <span class="tex-span"><i>n</i></span> arrows, parallel to the coordinate axes. The arrows do not intersect and do not touch each other. When the Beaveractor reaches some arrow, it turns in the arrow's direction and moves on until it either reaches the next arrow or gets outside the campus. The Beaveractor covers exactly one unit of space per one unit of time. You can assume that there are no obstacles to the Beaveractor.</p><p>The BSA scientists want to transport the brand new Beaveractor to the &quot;Academic Tractor&quot; research institute and send the Smart Beaver to do his postgraduate studies and sharpen pencils. They have <span class="tex-span"><i>q</i></span> plans, representing the Beaveractor's initial position <span class="tex-span">(<i>x</i><sub class="lower-index"><i>i</i></sub>, <i>y</i><sub class="lower-index"><i>i</i></sub>)</span>, the initial motion vector <span class="tex-span"><i>w</i><sub class="lower-index"><i>i</i></sub></span> and the time <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub></span> that have passed after the escape started.</p><p>Your task is for each of the <span class="tex-span"><i>q</i></span> plans to determine the Smart Beaver's position after the given time.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains two integers: the number of traffic rules <span class="tex-span"><i>n</i></span> and the size of the campus <span class="tex-span"><i>b</i></span>, <span class="tex-span">0 ≤ <i>n</i></span>, <span class="tex-span">1 ≤ <i>b</i></span>. Next <span class="tex-span"><i>n</i></span> lines contain the rules. Each line of the rules contains four space-separated integers <span class="tex-span"><i>x</i><sub class="lower-index">0</sub></span>, <span class="tex-span"><i>y</i><sub class="lower-index">0</sub></span>, <span class="tex-span"><i>x</i><sub class="lower-index">1</sub></span>, <span class="tex-span"><i>y</i><sub class="lower-index">1</sub></span> — the beginning and the end of the arrow. It is guaranteed that all arrows are parallel to the coordinate axes and have no common points. All arrows are located inside the campus, that is, <span class="tex-span">0 ≤ <i>x</i><sub class="lower-index">0</sub>, <i>y</i><sub class="lower-index">0</sub>, <i>x</i><sub class="lower-index">1</sub>, <i>y</i><sub class="lower-index">1</sub> ≤ <i>b</i></span> holds.</p><p>Next line contains integer <span class="tex-span"><i>q</i></span> — the number of plans the scientists have, <span class="tex-span">1 ≤ <i>q</i> ≤ 10<sup class="upper-index">5</sup></span>. The <span class="tex-span"><i>i</i></span>-th plan is represented by two integers, <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub></span> are the Beaveractor's coordinates at the initial time, <span class="tex-span">0 ≤ <i>x</i><sub class="lower-index"><i>i</i></sub>, <i>y</i><sub class="lower-index"><i>i</i></sub> ≤ <i>b</i></span>, character <span class="tex-span"><i>w</i><sub class="lower-index"><i>i</i></sub></span>, that takes value <span class="tex-font-style-tt">U</span>, <span class="tex-font-style-tt">D</span>, <span class="tex-font-style-tt">L</span>, <span class="tex-font-style-tt">R</span> and sets the initial direction up, down, to the left or to the right correspondingly (the Y axis is directed upwards), and <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub></span> — the time passed after the escape started, <span class="tex-span">0 ≤ <i>t</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">15</sup></span>.</p><ul> <li> to get 30 points you need to solve the problem with constraints <span class="tex-span"><i>n</i>, <i>b</i> ≤ 30</span> (subproblem D1); </li><li> to get 60 points you need to solve the problem with constraints <span class="tex-span"><i>n</i>, <i>b</i> ≤ 1000</span> (subproblems D1+D2); </li><li> to get 100 points you need to solve the problem with constraints <span class="tex-span"><i>n</i>, <i>b</i> ≤ 10<sup class="upper-index">5</sup></span> (subproblems D1+D2+D3). </li></ul></div><div class="output-specification"><div class="section-title">Output</div><p>Print <span class="tex-span"><i>q</i></span> lines. Each line should contain two integers — the Beaveractor's coordinates at the final moment of time for each plan. If the Smart Beaver manages to leave the campus in time <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub></span>, print the coordinates of the last point in the campus he visited.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3 3<br />0 0 0 1<br />0 2 2 2<br />3 3 2 3<br />12<br />0 0 L 0<br />0 0 L 1<br />0 0 L 2<br />0 0 L 3<br />0 0 L 4<br />0 0 L 5<br />0 0 L 6<br />2 0 U 2<br />2 0 U 3<br />3 0 U 5<br />1 3 D 2<br />1 3 R 2<br /></pre></div><div class="output"><div class="title">Output</div><pre>0 0<br />0 1<br />0 2<br />1 2<br />2 2<br />3 2<br />3 2<br />2 2<br />3 2<br />1 3<br />2 2<br />1 3<br /></pre></div></div></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=D1]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/55432");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="D2" data-uuid="ps_4d24b5257ac0c3fc9568ef2f5211c40809da3af8">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D2. Escaping on Beaveractor</div><div class="time-limit"><div class="property-title">time limit per test</div>6 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>512 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Don't put up with what you're sick of! The Smart Beaver decided to escape from the campus of Beaver Science Academy (BSA). BSA is a <span class="tex-span"><i>b</i> × <i>b</i></span> square on a plane. Each point <span class="tex-span"><i>x</i>, <i>y</i></span> <span class="tex-span">(0 ≤ <i>x</i>, <i>y</i> ≤ <i>b</i>)</span> belongs to BSA. To make the path quick and funny, the Beaver constructed a Beaveractor, an effective and comfortable types of transport.</p><p>The campus obeys traffic rules: there are <span class="tex-span"><i>n</i></span> arrows, parallel to the coordinate axes. The arrows do not intersect and do not touch each other. When the Beaveractor reaches some arrow, it turns in the arrow's direction and moves on until it either reaches the next arrow or gets outside the campus. The Beaveractor covers exactly one unit of space per one unit of time. You can assume that there are no obstacles to the Beaveractor.</p><p>The BSA scientists want to transport the brand new Beaveractor to the &quot;Academic Tractor&quot; research institute and send the Smart Beaver to do his postgraduate studies and sharpen pencils. They have <span class="tex-span"><i>q</i></span> plans, representing the Beaveractor's initial position <span class="tex-span">(<i>x</i><sub class="lower-index"><i>i</i></sub>, <i>y</i><sub class="lower-index"><i>i</i></sub>)</span>, the initial motion vector <span class="tex-span"><i>w</i><sub class="lower-index"><i>i</i></sub></span> and the time <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub></span> that have passed after the escape started.</p><p>Your task is for each of the <span class="tex-span"><i>q</i></span> plans to determine the Smart Beaver's position after the given time.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains two integers: the number of traffic rules <span class="tex-span"><i>n</i></span> and the size of the campus <span class="tex-span"><i>b</i></span>, <span class="tex-span">0 ≤ <i>n</i></span>, <span class="tex-span">1 ≤ <i>b</i></span>. Next <span class="tex-span"><i>n</i></span> lines contain the rules. Each line of the rules contains four space-separated integers <span class="tex-span"><i>x</i><sub class="lower-index">0</sub></span>, <span class="tex-span"><i>y</i><sub class="lower-index">0</sub></span>, <span class="tex-span"><i>x</i><sub class="lower-index">1</sub></span>, <span class="tex-span"><i>y</i><sub class="lower-index">1</sub></span> — the beginning and the end of the arrow. It is guaranteed that all arrows are parallel to the coordinate axes and have no common points. All arrows are located inside the campus, that is, <span class="tex-span">0 ≤ <i>x</i><sub class="lower-index">0</sub>, <i>y</i><sub class="lower-index">0</sub>, <i>x</i><sub class="lower-index">1</sub>, <i>y</i><sub class="lower-index">1</sub> ≤ <i>b</i></span> holds.</p><p>Next line contains integer <span class="tex-span"><i>q</i></span> — the number of plans the scientists have, <span class="tex-span">1 ≤ <i>q</i> ≤ 10<sup class="upper-index">5</sup></span>. The <span class="tex-span"><i>i</i></span>-th plan is represented by two integers, <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub></span> are the Beaveractor's coordinates at the initial time, <span class="tex-span">0 ≤ <i>x</i><sub class="lower-index"><i>i</i></sub>, <i>y</i><sub class="lower-index"><i>i</i></sub> ≤ <i>b</i></span>, character <span class="tex-span"><i>w</i><sub class="lower-index"><i>i</i></sub></span>, that takes value <span class="tex-font-style-tt">U</span>, <span class="tex-font-style-tt">D</span>, <span class="tex-font-style-tt">L</span>, <span class="tex-font-style-tt">R</span> and sets the initial direction up, down, to the left or to the right correspondingly (the Y axis is directed upwards), and <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub></span> — the time passed after the escape started, <span class="tex-span">0 ≤ <i>t</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">15</sup></span>.</p><ul> <li> to get 30 points you need to solve the problem with constraints <span class="tex-span"><i>n</i>, <i>b</i> ≤ 30</span> (subproblem D1); </li><li> to get 60 points you need to solve the problem with constraints <span class="tex-span"><i>n</i>, <i>b</i> ≤ 1000</span> (subproblems D1+D2); </li><li> to get 100 points you need to solve the problem with constraints <span class="tex-span"><i>n</i>, <i>b</i> ≤ 10<sup class="upper-index">5</sup></span> (subproblems D1+D2+D3). </li></ul></div><div class="output-specification"><div class="section-title">Output</div><p>Print <span class="tex-span"><i>q</i></span> lines. Each line should contain two integers — the Beaveractor's coordinates at the final moment of time for each plan. If the Smart Beaver manages to leave the campus in time <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub></span>, print the coordinates of the last point in the campus he visited.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3 3<br />0 0 0 1<br />0 2 2 2<br />3 3 2 3<br />12<br />0 0 L 0<br />0 0 L 1<br />0 0 L 2<br />0 0 L 3<br />0 0 L 4<br />0 0 L 5<br />0 0 L 6<br />2 0 U 2<br />2 0 U 3<br />3 0 U 5<br />1 3 D 2<br />1 3 R 2<br /></pre></div><div class="output"><div class="title">Output</div><pre>0 0<br />0 1<br />0 2<br />1 2<br />2 2<br />3 2<br />3 2<br />2 2<br />3 2<br />1 3<br />2 2<br />1 3<br /></pre></div></div></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=D2]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/55432");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="D3" data-uuid="ps_4d24b5257ac0c3fc9568ef2f5211c40809da3af8">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D3. Escaping on Beaveractor</div><div class="time-limit"><div class="property-title">time limit per test</div>6 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>512 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Don't put up with what you're sick of! The Smart Beaver decided to escape from the campus of Beaver Science Academy (BSA). BSA is a <span class="tex-span"><i>b</i> × <i>b</i></span> square on a plane. Each point <span class="tex-span"><i>x</i>, <i>y</i></span> <span class="tex-span">(0 ≤ <i>x</i>, <i>y</i> ≤ <i>b</i>)</span> belongs to BSA. To make the path quick and funny, the Beaver constructed a Beaveractor, an effective and comfortable types of transport.</p><p>The campus obeys traffic rules: there are <span class="tex-span"><i>n</i></span> arrows, parallel to the coordinate axes. The arrows do not intersect and do not touch each other. When the Beaveractor reaches some arrow, it turns in the arrow's direction and moves on until it either reaches the next arrow or gets outside the campus. The Beaveractor covers exactly one unit of space per one unit of time. You can assume that there are no obstacles to the Beaveractor.</p><p>The BSA scientists want to transport the brand new Beaveractor to the &quot;Academic Tractor&quot; research institute and send the Smart Beaver to do his postgraduate studies and sharpen pencils. They have <span class="tex-span"><i>q</i></span> plans, representing the Beaveractor's initial position <span class="tex-span">(<i>x</i><sub class="lower-index"><i>i</i></sub>, <i>y</i><sub class="lower-index"><i>i</i></sub>)</span>, the initial motion vector <span class="tex-span"><i>w</i><sub class="lower-index"><i>i</i></sub></span> and the time <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub></span> that have passed after the escape started.</p><p>Your task is for each of the <span class="tex-span"><i>q</i></span> plans to determine the Smart Beaver's position after the given time.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains two integers: the number of traffic rules <span class="tex-span"><i>n</i></span> and the size of the campus <span class="tex-span"><i>b</i></span>, <span class="tex-span">0 ≤ <i>n</i></span>, <span class="tex-span">1 ≤ <i>b</i></span>. Next <span class="tex-span"><i>n</i></span> lines contain the rules. Each line of the rules contains four space-separated integers <span class="tex-span"><i>x</i><sub class="lower-index">0</sub></span>, <span class="tex-span"><i>y</i><sub class="lower-index">0</sub></span>, <span class="tex-span"><i>x</i><sub class="lower-index">1</sub></span>, <span class="tex-span"><i>y</i><sub class="lower-index">1</sub></span> — the beginning and the end of the arrow. It is guaranteed that all arrows are parallel to the coordinate axes and have no common points. All arrows are located inside the campus, that is, <span class="tex-span">0 ≤ <i>x</i><sub class="lower-index">0</sub>, <i>y</i><sub class="lower-index">0</sub>, <i>x</i><sub class="lower-index">1</sub>, <i>y</i><sub class="lower-index">1</sub> ≤ <i>b</i></span> holds.</p><p>Next line contains integer <span class="tex-span"><i>q</i></span> — the number of plans the scientists have, <span class="tex-span">1 ≤ <i>q</i> ≤ 10<sup class="upper-index">5</sup></span>. The <span class="tex-span"><i>i</i></span>-th plan is represented by two integers, <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub></span> are the Beaveractor's coordinates at the initial time, <span class="tex-span">0 ≤ <i>x</i><sub class="lower-index"><i>i</i></sub>, <i>y</i><sub class="lower-index"><i>i</i></sub> ≤ <i>b</i></span>, character <span class="tex-span"><i>w</i><sub class="lower-index"><i>i</i></sub></span>, that takes value <span class="tex-font-style-tt">U</span>, <span class="tex-font-style-tt">D</span>, <span class="tex-font-style-tt">L</span>, <span class="tex-font-style-tt">R</span> and sets the initial direction up, down, to the left or to the right correspondingly (the Y axis is directed upwards), and <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub></span> — the time passed after the escape started, <span class="tex-span">0 ≤ <i>t</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">15</sup></span>.</p><ul> <li> to get 30 points you need to solve the problem with constraints <span class="tex-span"><i>n</i>, <i>b</i> ≤ 30</span> (subproblem D1); </li><li> to get 60 points you need to solve the problem with constraints <span class="tex-span"><i>n</i>, <i>b</i> ≤ 1000</span> (subproblems D1+D2); </li><li> to get 100 points you need to solve the problem with constraints <span class="tex-span"><i>n</i>, <i>b</i> ≤ 10<sup class="upper-index">5</sup></span> (subproblems D1+D2+D3). </li></ul></div><div class="output-specification"><div class="section-title">Output</div><p>Print <span class="tex-span"><i>q</i></span> lines. Each line should contain two integers — the Beaveractor's coordinates at the final moment of time for each plan. If the Smart Beaver manages to leave the campus in time <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub></span>, print the coordinates of the last point in the campus he visited.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3 3<br />0 0 0 1<br />0 2 2 2<br />3 3 2 3<br />12<br />0 0 L 0<br />0 0 L 1<br />0 0 L 2<br />0 0 L 3<br />0 0 L 4<br />0 0 L 5<br />0 0 L 6<br />2 0 U 2<br />2 0 U 3<br />3 0 U 5<br />1 3 D 2<br />1 3 R 2<br /></pre></div><div class="output"><div class="title">Output</div><pre>0 0<br />0 1<br />0 2<br />1 2<br />2 2<br />3 2<br />3 2<br />2 2<br />3 2<br />1 3<br />2 2<br />1 3<br /></pre></div></div></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=D3]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/55432");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="E1" data-uuid="ps_75c6ddf783825cc05549c8c566c3de81b402eacb">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E1. Deja Vu</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Everybody knows that we have been living in the Matrix for a long time. And in the new seventh Matrix the world is ruled by beavers.</p><p>So let's take beaver Neo. Neo has so-called &quot;deja vu&quot; outbursts when he gets visions of events in some places he's been at or is going to be at. Let's examine the phenomenon in more detail.</p><p>We can say that Neo's city is represented by a directed graph, consisting of <span class="tex-span"><i>n</i></span> shops and <span class="tex-span"><i>m</i></span> streets that connect the shops. No two streets connect the same pair of shops (besides, there can't be one street from A to B and one street from B to A). No street connects a shop with itself. As Neo passes some streets, he gets visions. No matter how many times he passes street <span class="tex-span"><i>k</i></span>, every time he will get the same visions in the same order. A vision is a sequence of shops.</p><p>We know that Neo is going to get really shocked if he passes the way from some shop <span class="tex-span"><i>a</i></span> to some shop <span class="tex-span"><i>b</i></span>, possible coinciding with <span class="tex-span"><i>a</i></span>, such that the list of visited shops in the real life and in the visions coincide.</p><p>Suggest beaver Neo such path of non-zero length. Or maybe you can even count the number of such paths modulo <span class="tex-span">1000000007</span> <span class="tex-span">(10<sup class="upper-index">9</sup> + 7)</span>?..</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>m</i></span> — the number of shops and the number of streets, correspondingly, <span class="tex-span">1 ≤ <i>n</i> ≤ 50</span>, <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/8ea7e8d4963d7e2e692b960f3208e1550d376981.png" style="max-width: 100.0%;max-height: 100.0%;" />. Next <span class="tex-span"><i>m</i></span> lines contain the descriptions of the streets in the following format: <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span"><i>k</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span"><i>v</i><sub class="lower-index">1</sub></span> <span class="tex-span"><i>v</i><sub class="lower-index">2</sub></span> ... <span class="tex-span"><i>v</i><sub class="lower-index"><i>k</i></sub></span>, where <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span">(1 ≤ <i>x</i><sub class="lower-index"><i>i</i></sub>, <i>y</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i>, <i>x</i><sub class="lower-index"><i>i</i></sub> ≠ <i>y</i><sub class="lower-index"><i>i</i></sub>)</span> are indices of shops connected by a street, <span class="tex-span"><i>k</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span">(0 ≤ <i>k</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i>)</span> is the number of visions on the way from <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> to <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub></span>; <span class="tex-span"><i>v</i><sub class="lower-index">1</sub></span>, <span class="tex-span"><i>v</i><sub class="lower-index">2</sub></span>, ..., <span class="tex-span"><i>v</i><sub class="lower-index"><i>k</i></sub></span> <span class="tex-span">(1 ≤ <i>v</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i>)</span> describe the visions: the numbers of the shops Neo saw. Note that the order of the visions matters.</p><p>It is guaranteed that the total number of visions on all streets doesn't exceed <span class="tex-span">10<sup class="upper-index">5</sup></span>.</p><ul> <li> to get 50 points, you need to find any (not necessarily simple) path of length at most <span class="tex-span">2·<i>n</i></span>, that meets the attributes described above (subproblem E1); </li><li> to get 50 more points, you need to count for each length from <span class="tex-span">1</span> to <span class="tex-span">2·<i>n</i></span> the number of paths that have the attribute described above (subproblem E2). </li></ul></div><div class="output-specification"><div class="section-title">Output</div><p>Subproblem E1. In the first line print an integer <span class="tex-span"><i>k</i></span> <span class="tex-span">(1 ≤ <i>k</i> ≤ 2·<i>n</i>)</span> — the numbers of shops on Neo's path. In the next line print <span class="tex-span"><i>k</i></span> integers — the number of shops in the order Neo passes them. If the graph doesn't have such paths or the length of the shortest path includes more than <span class="tex-span">2·<i>n</i></span> shops, print on a single line <span class="tex-span">0</span>.</p><p>Subproblem E2. Print <span class="tex-span">2·<i>n</i></span> lines. The <span class="tex-span"><i>i</i></span>-th line must contain a single integer — the number of required paths of length <span class="tex-span"><i>i</i></span> modulo <span class="tex-span">1000000007</span> <span class="tex-span">(10<sup class="upper-index">9</sup> + 7)</span>.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>6 6<br />1 2 2 1 2<br />2 3 1 3<br />3 4 2 4 5<br />4 5 0<br />5 3 1 3<br />6 1 1 6<br /></pre></div><div class="output"><div class="title">Output</div><pre>4<br />6 1 2 3<br /></pre></div><div class="input"><div class="title">Input</div><pre>6 6<br />1 2 2 1 2<br />2 3 1 3<br />3 4 2 4 5<br />4 5 0<br />5 3 1 3<br />6 1 1 6<br /></pre></div><div class="output"><div class="title">Output</div><pre>1<br />2<br />1<br />1<br />2<br />1<br />1<br />2<br />1<br />1<br />2<br />1</pre></div></div></div><div class="note"><div class="section-title">Note</div><p>The input in both samples are the same. The first sample contains the answer to the first subproblem, the second sample contains the answer to the second subproblem.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=E1]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/55432");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 1em;"
        >


<div class="problemindexholder" problemindex="E2" data-uuid="ps_b0086f5da8747486ee87e29a87f6aac4dcb4db39">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E2. Deja Vu</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Everybody knows that we have been living in the Matrix for a long time. And in the new seventh Matrix the world is ruled by beavers.</p><p>So let's take beaver Neo. Neo has so-called &quot;deja vu&quot; outbursts when he gets visions of events in some places he's been at or is going to be at. Let's examine the phenomenon in more detail.</p><p>We can say that Neo's city is represented by a directed graph, consisting of <span class="tex-span"><i>n</i></span> shops and <span class="tex-span"><i>m</i></span> streets that connect the shops. No two streets connect the same pair of shops (besides, there can't be one street from A to B and one street from B to A). No street connects a shop with itself. As Neo passes some streets, he gets visions. No matter how many times he passes street <span class="tex-span"><i>k</i></span>, every time he will get the same visions in the same order. A vision is a sequence of shops.</p><p>We know that Neo is going to get really shocked if he passes the way from some shop <span class="tex-span"><i>a</i></span> to some shop <span class="tex-span"><i>b</i></span>, possible coinciding with <span class="tex-span"><i>a</i></span>, such that the list of visited shops in the real life and in the visions coincide.</p><p>Suggest beaver Neo such path of non-zero length. Or maybe you can even count the number of such paths modulo <span class="tex-span">1000000007</span> <span class="tex-span">(10<sup class="upper-index">9</sup> + 7)</span>?..</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>m</i></span> — the number of shops and the number of streets, correspondingly, <span class="tex-span">1 ≤ <i>n</i> ≤ 50</span>, <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/8ea7e8d4963d7e2e692b960f3208e1550d376981.png" style="max-width: 100.0%;max-height: 100.0%;" />. Next <span class="tex-span"><i>m</i></span> lines contain the descriptions of the streets in the following format: <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span"><i>k</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span"><i>v</i><sub class="lower-index">1</sub></span> <span class="tex-span"><i>v</i><sub class="lower-index">2</sub></span> ... <span class="tex-span"><i>v</i><sub class="lower-index"><i>k</i></sub></span>, where <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span">(1 ≤ <i>x</i><sub class="lower-index"><i>i</i></sub>, <i>y</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i>, <i>x</i><sub class="lower-index"><i>i</i></sub> ≠ <i>y</i><sub class="lower-index"><i>i</i></sub>)</span> are numbers of shops connected by a street, <span class="tex-span"><i>k</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span">(0 ≤ <i>k</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i>)</span> is the number of visions on the way from <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> to <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub></span>; <span class="tex-span"><i>v</i><sub class="lower-index">1</sub></span>, <span class="tex-span"><i>v</i><sub class="lower-index">2</sub></span>, ..., <span class="tex-span"><i>v</i><sub class="lower-index"><i>k</i></sub></span> <span class="tex-span">(1 ≤ <i>v</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i>)</span> describe the visions: the numbers of the shops Neo saw. Note that the order of the visions matters.</p><p>It is guaranteed that the total number of visions on all streets doesn't exceed <span class="tex-span">10<sup class="upper-index">5</sup></span>.</p><ul> <li> to get 50 points, you need to find any (not necessarily simple) path of length at most <span class="tex-span">2·<i>n</i></span>, that meets the attributes described above (subproblem E1); </li><li> to get 50 more points, you need to count for each length from <span class="tex-span">1</span> to <span class="tex-span">2·<i>n</i></span> the number of paths that have the attribute described above (subproblem E2). </li></ul></div><div class="output-specification"><div class="section-title">Output</div><p>Subproblem E1. In the first line print an integer <span class="tex-span"><i>k</i></span> <span class="tex-span">(1 ≤ <i>k</i> ≤ 2·<i>n</i>)</span> — the numbers of shops on Neo's path. In the next line print <span class="tex-span"><i>k</i></span> integers — the number of shops in the order Neo passes them. If the graph doesn't have such paths or the length of the shortest path includes more than <span class="tex-span">2·<i>n</i></span> shops, print on a single line <span class="tex-span">0</span>.</p><p>Subproblem E2. Print <span class="tex-span">2·<i>n</i></span> lines. The <span class="tex-span"><i>i</i></span>-th line must contain a single integer — the number of required paths of length <span class="tex-span"><i>i</i></span> modulo <span class="tex-span">1000000007</span> <span class="tex-span">(10<sup class="upper-index">9</sup> + 7)</span>.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>6 6<br />1 2 2 1 2<br />2 3 1 3<br />3 4 2 4 5<br />4 5 0<br />5 3 1 3<br />6 1 1 6<br /></pre></div><div class="output"><div class="title">Output</div><pre>4<br />6 1 2 3<br /></pre></div><div class="input"><div class="title">Input</div><pre>6 6<br />1 2 2 1 2<br />2 3 1 3<br />3 4 2 4 5<br />4 5 0<br />5 3 1 3<br />6 1 1 6<br /></pre></div><div class="output"><div class="title">Output</div><pre>1<br />2<br />1<br />1<br />2<br />1<br />1<br />2<br />1<br />1<br />2<br />1</pre></div></div></div><div class="note"><div class="section-title">Note</div><p>The input in both samples are the same. The first sample contains the answer to the first subproblem, the second sample contains the answer to the second subproblem.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=E2]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/55432");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
    </div>

    <div id="footer">
        <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2024 Mike Mirzayanov</div>
        <div>The only programming contests Web 2.0 platform</div>

    </div>

</div>
</div>
    <script type="application/javascript">
        if ('serviceWorker' in navigator && 'fetch' in window && 'caches' in window) {
            navigator.serviceWorker.register('/service-worker-55432.js')
                .then(function (registration) {
                    console.log('Service worker registered: ', registration);
                })
                .catch(function (error) {
                    console.log('Registration failed: ', error);
                });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'89f787688da77784',t:'MTcyMDM1MjEwNC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

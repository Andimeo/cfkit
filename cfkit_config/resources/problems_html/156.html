
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-743380-5"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-743380-5');
        </script>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="0443da176539ffb9874f965d569f3de3"/>
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01"/>

    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery-1.8.3.js"></script>
    <script type="application/javascript">
        window.locale = "en";
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }

        /* Protection against trailing dot in domain. */
        let hostLength = window.location.host.length;
        if (hostLength > 1 && window.location.host[hostLength - 1] === '.') {
            window.location = window.location.protocol + "//" + window.location.host.substring(0, hostLength - 1);
        }
    </script>

    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="j2">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="//codeforces.org/s/49284/images/codeforces-sponsored-by-ton.png" />
    <link rel="image_src" href="//codeforces.org/s/49284/images/codeforces-sponsored-by-ton.png" />
    <meta property="og:title" content="Problems - Codeforces"/>
    <meta property="og:description" content=""/>
    
    <meta property="og:site_name" content="Codeforces"/>
    
    
    
    
    
    
    <meta name="utc_offset" content="+03:00"/>
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Problems - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community" />
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup" />
    <meta name="robots" content="index, follow" />

    <link rel="stylesheet" href="//codeforces.org/s/49284/css/font-awesome.min.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/line-awesome.min.css" type="text/css" charset="utf-8" />

        <link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>


    <link rel="apple-touch-icon" sizes="57x57" href="//codeforces.org/s/49284/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="//codeforces.org/s/49284/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="//codeforces.org/s/49284/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="//codeforces.org/s/49284/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="//codeforces.org/s/49284/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="//codeforces.org/s/49284/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="//codeforces.org/s/49284/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="//codeforces.org/s/49284/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="//codeforces.org/s/49284/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="//codeforces.org/s/49284/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="//codeforces.org/s/49284/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="//codeforces.org/s/49284/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="//codeforces.org/s/49284/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="//codeforces.org/s/49284/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/prettify.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/clear.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/ttypography.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/problem-statement.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/second-level-menu.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/roundbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/datatable.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/table-form.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/topic.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/jquery.jgrowl.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/facebox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/jquery.wysiwyg.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/jquery.autocomplete.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/codeforces.datepick.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/colorbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/jquery.drafts.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/49284/css/community.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/49284/css/sidebar-menu.css" type="text/css" charset="utf-8" />

    <!-- MathJax -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    MathJax.Hub.Register.StartupHook("End", function () {
        Codeforces.runMathJaxListeners();
    });
    </script>
    <script type="text/javascript" async
            src="https://mathjax.codeforces.org/MathJax.js?config=TeX-AMS_HTML-full"
    >
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="//codeforces.org/s/49284/js/prettify/prettify.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/pushstream.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.easing.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.swipe.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.hotkeys.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/facebox.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/controls/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/controls/wysiwyg.table.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/controls/wysiwyg.image.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/controls/wysiwyg.link.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.datepick.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.drafts.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/clipboard.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/autosize.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/sjcl.js"></script>
    <script type="text/javascript" src="/scripts/7fbe203c3ac496959a36220db411efde/en/codeforces-options.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/codeforces.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/EventCatcher.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/preparedVerdictFormats-en.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/confetti.min.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="//codeforces.org/s/49284/markitup/skins/markitup/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/markitup/sets/markdown/style.css" type="text/css" charset="utf-8" />


    <script type="text/javascript" src="//codeforces.org/s/49284/markitup/jquery.markitup.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/markitup/sets/markdown/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->




</head>
<body class=" "><span style='display:none;' class='csrf-token' data-csrf='0443da176539ffb9874f965d569f3de3'>&nbsp;</span>

<!-- .notificationTextCleaner used in Codeforces.showAnnouncements() -->
<div class="notificationTextCleaner" style="font-size: 0"></div>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 3.0rem;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    String.prototype.hashCode = function() {
        var hash = 0, i, chr;
        if (this.length === 0) return hash;
        for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };

    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile === "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>





    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 700
        });
    }, 100);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


    function showAnnouncements(json) {
        //info("j=" + JSON.stringify(json));

        if (json.t != "a") {
            return;
        }

        setTimeout(function() {
            Codeforces.showAnnouncements(json.d, "en");
        }, Math.random() * 500);
    }

    function showEventCatcherUserMessage(json) {
        if (json.t == "s") {
            var points = json.d[5];
            var passedTestCount = json.d[7];
            var judgedTestCount = json.d[8];
            var verdict = preparedVerdictFormats[json.d[12]];
            var verdictPrototypeDiv = $(".verdictPrototypeDiv");
            verdictPrototypeDiv.html(verdict);
            if (judgedTestCount != null && judgedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-judged").text(judgedTestCount);
            }
            if (passedTestCount != null && passedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-passed").text(passedTestCount);
            }
            if (points != null && points != undefined) {
                verdictPrototypeDiv.find(".verdict-format-points").text(points);
            }
            Codeforces.showMessage(verdictPrototypeDiv.text());
        }
    }

    $(".clickable-title").each(function() {
        var title = $(this).attr("data-title");
        if (title) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = title;
            $(this).attr("title", tmp.textContent || tmp.innerText || "");
        }
    });

    $(".clickable-title").click(function() {
        var title = $(this).attr("data-title");
        if (title) {
            Codeforces.alert(title);
        } else {
            Codeforces.alert($(this).attr("title"));
        }
    }).css("position", "relative").css("bottom", "3px");

        Codeforces.showDelayedMessage();

    Codeforces.reformatTimes();

    //Codeforces.initializePubSub();
    if (window.codeforcesOptions.subscribeServerUrl) {
        window.eventCatcher = new EventCatcher(
            window.codeforcesOptions.subscribeServerUrl,
            [
                Codeforces.getGlobalChannel(),
                Codeforces.getUserChannel(),
                Codeforces.getUserShowMessageChannel(),
                Codeforces.getContestChannel(),
                Codeforces.getParticipantChannel(),
                Codeforces.getTalkChannel()
            ]
        );

        if (Codeforces.getParticipantChannel()) {
            window.eventCatcher.subscribe(Codeforces.getParticipantChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getContestChannel()) {
            window.eventCatcher.subscribe(Codeforces.getContestChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getGlobalChannel()) {
            window.eventCatcher.subscribe(Codeforces.getGlobalChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserShowMessageChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserShowMessageChannel(), function(json) {
                showEventCatcherUserMessage(json);
            });
        }
    }

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>


<div id="body">
<div style="width: 950px; margin: 0 auto;" class="compact-problemset">
    <div id="header" style="position: relative; margin: 0;">
        <div style="float:left;">
                  <a href="/"><img height="65" style="height: 65px;" src="//codeforces.org/s/49284/images/codeforces-sponsored-by-ton.png" alt="Codeforces"/></a>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="//codeforces.org/s/49284/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="//codeforces.org/s/49284/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <br style="clear: both;"/>

    <div style="text-align: center; font-size: 1.8rem; margin-bottom: 0.5em;"
         class="caption">Codeforces Round 110 (Div. 1)</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

    <div class="problem-frames">
        <div
                    style="margin-bottom: 2em;"
        >

    <style>
        #facebox .content:has(.diff-popup) {
            width: 90vw;
            max-width: 120rem !important;
        }

        .testCaseMarker {
            position: absolute;
            font-weight: bold;
            font-size: 1rem;
        }

        .diff-popup {
            width: 90vw;
            max-width: 120rem !important;
            display: none;
            overflow: auto;
        }

        .input-output-copier {
            font-size: 1.2rem;
            float: right;
            color: #888 !important;
            cursor: pointer;
            border: 1px solid rgb(185, 185, 185);
            padding: 3px;
            margin: 1px;
            line-height: 1.1rem;
            text-transform: none;
        }

        .input-output-copier:hover {
            background-color: #def;
        }

        .test-explanation textarea {
            width: 100%;
            height: 1.5em;
        }

        .pending-submission-message {
            color: darkorange !important;
        }
    </style>
    <script>
        const OPENING_SPACE = String.fromCharCode(1001);
        const CLOSING_SPACE = String.fromCharCode(1002);

        const nodeToText = function (node, pre) {
            let result = [];

            if (node.tagName === "SCRIPT" || node.tagName === "math"
                || (node.classList && node.classList.contains("input-output-copier")))
                return [];

            if (node.tagName === "NOBR") {
                result.push(OPENING_SPACE);
            }

            if (node.nodeType === Node.TEXT_NODE) {
                let s = node.textContent;
                if (!pre) {
                    s = s.replace(/\s+/g, " ");
                }
                if (s.length > 0) {
                    result.push(s);
                }
            }

            if (pre && node.tagName === "BR") {
                result.push("\n");
            }

            node.childNodes.forEach(function (child) {
                result.push(nodeToText(child, node.tagName === "PRE").join(""));
            });

            if (node.tagName === "DIV"
                || node.tagName === "P"
                || node.tagName === "PRE"
                || node.tagName === "UL"
                || node.tagName === "LI"
            ) {
                result.push("\n");
            }

            if (node.tagName === "NOBR") {
                result.push(CLOSING_SPACE);
            }

            return result;
        }

        const isSpecial = function (c) {
            return c === ',' || c === '.' || c === ';' || c === ')' || c === ' ';
        }

        const convertStatementToText = function(statmentNode) {
            const text = nodeToText(statmentNode, false).join("").replace(/ +/g, " ").replace(/\n\n+/g, "\n\n");
            let result = [];
            for (let i = 0; i < text.length; i++) {
                const c = text.charAt(i);
                if (c === OPENING_SPACE) {
                    if (!((i > 0 && text.charAt(i - 1) === '(') || (result.length > 0 && result[result.length - 1] === ' '))) {
                        result.push('+');
                    }
                } else if (c === CLOSING_SPACE) {
                    if (!(i + 1 < text.length && isSpecial(text.charAt(i + 1)))) {
                        result.push('-');
                    }
                } else {
                    result.push(c);
                }
            }
            return result.join("").split("\n").map(value => value.trim()).join("\n");
        };
    </script>
    <div class="diff-popup">
    </div>

<div class="problemindexholder" problemindex="A" data-uuid="ps_37a7ddd399e88cf606fe60bc5b5a9313abef02c0">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A. Message</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Dr. Moriarty is about to send a message to Sherlock Holmes. He has a string <span class="tex-span"><i>s</i></span>. </p><p>String <span class="tex-span"><i>p</i></span> is called a <span class="tex-font-style-it">substring</span> of string <span class="tex-span"><i>s</i></span> if you can read it starting from some position in the string <span class="tex-span"><i>s</i></span>. For example, string &quot;<span class="tex-font-style-tt">aba</span>&quot; has six substrings: &quot;<span class="tex-font-style-tt">a</span>&quot;, &quot;<span class="tex-font-style-tt">b</span>&quot;, &quot;<span class="tex-font-style-tt">a</span>&quot;, &quot;<span class="tex-font-style-tt">ab</span>&quot;, &quot;<span class="tex-font-style-tt">ba</span>&quot;, &quot;<span class="tex-font-style-tt">aba</span>&quot;.</p><p>Dr. Moriarty plans to take string <span class="tex-span"><i>s</i></span> and cut out some substring from it, let's call it <span class="tex-span"><i>t</i></span>. Then he needs to <span class="tex-font-style-underline">change</span> the substring <span class="tex-span"><i>t</i></span> zero or more times. As a result, he should obtain a fixed string <span class="tex-span"><i>u</i></span> (which is the string that should be sent to Sherlock Holmes). One change is defined as making one of the following actions: </p><ul> <li> Insert one letter to any end of the string. </li><li> Delete one letter from any end of the string. </li><li> Change one letter into any other one. </li></ul><p>Moriarty is very smart and after he chooses some substring <span class="tex-span"><i>t</i></span>, he always makes the minimal number of changes to obtain <span class="tex-span"><i>u</i></span>. </p><p>Help Moriarty choose the best substring <span class="tex-span"><i>t</i></span> from all substrings of the string <span class="tex-span"><i>s</i></span>. The substring <span class="tex-span"><i>t</i></span> should minimize the number of changes Moriarty should make to obtain the string <span class="tex-span"><i>u</i></span> from it.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains a non-empty string <span class="tex-span"><i>s</i></span>, consisting of lowercase Latin letters. The second line contains a non-empty string <span class="tex-span"><i>u</i></span>, consisting of lowercase Latin letters. The lengths of both strings are in the range from <span class="tex-span">1</span> to <span class="tex-span">2000</span>, inclusive.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print the only integer — the minimum number of changes that Dr. Moriarty has to make with the string that you choose.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>aaaaa<br />aaa<br /></pre></div><div class="output"><div class="title">Output</div><pre>0<br /></pre></div><div class="input"><div class="title">Input</div><pre>abcabc<br />bcd<br /></pre></div><div class="output"><div class="title">Output</div><pre>1<br /></pre></div><div class="input"><div class="title">Input</div><pre>abcdef<br />klmnopq<br /></pre></div><div class="output"><div class="title">Output</div><pre>7<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample Moriarty can take any substring of length <span class="tex-span">3</span>, and it will be equal to the required message <span class="tex-span"><i>u</i></span>, so Moriarty won't have to make any changes.</p><p>In the second sample you should take a substring consisting of characters from second to fourth (&quot;<span class="tex-font-style-tt">bca</span>&quot;) or from fifth to sixth (&quot;<span class="tex-font-style-tt">bc</span>&quot;). Then you will only have to make one change: to change or to add the last character.</p><p>In the third sample the initial string <span class="tex-span"><i>s</i></span> doesn't contain any character that the message should contain, so, whatever string you choose, you will have to make at least <span class="tex-span">7</span> changes to obtain the required message.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=A]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/49284");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {
        window.changedTests = new Set();

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");



        String.prototype.replaceAll = function (search, replace) {
            return this.split(search).join(replace);
        };

        $(".sample-test .title").each(function () {
            const preId = ("id" + Math.random()).replaceAll(".", "0");
            const cpyId = ("id" + Math.random()).replaceAll(".", "0");

            $(this).parent().find("pre").attr("id", preId);
            const $copy = $("<div title='Copy' data-clipboard-target='#" + preId + "' id='" + cpyId + "' class='input-output-copier'>Copy</div>");
            $(this).append($copy);

            const clipboard = new Clipboard('#' + cpyId, {
                text: function (trigger) {
                    const pre = document.querySelector('#' + preId);
                    const lines = pre.querySelectorAll(".test-example-line");
                    return Codeforces.filterClipboardText(pre.innerText, lines.length);
                }
            });

            const isInput = $(this).parent().hasClass("input");

            clipboard.on('success', function (e) {
                if (isInput) {
                    Codeforces.showMessage("The example input has been copied into the clipboard");
                } else {
                    Codeforces.showMessage("The example output has been copied into the clipboard");
                }
                e.clearSelection();
            });
        });

        $(".test-form-item input").change(function () {
            addPendingSubmissionMessage($($(this).closest("form")), "You changed the answer, do not forget to submit it if you want to save the changes");
            const index = $(this).closest(".problemindexholder").attr("problemindex");
            let test = "";
            $(this).closest("form input").each(function () {
                const test_ = $(this).attr("name");
                if (test_ && test_.substring(0, 4) === "test") {
                    test = test_;
                }
            });
            if (index.length > 0 && test.length > 0) {
                const indexTest = index + "::" + test;
                window.changedTests.add(indexTest);
            }
        });

        $(window).on('beforeunload', function () {
            if (window.changedTests.size > 0) {
                return 'Dialog text here';
            }
        });

        autosize($('.test-explanation textarea'));

        $(".test-example-line").hover(function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        let top = 1E20;
                        let left = 1E20;
                        let problem = $(this).closest(".problemindexholder");
                        $(this).closest(".input").find("." + clazz).css("background-color", "#FFFDE7").each(function() {
                            top = Math.min(top, $(this).offset().top);
                            left = Math.min(left, $(this).offset().left);
                        });
                        let testCaseMarker = problem.find(".testCaseMarker_" + end);
                        if (testCaseMarker.length === 0) {
                            const html = "<div class=\"testCaseMarker testCaseMarker_" + end + " notice\"></div>";
                            problem.append($(html));
                            testCaseMarker = problem.find(".testCaseMarker_" + end);
                        }
                        if (testCaseMarker) {
                            testCaseMarker.show()
                                    .offset({top, left: left - 20})
                                    .text(end);
                        }
                    }
                }
            });
        }, function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        $("." + clazz).css("background-color", "");
                        $(this).closest(".problemindexholder").find(".testCaseMarker_" + end).hide();
                    }
                }
            });
        });

    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="B" data-uuid="ps_980834aa9870281b751e28adf035f775d776caea">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B. Suspects</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>As Sherlock Holmes was investigating a crime, he identified <span class="tex-span"><i>n</i></span> suspects. He knows for sure that exactly one of them committed the crime. To find out which one did it, the detective lines up the suspects and numbered them from <span class="tex-span">1</span> to <span class="tex-span"><i>n</i></span>. After that, he asked each one: &quot;Which one committed the crime?&quot;. Suspect number <span class="tex-span"><i>i</i></span> answered either &quot;The crime was committed by suspect number <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>&quot;, or &quot;Suspect number <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> didn't commit the crime&quot;. Also, the suspect could say so about himself (<span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub> = <i>i</i></span>).</p><p>Sherlock Holmes understood for sure that exactly <span class="tex-span"><i>m</i></span> answers were the truth and all other answers were a lie. Now help him understand this: which suspect lied and which one told the truth?</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains two integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>m</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup>, 0 ≤ <i>m</i> ≤ <i>n</i></span>) — the total number of suspects and the number of suspects who told the truth. Next <span class="tex-span"><i>n</i></span> lines contain the suspects' answers. The <span class="tex-span"><i>i</i></span>-th line contains either &quot;+<span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>&quot; (without the quotes), if the suspect number <span class="tex-span"><i>i</i></span> says that the crime was committed by suspect number <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>, or &quot;-<span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>&quot; (without the quotes), if the suspect number <span class="tex-span"><i>i</i></span> says that the suspect number <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> didn't commit the crime (<span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> is an integer, <span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i></span>).</p><p>It is guaranteed that at least one suspect exists, such that if he committed the crime, then exactly <span class="tex-span"><i>m</i></span> people told the truth.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print <span class="tex-span"><i>n</i></span> lines. Line number <span class="tex-span"><i>i</i></span> should contain &quot;<span class="tex-font-style-tt">Truth</span>&quot; if suspect number <span class="tex-span"><i>i</i></span> has told the truth for sure. Print &quot;<span class="tex-font-style-tt">Lie</span>&quot; if the suspect number <span class="tex-span"><i>i</i></span> lied for sure and print &quot;<span class="tex-font-style-tt">Not defined</span>&quot; if he could lie and could tell the truth, too, depending on who committed the crime.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>1 1<br />+1<br /></pre></div><div class="output"><div class="title">Output</div><pre>Truth<br /></pre></div><div class="input"><div class="title">Input</div><pre>3 2<br />-1<br />-2<br />-3<br /></pre></div><div class="output"><div class="title">Output</div><pre>Not defined<br />Not defined<br />Not defined<br /></pre></div><div class="input"><div class="title">Input</div><pre>4 1<br />+2<br />-3<br />+4<br />-1<br /></pre></div><div class="output"><div class="title">Output</div><pre>Lie<br />Not defined<br />Lie<br />Not defined<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>The first sample has the single person and he confesses to the crime, and Sherlock Holmes knows that one person is telling the truth. That means that this person is telling the truth.</p><p>In the second sample there are three suspects and each one denies his guilt. Sherlock Holmes knows that only two of them are telling the truth. Any one of them can be the criminal, so we don't know for any of them, whether this person is telling the truth or not.</p><p>In the third sample the second and the fourth suspect defend the first and the third one. But only one is telling the truth, thus, the first or the third one is the criminal. Both of them can be criminals, so the second and the fourth one can either be lying or telling the truth. The first and the third one are lying for sure as they are blaming the second and the fourth one.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=B]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/49284");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="C" data-uuid="ps_b3ac8b0bc76fc4631e7339b8da26c0aa328b0215">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C. Cipher</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Sherlock Holmes found a mysterious correspondence of two VIPs and made up his mind to read it. But there is a problem! The correspondence turned out to be encrypted. The detective tried really hard to decipher the correspondence, but he couldn't understand anything. </p><p>At last, after some thought, he thought of something. Let's say there is a word <span class="tex-span"><i>s</i></span>, consisting of <span class="tex-span">|<i>s</i>|</span> lowercase Latin letters. Then for one <span class="tex-font-style-underline">operation</span> you can choose a certain position <span class="tex-span"><i>p</i></span> (<span class="tex-span">1 ≤ <i>p</i> &lt; |<i>s</i>|</span>) and perform one of the following actions: </p><ul> <li> either replace letter <span class="tex-span"><i>s</i><sub class="lower-index"><i>p</i></sub></span> with the one that alphabetically <span class="tex-font-style-bf">follows</span> it and replace letter <span class="tex-span"><i>s</i><sub class="lower-index"><i>p</i> + 1</sub></span> with the one that alphabetically <span class="tex-font-style-bf">precedes</span> it; </li><li> or replace letter <span class="tex-span"><i>s</i><sub class="lower-index"><i>p</i></sub></span> with the one that alphabetically <span class="tex-font-style-bf">precedes</span> it and replace letter <span class="tex-span"><i>s</i><sub class="lower-index"><i>p</i> + 1</sub></span> with the one that alphabetically <span class="tex-font-style-bf">follows</span> it. </li></ul><p>Let us note that letter &quot;<span class="tex-font-style-tt">z</span>&quot; doesn't have a defined following letter and letter &quot;<span class="tex-font-style-tt">a</span>&quot; doesn't have a defined preceding letter. That's why the corresponding changes are not acceptable. If the operation requires performing at least one unacceptable change, then such operation cannot be performed.</p><p>Two words <span class="tex-font-style-underline">coincide in their meaning</span> iff one of them can be transformed into the other one as a result of zero or more operations.</p><p>Sherlock Holmes needs to learn to quickly determine the following for each word: how many words can exist that coincide in their meaning with the given word, but differs from the given word in at least one character? Count this number for him modulo <span class="tex-span">1000000007</span> <span class="tex-span">(10<sup class="upper-index">9</sup> + 7)</span>.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The input data contains several tests. The first line contains the only integer <span class="tex-span"><i>t</i></span> (<span class="tex-span">1 ≤ <i>t</i> ≤ 10<sup class="upper-index">4</sup></span>) — the number of tests.</p><p>Next <span class="tex-span"><i>t</i></span> lines contain the words, one per line. Each word consists of lowercase Latin letters and has length from <span class="tex-span">1</span> to <span class="tex-span">100</span>, inclusive. Lengths of words can differ.</p></div><div class="output-specification"><div class="section-title">Output</div><p>For each word you should print the number of different <span class="tex-font-style-bf">other</span> words that coincide with it in their meaning — not from the words listed in the input data, but from all possible words. As the sought number can be very large, print its value modulo <span class="tex-span">1000000007</span> <span class="tex-span">(10<sup class="upper-index">9</sup> + 7)</span>.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>1<br />ab<br /></pre></div><div class="output"><div class="title">Output</div><pre>1<br /></pre></div><div class="input"><div class="title">Input</div><pre>1<br />aaaaaaaaaaa<br /></pre></div><div class="output"><div class="title">Output</div><pre>0<br /></pre></div><div class="input"><div class="title">Input</div><pre>2<br />ya<br />klmbfxzb<br /></pre></div><div class="output"><div class="title">Output</div><pre>24<br />320092793<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Some explanations about the <span class="tex-font-style-underline">operation</span>:</p><ul> <li> Note that for each letter, we can clearly define the letter that follows it. Letter &quot;<span class="tex-font-style-tt">b</span>&quot; alphabetically follows letter &quot;<span class="tex-font-style-tt">a</span>&quot;, letter &quot;<span class="tex-font-style-tt">c</span>&quot; follows letter &quot;<span class="tex-font-style-tt">b</span>&quot;, ..., &quot;<span class="tex-font-style-tt">z</span>&quot; follows letter &quot;<span class="tex-font-style-tt">y</span>&quot;. </li><li> Preceding letters are defined in the similar manner: letter &quot;<span class="tex-font-style-tt">y</span>&quot; precedes letter &quot;<span class="tex-font-style-tt">z</span>&quot;, ..., &quot;<span class="tex-font-style-tt">a</span>&quot; precedes letter &quot;<span class="tex-font-style-tt">b</span>&quot;. </li><li> Note that the operation never changes a word's length. </li></ul><p>In the first sample you can obtain the only other word &quot;<span class="tex-font-style-tt">ba</span>&quot;. In the second sample you cannot obtain any other word, so the correct answer is <span class="tex-span">0</span>.</p><p>Consider the third sample. One operation can transform word &quot;<span class="tex-font-style-tt">klmbfxzb</span>&quot; into word &quot;<span class="tex-font-style-tt">klmcexzb</span>&quot;: we should choose <span class="tex-span"><i>p</i> = 4</span>, and replace the fourth letter with the following one (&quot;<span class="tex-font-style-tt">b</span>&quot; <span class="tex-span"> → </span> &quot;<span class="tex-font-style-tt">c</span>&quot;), and the fifth one — with the preceding one (&quot;<span class="tex-font-style-tt">f</span>&quot; <span class="tex-span"> → </span> &quot;<span class="tex-font-style-tt">e</span>&quot;). Also, we can obtain many other words from this one. An operation can transform word &quot;<span class="tex-font-style-tt">ya</span>&quot; only into one other word &quot;<span class="tex-font-style-tt">xb</span>&quot;. </p><p>Word &quot;<span class="tex-font-style-tt">ya</span>&quot; coincides in its meaning with words &quot;<span class="tex-font-style-tt">xb</span>&quot;, &quot;<span class="tex-font-style-tt">wc</span>&quot;, &quot;<span class="tex-font-style-tt">vd</span>&quot;, ..., &quot;<span class="tex-font-style-tt">ay</span>&quot; (overall there are <span class="tex-span">24</span> other words). The word &quot;<span class="tex-font-style-tt">klmbfxzb</span> has many more variants — there are <span class="tex-span">3320092814</span> other words that coincide with in the meaning. So the answer for the first word equals <span class="tex-span">24</span> and for the second one equals <span class="tex-span">320092793</span> — the number <span class="tex-span">3320092814</span> modulo <span class="tex-span">10<sup class="upper-index">9</sup> + 7</span></p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=C]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/49284");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="D" data-uuid="ps_9e4e8cc5b3eba5408368aa803e16ad5ec45de902">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. Clues</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>As Sherlock Holmes was investigating another crime, he found a certain number of clues. Also, he has already found <span class="tex-font-style-underline">direct links</span> between some of those clues. The direct links between the clues are mutual. That is, the direct link between clues <span class="tex-span"><i>A</i></span> and <span class="tex-span"><i>B</i></span> and the direct link between clues <span class="tex-span"><i>B</i></span> and <span class="tex-span"><i>A</i></span> is the same thing. No more than one direct link can exist between two clues.</p><p>Of course Sherlock is able to find direct links between all clues. But it will take too much time and the criminals can use this extra time to hide. To solve the crime, Sherlock needs each clue to be linked to all other clues (maybe not directly, via some other clues). Clues <span class="tex-span"><i>A</i></span> and <span class="tex-span"><i>B</i></span> are considered linked either if there is a direct link between them or if there is a direct link between <span class="tex-span"><i>A</i></span> and some other clue <span class="tex-span"><i>C</i></span> which is linked to <span class="tex-span"><i>B</i></span>. </p><p>Sherlock Holmes counted the minimum number of additional direct links that he needs to find to solve the crime. As it turns out, it equals <span class="tex-span"><i>T</i></span>.</p><p>Please count the number of different ways to find exactly <span class="tex-span"><i>T</i></span> direct links between the clues so that the crime is solved in the end. Two ways to find direct links are considered different if there exist two clues which have a direct link in one way and do not have a direct link in the other way. </p><p>As the number of different ways can turn out rather big, print it modulo <span class="tex-span"><i>k</i></span>.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains three space-separated integers <span class="tex-span"><i>n</i>, <i>m</i>, <i>k</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup>, 0 ≤ <i>m</i> ≤ 10<sup class="upper-index">5</sup></span>, <span class="tex-span">1 ≤ <i>k</i> ≤ 10<sup class="upper-index">9</sup></span>) — the number of clues, the number of direct clue links that Holmes has already found and the divisor for the modulo operation.</p><p>Each of next <span class="tex-span"><i>m</i></span> lines contains two integers <span class="tex-span"><i>a</i></span> and <span class="tex-span"><i>b</i></span> (<span class="tex-span">1 ≤ <i>a</i>, <i>b</i> ≤ <i>n</i>, <i>a</i> ≠ <i>b</i></span>), that represent a direct link between clues. It is guaranteed that any two clues are linked by no more than one direct link. Note that the direct links between the clues are mutual.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print the single number — the answer to the problem modulo <span class="tex-span"><i>k</i></span>.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>2 0 1000000000<br /></pre></div><div class="output"><div class="title">Output</div><pre>1<br /></pre></div><div class="input"><div class="title">Input</div><pre>3 0 100<br /></pre></div><div class="output"><div class="title">Output</div><pre>3<br /></pre></div><div class="input"><div class="title">Input</div><pre>4 1 1000000000<br />1 4<br /></pre></div><div class="output"><div class="title">Output</div><pre>8<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>The first sample only has two clues and Sherlock hasn't found any direct link between them yet. The only way to solve the crime is to find the link.</p><p>The second sample has three clues and Sherlock hasn't found any direct links between them. He has to find two of three possible direct links between clues to solve the crime — there are <span class="tex-span">3</span> ways to do it.</p><p>The third sample has four clues and the detective has already found one direct link between the first and the fourth clue. There are <span class="tex-span">8</span> ways to find two remaining clues to solve the crime.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=D]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/49284");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 1em;"
        >


<div class="problemindexholder" problemindex="E" data-uuid="ps_4c420401cbd2f5b9f288e72f663644867412a75e">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. Mrs. Hudson's Pancakes</div><div class="time-limit"><div class="property-title">time limit per test</div>5 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Mrs. Hudson hasn't made her famous pancakes for quite a while and finally she decided to make them again. She has learned <span class="tex-span"><i>m</i></span> new recipes recently and she can't wait to try them. Those recipes are based on <span class="tex-span"><i>n</i></span> special spices. Mrs. Hudson has these spices in the kitchen lying in jars <span class="tex-font-style-bf">numbered</span> with integers from <span class="tex-span">0</span> to <span class="tex-span"><i>n</i> - 1</span> (each spice lies in an individual jar). Each jar also has the <span class="tex-font-style-bf">price</span> of the corresponding spice inscribed — some integer <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>.</p><p>We know three values for the <span class="tex-span"><i>i</i></span>-th pancake recipe: <span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span>. Here <span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> are integers, and <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span> is the <span class="tex-font-style-underline">pattern</span> of some integer written in the numeral system with radix <span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub></span>. The pattern contains digits, Latin letters (to denote digits larger than nine) and question marks. Number <span class="tex-span"><i>x</i></span> in the <span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub></span>-base numeral system <span class="tex-font-style-underline">matches the pattern</span> <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span>, if we can replace question marks in the pattern with digits and letters so that we obtain number <span class="tex-span"><i>x</i></span> (leading zeroes aren't taken into consideration when performing the comparison). More formally: each question mark should be replaced by exactly one digit or exactly one letter. If after we replace all question marks we get a number with leading zeroes, we can delete these zeroes. For example, number <span class="tex-font-style-tt">40A9875</span> in the <span class="tex-span">11</span>-base numeral system matches the pattern &quot;<span class="tex-font-style-tt">??4??987?</span>&quot;, and number <span class="tex-font-style-tt">4A9875</span> does not.</p><p>To make the pancakes by the <span class="tex-span"><i>i</i></span>-th recipe, Mrs. Hudson should take all jars with <span class="tex-font-style-bf">numbers</span> whose representation in the <span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub></span>-base numeral system matches the pattern <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span>. The <span class="tex-font-style-underline">control number</span> of the recipe (<span class="tex-span"><i>z</i><sub class="lower-index"><i>i</i></sub></span>) is defined as the sum of number <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> and the product of <span class="tex-font-style-bf">prices</span> of all taken jars. More formally: <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/86ea62c3906295d11ece4457098162f25554cfce.png" style="max-width: 100.0%;max-height: 100.0%;" /> (where <span class="tex-span"><i>j</i></span> is all such numbers whose representation in the <span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub></span>-base numeral system matches the pattern <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span>).</p><p>Mrs. Hudson isn't as interested in the control numbers as she is in their minimum prime divisors. Your task is: for each recipe <span class="tex-span"><i>i</i></span> find the minimum prime divisor of number <span class="tex-span"><i>z</i><sub class="lower-index"><i>i</i></sub></span>. If this divisor exceeds <span class="tex-span">100</span>, then you do not have to find it, print -1.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains the single integer <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 10<sup class="upper-index">4</sup></span>). The second line contains space-separated prices of the spices <span class="tex-span"><i>a</i><sub class="lower-index">0</sub>, <i>a</i><sub class="lower-index">1</sub>, ..., <i>a</i><sub class="lower-index"><i>n</i> - 1</sub></span>, where <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> is an integer (<span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">18</sup></span>).</p><p>The third line contains the single integer <span class="tex-span"><i>m</i></span> (<span class="tex-span">1 ≤ <i>m</i> ≤ 3·10<sup class="upper-index">4</sup></span>) — the number of recipes Mrs. Hudson has learned. </p><p>Next <span class="tex-span"><i>m</i></span> lines describe the recipes, one per line. First you are given an integer <span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub></span>, written in the decimal numeral system (<span class="tex-span">2 ≤ <i>d</i><sub class="lower-index"><i>i</i></sub> ≤ 16</span>). Then after a space follows the <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span> pattern — a string from <span class="tex-span">1</span> to <span class="tex-span">30</span> in length, inclusive, consisting of digits from &quot;<span class="tex-font-style-tt">0</span>&quot; to &quot;<span class="tex-font-style-tt">9</span>&quot;, letters from &quot;<span class="tex-font-style-tt">A</span>&quot; to &quot;<span class="tex-font-style-tt">F</span>&quot; and signs &quot;<span class="tex-font-style-tt">?</span>&quot;. Letters from &quot;<span class="tex-font-style-tt">A</span>&quot; to &quot;<span class="tex-font-style-tt">F</span>&quot; should be considered as digits from <span class="tex-span">10</span> to <span class="tex-span">15</span> correspondingly. It is guaranteed that all digits of the pattern (including the digits that are represented by letters) are strictly less than <span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub></span>. Then after a space follows an integer <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span>, written in the decimal numeral system (<span class="tex-span">1 ≤ <i>c</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">18</sup></span>).</p><p>Please do not use the <span class="tex-font-style-tt">%lld</span> specificator to read or write 64-bit integers in С++, in is preferred to use <span class="tex-font-style-tt">cin</span>, <span class="tex-font-style-tt">cout</span>, strings or the <span class="tex-font-style-tt">%I64d</span> specificator instead.</p></div><div class="output-specification"><div class="section-title">Output</div><p>For each recipe count by what minimum prime number the control number is divided and print this prime number on the single line. If this number turns out larger than <span class="tex-span">100</span>, print -1.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>1<br />1<br />1<br />2 ? 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>2<br /></pre></div><div class="input"><div class="title">Input</div><pre>4<br />2 3 5 7<br />4<br />2 ?0 11<br />2 ?1 13<br />2 0? 17<br />2 1? 19<br /></pre></div><div class="output"><div class="title">Output</div><pre>3<br />2<br />23<br />2<br /></pre></div><div class="input"><div class="title">Input</div><pre>1<br />1000000000000000000<br />1<br />16 ?????????????? 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>-1<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first test any one-digit number in the binary system matches. The jar is only one and its price is equal to <span class="tex-span">1</span>, the number <span class="tex-span"><i>c</i></span> is also equal to <span class="tex-span">1</span>, the control number equals <span class="tex-span">2</span>. The minimal prime divisor of <span class="tex-span">2</span> is <span class="tex-span">2</span>.</p><p>In the second test there are <span class="tex-span">4</span> jars with numbers from <span class="tex-span">0</span> to <span class="tex-span">3</span>, and the prices are equal <span class="tex-span">2</span>, <span class="tex-span">3</span>, <span class="tex-span">5</span> and <span class="tex-span">7</span> correspondingly — the first four prime numbers. In all recipes numbers should be two-digit. In the first recipe the second digit always is <span class="tex-span">0</span>, in the second recipe the second digit always is <span class="tex-span">1</span>, in the third recipe the first digit must be <span class="tex-span">0</span>, in the fourth recipe the first digit always is <span class="tex-span">1</span>. Consequently, the control numbers ​​are as follows: in the first recipe <span class="tex-span">2 × 5 + 11 = 21</span> (the minimum prime divisor is <span class="tex-span">3</span>), in the second recipe <span class="tex-span">3 × 7 + 13 = 44</span> (the minimum prime divisor is <span class="tex-span">2</span>), in the third recipe <span class="tex-span">2 × 3 + 17 = 23</span> (the minimum prime divisor is <span class="tex-span">23</span>) and, finally, in the fourth recipe <span class="tex-span">5 × 7 + 19 = 54</span> (the minimum prime divisor is <span class="tex-span">2</span>).</p><p>In the third test, the number should consist of fourteen digits and be recorded in a sixteen-base numeral system. Number <span class="tex-span">0</span> (the number of the single bottles) matches, the control number will be equal to <span class="tex-span">10<sup class="upper-index">18</sup> + 1</span>. The minimum prime divisor of this number is equal to <span class="tex-span">101</span> and you should print -1.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=E]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/49284");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
    </div>

    <div id="footer">
        <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2024 Mike Mirzayanov</div>
        <div>The only programming contests Web 2.0 platform</div>

    </div>

</div>
</div>
    <script type="application/javascript">
        if ('serviceWorker' in navigator && 'fetch' in window && 'caches' in window) {
            navigator.serviceWorker.register('/service-worker-49284.js')
                .then(function (registration) {
                    console.log('Service worker registered: ', registration);
                })
                .catch(function (error) {
                    console.log('Registration failed: ', error);
                });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'89f757d50fb4777b',t:'MTcyMDM1MDE1NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

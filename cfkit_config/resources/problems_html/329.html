
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-743380-5"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-743380-5');
        </script>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="d10a6b932a177d969a6328b43180a3bf"/>
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01"/>

    <script type="text/javascript" src="//codeforces.org/s/83804/js/jquery-1.8.3.js"></script>
    <script type="application/javascript">
        window.locale = "en";
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }

        /* Protection against trailing dot in domain. */
        let hostLength = window.location.host.length;
        if (hostLength > 1 && window.location.host[hostLength - 1] === '.') {
            window.location = window.location.protocol + "//" + window.location.host.substring(0, hostLength - 1);
        }
    </script>

    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="k2">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="//codeforces.org/s/83804/images/codeforces-sponsored-by-ton.png" />
    <link rel="image_src" href="//codeforces.org/s/83804/images/codeforces-sponsored-by-ton.png" />
    <meta property="og:title" content="Problems - Codeforces"/>
    <meta property="og:description" content=""/>
    
    <meta property="og:site_name" content="Codeforces"/>
    
    
    
    
    
    
    <meta name="utc_offset" content="+03:00"/>
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Problems - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community" />
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup" />
    <meta name="robots" content="index, follow" />

    <link rel="stylesheet" href="//codeforces.org/s/83804/css/font-awesome.min.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/83804/css/line-awesome.min.css" type="text/css" charset="utf-8" />

        <link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>


    <link rel="apple-touch-icon" sizes="57x57" href="//codeforces.org/s/83804/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="//codeforces.org/s/83804/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="//codeforces.org/s/83804/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="//codeforces.org/s/83804/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="//codeforces.org/s/83804/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="//codeforces.org/s/83804/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="//codeforces.org/s/83804/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="//codeforces.org/s/83804/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="//codeforces.org/s/83804/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="//codeforces.org/s/83804/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="//codeforces.org/s/83804/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="//codeforces.org/s/83804/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="//codeforces.org/s/83804/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="//codeforces.org/s/83804/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="//codeforces.org/s/83804/css/prettify.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/83804/css/clear.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/83804/css/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/83804/css/ttypography.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/83804/css/problem-statement.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/83804/css/second-level-menu.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/83804/css/roundbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/83804/css/datatable.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/83804/css/table-form.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/83804/css/topic.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/83804/css/jquery.jgrowl.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/83804/css/facebox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/83804/css/jquery.wysiwyg.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/83804/css/jquery.autocomplete.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/83804/css/codeforces.datepick.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/83804/css/colorbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/83804/css/jquery.drafts.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/83804/css/community.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/83804/css/sidebar-menu.css" type="text/css" charset="utf-8" />

    <!-- MathJax -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    MathJax.Hub.Register.StartupHook("End", function () {
        Codeforces.runMathJaxListeners();
    });
    </script>
    <script type="text/javascript" async
            src="https://mathjax.codeforces.org/MathJax.js?config=TeX-AMS_HTML-full"
    >
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="//codeforces.org/s/83804/js/prettify/prettify.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/83804/js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/83804/js/pushstream.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/83804/js/jquery.easing.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/83804/js/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/83804/js/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/83804/js/jquery.swipe.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/83804/js/jquery.hotkeys.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/83804/js/facebox.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/83804/js/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/83804/js/controls/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/83804/js/controls/wysiwyg.table.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/83804/js/controls/wysiwyg.image.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/83804/js/controls/wysiwyg.link.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/83804/js/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/83804/js/jquery.datepick.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/83804/js/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/83804/js/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/83804/js/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/83804/js/jquery.drafts.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/83804/js/clipboard.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/83804/js/autosize.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/83804/js/sjcl.js"></script>
    <script type="text/javascript" src="/scripts/46d3ec042753fd50f59390aa050764b0/en/codeforces-options.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/83804/js/codeforces.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/83804/js/EventCatcher.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/83804/js/preparedVerdictFormats-en.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/83804/js/confetti.min.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="//codeforces.org/s/83804/markitup/skins/markitup/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/83804/markitup/sets/markdown/style.css" type="text/css" charset="utf-8" />


    <script type="text/javascript" src="//codeforces.org/s/83804/markitup/jquery.markitup.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/83804/markitup/sets/markdown/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->




</head>
<body class=" "><span style='display:none;' class='csrf-token' data-csrf='d10a6b932a177d969a6328b43180a3bf'>&nbsp;</span>

<!-- .notificationTextCleaner used in Codeforces.showAnnouncements() -->
<div class="notificationTextCleaner" style="font-size: 0"></div>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 3.0rem;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    String.prototype.hashCode = function() {
        var hash = 0, i, chr;
        if (this.length === 0) return hash;
        for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };

    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile === "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>





    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 700
        });
    }, 100);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


    function showAnnouncements(json) {
        //info("j=" + JSON.stringify(json));

        if (json.t != "a") {
            return;
        }

        setTimeout(function() {
            Codeforces.showAnnouncements(json.d, "en");
        }, Math.random() * 500);
    }

    function showEventCatcherUserMessage(json) {
        if (json.t == "s") {
            var points = json.d[5];
            var passedTestCount = json.d[7];
            var judgedTestCount = json.d[8];
            var verdict = preparedVerdictFormats[json.d[12]];
            var verdictPrototypeDiv = $(".verdictPrototypeDiv");
            verdictPrototypeDiv.html(verdict);
            if (judgedTestCount != null && judgedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-judged").text(judgedTestCount);
            }
            if (passedTestCount != null && passedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-passed").text(passedTestCount);
            }
            if (points != null && points != undefined) {
                verdictPrototypeDiv.find(".verdict-format-points").text(points);
            }
            Codeforces.showMessage(verdictPrototypeDiv.text());
        }
    }

    $(".clickable-title").each(function() {
        var title = $(this).attr("data-title");
        if (title) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = title;
            $(this).attr("title", tmp.textContent || tmp.innerText || "");
        }
    });

    $(".clickable-title").click(function() {
        var title = $(this).attr("data-title");
        if (title) {
            Codeforces.alert(title);
        } else {
            Codeforces.alert($(this).attr("title"));
        }
    }).css("position", "relative").css("bottom", "3px");

        Codeforces.showDelayedMessage();

    Codeforces.reformatTimes();

    //Codeforces.initializePubSub();
    if (window.codeforcesOptions.subscribeServerUrl) {
        window.eventCatcher = new EventCatcher(
            window.codeforcesOptions.subscribeServerUrl,
            [
                Codeforces.getGlobalChannel(),
                Codeforces.getUserChannel(),
                Codeforces.getUserShowMessageChannel(),
                Codeforces.getContestChannel(),
                Codeforces.getParticipantChannel(),
                Codeforces.getTalkChannel()
            ]
        );

        if (Codeforces.getParticipantChannel()) {
            window.eventCatcher.subscribe(Codeforces.getParticipantChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getContestChannel()) {
            window.eventCatcher.subscribe(Codeforces.getContestChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getGlobalChannel()) {
            window.eventCatcher.subscribe(Codeforces.getGlobalChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserShowMessageChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserShowMessageChannel(), function(json) {
                showEventCatcherUserMessage(json);
            });
        }
    }

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>


<div id="body">
<div style="width: 950px; margin: 0 auto;" class="compact-problemset">
    <div id="header" style="position: relative; margin: 0;">
        <div style="float:left;">
                  <a href="/"><img height="65" style="height: 65px;" src="//codeforces.org/s/83804/images/codeforces-sponsored-by-ton.png" alt="Codeforces"/></a>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="//codeforces.org/s/83804/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="//codeforces.org/s/83804/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <br style="clear: both;"/>

    <div style="text-align: center; font-size: 1.8rem; margin-bottom: 0.5em;"
         class="caption">Codeforces Round 192 (Div. 1)</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

    <div class="problem-frames">
        <div
                    style="margin-bottom: 2em;"
        >

    <style>
        #facebox .content:has(.diff-popup) {
            width: 90vw;
            max-width: 120rem !important;
        }

        .testCaseMarker {
            position: absolute;
            font-weight: bold;
            font-size: 1rem;
        }

        .diff-popup {
            width: 90vw;
            max-width: 120rem !important;
            display: none;
            overflow: auto;
        }

        .input-output-copier {
            font-size: 1.2rem;
            float: right;
            color: #888 !important;
            cursor: pointer;
            border: 1px solid rgb(185, 185, 185);
            padding: 3px;
            margin: 1px;
            line-height: 1.1rem;
            text-transform: none;
        }

        .input-output-copier:hover {
            background-color: #def;
        }

        .test-explanation textarea {
            width: 100%;
            height: 1.5em;
        }

        .pending-submission-message {
            color: darkorange !important;
        }
    </style>
    <script>
        const OPENING_SPACE = String.fromCharCode(1001);
        const CLOSING_SPACE = String.fromCharCode(1002);

        const nodeToText = function (node, pre) {
            let result = [];

            if (node.tagName === "SCRIPT" || node.tagName === "math"
                || (node.classList && node.classList.contains("input-output-copier")))
                return [];

            if (node.tagName === "NOBR") {
                result.push(OPENING_SPACE);
            }

            if (node.nodeType === Node.TEXT_NODE) {
                let s = node.textContent;
                if (!pre) {
                    s = s.replace(/\s+/g, " ");
                }
                if (s.length > 0) {
                    result.push(s);
                }
            }

            if (pre && node.tagName === "BR") {
                result.push("\n");
            }

            node.childNodes.forEach(function (child) {
                result.push(nodeToText(child, node.tagName === "PRE").join(""));
            });

            if (node.tagName === "DIV"
                || node.tagName === "P"
                || node.tagName === "PRE"
                || node.tagName === "UL"
                || node.tagName === "LI"
            ) {
                result.push("\n");
            }

            if (node.tagName === "NOBR") {
                result.push(CLOSING_SPACE);
            }

            return result;
        }

        const isSpecial = function (c) {
            return c === ',' || c === '.' || c === ';' || c === ')' || c === ' ';
        }

        const convertStatementToText = function(statmentNode) {
            const text = nodeToText(statmentNode, false).join("").replace(/ +/g, " ").replace(/\n\n+/g, "\n\n");
            let result = [];
            for (let i = 0; i < text.length; i++) {
                const c = text.charAt(i);
                if (c === OPENING_SPACE) {
                    if (!((i > 0 && text.charAt(i - 1) === '(') || (result.length > 0 && result[result.length - 1] === ' '))) {
                        result.push('+');
                    }
                } else if (c === CLOSING_SPACE) {
                    if (!(i + 1 < text.length && isSpecial(text.charAt(i + 1)))) {
                        result.push('-');
                    }
                } else {
                    result.push(c);
                }
            }
            return result.join("").split("\n").map(value => value.trim()).join("\n");
        };
    </script>
    <div class="diff-popup">
    </div>

<div class="problemindexholder" problemindex="A" data-uuid="ps_2137cde5aecdccbf669801916999730eb693e3d2">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A. Purification</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>You are an adventurer currently journeying inside an evil temple. After defeating a couple of weak zombies, you arrived at a square room consisting of tiles forming an <span class="tex-span"><i>n</i> × <i>n</i></span> grid. The rows are numbered <span class="tex-span">1</span> through <span class="tex-span"><i>n</i></span> from top to bottom, and the columns are numbered <span class="tex-span">1</span> through <span class="tex-span"><i>n</i></span> from left to right. At the far side of the room lies a door locked with evil magical forces. The following inscriptions are written on the door:</p><center> <span class="tex-font-style-underline">The cleaning of all evil will awaken the door!</span> </center><p>Being a very senior adventurer, you immediately realize what this means. You notice that every single cell in the grid are initially evil. You should purify all of these cells.</p><p>The only method of tile purification known to you is by casting the &quot;Purification&quot; spell. You cast this spell on a single tile — then, all cells that are located in the same row and all cells that are located in the same column as the selected tile become purified (including the selected tile)! It is allowed to purify a cell more than once.</p><p>You would like to purify all <span class="tex-span"><i>n</i> × <i>n</i></span> cells while minimizing the number of times you cast the &quot;Purification&quot; spell. This sounds very easy, but you just noticed that some tiles are particularly more evil than the other tiles. You cannot cast the &quot;Purification&quot; spell on those particularly more evil tiles, not even after they have been purified. They can still be purified if a cell sharing the same row or the same column gets selected by the &quot;Purification&quot; spell.</p><p>Please find some way to purify all the cells with the minimum number of spells cast. Print -1 if there is no such way.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line will contain a single integer <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 100</span>). Then, <span class="tex-span"><i>n</i></span> lines follows, each contains <span class="tex-span"><i>n</i></span> characters. The <span class="tex-span"><i>j</i></span>-th character in the <span class="tex-span"><i>i</i></span>-th row represents the cell located at row <span class="tex-span"><i>i</i></span> and column <span class="tex-span"><i>j</i></span>. It will be the character '<span class="tex-font-style-tt">E</span>' if it is a particularly more evil cell, and '<span class="tex-font-style-tt">.</span>' otherwise.</p></div><div class="output-specification"><div class="section-title">Output</div><p>If there exists no way to purify all the cells, output -1. Otherwise, if your solution casts <span class="tex-span"><i>x</i></span> &quot;Purification&quot; spells (where <span class="tex-span"><i>x</i></span> is the minimum possible number of spells), output <span class="tex-span"><i>x</i></span> lines. Each line should consist of two integers denoting the row and column numbers of the cell on which you should cast the &quot;Purification&quot; spell.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3<br />.E.<br />E.E<br />.E.<br /></pre></div><div class="output"><div class="title">Output</div><pre>1 1<br />2 2<br />3 3<br /></pre></div><div class="input"><div class="title">Input</div><pre>3<br />EEE<br />E..<br />E.E<br /></pre></div><div class="output"><div class="title">Output</div><pre>-1<br /></pre></div><div class="input"><div class="title">Input</div><pre>5<br />EE.EE<br />E.EE.<br />E...E<br />.EE.E<br />EE.EE<br /></pre></div><div class="output"><div class="title">Output</div><pre>3 3<br />1 3<br />2 2<br />4 4<br />5 3</pre></div></div></div><div class="note"><div class="section-title">Note</div><p>The first example is illustrated as follows. Purple tiles are evil tiles that have not yet been purified. Red tile is the tile on which &quot;Purification&quot; is cast. Yellow tiles are the tiles being purified as a result of the current &quot;Purification&quot; spell. Green tiles are tiles that have been purified previously. </p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/d3d9573a3f4c30a4dc1d501618a87f0e131190dc.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>In the second example, it is impossible to purify the cell located at row <span class="tex-span">1</span> and column <span class="tex-span">1</span>.</p><p>For the third example:</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/fef2db9707af73580fe82f91e87966de4e6a0d3f.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=A]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/83804");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {
        window.changedTests = new Set();

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");



        String.prototype.replaceAll = function (search, replace) {
            return this.split(search).join(replace);
        };

        $(".sample-test .title").each(function () {
            const preId = ("id" + Math.random()).replaceAll(".", "0");
            const cpyId = ("id" + Math.random()).replaceAll(".", "0");

            $(this).parent().find("pre").attr("id", preId);
            const $copy = $("<div title='Copy' data-clipboard-target='#" + preId + "' id='" + cpyId + "' class='input-output-copier'>Copy</div>");
            $(this).append($copy);

            const clipboard = new Clipboard('#' + cpyId, {
                text: function (trigger) {
                    const pre = document.querySelector('#' + preId);
                    const lines = pre.querySelectorAll(".test-example-line");
                    return Codeforces.filterClipboardText(pre.innerText, lines.length);
                }
            });

            const isInput = $(this).parent().hasClass("input");

            clipboard.on('success', function (e) {
                if (isInput) {
                    Codeforces.showMessage("The example input has been copied into the clipboard");
                } else {
                    Codeforces.showMessage("The example output has been copied into the clipboard");
                }
                e.clearSelection();
            });
        });

        $(".test-form-item input").change(function () {
            addPendingSubmissionMessage($($(this).closest("form")), "You changed the answer, do not forget to submit it if you want to save the changes");
            const index = $(this).closest(".problemindexholder").attr("problemindex");
            let test = "";
            $(this).closest("form input").each(function () {
                const test_ = $(this).attr("name");
                if (test_ && test_.substring(0, 4) === "test") {
                    test = test_;
                }
            });
            if (index.length > 0 && test.length > 0) {
                const indexTest = index + "::" + test;
                window.changedTests.add(indexTest);
            }
        });

        $(window).on('beforeunload', function () {
            if (window.changedTests.size > 0) {
                return 'Dialog text here';
            }
        });

        autosize($('.test-explanation textarea'));

        $(".test-example-line").hover(function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        let top = 1E20;
                        let left = 1E20;
                        let problem = $(this).closest(".problemindexholder");
                        $(this).closest(".input").find("." + clazz).css("background-color", "#FFFDE7").each(function() {
                            top = Math.min(top, $(this).offset().top);
                            left = Math.min(left, $(this).offset().left);
                        });
                        let testCaseMarker = problem.find(".testCaseMarker_" + end);
                        if (testCaseMarker.length === 0) {
                            const html = "<div class=\"testCaseMarker testCaseMarker_" + end + " notice\"></div>";
                            problem.append($(html));
                            testCaseMarker = problem.find(".testCaseMarker_" + end);
                        }
                        if (testCaseMarker) {
                            testCaseMarker.show()
                                    .offset({top, left: left - 20})
                                    .text(end);
                        }
                    }
                }
            });
        }, function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        $("." + clazz).css("background-color", "");
                        $(this).closest(".problemindexholder").find(".testCaseMarker_" + end).hide();
                    }
                }
            });
        });

    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="B" data-uuid="ps_aecde15cec6c285ef99ad78abb294550747846c3">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B. Biridian Forest</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>You're a mikemon breeder currently in the middle of your journey to become a mikemon master. Your current obstacle is go through the infamous Biridian Forest.</p><p><span class="tex-font-style-bf">The forest</span></p><p>The Biridian Forest is a two-dimensional grid consisting of <span class="tex-span"><i>r</i></span> rows and <span class="tex-span"><i>c</i></span> columns. Each cell in Biridian Forest may contain a tree, or may be vacant. A vacant cell may be occupied by zero or more mikemon breeders (there may also be breeders other than you in the forest). Mikemon breeders (including you) cannot enter cells with trees. One of the cells is designated as the exit cell.</p><p>The initial grid, including your initial position, the exit cell, and the initial positions of all other breeders, will be given to you. Here's an example of such grid (from the first example):</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/cfbf62f062c0646352b1420e792a1ee199adfe59.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p><span class="tex-font-style-bf">Moves</span></p><p>Breeders (including you) may move in the forest. In a single move, breeders may perform one of the following actions: </p><ul> <li> Do nothing. </li><li> Move from the current cell to one of the four adjacent cells (two cells are adjacent if they share a side). Note that breeders cannot enter cells with trees. </li><li> If you are located on the exit cell, you may leave the forest. Only you can perform this move — all other mikemon breeders will never leave the forest by using this type of movement. </li></ul><p>After each time you make a single move, each of the other breeders simultaneously make a single move (the choice of which move to make may be different for each of the breeders).</p><p><span class="tex-font-style-bf">Mikemon battle</span></p><p>If you and <span class="tex-span"><i>t</i></span> <span class="tex-span">(<i>t</i> &gt; 0)</span> mikemon breeders are located on the same cell, exactly <span class="tex-span"><i>t</i></span> mikemon battles will ensue that time (since you will be battling each of those <span class="tex-span"><i>t</i></span> breeders once). After the battle, all of those <span class="tex-span"><i>t</i></span> breeders will leave the forest to heal their respective mikemons.</p><p>Note that the moment you leave the forest, no more mikemon battles can ensue, even if another mikemon breeder move to the exit cell immediately after that. Also note that a battle only happens between you and another breeders — there will be no battle between two other breeders (there may be multiple breeders coexisting in a single cell).</p><p><span class="tex-font-style-bf">Your goal</span></p><p>You would like to leave the forest. In order to do so, you have to make a sequence of moves, ending with a move of the final type. Before you make any move, however, you post this sequence on your personal virtual idol Blog. Then, you will follow this sequence of moves faithfully.</p><p><span class="tex-font-style-bf">Goal of other breeders</span></p><p>Because you post the sequence in your Blog, the other breeders will all know your exact sequence of moves even before you make your first move. All of them will move in such way that will guarantee a mikemon battle with you, if possible. The breeders that couldn't battle you will do nothing.</p><p><span class="tex-font-style-bf">Your task</span></p><p>Print the minimum number of mikemon battles that you must participate in, assuming that you pick the sequence of moves that minimize this number. Note that you are not required to minimize the number of moves you make.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line consists of two integers: <span class="tex-span"><i>r</i></span> and <span class="tex-span"><i>c</i></span> (<span class="tex-span">1 ≤ <i>r</i>, <i>c</i> ≤ 1000</span>), denoting the number of rows and the number of columns in Biridian Forest. The next <span class="tex-span"><i>r</i></span> rows will each depict a row of the map, where each character represents the content of a single cell: </p><ul> <li> '<span class="tex-font-style-tt">T</span>': A cell occupied by a tree. </li><li> '<span class="tex-font-style-tt">S</span>': An empty cell, and your starting position. There will be exactly one occurence of this in the map. </li><li> '<span class="tex-font-style-tt">E</span>': An empty cell, and where the exit is located. There will be exactly one occurence of this in the map. </li><li> A digit (0-9): A cell represented by a digit X means that the cell is empty and is occupied by X breeders (in particular, if X is zero, it means that the cell is not occupied by any breeder). </li></ul><p>It is guaranteed that it will be possible for you to go from your starting position to the exit cell through a sequence of moves.</p></div><div class="output-specification"><div class="section-title">Output</div><p>A single line denoted the minimum possible number of mikemon battles that you have to participate in if you pick a strategy that minimize this number.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>5 7<br />000E0T3<br />T0TT0T0<br />010T0T0<br />2T0T0T0<br />0T0S000<br /></pre></div><div class="output"><div class="title">Output</div><pre>3<br /></pre></div><div class="input"><div class="title">Input</div><pre>1 4<br />SE23<br /></pre></div><div class="output"><div class="title">Output</div><pre>2<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>The following picture illustrates the first example. The blue line denotes a possible sequence of moves that you should post in your blog:</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/43601193d3b2a06ac035662876e3072bac90d04f.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>The three breeders on the left side of the map will be able to battle you — the lone breeder can simply stay in his place until you come while the other two breeders can move to where the lone breeder is and stay there until you come. The three breeders on the right does not have a way to battle you, so they will stay in their place.</p><p>For the second example, you should post this sequence in your Blog:</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/fa90824d102700da8fab53d7a183a00746482192.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>Here's what happens. First, you move one cell to the right.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/7591e6e9117c7b271819e1ee3b557903291f32cd.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>Then, the two breeders directly to the right of the exit will simultaneously move to the left. The other three breeder cannot battle you so they will do nothing.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/5ffca4841451e6e45e3fca5521793a09232af5f7.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>You end up in the same cell with <span class="tex-span">2</span> breeders, so <span class="tex-span">2</span> mikemon battles are conducted. After those battles, all of your opponents leave the forest.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/6fed70a835b537382cc27797595020c575ca0235.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>Finally, you make another move by leaving the forest.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/dfd7c2a8ebe0500e020d58ddb9d065b1ab67b64f.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=B]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/83804");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="C" data-uuid="ps_b618a1690212be7a771e950334f4295cad64c083">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C. Graph Reconstruction</div><div class="time-limit"><div class="property-title">time limit per test</div>3 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>I have an undirected graph consisting of <span class="tex-span"><i>n</i></span> nodes, numbered 1 through <span class="tex-span"><i>n</i></span>. Each node has at most two incident edges. For each pair of nodes, there is at most an edge connecting them. No edge connects a node to itself.</p><p>I would like to create a new graph in such a way that: </p><ul> <li> The new graph consists of the same number of nodes and edges as the old graph. </li><li> The properties in the first paragraph still hold. </li><li> For each two nodes <span class="tex-span"><i>u</i></span> and <span class="tex-span"><i>v</i></span>, if there is an edge connecting them in the old graph, there is no edge connecting them in the new graph. </li></ul><p>Help me construct the new graph, or tell me if it is impossible.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line consists of two space-separated integers: <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>m</i></span> (<span class="tex-span">1 ≤ <i>m</i> ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup></span>), denoting the number of nodes and edges, respectively. Then <span class="tex-span"><i>m</i></span> lines follow. Each of the <span class="tex-span"><i>m</i></span> lines consists of two space-separated integers <span class="tex-span"><i>u</i></span> and <span class="tex-span"><i>v</i></span> (<span class="tex-span">1 ≤ <i>u</i>, <i>v</i> ≤ <i>n</i>; <i>u</i> ≠ <i>v</i></span>), denoting an edge between nodes <span class="tex-span"><i>u</i></span> and <span class="tex-span"><i>v</i></span>.</p></div><div class="output-specification"><div class="section-title">Output</div><p>If it is not possible to construct a new graph with the mentioned properties, output a single line consisting of -1. Otherwise, output exactly <span class="tex-span"><i>m</i></span> lines. Each line should contain a description of edge in the same way as used in the input format.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>8 7<br />1 2<br />2 3<br />4 5<br />5 6<br />6 8<br />8 7<br />7 4<br /></pre></div><div class="output"><div class="title">Output</div><pre>1 4<br />4 6<br />1 6<br />2 7<br />7 5<br />8 5<br />2 8<br /></pre></div><div class="input"><div class="title">Input</div><pre>3 2<br />1 2<br />2 3<br /></pre></div><div class="output"><div class="title">Output</div><pre>-1<br /></pre></div><div class="input"><div class="title">Input</div><pre>5 4<br />1 2<br />2 3<br />3 4<br />4 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>1 3<br />3 5<br />5 2<br />2 4<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>The old graph of the first example:</p><p><img class="tex-graphics" src="https://espresso.codeforces.com/1a5d4ab85ef86541ea9bea88ee537f6852ca2194.png" style="max-width: 100.0%;max-height: 100.0%;" /></p><p>A possible new graph for the first example:</p><p><img class="tex-graphics" src="https://espresso.codeforces.com/8a2d63a60d51967903043452c9d1fe4dd6385753.png" style="max-width: 100.0%;max-height: 100.0%;" /></p><p>In the second example, we cannot create any new graph.</p><p>The old graph of the third example:</p><p><img class="tex-graphics" src="https://espresso.codeforces.com/22079249a5965faa550b830e5827cde2910342f3.png" style="max-width: 100.0%;max-height: 100.0%;" /></p><p>A possible new graph for the third example:</p><p><img class="tex-graphics" src="https://espresso.codeforces.com/69fb5a55e3d0dde42a4ba4131e82d463f782fe9e.png" style="max-width: 100.0%;max-height: 100.0%;" /></p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=C]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/83804");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="D" data-uuid="ps_c5ac4481587114ab6317fd070222f1819591ae91">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. The Evil Temple and the Moving Rocks</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p><span class="tex-font-style-underline">Important: All possible tests are in the pretest, so you shouldn't hack on this problem. So, if you passed pretests, you will also pass the system test.</span></p><p>You are an adventurer currently journeying inside an evil temple. After defeating a couple of weak monsters, you arrived at a square room consisting of tiles forming an <span class="tex-span"><i>n</i> × <i>n</i></span> grid, surrounded entirely by walls. At the end of the room lies a door locked with evil magical forces. The following inscriptions are written on the door:</p><center> <span class="tex-font-style-underline">The sound of clashing rocks will awaken the door!</span> </center><p>Being a very senior adventurer, you immediately realize what this means. In the room next door lies an infinite number of magical rocks. There are four types of rocks: </p><ul> <li> '<span class="tex-font-style-tt">^</span>': this rock moves upwards; </li><li> '<span class="tex-font-style-tt">&lt;</span>': this rock moves leftwards; </li><li> '<span class="tex-font-style-tt">&gt;</span>': this rock moves rightwards; </li><li> '<span class="tex-font-style-tt">v</span>': this rock moves downwards. </li></ul><p>To open the door, you first need to place the rocks on some of the tiles (one tile can be occupied by at most one rock). Then, you select a single rock that you have placed and activate it. The activated rock will then move in its direction until it hits another rock or hits the walls of the room (the rock will not move if something already blocks it in its chosen direction). The rock then deactivates. If it hits the walls, or if there have been already <span class="tex-span">10<sup class="upper-index">7</sup></span> events of rock becoming activated, the movements end. Otherwise, the rock that was hit becomes activated and this procedure is repeated.</p><p>If a rock moves at least one cell before hitting either the wall or another rock, the hit produces a sound. The door will open once the number of produced sounds is at least <span class="tex-span"><i>x</i></span>. It is okay for the rocks to continue moving after producing <span class="tex-span"><i>x</i></span> sounds.</p><p>The following picture illustrates the four possible scenarios of moving rocks.</p><ul><li> Moves at least one cell, then hits another rock. A sound is produced, the hit rock becomes activated.<center> <img class="tex-graphics" src="https://espresso.codeforces.com/4ca4330cf142867ff123fb6653edcbe06027c0bd.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center></li><li> Moves at least one cell, then hits the wall (i.e., the side of the room). A sound is produced, the movements end.<center> <img class="tex-graphics" src="https://espresso.codeforces.com/3d5539e98fffe04f2e5c1dc7584f0719ae67d434.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center></li><li> Does not move because a rock is already standing in the path. The blocking rock becomes activated, but no sounds are produced.<center> <img class="tex-graphics" src="https://espresso.codeforces.com/55d023c81c3b105439ef7c5da5db79e2724919ea.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center></li><li> Does not move because the wall is in the way. No sounds are produced and the movements end.<center> <img class="tex-graphics" src="https://espresso.codeforces.com/44e05cc60b287be4bccc7e63247a1223807764f7.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center></li></ul><p>Assume there's an infinite number of rocks of each type in the neighboring room. You know what to do: place the rocks and open the door!</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line will consists of two integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>x</i></span>, denoting the size of the room and the number of sounds required to open the door. There will be exactly three test cases for this problem:</p><ul> <li> <span class="tex-span"><i>n</i> = 5, <i>x</i> = 5</span>; </li><li> <span class="tex-span"><i>n</i> = 3, <i>x</i> = 2</span>; </li><li> <span class="tex-span"><i>n</i> = 100, <i>x</i> = 10<sup class="upper-index">5</sup></span>. </li></ul><p>All of these testcases are in pretest.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Output <span class="tex-span"><i>n</i></span> lines. Each line consists of <span class="tex-span"><i>n</i></span> characters — the <span class="tex-span"><i>j</i></span>-th character of the <span class="tex-span"><i>i</i></span>-th line represents the content of the tile at the <span class="tex-span"><i>i</i></span>-th row and the <span class="tex-span"><i>j</i></span>-th column, and should be one of these:</p><ul> <li> '<span class="tex-font-style-tt">^</span>', '<span class="tex-font-style-tt">&lt;</span>', '<span class="tex-font-style-tt">&gt;</span>', or '<span class="tex-font-style-tt">v</span>': a rock as described in the problem statement. </li><li> '<span class="tex-font-style-tt">.</span>': an empty tile. </li></ul><p>Then, output two integers <span class="tex-span"><i>r</i></span> and <span class="tex-span"><i>c</i></span> (<span class="tex-span">1 ≤ <i>r</i>, <i>c</i> ≤ <i>n</i></span>) on the next line — this means that the rock you activate first is located at the <span class="tex-span"><i>r</i></span>-th row from above and <span class="tex-span"><i>c</i></span>-th column from the left. There must be a rock in this cell.</p><p>If there are multiple solutions, you may output any of them.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>5 5<br /></pre></div><div class="output"><div class="title">Output</div><pre>&gt;...v<br />v.&lt;..<br />..^..<br />&gt;....<br />..^.&lt;<br />1 1<br /></pre></div><div class="input"><div class="title">Input</div><pre>3 2<br /></pre></div><div class="output"><div class="title">Output</div><pre>&gt;vv<br />^&lt;.<br />^.&lt;<br />1 3<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Here's a simulation of the first example, accompanied with the number of sounds produced so far.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/ce8f46e052b403b0e419a2067846cb8db7ee76b2.png" style="max-width: 100.0%;max-height: 100.0%;" /> 0 sound </center><center> <img class="tex-graphics" src="https://espresso.codeforces.com/c0638b8a9b5177794b442e150ccda900791919f6.png" style="max-width: 100.0%;max-height: 100.0%;" /> 1 sound </center><center> <img class="tex-graphics" src="https://espresso.codeforces.com/82734f00efb908f680acbbb8c448829c5dd843e0.png" style="max-width: 100.0%;max-height: 100.0%;" /> 2 sounds </center><center> <img class="tex-graphics" src="https://espresso.codeforces.com/d54d4d3afde1a75a765d496b2aa691d7a85814d4.png" style="max-width: 100.0%;max-height: 100.0%;" /> 3 sounds </center><center> <img class="tex-graphics" src="https://espresso.codeforces.com/28f3796808f0afaae9f4b1fa5b6da02b2a8a15e5.png" style="max-width: 100.0%;max-height: 100.0%;" /> 4 sounds </center><center> <img class="tex-graphics" src="https://espresso.codeforces.com/f9cf52bc1d12c3ef7be60eeddc368a290e7dd23c.png" style="max-width: 100.0%;max-height: 100.0%;" /> still 4 sounds </center><p>In the picture above, the activated rock switches between the '<span class="tex-font-style-tt">^</span>' rock and the '<span class="tex-font-style-tt">&lt;</span>' rock. However, no sound is produced since the '<span class="tex-font-style-tt">^</span>' rock didn't move even a single tile. So, still 4 sound.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/8a6a4ef606421090efd3564d59062a061d03113b.png" style="max-width: 100.0%;max-height: 100.0%;" /> 5 sounds </center><p>At this point, 5 sound are already produced, so this solution is already correct. However, for the sake of example, we will continue simulating what happens.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/5bc49be9c60c0c3f1705169cbda149af6a97634b.png" style="max-width: 100.0%;max-height: 100.0%;" /> 6 sounds </center><center> <img class="tex-graphics" src="https://espresso.codeforces.com/f47820f83d261afdf5a2a2c6a4bee49cb3e30f23.png" style="max-width: 100.0%;max-height: 100.0%;" /> 7 sounds </center><center> <img class="tex-graphics" src="https://espresso.codeforces.com/d7e7f2c1f416753065369c24e61281dfe517b926.png" style="max-width: 100.0%;max-height: 100.0%;" /> still 7 sounds </center><center> <img class="tex-graphics" src="https://espresso.codeforces.com/0137d85fabf44a208f6254021ec95d456c32bb6f.png" style="max-width: 100.0%;max-height: 100.0%;" /> 8 sounds </center><p>And the movement stops. In total, it produces 8 sounds. Notice that the last move produced sound.</p><p>Here's a simulation of the second example:</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/3a00ce793bac0cc39d4115e73f09747c506e6531.png" style="max-width: 100.0%;max-height: 100.0%;" /> 0 sound </center><center> <img class="tex-graphics" src="https://espresso.codeforces.com/1599e3ec3f48463da7c01a618de1e398c1d15f18.png" style="max-width: 100.0%;max-height: 100.0%;" /> 1 sound </center><center> <img class="tex-graphics" src="https://espresso.codeforces.com/5ed3d9bf33a96af61a0b4719971e1f0a79c80a9f.png" style="max-width: 100.0%;max-height: 100.0%;" /> 2 sounds </center><p>Now, the activated stone will switch continuously from one to another without producing a sound until it reaches the <span class="tex-span">10<sup class="upper-index">7</sup></span> limit, after which the movement will cease.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/1a456e7a9c04030ae8e7672fcf28304f7fd8e29c.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>In total, it produced exactly 2 sounds, so the solution is correct.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=D]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/83804");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 1em;"
        >


<div class="problemindexholder" problemindex="E" data-uuid="ps_31e8215b1850325f0e96c8ee72c68ac3ab8378a5">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. Evil</div><div class="time-limit"><div class="property-title">time limit per test</div>3 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>There are <span class="tex-span"><i>n</i></span> cities on a two dimensional Cartesian plane. The distance between two cities is equal to the Manhattan distance between them (see the Notes for definition). A Hamiltonian cycle of the cities is defined as a permutation of all <span class="tex-span"><i>n</i></span> cities. The length of this Hamiltonian cycle is defined as the sum of the distances between adjacent cities in the permutation plus the distance between the first and final city in the permutation. Please compute the longest possible length of a Hamiltonian cycle of the given cities.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains an integer <span class="tex-span"><i>n</i></span> <span class="tex-span">(3 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup>)</span>. Then <span class="tex-span"><i>n</i></span> lines follow, each consisting of two integers <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">0 ≤ <i>x</i><sub class="lower-index"><i>i</i></sub>, <i>y</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>), denoting the coordinates of a city. All given points will be distinct.</p></div><div class="output-specification"><div class="section-title">Output</div><p>A single line denoting the longest possible length of a Hamiltonian cycle of the given cities. You should not output the cycle, only its length.</p><p>Please, do not write the <span class="tex-font-style-tt">%lld</span> specifier to read or write 64-bit integers in С++. It is preferred to use the <span class="tex-font-style-tt">cin</span>, <span class="tex-font-style-tt">cout</span> streams or the <span class="tex-font-style-tt">%I64d</span> specifier.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>4<br />1 1<br />1 2<br />2 1<br />2 2<br /></pre></div><div class="output"><div class="title">Output</div><pre>6<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the example, one of the possible Hamiltonian cycles with length 6 is (1, 1) (1, 2) (2, 1) (2, 2). There does not exist any other Hamiltonian cycle with a length greater than 6.</p><p>The Manhattan distance between two cities <span class="tex-span">(<i>x</i><sub class="lower-index"><i>i</i></sub>, <i>y</i><sub class="lower-index"><i>i</i></sub>)</span> and <span class="tex-span">(<i>x</i><sub class="lower-index"><i>j</i></sub>, <i>y</i><sub class="lower-index"><i>j</i></sub>)</span> is <span class="tex-span">|<i>x</i><sub class="lower-index"><i>i</i></sub> - <i>x</i><sub class="lower-index"><i>j</i></sub>| + |<i>y</i><sub class="lower-index"><i>i</i></sub> - <i>y</i><sub class="lower-index"><i>j</i></sub>|</span>.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=E]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/83804");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
    </div>

    <div id="footer">
        <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2024 Mike Mirzayanov</div>
        <div>The only programming contests Web 2.0 platform</div>

    </div>

</div>
</div>
    <script type="application/javascript">
        if ('serviceWorker' in navigator && 'fetch' in window && 'caches' in window) {
            navigator.serviceWorker.register('/service-worker-83804.js')
                .then(function (registration) {
                    console.log('Service worker registered: ', registration);
                })
                .catch(function (error) {
                    console.log('Registration failed: ', error);
                });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'89ffaf604faa7782',t:'MTcyMDQzNzYyNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>


<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-743380-5"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-743380-5');
        </script>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="82606ec9e78bc94c501066aead44dbae"/>
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01"/>

    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery-1.8.3.js"></script>
    <script type="application/javascript">
        window.locale = "en";
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }

        /* Protection against trailing dot in domain. */
        let hostLength = window.location.host.length;
        if (hostLength > 1 && window.location.host[hostLength - 1] === '.') {
            window.location = window.location.protocol + "//" + window.location.host.substring(0, hostLength - 1);
        }
    </script>

    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="k1">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="//codeforces.org/s/64849/images/codeforces-sponsored-by-ton.png" />
    <link rel="image_src" href="//codeforces.org/s/64849/images/codeforces-sponsored-by-ton.png" />
    <meta property="og:title" content="Problems - Codeforces"/>
    <meta property="og:description" content=""/>
    
    <meta property="og:site_name" content="Codeforces"/>
    
    
    
    
    
    
    <meta name="utc_offset" content="+03:00"/>
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Problems - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community" />
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup" />
    <meta name="robots" content="index, follow" />

    <link rel="stylesheet" href="//codeforces.org/s/64849/css/font-awesome.min.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/line-awesome.min.css" type="text/css" charset="utf-8" />

        <link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>


    <link rel="apple-touch-icon" sizes="57x57" href="//codeforces.org/s/64849/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="//codeforces.org/s/64849/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="//codeforces.org/s/64849/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="//codeforces.org/s/64849/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="//codeforces.org/s/64849/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="//codeforces.org/s/64849/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="//codeforces.org/s/64849/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="//codeforces.org/s/64849/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="//codeforces.org/s/64849/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="//codeforces.org/s/64849/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="//codeforces.org/s/64849/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="//codeforces.org/s/64849/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="//codeforces.org/s/64849/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="//codeforces.org/s/64849/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/prettify.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/clear.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/ttypography.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/problem-statement.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/second-level-menu.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/roundbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/datatable.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/table-form.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/topic.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/jquery.jgrowl.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/facebox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/jquery.wysiwyg.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/jquery.autocomplete.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/codeforces.datepick.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/colorbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/jquery.drafts.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/64849/css/community.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/64849/css/sidebar-menu.css" type="text/css" charset="utf-8" />

    <!-- MathJax -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    MathJax.Hub.Register.StartupHook("End", function () {
        Codeforces.runMathJaxListeners();
    });
    </script>
    <script type="text/javascript" async
            src="https://mathjax.codeforces.org/MathJax.js?config=TeX-AMS_HTML-full"
    >
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="//codeforces.org/s/64849/js/prettify/prettify.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/pushstream.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.easing.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.swipe.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.hotkeys.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/facebox.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/controls/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/controls/wysiwyg.table.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/controls/wysiwyg.image.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/controls/wysiwyg.link.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.datepick.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.drafts.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/clipboard.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/autosize.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/sjcl.js"></script>
    <script type="text/javascript" src="/scripts/f8f695306b4bab3cbdd456143062ab76/en/codeforces-options.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/codeforces.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/EventCatcher.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/preparedVerdictFormats-en.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/confetti.min.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="//codeforces.org/s/64849/markitup/skins/markitup/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/markitup/sets/markdown/style.css" type="text/css" charset="utf-8" />


    <script type="text/javascript" src="//codeforces.org/s/64849/markitup/jquery.markitup.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/markitup/sets/markdown/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->




</head>
<body class=" "><span style='display:none;' class='csrf-token' data-csrf='82606ec9e78bc94c501066aead44dbae'>&nbsp;</span>

<!-- .notificationTextCleaner used in Codeforces.showAnnouncements() -->
<div class="notificationTextCleaner" style="font-size: 0"></div>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 3.0rem;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    String.prototype.hashCode = function() {
        var hash = 0, i, chr;
        if (this.length === 0) return hash;
        for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };

    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile === "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>





    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 700
        });
    }, 100);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


    function showAnnouncements(json) {
        //info("j=" + JSON.stringify(json));

        if (json.t != "a") {
            return;
        }

        setTimeout(function() {
            Codeforces.showAnnouncements(json.d, "en");
        }, Math.random() * 500);
    }

    function showEventCatcherUserMessage(json) {
        if (json.t == "s") {
            var points = json.d[5];
            var passedTestCount = json.d[7];
            var judgedTestCount = json.d[8];
            var verdict = preparedVerdictFormats[json.d[12]];
            var verdictPrototypeDiv = $(".verdictPrototypeDiv");
            verdictPrototypeDiv.html(verdict);
            if (judgedTestCount != null && judgedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-judged").text(judgedTestCount);
            }
            if (passedTestCount != null && passedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-passed").text(passedTestCount);
            }
            if (points != null && points != undefined) {
                verdictPrototypeDiv.find(".verdict-format-points").text(points);
            }
            Codeforces.showMessage(verdictPrototypeDiv.text());
        }
    }

    $(".clickable-title").each(function() {
        var title = $(this).attr("data-title");
        if (title) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = title;
            $(this).attr("title", tmp.textContent || tmp.innerText || "");
        }
    });

    $(".clickable-title").click(function() {
        var title = $(this).attr("data-title");
        if (title) {
            Codeforces.alert(title);
        } else {
            Codeforces.alert($(this).attr("title"));
        }
    }).css("position", "relative").css("bottom", "3px");

        Codeforces.showDelayedMessage();

    Codeforces.reformatTimes();

    //Codeforces.initializePubSub();
    if (window.codeforcesOptions.subscribeServerUrl) {
        window.eventCatcher = new EventCatcher(
            window.codeforcesOptions.subscribeServerUrl,
            [
                Codeforces.getGlobalChannel(),
                Codeforces.getUserChannel(),
                Codeforces.getUserShowMessageChannel(),
                Codeforces.getContestChannel(),
                Codeforces.getParticipantChannel(),
                Codeforces.getTalkChannel()
            ]
        );

        if (Codeforces.getParticipantChannel()) {
            window.eventCatcher.subscribe(Codeforces.getParticipantChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getContestChannel()) {
            window.eventCatcher.subscribe(Codeforces.getContestChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getGlobalChannel()) {
            window.eventCatcher.subscribe(Codeforces.getGlobalChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserShowMessageChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserShowMessageChannel(), function(json) {
                showEventCatcherUserMessage(json);
            });
        }
    }

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>


<div id="body">
<div style="width: 950px; margin: 0 auto;" class="compact-problemset">
    <div id="header" style="position: relative; margin: 0;">
        <div style="float:left;">
                  <a href="/"><img height="65" style="height: 65px;" src="//codeforces.org/s/64849/images/codeforces-sponsored-by-ton.png" alt="Codeforces"/></a>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="//codeforces.org/s/64849/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="//codeforces.org/s/64849/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <br style="clear: both;"/>

    <div style="text-align: center; font-size: 1.8rem; margin-bottom: 0.5em;"
         class="caption">Codeforces Round 369 (Div. 2)</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

    <div class="problem-frames">
        <div
                    style="margin-bottom: 2em;"
        >

    <style>
        #facebox .content:has(.diff-popup) {
            width: 90vw;
            max-width: 120rem !important;
        }

        .testCaseMarker {
            position: absolute;
            font-weight: bold;
            font-size: 1rem;
        }

        .diff-popup {
            width: 90vw;
            max-width: 120rem !important;
            display: none;
            overflow: auto;
        }

        .input-output-copier {
            font-size: 1.2rem;
            float: right;
            color: #888 !important;
            cursor: pointer;
            border: 1px solid rgb(185, 185, 185);
            padding: 3px;
            margin: 1px;
            line-height: 1.1rem;
            text-transform: none;
        }

        .input-output-copier:hover {
            background-color: #def;
        }

        .test-explanation textarea {
            width: 100%;
            height: 1.5em;
        }

        .pending-submission-message {
            color: darkorange !important;
        }
    </style>
    <script>
        const OPENING_SPACE = String.fromCharCode(1001);
        const CLOSING_SPACE = String.fromCharCode(1002);

        const nodeToText = function (node, pre) {
            let result = [];

            if (node.tagName === "SCRIPT" || node.tagName === "math"
                || (node.classList && node.classList.contains("input-output-copier")))
                return [];

            if (node.tagName === "NOBR") {
                result.push(OPENING_SPACE);
            }

            if (node.nodeType === Node.TEXT_NODE) {
                let s = node.textContent;
                if (!pre) {
                    s = s.replace(/\s+/g, " ");
                }
                if (s.length > 0) {
                    result.push(s);
                }
            }

            if (pre && node.tagName === "BR") {
                result.push("\n");
            }

            node.childNodes.forEach(function (child) {
                result.push(nodeToText(child, node.tagName === "PRE").join(""));
            });

            if (node.tagName === "DIV"
                || node.tagName === "P"
                || node.tagName === "PRE"
                || node.tagName === "UL"
                || node.tagName === "LI"
            ) {
                result.push("\n");
            }

            if (node.tagName === "NOBR") {
                result.push(CLOSING_SPACE);
            }

            return result;
        }

        const isSpecial = function (c) {
            return c === ',' || c === '.' || c === ';' || c === ')' || c === ' ';
        }

        const convertStatementToText = function(statmentNode) {
            const text = nodeToText(statmentNode, false).join("").replace(/ +/g, " ").replace(/\n\n+/g, "\n\n");
            let result = [];
            for (let i = 0; i < text.length; i++) {
                const c = text.charAt(i);
                if (c === OPENING_SPACE) {
                    if (!((i > 0 && text.charAt(i - 1) === '(') || (result.length > 0 && result[result.length - 1] === ' '))) {
                        result.push('+');
                    }
                } else if (c === CLOSING_SPACE) {
                    if (!(i + 1 < text.length && isSpecial(text.charAt(i + 1)))) {
                        result.push('-');
                    }
                } else {
                    result.push(c);
                }
            }
            return result.join("").split("\n").map(value => value.trim()).join("\n");
        };
    </script>
    <div class="diff-popup">
    </div>

<div class="problemindexholder" problemindex="A" data-uuid="ps_e2d423e88ba39d84f0c41d3a43bdcda6b304193e">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A. Bus to Udayland</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>ZS the Coder and Chris the Baboon are travelling to Udayland! To get there, they have to get on the special IOI bus. The IOI bus has <span class="tex-span"><i>n</i></span> rows of seats. There are <span class="tex-span">4</span> seats in each row, and the seats are separated into pairs by a walkway. When ZS and Chris came, some places in the bus was already occupied.</p><p>ZS and Chris are good friends. They insist to get <span class="tex-font-style-bf">a pair of neighbouring empty seats</span>. Two seats are considered neighbouring if they are in the same row and in the same pair. Given the configuration of the bus, can you help ZS and Chris determine where they should sit?</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of the input contains a single integer <span class="tex-span"><i>n</i></span> <span class="tex-span">(1 ≤ <i>n</i> ≤ 1000)</span> — the number of rows of seats in the bus.</p><p>Then, <span class="tex-span"><i>n</i></span> lines follow. Each line contains exactly <span class="tex-span">5</span> characters, the first two of them denote the first pair of seats in the row, the third character denotes the walkway (it always equals '|') and the last two of them denote the second pair of seats in the row. </p><p>Each character, except the walkway, equals to 'O' or to 'X'. 'O' denotes an empty seat, 'X' denotes an occupied seat. See the sample cases for more details. </p></div><div class="output-specification"><div class="section-title">Output</div><p>If it is possible for Chris and ZS to sit at neighbouring empty seats, print &quot;YES&quot; (without quotes) in the first line. In the next <span class="tex-span"><i>n</i></span> lines print the bus configuration, where the characters in the pair of seats for Chris and ZS is changed with characters '+'. Thus the configuration should differ from the input one by exactly two charaters (they should be equal to 'O' in the input and to '+' in the output).</p><p>If there is no pair of seats for Chris and ZS, print &quot;NO&quot; (without quotes) in a single line.</p><p>If there are multiple solutions, you may print any of them.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>6<br />OO|OX<br />XO|XX<br />OX|OO<br />XX|OX<br />OO|OO<br />OO|XX<br /></pre></div><div class="output"><div class="title">Output</div><pre>YES<br />++|OX<br />XO|XX<br />OX|OO<br />XX|OX<br />OO|OO<br />OO|XX<br /></pre></div><div class="input"><div class="title">Input</div><pre>4<br />XO|OX<br />XO|XX<br />OX|OX<br />XX|OX<br /></pre></div><div class="output"><div class="title">Output</div><pre>NO<br /></pre></div><div class="input"><div class="title">Input</div><pre>5<br />XX|XX<br />XX|XX<br />XO|OX<br />XO|OO<br />OX|XO<br /></pre></div><div class="output"><div class="title">Output</div><pre>YES<br />XX|XX<br />XX|XX<br />XO|OX<br />XO|++<br />OX|XO<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Note that the following is an incorrect configuration for the first sample case because the seats must be in the same pair.</p><p><span class="tex-font-style-tt">O+|+X</span></p><p><span class="tex-font-style-tt">XO|XX</span></p><p><span class="tex-font-style-tt">OX|OO</span></p><p><span class="tex-font-style-tt">XX|OX</span></p><p><span class="tex-font-style-tt">OO|OO</span></p><p><span class="tex-font-style-tt">OO|XX</span></p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=A]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {
        window.changedTests = new Set();

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");



        String.prototype.replaceAll = function (search, replace) {
            return this.split(search).join(replace);
        };

        $(".sample-test .title").each(function () {
            const preId = ("id" + Math.random()).replaceAll(".", "0");
            const cpyId = ("id" + Math.random()).replaceAll(".", "0");

            $(this).parent().find("pre").attr("id", preId);
            const $copy = $("<div title='Copy' data-clipboard-target='#" + preId + "' id='" + cpyId + "' class='input-output-copier'>Copy</div>");
            $(this).append($copy);

            const clipboard = new Clipboard('#' + cpyId, {
                text: function (trigger) {
                    const pre = document.querySelector('#' + preId);
                    const lines = pre.querySelectorAll(".test-example-line");
                    return Codeforces.filterClipboardText(pre.innerText, lines.length);
                }
            });

            const isInput = $(this).parent().hasClass("input");

            clipboard.on('success', function (e) {
                if (isInput) {
                    Codeforces.showMessage("The example input has been copied into the clipboard");
                } else {
                    Codeforces.showMessage("The example output has been copied into the clipboard");
                }
                e.clearSelection();
            });
        });

        $(".test-form-item input").change(function () {
            addPendingSubmissionMessage($($(this).closest("form")), "You changed the answer, do not forget to submit it if you want to save the changes");
            const index = $(this).closest(".problemindexholder").attr("problemindex");
            let test = "";
            $(this).closest("form input").each(function () {
                const test_ = $(this).attr("name");
                if (test_ && test_.substring(0, 4) === "test") {
                    test = test_;
                }
            });
            if (index.length > 0 && test.length > 0) {
                const indexTest = index + "::" + test;
                window.changedTests.add(indexTest);
            }
        });

        $(window).on('beforeunload', function () {
            if (window.changedTests.size > 0) {
                return 'Dialog text here';
            }
        });

        autosize($('.test-explanation textarea'));

        $(".test-example-line").hover(function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        let top = 1E20;
                        let left = 1E20;
                        let problem = $(this).closest(".problemindexholder");
                        $(this).closest(".input").find("." + clazz).css("background-color", "#FFFDE7").each(function() {
                            top = Math.min(top, $(this).offset().top);
                            left = Math.min(left, $(this).offset().left);
                        });
                        let testCaseMarker = problem.find(".testCaseMarker_" + end);
                        if (testCaseMarker.length === 0) {
                            const html = "<div class=\"testCaseMarker testCaseMarker_" + end + " notice\"></div>";
                            problem.append($(html));
                            testCaseMarker = problem.find(".testCaseMarker_" + end);
                        }
                        if (testCaseMarker) {
                            testCaseMarker.show()
                                    .offset({top, left: left - 20})
                                    .text(end);
                        }
                    }
                }
            });
        }, function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        $("." + clazz).css("background-color", "");
                        $(this).closest(".problemindexholder").find(".testCaseMarker_" + end).hide();
                    }
                }
            });
        });

    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="B" data-uuid="ps_fc6399accdd0f57dd64106306ce2ea58ba4a2248">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B. Chris and Magic Square</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>ZS the Coder and Chris the Baboon arrived at the entrance of Udayland. There is a <span class="tex-span"><i>n</i> × <i>n</i></span> magic grid on the entrance which is filled with integers. Chris noticed that exactly one of the cells in the grid is empty, and to enter Udayland, they need to fill a <span class="tex-font-style-bf">positive integer</span> into the empty cell.</p><p>Chris tried filling in random numbers but it didn't work. ZS the Coder realizes that they need to fill in a positive integer such that the numbers in the grid form <span class="tex-font-style-it">a magic square</span>. This means that he has to fill in a positive integer so that the sum of the numbers in each row of the grid (<img align="middle" class="tex-formula" src="https://espresso.codeforces.com/84d9c6e32ef1298cc936c35b0131ab75b15f947c.png" style="max-width: 100.0%;max-height: 100.0%;" />), each column of the grid (<img align="middle" class="tex-formula" src="https://espresso.codeforces.com/6d6585d1d6716c49d59de38fbfa9c3f112c4fb13.png" style="max-width: 100.0%;max-height: 100.0%;" />), and the two long diagonals of the grid (the main diagonal — <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/3b14e61ddae8941322273d61538786b273ba87bf.png" style="max-width: 100.0%;max-height: 100.0%;" /> and the secondary diagonal — <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/0831b5f2c141c2973dca669d78fe949ba67b5b12.png" style="max-width: 100.0%;max-height: 100.0%;" />) are equal. </p><p>Chris doesn't know what number to fill in. Can you help Chris find the correct positive integer to fill in or determine that it is impossible?</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of the input contains a single integer <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 500</span>) — the number of rows and columns of the magic grid.</p><p><span class="tex-span"><i>n</i></span> lines follow, each of them contains <span class="tex-span"><i>n</i></span> integers. The <span class="tex-span"><i>j</i></span>-th number in the <span class="tex-span"><i>i</i></span>-th of them denotes <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i>, <i>j</i></sub></span> (<span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i>, <i>j</i></sub> ≤ 10<sup class="upper-index">9</sup></span> or <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i>, <i>j</i></sub> = 0</span>), the number in the <span class="tex-span"><i>i</i></span>-th row and <span class="tex-span"><i>j</i></span>-th column of the magic grid. If the corresponding cell is empty, <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i>, <i>j</i></sub></span> will be equal to <span class="tex-span">0</span>. Otherwise, <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i>, <i>j</i></sub></span> is <span class="tex-font-style-bf">positive</span>.</p><p>It is guaranteed that there is exactly one pair of integers <span class="tex-span"><i>i</i>, <i>j</i></span> <span class="tex-span">(1 ≤ <i>i</i>, <i>j</i> ≤ <i>n</i>)</span> such that <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i>, <i>j</i></sub> = 0</span>.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Output a single integer, the positive integer <span class="tex-span"><i>x</i></span> (<span class="tex-span">1 ≤ <i>x</i> ≤ 10<sup class="upper-index">18</sup></span>) that should be filled in the empty cell so that the whole grid becomes a magic square. If such positive integer <span class="tex-span"><i>x</i></span> does not exist, output <span class="tex-span"> - 1</span> instead.</p><p>If there are multiple solutions, you may print any of them.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3<br />4 0 2<br />3 5 7<br />8 1 6<br /></pre></div><div class="output"><div class="title">Output</div><pre>9<br /></pre></div><div class="input"><div class="title">Input</div><pre>4<br />1 1 1 1<br />1 1 0 1<br />1 1 1 1<br />1 1 1 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>1<br /></pre></div><div class="input"><div class="title">Input</div><pre>4<br />1 1 1 1<br />1 1 0 1<br />1 1 2 1<br />1 1 1 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>-1<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample case, we can fill in <span class="tex-span">9</span> into the empty cell to make the resulting grid a magic square. Indeed, </p><p>The sum of numbers in each row is:</p><p><span class="tex-span">4 + 9 + 2 = 3 + 5 + 7 = 8 + 1 + 6 = 15</span>.</p><p>The sum of numbers in each column is:</p><p><span class="tex-span">4 + 3 + 8 = 9 + 5 + 1 = 2 + 7 + 6 = 15</span>.</p><p>The sum of numbers in the two diagonals is:</p><p><span class="tex-span">4 + 5 + 6 = 2 + 5 + 8 = 15</span>.</p><p>In the third sample case, it is impossible to fill a number in the empty square such that the resulting grid is a magic square.</p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=B]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="C" data-uuid="ps_2b157522331c6a9e368c803500f52a49fe41bbef">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C. Coloring Trees</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>ZS the Coder and Chris the Baboon has arrived at Udayland! They walked in the park where <span class="tex-span"><i>n</i></span> trees grow. They decided to be naughty and color the trees in the park. The trees are numbered with integers from <span class="tex-span">1</span> to <span class="tex-span"><i>n</i></span> from left to right.</p><p>Initially, tree <span class="tex-span"><i>i</i></span> has color <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span>. ZS the Coder and Chris the Baboon recognizes only <span class="tex-span"><i>m</i></span> different colors, so <span class="tex-span">0 ≤ <i>c</i><sub class="lower-index"><i>i</i></sub> ≤ <i>m</i></span>, where <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub> = 0</span> means that tree <span class="tex-span"><i>i</i></span> is <span class="tex-font-style-it">uncolored</span>.</p><p>ZS the Coder and Chris the Baboon decides to color only the uncolored trees, i.e. the trees with <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub> = 0</span>. They can color each of them them in any of the <span class="tex-span"><i>m</i></span> colors from <span class="tex-span">1</span> to <span class="tex-span"><i>m</i></span>. Coloring the <span class="tex-span"><i>i</i></span>-th tree with color <span class="tex-span"><i>j</i></span> requires exactly <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i>, <i>j</i></sub></span> litres of paint.</p><p>The two friends define the <span class="tex-font-style-it">beauty</span> of a coloring of the trees as the <span class="tex-font-style-bf">minimum</span> number of contiguous groups (each group contains some subsegment of trees) you can split all the <span class="tex-span"><i>n</i></span> trees into so that each group contains trees of the same color. For example, if the colors of the trees from left to right are <span class="tex-span">2, 1, 1, 1, 3, 2, 2, 3, 1, 3</span>, the beauty of the coloring is <span class="tex-span">7</span>, since we can partition the trees into <span class="tex-span">7</span> contiguous groups of the same color : <span class="tex-span">{2}, {1, 1, 1}, {3}, {2, 2}, {3}, {1}, {3}</span>. </p><p>ZS the Coder and Chris the Baboon wants to color all uncolored trees so that the beauty of the coloring is <span class="tex-font-style-bf">exactly</span> <span class="tex-span"><i>k</i></span>. They need your help to determine the minimum amount of paint (in litres) needed to finish the job.</p><p>Please note that the friends can't color the trees that are already colored.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains three integers, <span class="tex-span"><i>n</i></span>, <span class="tex-span"><i>m</i></span> and <span class="tex-span"><i>k</i></span> (<span class="tex-span">1 ≤ <i>k</i> ≤ <i>n</i> ≤ 100</span>, <span class="tex-span">1 ≤ <i>m</i> ≤ 100</span>) — the number of trees, number of colors and beauty of the resulting coloring respectively.</p><p>The second line contains <span class="tex-span"><i>n</i></span> integers <span class="tex-span"><i>c</i><sub class="lower-index">1</sub>, <i>c</i><sub class="lower-index">2</sub>, ..., <i>c</i><sub class="lower-index"><i>n</i></sub></span> (<span class="tex-span">0 ≤ <i>c</i><sub class="lower-index"><i>i</i></sub> ≤ <i>m</i></span>), the initial colors of the trees. <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> equals to <span class="tex-span">0</span> if the tree number <span class="tex-span"><i>i</i></span> is uncolored, otherwise the <span class="tex-span"><i>i</i></span>-th tree has color <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span>.</p><p>Then <span class="tex-span"><i>n</i></span> lines follow. Each of them contains <span class="tex-span"><i>m</i></span> integers. The <span class="tex-span"><i>j</i></span>-th number on the <span class="tex-span"><i>i</i></span>-th of them line denotes <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i>, <i>j</i></sub></span> (<span class="tex-span">1 ≤ <i>p</i><sub class="lower-index"><i>i</i>, <i>j</i></sub> ≤ 10<sup class="upper-index">9</sup></span>) — the amount of litres the friends need to color <span class="tex-span"><i>i</i></span>-th tree with color <span class="tex-span"><i>j</i></span>. <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i>, <i>j</i></sub></span>'s are specified even for the initially colored trees, but such trees still can't be colored.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print a single integer, the minimum amount of paint needed to color the trees. If there are no valid tree colorings of beauty <span class="tex-span"><i>k</i></span>, print <span class="tex-span"> - 1</span>.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3 2 2<br />0 0 0<br />1 2<br />3 4<br />5 6<br /></pre></div><div class="output"><div class="title">Output</div><pre>10</pre></div><div class="input"><div class="title">Input</div><pre>3 2 2<br />2 1 2<br />1 3<br />2 4<br />3 5<br /></pre></div><div class="output"><div class="title">Output</div><pre>-1</pre></div><div class="input"><div class="title">Input</div><pre>3 2 2<br />2 0 0<br />1 3<br />2 4<br />3 5<br /></pre></div><div class="output"><div class="title">Output</div><pre>5</pre></div><div class="input"><div class="title">Input</div><pre>3 2 3<br />2 1 2<br />1 3<br />2 4<br />3 5<br /></pre></div><div class="output"><div class="title">Output</div><pre>0</pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample case, coloring the trees with colors <span class="tex-span">2, 1, 1</span> minimizes the amount of paint used, which equals to <span class="tex-span">2 + 3 + 5 = 10</span>. Note that <span class="tex-span">1, 1, 1</span> would not be valid because the beauty of such coloring equals to <span class="tex-span">1</span> (<span class="tex-span">{1, 1, 1}</span> is a way to group the trees into a single group of the same color).</p><p>In the second sample case, all the trees are colored, but the beauty of the coloring is <span class="tex-span">3</span>, so there is no valid coloring, and the answer is <span class="tex-span"> - 1</span>.</p><p>In the last sample case, all the trees are colored and the beauty of the coloring matches <span class="tex-span"><i>k</i></span>, so no paint is used and the answer is <span class="tex-span">0</span>. </p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=C]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="D" data-uuid="ps_6438fb54a98b953d04ca37ac920c0db81644df41">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. Directed Roads</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>ZS the Coder and Chris the Baboon has explored Udayland for quite some time. They realize that it consists of <span class="tex-span"><i>n</i></span> towns numbered from <span class="tex-span">1</span> to <span class="tex-span"><i>n</i></span>. </p><p>There are <span class="tex-span"><i>n</i></span> directed roads in the Udayland. <span class="tex-span"><i>i</i></span>-th of them goes from town <span class="tex-span"><i>i</i></span> to some other town <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub> ≠ <i>i</i></span>). ZS the Coder can flip the direction of any road in Udayland, i.e. if it goes from town <span class="tex-span"><i>A</i></span> to town <span class="tex-span"><i>B</i></span> before the flip, it will go from town <span class="tex-span"><i>B</i></span> to town <span class="tex-span"><i>A</i></span> after.</p><p>ZS the Coder considers the roads in the Udayland <span class="tex-font-style-it">confusing</span>, if there is a sequence of distinct towns <span class="tex-span"><i>A</i><sub class="lower-index">1</sub>, <i>A</i><sub class="lower-index">2</sub>, ..., <i>A</i><sub class="lower-index"><i>k</i></sub></span> (<span class="tex-span"><i>k</i> &gt; 1</span>) such that for every <span class="tex-span">1 ≤ <i>i</i> &lt; <i>k</i></span> there is a road from town <span class="tex-span"><i>A</i><sub class="lower-index"><i>i</i></sub></span> to town <span class="tex-span"><i>A</i><sub class="lower-index"><i>i</i> + 1</sub></span> and another road from town <span class="tex-span"><i>A</i><sub class="lower-index"><i>k</i></sub></span> to town <span class="tex-span"><i>A</i><sub class="lower-index">1</sub></span>. In other words, the roads are confusing if <span class="tex-font-style-bf">some of them</span> form a directed cycle of some towns.</p><p>Now ZS the Coder wonders how many sets of roads (there are <span class="tex-span">2<sup class="upper-index"><i>n</i></sup></span> variants) in initial configuration can he choose to flip such that after flipping each road in the set exactly once, the resulting network will <span class="tex-font-style-bf">not</span> be confusing.</p><p>Note that it is allowed that after the flipping there are more than one directed road from some town and possibly some towns with no roads leading out of it, or multiple roads between any pair of cities.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of the input contains single integer <span class="tex-span"><i>n</i></span> (<span class="tex-span">2 ≤ <i>n</i> ≤ 2·10<sup class="upper-index">5</sup></span>) — the number of towns in Udayland.</p><p>The next line contains <span class="tex-span"><i>n</i></span> integers <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>n</i></sub></span> <span class="tex-span">(1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i>, <i>a</i><sub class="lower-index"><i>i</i></sub> ≠ <i>i</i>)</span>, <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> denotes a road going from town <span class="tex-span"><i>i</i></span> to town <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print a single integer — the number of ways to flip some set of the roads so that the resulting whole set of all roads is not confusing. Since this number may be too large, print the answer modulo <span class="tex-span">10<sup class="upper-index">9</sup> + 7</span>.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3<br />2 3 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>6<br /></pre></div><div class="input"><div class="title">Input</div><pre>4<br />2 1 1 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>8<br /></pre></div><div class="input"><div class="title">Input</div><pre>5<br />2 4 2 5 3<br /></pre></div><div class="output"><div class="title">Output</div><pre>28<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Consider the first sample case. There are <span class="tex-span">3</span> towns and <span class="tex-span">3</span> roads. The towns are numbered from <span class="tex-span">1</span> to <span class="tex-span">3</span> and the roads are <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/e5b18c46402af724bd3841d549d5d6f52fc16253.png" style="max-width: 100.0%;max-height: 100.0%;" />, <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/29f71c065c3536e88b54429c734103ad3604f68b.png" style="max-width: 100.0%;max-height: 100.0%;" />, <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/030fc9181b578c2d906254d38dc56da5554323eb.png" style="max-width: 100.0%;max-height: 100.0%;" /> initially. Number the roads <span class="tex-span">1</span> to <span class="tex-span">3</span> in this order. </p><p>The sets of roads that ZS the Coder can flip (to make them not confusing) are <span class="tex-span">{1}, {2}, {3}, {1, 2}, {1, 3}, {2, 3}</span>. Note that the empty set is invalid because if no roads are flipped, then towns <span class="tex-span">1, 2, 3</span> is form a directed cycle, so it is confusing. Similarly, flipping all roads is confusing too. Thus, there are a total of <span class="tex-span">6</span> possible sets ZS the Coder can flip.</p><p>The sample image shows all possible ways of orienting the roads from the first sample such that the network is <span class="tex-font-style-bf">not confusing</span>.</p><p><img class="tex-graphics" src="https://espresso.codeforces.com/2e275877797bea4817665ce9cfb5274b837194bc.png" style="max-width: 100.0%;max-height: 100.0%;" /></p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=D]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 1em;"
        >


<div class="problemindexholder" problemindex="E" data-uuid="ps_5448c037c038be6da1c64060176d45304d4eceb0">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. ZS and The Birthday Paradox</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>ZS the Coder has recently found an interesting concept called the Birthday Paradox. It states that given a random set of <span class="tex-span">23</span> people, there is around <span class="tex-span">50%</span> chance that some two of them share the same birthday. ZS the Coder finds this very interesting, and decides to test this with the inhabitants of Udayland.</p><p>In Udayland, there are <span class="tex-span">2<sup class="upper-index"><i>n</i></sup></span> days in a year. ZS the Coder wants to interview <span class="tex-span"><i>k</i></span> people from Udayland, each of them has birthday in one of <span class="tex-span">2<sup class="upper-index"><i>n</i></sup></span> days (each day with equal probability). He is interested in the probability of at least two of them have the birthday at the same day. </p><p>ZS the Coder knows that the answer can be written as an irreducible fraction <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/930727af0e5a75c815d4282e2e454bf5e3fae083.png" style="max-width: 100.0%;max-height: 100.0%;" />. He wants to find the values of <span class="tex-span"><i>A</i></span> and <span class="tex-span"><i>B</i></span> (he does not like to deal with floating point numbers). Can you help him?</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first and only line of the input contains two integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>k</i></span> <span class="tex-span">(1 ≤ <i>n</i> ≤ 10<sup class="upper-index">18</sup>, 2 ≤ <i>k</i> ≤ 10<sup class="upper-index">18</sup>)</span>, meaning that there are <span class="tex-span">2<sup class="upper-index"><i>n</i></sup></span> days in a year and that ZS the Coder wants to interview exactly <span class="tex-span"><i>k</i></span> people.</p></div><div class="output-specification"><div class="section-title">Output</div><p>If the probability of at least two <span class="tex-span"><i>k</i></span> people having the same birthday in <span class="tex-span">2<sup class="upper-index"><i>n</i></sup></span> days long year equals <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/930727af0e5a75c815d4282e2e454bf5e3fae083.png" style="max-width: 100.0%;max-height: 100.0%;" /> (<span class="tex-span"><i>A</i> ≥ 0</span>, <span class="tex-span"><i>B</i> ≥ 1</span>, <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/47ae85b047b70a12975d0f4e001f9796b29a6e67.png" style="max-width: 100.0%;max-height: 100.0%;" />), print the <span class="tex-span"><i>A</i></span> and <span class="tex-span"><i>B</i></span> in a single line.</p><p>Since these numbers may be too large, print them modulo <span class="tex-span">10<sup class="upper-index">6</sup> + 3</span>. Note that <span class="tex-span"><i>A</i></span> and <span class="tex-span"><i>B</i></span> must be coprime <span class="tex-font-style-bf">before</span> their remainders modulo <span class="tex-span">10<sup class="upper-index">6</sup> + 3</span> are taken.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3 2<br /></pre></div><div class="output"><div class="title">Output</div><pre>1 8</pre></div><div class="input"><div class="title">Input</div><pre>1 3<br /></pre></div><div class="output"><div class="title">Output</div><pre>1 1</pre></div><div class="input"><div class="title">Input</div><pre>4 3<br /></pre></div><div class="output"><div class="title">Output</div><pre>23 128</pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample case, there are <span class="tex-span">2<sup class="upper-index">3</sup> = 8</span> days in Udayland. The probability that <span class="tex-span">2</span> people have the same birthday among <span class="tex-span">2</span> people is clearly <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/5947a169159fe867f85f3fd8b9690019b48152f5.png" style="max-width: 100.0%;max-height: 100.0%;" />, so <span class="tex-span"><i>A</i> = 1</span>, <span class="tex-span"><i>B</i> = 8</span>.</p><p>In the second sample case, there are only <span class="tex-span">2<sup class="upper-index">1</sup> = 2</span> days in Udayland, but there are <span class="tex-span">3</span> people, so it is guaranteed that two of them have the same birthday. Thus, the probability is <span class="tex-span">1</span> and <span class="tex-span"><i>A</i> = <i>B</i> = 1</span>.</p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=E]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
    </div>

    <div id="footer">
        <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2024 Mike Mirzayanov</div>
        <div>The only programming contests Web 2.0 platform</div>

    </div>

</div>
</div>
    <script type="application/javascript">
        if ('serviceWorker' in navigator && 'fetch' in window && 'caches' in window) {
            navigator.serviceWorker.register('/service-worker-64849.js')
                .then(function (registration) {
                    console.log('Service worker registered: ', registration);
                })
                .catch(function (error) {
                    console.log('Registration failed: ', error);
                });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8a017ba8ffb2777b',t:'MTcyMDQ1NjQ4MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

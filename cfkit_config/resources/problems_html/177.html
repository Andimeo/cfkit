
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-743380-5"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-743380-5');
        </script>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="2d2dee1ce85fe287a1035af63e09cac5"/>
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01"/>

    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery-1.8.3.js"></script>
    <script type="application/javascript">
        window.locale = "en";
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }

        /* Protection against trailing dot in domain. */
        let hostLength = window.location.host.length;
        if (hostLength > 1 && window.location.host[hostLength - 1] === '.') {
            window.location = window.location.protocol + "//" + window.location.host.substring(0, hostLength - 1);
        }
    </script>

    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="j2">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="//codeforces.org/s/49284/images/codeforces-sponsored-by-ton.png" />
    <link rel="image_src" href="//codeforces.org/s/49284/images/codeforces-sponsored-by-ton.png" />
    <meta property="og:title" content="Problems - Codeforces"/>
    <meta property="og:description" content=""/>
    
    <meta property="og:site_name" content="Codeforces"/>
    
    
    
    
    
    
    <meta name="utc_offset" content="+03:00"/>
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Problems - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community" />
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup" />
    <meta name="robots" content="index, follow" />

    <link rel="stylesheet" href="//codeforces.org/s/49284/css/font-awesome.min.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/line-awesome.min.css" type="text/css" charset="utf-8" />

        <link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>


    <link rel="apple-touch-icon" sizes="57x57" href="//codeforces.org/s/49284/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="//codeforces.org/s/49284/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="//codeforces.org/s/49284/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="//codeforces.org/s/49284/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="//codeforces.org/s/49284/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="//codeforces.org/s/49284/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="//codeforces.org/s/49284/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="//codeforces.org/s/49284/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="//codeforces.org/s/49284/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="//codeforces.org/s/49284/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="//codeforces.org/s/49284/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="//codeforces.org/s/49284/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="//codeforces.org/s/49284/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="//codeforces.org/s/49284/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/prettify.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/clear.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/ttypography.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/problem-statement.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/second-level-menu.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/roundbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/datatable.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/table-form.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/topic.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/jquery.jgrowl.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/facebox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/jquery.wysiwyg.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/jquery.autocomplete.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/codeforces.datepick.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/colorbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/css/jquery.drafts.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/49284/css/community.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/49284/css/sidebar-menu.css" type="text/css" charset="utf-8" />

    <!-- MathJax -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    MathJax.Hub.Register.StartupHook("End", function () {
        Codeforces.runMathJaxListeners();
    });
    </script>
    <script type="text/javascript" async
            src="https://mathjax.codeforces.org/MathJax.js?config=TeX-AMS_HTML-full"
    >
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="//codeforces.org/s/49284/js/prettify/prettify.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/pushstream.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.easing.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.swipe.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.hotkeys.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/facebox.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/controls/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/controls/wysiwyg.table.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/controls/wysiwyg.image.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/controls/wysiwyg.link.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.datepick.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/jquery.drafts.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/clipboard.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/autosize.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/sjcl.js"></script>
    <script type="text/javascript" src="/scripts/7fbe203c3ac496959a36220db411efde/en/codeforces-options.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/codeforces.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/EventCatcher.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/preparedVerdictFormats-en.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/js/confetti.min.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="//codeforces.org/s/49284/markitup/skins/markitup/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/49284/markitup/sets/markdown/style.css" type="text/css" charset="utf-8" />


    <script type="text/javascript" src="//codeforces.org/s/49284/markitup/jquery.markitup.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/49284/markitup/sets/markdown/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->




</head>
<body class=" "><span style='display:none;' class='csrf-token' data-csrf='2d2dee1ce85fe287a1035af63e09cac5'>&nbsp;</span>

<!-- .notificationTextCleaner used in Codeforces.showAnnouncements() -->
<div class="notificationTextCleaner" style="font-size: 0"></div>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 3.0rem;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    String.prototype.hashCode = function() {
        var hash = 0, i, chr;
        if (this.length === 0) return hash;
        for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };

    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile === "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>





    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 700
        });
    }, 100);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


    function showAnnouncements(json) {
        //info("j=" + JSON.stringify(json));

        if (json.t != "a") {
            return;
        }

        setTimeout(function() {
            Codeforces.showAnnouncements(json.d, "en");
        }, Math.random() * 500);
    }

    function showEventCatcherUserMessage(json) {
        if (json.t == "s") {
            var points = json.d[5];
            var passedTestCount = json.d[7];
            var judgedTestCount = json.d[8];
            var verdict = preparedVerdictFormats[json.d[12]];
            var verdictPrototypeDiv = $(".verdictPrototypeDiv");
            verdictPrototypeDiv.html(verdict);
            if (judgedTestCount != null && judgedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-judged").text(judgedTestCount);
            }
            if (passedTestCount != null && passedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-passed").text(passedTestCount);
            }
            if (points != null && points != undefined) {
                verdictPrototypeDiv.find(".verdict-format-points").text(points);
            }
            Codeforces.showMessage(verdictPrototypeDiv.text());
        }
    }

    $(".clickable-title").each(function() {
        var title = $(this).attr("data-title");
        if (title) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = title;
            $(this).attr("title", tmp.textContent || tmp.innerText || "");
        }
    });

    $(".clickable-title").click(function() {
        var title = $(this).attr("data-title");
        if (title) {
            Codeforces.alert(title);
        } else {
            Codeforces.alert($(this).attr("title"));
        }
    }).css("position", "relative").css("bottom", "3px");

        Codeforces.showDelayedMessage();

    Codeforces.reformatTimes();

    //Codeforces.initializePubSub();
    if (window.codeforcesOptions.subscribeServerUrl) {
        window.eventCatcher = new EventCatcher(
            window.codeforcesOptions.subscribeServerUrl,
            [
                Codeforces.getGlobalChannel(),
                Codeforces.getUserChannel(),
                Codeforces.getUserShowMessageChannel(),
                Codeforces.getContestChannel(),
                Codeforces.getParticipantChannel(),
                Codeforces.getTalkChannel()
            ]
        );

        if (Codeforces.getParticipantChannel()) {
            window.eventCatcher.subscribe(Codeforces.getParticipantChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getContestChannel()) {
            window.eventCatcher.subscribe(Codeforces.getContestChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getGlobalChannel()) {
            window.eventCatcher.subscribe(Codeforces.getGlobalChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserShowMessageChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserShowMessageChannel(), function(json) {
                showEventCatcherUserMessage(json);
            });
        }
    }

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>


<div id="body">
<div style="width: 950px; margin: 0 auto;" class="compact-problemset">
    <div id="header" style="position: relative; margin: 0;">
        <div style="float:left;">
            <div style="padding:1em 0 0 2px;color:#C60C30;font-size:18px;font-weight:bold;">
<a href="/abbyycup20"><img src="http://www.abbyy.ru/images/logo.gif"/></a>
<span style="padding:1.5em;position:relative;bottom:7px;">ABBYY Cup 2.0 is waiting for you!</span>
</div>

        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="//codeforces.org/s/49284/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="//codeforces.org/s/49284/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <br style="clear: both;"/>

    <div style="text-align: center; font-size: 1.8rem; margin-bottom: 0.5em;"
         class="caption">ABBYY Cup 2.0 - Easy</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

    <div class="problem-frames">
        <div
                    style="margin-bottom: 2em;"
        >

    <style>
        #facebox .content:has(.diff-popup) {
            width: 90vw;
            max-width: 120rem !important;
        }

        .testCaseMarker {
            position: absolute;
            font-weight: bold;
            font-size: 1rem;
        }

        .diff-popup {
            width: 90vw;
            max-width: 120rem !important;
            display: none;
            overflow: auto;
        }

        .input-output-copier {
            font-size: 1.2rem;
            float: right;
            color: #888 !important;
            cursor: pointer;
            border: 1px solid rgb(185, 185, 185);
            padding: 3px;
            margin: 1px;
            line-height: 1.1rem;
            text-transform: none;
        }

        .input-output-copier:hover {
            background-color: #def;
        }

        .test-explanation textarea {
            width: 100%;
            height: 1.5em;
        }

        .pending-submission-message {
            color: darkorange !important;
        }
    </style>
    <script>
        const OPENING_SPACE = String.fromCharCode(1001);
        const CLOSING_SPACE = String.fromCharCode(1002);

        const nodeToText = function (node, pre) {
            let result = [];

            if (node.tagName === "SCRIPT" || node.tagName === "math"
                || (node.classList && node.classList.contains("input-output-copier")))
                return [];

            if (node.tagName === "NOBR") {
                result.push(OPENING_SPACE);
            }

            if (node.nodeType === Node.TEXT_NODE) {
                let s = node.textContent;
                if (!pre) {
                    s = s.replace(/\s+/g, " ");
                }
                if (s.length > 0) {
                    result.push(s);
                }
            }

            if (pre && node.tagName === "BR") {
                result.push("\n");
            }

            node.childNodes.forEach(function (child) {
                result.push(nodeToText(child, node.tagName === "PRE").join(""));
            });

            if (node.tagName === "DIV"
                || node.tagName === "P"
                || node.tagName === "PRE"
                || node.tagName === "UL"
                || node.tagName === "LI"
            ) {
                result.push("\n");
            }

            if (node.tagName === "NOBR") {
                result.push(CLOSING_SPACE);
            }

            return result;
        }

        const isSpecial = function (c) {
            return c === ',' || c === '.' || c === ';' || c === ')' || c === ' ';
        }

        const convertStatementToText = function(statmentNode) {
            const text = nodeToText(statmentNode, false).join("").replace(/ +/g, " ").replace(/\n\n+/g, "\n\n");
            let result = [];
            for (let i = 0; i < text.length; i++) {
                const c = text.charAt(i);
                if (c === OPENING_SPACE) {
                    if (!((i > 0 && text.charAt(i - 1) === '(') || (result.length > 0 && result[result.length - 1] === ' '))) {
                        result.push('+');
                    }
                } else if (c === CLOSING_SPACE) {
                    if (!(i + 1 < text.length && isSpecial(text.charAt(i + 1)))) {
                        result.push('-');
                    }
                } else {
                    result.push(c);
                }
            }
            return result.join("").split("\n").map(value => value.trim()).join("\n");
        };
    </script>
    <div class="diff-popup">
    </div>

<div class="problemindexholder" problemindex="A1" data-uuid="ps_9188e5c1bd7c20bb03a363a3ccbf28ce8b3b7065">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A1. Good Matrix Elements</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>The Smart Beaver from ABBYY got hooked on square matrices. Now he is busy studying an <span class="tex-span"><i>n</i> × <i>n</i></span> size matrix, where <span class="tex-span"><i>n</i></span> is odd. The Smart Beaver considers the following matrix elements good:  </p><ul> <li> Elements of the main diagonal.  </li><li> Elements of the secondary diagonal.  </li><li> Elements of the &quot;middle&quot; row — the row which has exactly <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/55e8f30a55c1086f22e41e6036894dfd3c68d3a3.png" style="max-width: 100.0%;max-height: 100.0%;" /> rows above it and the same number of rows below it.  </li><li> Elements of the &quot;middle&quot; column — the column that has exactly <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/55e8f30a55c1086f22e41e6036894dfd3c68d3a3.png" style="max-width: 100.0%;max-height: 100.0%;" /> columns to the left of it and the same number of columns to the right of it. </li></ul><center> <img class="tex-graphics" src="https://espresso.codeforces.com/d97d5d0d20c81a6225574d6cf14041964615f693.png" style="max-width: 100.0%;max-height: 100.0%;" /> <span class="tex-font-size-script"> The figure shows a <span class="tex-span">5 × 5</span> matrix.   The good elements are marked with green. </span> </center><p>Help the Smart Beaver count the sum of good elements of the given matrix.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of input data contains a single odd integer <span class="tex-span"><i>n</i></span>. Each of the next <span class="tex-span"><i>n</i></span> lines contains <span class="tex-span"><i>n</i></span> integers <span class="tex-span"><i>a</i><sub class="lower-index"><i>ij</i></sub></span> <span class="tex-span">(0 ≤ <i>a</i><sub class="lower-index"><i>ij</i></sub> ≤ 100)</span> separated by single spaces — the elements of the given matrix.</p><p>The input limitations for getting 30 points are: </p><ul> <li> <span class="tex-span">1 ≤ <i>n</i> ≤ 5</span> </li></ul><p>The input limitations for getting 100 points are:</p><ul> <li> <span class="tex-span">1 ≤ <i>n</i> ≤ 101</span> </li></ul></div><div class="output-specification"><div class="section-title">Output</div><p>Print a single integer — the sum of good matrix elements.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3<br />1 2 3<br />4 5 6<br />7 8 9<br /></pre></div><div class="output"><div class="title">Output</div><pre>45<br /></pre></div><div class="input"><div class="title">Input</div><pre>5<br />1 1 1 1 1<br />1 1 1 1 1<br />1 1 1 1 1<br />1 1 1 1 1<br />1 1 1 1 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>17<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample all matrix elements will be good. Good elements in the second sample are shown on the figure.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=A1]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/49284");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {
        window.changedTests = new Set();

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");



        String.prototype.replaceAll = function (search, replace) {
            return this.split(search).join(replace);
        };

        $(".sample-test .title").each(function () {
            const preId = ("id" + Math.random()).replaceAll(".", "0");
            const cpyId = ("id" + Math.random()).replaceAll(".", "0");

            $(this).parent().find("pre").attr("id", preId);
            const $copy = $("<div title='Copy' data-clipboard-target='#" + preId + "' id='" + cpyId + "' class='input-output-copier'>Copy</div>");
            $(this).append($copy);

            const clipboard = new Clipboard('#' + cpyId, {
                text: function (trigger) {
                    const pre = document.querySelector('#' + preId);
                    const lines = pre.querySelectorAll(".test-example-line");
                    return Codeforces.filterClipboardText(pre.innerText, lines.length);
                }
            });

            const isInput = $(this).parent().hasClass("input");

            clipboard.on('success', function (e) {
                if (isInput) {
                    Codeforces.showMessage("The example input has been copied into the clipboard");
                } else {
                    Codeforces.showMessage("The example output has been copied into the clipboard");
                }
                e.clearSelection();
            });
        });

        $(".test-form-item input").change(function () {
            addPendingSubmissionMessage($($(this).closest("form")), "You changed the answer, do not forget to submit it if you want to save the changes");
            const index = $(this).closest(".problemindexholder").attr("problemindex");
            let test = "";
            $(this).closest("form input").each(function () {
                const test_ = $(this).attr("name");
                if (test_ && test_.substring(0, 4) === "test") {
                    test = test_;
                }
            });
            if (index.length > 0 && test.length > 0) {
                const indexTest = index + "::" + test;
                window.changedTests.add(indexTest);
            }
        });

        $(window).on('beforeunload', function () {
            if (window.changedTests.size > 0) {
                return 'Dialog text here';
            }
        });

        autosize($('.test-explanation textarea'));

        $(".test-example-line").hover(function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        let top = 1E20;
                        let left = 1E20;
                        let problem = $(this).closest(".problemindexholder");
                        $(this).closest(".input").find("." + clazz).css("background-color", "#FFFDE7").each(function() {
                            top = Math.min(top, $(this).offset().top);
                            left = Math.min(left, $(this).offset().left);
                        });
                        let testCaseMarker = problem.find(".testCaseMarker_" + end);
                        if (testCaseMarker.length === 0) {
                            const html = "<div class=\"testCaseMarker testCaseMarker_" + end + " notice\"></div>";
                            problem.append($(html));
                            testCaseMarker = problem.find(".testCaseMarker_" + end);
                        }
                        if (testCaseMarker) {
                            testCaseMarker.show()
                                    .offset({top, left: left - 20})
                                    .text(end);
                        }
                    }
                }
            });
        }, function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        $("." + clazz).css("background-color", "");
                        $(this).closest(".problemindexholder").find(".testCaseMarker_" + end).hide();
                    }
                }
            });
        });

    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="A2" data-uuid="ps_9188e5c1bd7c20bb03a363a3ccbf28ce8b3b7065">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A2. Good Matrix Elements</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>The Smart Beaver from ABBYY got hooked on square matrices. Now he is busy studying an <span class="tex-span"><i>n</i> × <i>n</i></span> size matrix, where <span class="tex-span"><i>n</i></span> is odd. The Smart Beaver considers the following matrix elements good:  </p><ul> <li> Elements of the main diagonal.  </li><li> Elements of the secondary diagonal.  </li><li> Elements of the &quot;middle&quot; row — the row which has exactly <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/55e8f30a55c1086f22e41e6036894dfd3c68d3a3.png" style="max-width: 100.0%;max-height: 100.0%;" /> rows above it and the same number of rows below it.  </li><li> Elements of the &quot;middle&quot; column — the column that has exactly <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/55e8f30a55c1086f22e41e6036894dfd3c68d3a3.png" style="max-width: 100.0%;max-height: 100.0%;" /> columns to the left of it and the same number of columns to the right of it. </li></ul><center> <img class="tex-graphics" src="https://espresso.codeforces.com/d97d5d0d20c81a6225574d6cf14041964615f693.png" style="max-width: 100.0%;max-height: 100.0%;" /> <span class="tex-font-size-script"> The figure shows a <span class="tex-span">5 × 5</span> matrix.   The good elements are marked with green. </span> </center><p>Help the Smart Beaver count the sum of good elements of the given matrix.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of input data contains a single odd integer <span class="tex-span"><i>n</i></span>. Each of the next <span class="tex-span"><i>n</i></span> lines contains <span class="tex-span"><i>n</i></span> integers <span class="tex-span"><i>a</i><sub class="lower-index"><i>ij</i></sub></span> <span class="tex-span">(0 ≤ <i>a</i><sub class="lower-index"><i>ij</i></sub> ≤ 100)</span> separated by single spaces — the elements of the given matrix.</p><p>The input limitations for getting 30 points are: </p><ul> <li> <span class="tex-span">1 ≤ <i>n</i> ≤ 5</span> </li></ul><p>The input limitations for getting 100 points are:</p><ul> <li> <span class="tex-span">1 ≤ <i>n</i> ≤ 101</span> </li></ul></div><div class="output-specification"><div class="section-title">Output</div><p>Print a single integer — the sum of good matrix elements.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3<br />1 2 3<br />4 5 6<br />7 8 9<br /></pre></div><div class="output"><div class="title">Output</div><pre>45<br /></pre></div><div class="input"><div class="title">Input</div><pre>5<br />1 1 1 1 1<br />1 1 1 1 1<br />1 1 1 1 1<br />1 1 1 1 1<br />1 1 1 1 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>17<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample all matrix elements will be good. Good elements in the second sample are shown on the figure.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=A2]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/49284");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="B1" data-uuid="ps_71e604abcb9c0a9eb46449e0474b84abd8b44c1a">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B1. Rectangular Game</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>The Smart Beaver from ABBYY decided to have a day off. But doing nothing the whole day turned out to be too boring, and he decided to play a game with pebbles. Initially, the Beaver has <span class="tex-span"><i>n</i></span> pebbles. He arranges them in <span class="tex-span"><i>a</i></span> equal rows, each row has <span class="tex-span"><i>b</i></span> pebbles (<span class="tex-span"><i>a</i> &gt; 1</span>). Note that the Beaver must use all the pebbles he has, i. e. <span class="tex-span"><i>n</i> = <i>a</i>·<i>b</i></span>.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/7f4dd23a2a6cd8290d060773328f7811098a6a8a.png" style="max-width: 100.0%;max-height: 100.0%;" /> <span class="tex-font-size-script"> 10 pebbles are arranged in two rows, each row has 5 pebbles </span> </center><p>Once the Smart Beaver has arranged the pebbles, he takes back any of the resulting rows (that is, <span class="tex-span"><i>b</i></span> pebbles) and discards all other pebbles. Then he arranges <span class="tex-font-style-bf">all</span> his pebbles again (possibly choosing other values of <span class="tex-span"><i>a</i></span> and <span class="tex-span"><i>b</i></span>) and takes back one row, and so on. The game continues until at some point the Beaver ends up with exactly one pebble. </p><p>The game process can be represented as a finite sequence of integers <span class="tex-span"><i>c</i><sub class="lower-index">1</sub>, ..., <i>c</i><sub class="lower-index"><i>k</i></sub></span>, where: </p><ul> <li> <span class="tex-span"><i>c</i><sub class="lower-index">1</sub> = <i>n</i></span> </li><li> <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i> + 1</sub></span> is the number of pebbles that the Beaver ends up with after the <span class="tex-span"><i>i</i></span>-th move, that is, the number of pebbles in a row after some arrangement of <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> pebbles (<span class="tex-span">1 ≤ <i>i</i> &lt; <i>k</i></span>). Note that <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub> &gt; <i>c</i><sub class="lower-index"><i>i</i> + 1</sub></span>. </li><li> <span class="tex-span"><i>c</i><sub class="lower-index"><i>k</i></sub> = 1</span> </li></ul><p>The result of the game is the sum of numbers <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span>. You are given <span class="tex-span"><i>n</i></span>. Find the maximum possible result of the game.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The single line of the input contains a single integer <span class="tex-span"><i>n</i></span> — the initial number of pebbles the Smart Beaver has.</p><p>The input limitations for getting 30 points are: </p><ul> <li> <span class="tex-span">2 ≤ <i>n</i> ≤ 50</span> </li></ul> <p>The input limitations for getting 100 points are: </p><ul> <li> <span class="tex-span">2 ≤ <i>n</i> ≤ 10<sup class="upper-index">9</sup></span> </li></ul> </div><div class="output-specification"><div class="section-title">Output</div><p>Print a single number — the maximum possible result of the game.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>10<br /></pre></div><div class="output"><div class="title">Output</div><pre>16<br /></pre></div><div class="input"><div class="title">Input</div><pre>8<br /></pre></div><div class="output"><div class="title">Output</div><pre>15<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Consider the first example (<span class="tex-span"><i>c</i><sub class="lower-index">1</sub> = 10</span>). The possible options for the game development are:</p><ul> <li> Arrange the pebbles in 10 rows, one pebble per row. Then <span class="tex-span"><i>c</i><sub class="lower-index">2</sub> = 1</span>, and the game ends after the first move with the result of 11. </li><li> Arrange the pebbles in 5 rows, two pebbles per row. Then <span class="tex-span"><i>c</i><sub class="lower-index">2</sub> = 2</span>, and the game continues. During the second move we have two pebbles which can be arranged in a unique way (remember that you are not allowed to put all the pebbles in the same row!) — 2 rows, one pebble per row. <span class="tex-span"><i>c</i><sub class="lower-index">3</sub> = 1</span>, and the game ends with the result of 13. </li><li> Finally, arrange the pebbles in two rows, five pebbles per row. The same logic leads us to <span class="tex-span"><i>c</i><sub class="lower-index">2</sub> = 5, <i>c</i><sub class="lower-index">3</sub> = 1</span>, and the game ends with the result of 16 — the maximum possible result. </li></ul></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=B1]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/49284");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="B2" data-uuid="ps_71e604abcb9c0a9eb46449e0474b84abd8b44c1a">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B2. Rectangular Game</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>The Smart Beaver from ABBYY decided to have a day off. But doing nothing the whole day turned out to be too boring, and he decided to play a game with pebbles. Initially, the Beaver has <span class="tex-span"><i>n</i></span> pebbles. He arranges them in <span class="tex-span"><i>a</i></span> equal rows, each row has <span class="tex-span"><i>b</i></span> pebbles (<span class="tex-span"><i>a</i> &gt; 1</span>). Note that the Beaver must use all the pebbles he has, i. e. <span class="tex-span"><i>n</i> = <i>a</i>·<i>b</i></span>.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/7f4dd23a2a6cd8290d060773328f7811098a6a8a.png" style="max-width: 100.0%;max-height: 100.0%;" /> <span class="tex-font-size-script"> 10 pebbles are arranged in two rows, each row has 5 pebbles </span> </center><p>Once the Smart Beaver has arranged the pebbles, he takes back any of the resulting rows (that is, <span class="tex-span"><i>b</i></span> pebbles) and discards all other pebbles. Then he arranges <span class="tex-font-style-bf">all</span> his pebbles again (possibly choosing other values of <span class="tex-span"><i>a</i></span> and <span class="tex-span"><i>b</i></span>) and takes back one row, and so on. The game continues until at some point the Beaver ends up with exactly one pebble. </p><p>The game process can be represented as a finite sequence of integers <span class="tex-span"><i>c</i><sub class="lower-index">1</sub>, ..., <i>c</i><sub class="lower-index"><i>k</i></sub></span>, where: </p><ul> <li> <span class="tex-span"><i>c</i><sub class="lower-index">1</sub> = <i>n</i></span> </li><li> <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i> + 1</sub></span> is the number of pebbles that the Beaver ends up with after the <span class="tex-span"><i>i</i></span>-th move, that is, the number of pebbles in a row after some arrangement of <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> pebbles (<span class="tex-span">1 ≤ <i>i</i> &lt; <i>k</i></span>). Note that <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub> &gt; <i>c</i><sub class="lower-index"><i>i</i> + 1</sub></span>. </li><li> <span class="tex-span"><i>c</i><sub class="lower-index"><i>k</i></sub> = 1</span> </li></ul><p>The result of the game is the sum of numbers <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span>. You are given <span class="tex-span"><i>n</i></span>. Find the maximum possible result of the game.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The single line of the input contains a single integer <span class="tex-span"><i>n</i></span> — the initial number of pebbles the Smart Beaver has.</p><p>The input limitations for getting 30 points are: </p><ul> <li> <span class="tex-span">2 ≤ <i>n</i> ≤ 50</span> </li></ul> <p>The input limitations for getting 100 points are: </p><ul> <li> <span class="tex-span">2 ≤ <i>n</i> ≤ 10<sup class="upper-index">9</sup></span> </li></ul> </div><div class="output-specification"><div class="section-title">Output</div><p>Print a single number — the maximum possible result of the game.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>10<br /></pre></div><div class="output"><div class="title">Output</div><pre>16<br /></pre></div><div class="input"><div class="title">Input</div><pre>8<br /></pre></div><div class="output"><div class="title">Output</div><pre>15<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Consider the first example (<span class="tex-span"><i>c</i><sub class="lower-index">1</sub> = 10</span>). The possible options for the game development are:</p><ul> <li> Arrange the pebbles in 10 rows, one pebble per row. Then <span class="tex-span"><i>c</i><sub class="lower-index">2</sub> = 1</span>, and the game ends after the first move with the result of 11. </li><li> Arrange the pebbles in 5 rows, two pebbles per row. Then <span class="tex-span"><i>c</i><sub class="lower-index">2</sub> = 2</span>, and the game continues. During the second move we have two pebbles which can be arranged in a unique way (remember that you are not allowed to put all the pebbles in the same row!) — 2 rows, one pebble per row. <span class="tex-span"><i>c</i><sub class="lower-index">3</sub> = 1</span>, and the game ends with the result of 13. </li><li> Finally, arrange the pebbles in two rows, five pebbles per row. The same logic leads us to <span class="tex-span"><i>c</i><sub class="lower-index">2</sub> = 5, <i>c</i><sub class="lower-index">3</sub> = 1</span>, and the game ends with the result of 16 — the maximum possible result. </li></ul></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=B2]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/49284");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="C1" data-uuid="ps_e37677dda83eb4d4d86c81d723445452df8f5837">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C1. Party</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>To celebrate the second ABBYY Cup tournament, the Smart Beaver decided to throw a party. The Beaver has a lot of acquaintances, some of them are friends with each other, and some of them dislike each other. To make party successful, the Smart Beaver wants to invite only those of his friends who are connected by friendship relations, and not to invite those who dislike each other. Both friendship and dislike are mutual feelings.</p><p>More formally, for each invited person the following conditions should be fulfilled: </p><ul> <li> all his friends should also be invited to the party; </li><li> the party shouldn't have any people he dislikes; </li><li> all people who are invited to the party should be connected with him by friendship either directly or through a chain of common friends of arbitrary length. We'll say that people <span class="tex-span"><i>a</i><sub class="lower-index">1</sub></span> and <span class="tex-span"><i>a</i><sub class="lower-index"><i>p</i></sub></span> are connected through a chain of common friends if there exists a sequence of people <span class="tex-span"><i>a</i><sub class="lower-index">2</sub>, <i>a</i><sub class="lower-index">3</sub>, ..., <i>a</i><sub class="lower-index"><i>p</i> - 1</sub></span> such that all pairs of people <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i> + 1</sub></span> (<span class="tex-span">1 ≤ <i>i</i> &lt; <i>p</i></span>) are friends. </li></ul><p>Help the Beaver find the maximum number of acquaintances he can invite.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of input contains an integer <span class="tex-span"><i>n</i></span> — the number of the Beaver's acquaintances. </p><p>The second line contains an integer <span class="tex-span"><i>k</i></span> <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/4723a08673d63c25b651f89d58d47e46a4430ea9.png" style="max-width: 100.0%;max-height: 100.0%;" /> — the number of pairs of friends. Next <span class="tex-span"><i>k</i></span> lines contain space-separated pairs of integers <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub>, <i>v</i><sub class="lower-index"><i>i</i></sub></span> <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/447b0a18d2967dc78efba89fef879ac76d26c94a.png" style="max-width: 100.0%;max-height: 100.0%;" /> — indices of people who form the <span class="tex-span"><i>i</i></span>-th pair of friends.</p><p>The next line contains an integer <span class="tex-span"><i>m</i></span> <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/8c1e79cb16ccc4416463a48018b8621e92ff2f48.png" style="max-width: 100.0%;max-height: 100.0%;" /> — the number of pairs of people who dislike each other. Next <span class="tex-span"><i>m</i></span> lines describe pairs of people who dislike each other in the same format as the pairs of friends were described.</p><p>Each pair of people is mentioned in the input at most once <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/9a7d2d374a0c2f92f490cea488df2d83503da07b.png" style="max-width: 100.0%;max-height: 100.0%;" />. In particular, two persons cannot be friends and dislike each other at the same time.</p><p>The input limitations for getting 30 points are: </p><ul> <li> <span class="tex-span">2 ≤ <i>n</i> ≤ 14</span> </li></ul> <p>The input limitations for getting 100 points are: </p><ul> <li> <span class="tex-span">2 ≤ <i>n</i> ≤ 2000</span> </li></ul> </div><div class="output-specification"><div class="section-title">Output</div><p>Output a single number — the maximum number of people that can be invited to the party. If a group of people that meets all the requirements is impossible to select, output 0.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>9<br />8<br />1 2<br />1 3<br />2 3<br />4 5<br />6 7<br />7 8<br />8 9<br />9 6<br />2<br />1 6<br />7 9<br /></pre></div><div class="output"><div class="title">Output</div><pre>3</pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Let's have a look at the example. </p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/a592ed9e35f21072bf632be91d9156aa29dd0198.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>Two groups of people can be invited: <span class="tex-span">{1, 2, 3}</span> and <span class="tex-span">{4, 5}</span>, thus the answer will be the size of the largest of these groups. Group <span class="tex-span">{6, 7, 8, 9}</span> doesn't fit, since it includes people <span class="tex-span">7</span> and <span class="tex-span">9</span> who dislike each other. Group <span class="tex-span">{1, 2, 3, 4, 5}</span> also doesn't fit, because not all of its members are connected by a chain of common friends (for example, people <span class="tex-span">2</span> and <span class="tex-span">5</span> aren't connected).</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=C1]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/49284");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="C2" data-uuid="ps_e37677dda83eb4d4d86c81d723445452df8f5837">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C2. Party</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>To celebrate the second ABBYY Cup tournament, the Smart Beaver decided to throw a party. The Beaver has a lot of acquaintances, some of them are friends with each other, and some of them dislike each other. To make party successful, the Smart Beaver wants to invite only those of his friends who are connected by friendship relations, and not to invite those who dislike each other. Both friendship and dislike are mutual feelings.</p><p>More formally, for each invited person the following conditions should be fulfilled: </p><ul> <li> all his friends should also be invited to the party; </li><li> the party shouldn't have any people he dislikes; </li><li> all people who are invited to the party should be connected with him by friendship either directly or through a chain of common friends of arbitrary length. We'll say that people <span class="tex-span"><i>a</i><sub class="lower-index">1</sub></span> and <span class="tex-span"><i>a</i><sub class="lower-index"><i>p</i></sub></span> are connected through a chain of common friends if there exists a sequence of people <span class="tex-span"><i>a</i><sub class="lower-index">2</sub>, <i>a</i><sub class="lower-index">3</sub>, ..., <i>a</i><sub class="lower-index"><i>p</i> - 1</sub></span> such that all pairs of people <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i> + 1</sub></span> (<span class="tex-span">1 ≤ <i>i</i> &lt; <i>p</i></span>) are friends. </li></ul><p>Help the Beaver find the maximum number of acquaintances he can invite.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of input contains an integer <span class="tex-span"><i>n</i></span> — the number of the Beaver's acquaintances. </p><p>The second line contains an integer <span class="tex-span"><i>k</i></span> <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/4723a08673d63c25b651f89d58d47e46a4430ea9.png" style="max-width: 100.0%;max-height: 100.0%;" /> — the number of pairs of friends. Next <span class="tex-span"><i>k</i></span> lines contain space-separated pairs of integers <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub>, <i>v</i><sub class="lower-index"><i>i</i></sub></span> <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/447b0a18d2967dc78efba89fef879ac76d26c94a.png" style="max-width: 100.0%;max-height: 100.0%;" /> — indices of people who form the <span class="tex-span"><i>i</i></span>-th pair of friends.</p><p>The next line contains an integer <span class="tex-span"><i>m</i></span> <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/8c1e79cb16ccc4416463a48018b8621e92ff2f48.png" style="max-width: 100.0%;max-height: 100.0%;" /> — the number of pairs of people who dislike each other. Next <span class="tex-span"><i>m</i></span> lines describe pairs of people who dislike each other in the same format as the pairs of friends were described.</p><p>Each pair of people is mentioned in the input at most once <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/9a7d2d374a0c2f92f490cea488df2d83503da07b.png" style="max-width: 100.0%;max-height: 100.0%;" />. In particular, two persons cannot be friends and dislike each other at the same time.</p><p>The input limitations for getting 30 points are: </p><ul> <li> <span class="tex-span">2 ≤ <i>n</i> ≤ 14</span> </li></ul> <p>The input limitations for getting 100 points are: </p><ul> <li> <span class="tex-span">2 ≤ <i>n</i> ≤ 2000</span> </li></ul> </div><div class="output-specification"><div class="section-title">Output</div><p>Output a single number — the maximum number of people that can be invited to the party. If a group of people that meets all the requirements is impossible to select, output 0.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>9<br />8<br />1 2<br />1 3<br />2 3<br />4 5<br />6 7<br />7 8<br />8 9<br />9 6<br />2<br />1 6<br />7 9<br /></pre></div><div class="output"><div class="title">Output</div><pre>3</pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Let's have a look at the example. </p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/a592ed9e35f21072bf632be91d9156aa29dd0198.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>Two groups of people can be invited: <span class="tex-span">{1, 2, 3}</span> and <span class="tex-span">{4, 5}</span>, thus the answer will be the size of the largest of these groups. Group <span class="tex-span">{6, 7, 8, 9}</span> doesn't fit, since it includes people <span class="tex-span">7</span> and <span class="tex-span">9</span> who dislike each other. Group <span class="tex-span">{1, 2, 3, 4, 5}</span> also doesn't fit, because not all of its members are connected by a chain of common friends (for example, people <span class="tex-span">2</span> and <span class="tex-span">5</span> aren't connected).</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=C2]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/49284");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="D1" data-uuid="ps_db2cfcd916414aa1cebfbabb8db16f2bf87aaadc">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D1. Encrypting Messages</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>The Smart Beaver from ABBYY invented a new message encryption method and now wants to check its performance. Checking it manually is long and tiresome, so he decided to ask the ABBYY Cup contestants for help.</p><p>A message is a sequence of <span class="tex-span"><i>n</i></span> integers <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>n</i></sub></span>. Encryption uses a key which is a sequence of <span class="tex-span"><i>m</i></span> integers <span class="tex-span"><i>b</i><sub class="lower-index">1</sub>, <i>b</i><sub class="lower-index">2</sub>, ..., <i>b</i><sub class="lower-index"><i>m</i></sub></span> (<span class="tex-span"><i>m</i> ≤ <i>n</i></span>). All numbers from the message and from the key belong to the interval from <span class="tex-span">0</span> to <span class="tex-span"><i>c</i> - 1</span>, inclusive, and all the calculations are performed modulo <span class="tex-span"><i>c</i></span>.</p><p>Encryption is performed in <span class="tex-span"><i>n</i> - <i>m</i> + 1</span> steps. On the first step we add to each number <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>m</i></sub></span> a corresponding number <span class="tex-span"><i>b</i><sub class="lower-index">1</sub>, <i>b</i><sub class="lower-index">2</sub>, ..., <i>b</i><sub class="lower-index"><i>m</i></sub></span>. On the second step we add to each number <span class="tex-span"><i>a</i><sub class="lower-index">2</sub>, <i>a</i><sub class="lower-index">3</sub>, ..., <i>a</i><sub class="lower-index"><i>m</i> + 1</sub></span> (changed on the previous step) a corresponding number <span class="tex-span"><i>b</i><sub class="lower-index">1</sub>, <i>b</i><sub class="lower-index">2</sub>, ..., <i>b</i><sub class="lower-index"><i>m</i></sub></span>. And so on: on step number <span class="tex-span"><i>i</i></span> we add to each number <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub>, <i>a</i><sub class="lower-index"><i>i</i> + 1</sub>, ..., <i>a</i><sub class="lower-index"><i>i</i> + <i>m</i> - 1</sub></span> a corresponding number <span class="tex-span"><i>b</i><sub class="lower-index">1</sub>, <i>b</i><sub class="lower-index">2</sub>, ..., <i>b</i><sub class="lower-index"><i>m</i></sub></span>. The result of the encryption is the sequence <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>n</i></sub></span> after <span class="tex-span"><i>n</i> - <i>m</i> + 1</span> steps.</p><p>Help the Beaver to write a program that will encrypt messages in the described manner.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first input line contains three integers <span class="tex-span"><i>n</i></span>, <span class="tex-span"><i>m</i></span> and <span class="tex-span"><i>c</i></span>, separated by single spaces. </p><p>The second input line contains <span class="tex-span"><i>n</i></span> integers <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">0 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> &lt; <i>c</i></span>), separated by single spaces — the original message. </p><p>The third input line contains <span class="tex-span"><i>m</i></span> integers <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">0 ≤ <i>b</i><sub class="lower-index"><i>i</i></sub> &lt; <i>c</i></span>), separated by single spaces — the encryption key.</p><p>The input limitations for getting 30 points are: </p><ul> <li> <span class="tex-span">1 ≤ <i>m</i> ≤ <i>n</i> ≤ 10<sup class="upper-index">3</sup></span> </li><li> <span class="tex-span">1 ≤ <i>c</i> ≤ 10<sup class="upper-index">3</sup></span> </li></ul> <p>The input limitations for getting 100 points are: </p><ul> <li> <span class="tex-span">1 ≤ <i>m</i> ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup></span> </li><li> <span class="tex-span">1 ≤ <i>c</i> ≤ 10<sup class="upper-index">3</sup></span> </li></ul> </div><div class="output-specification"><div class="section-title">Output</div><p>Print <span class="tex-span"><i>n</i></span> space-separated integers — the result of encrypting the original message.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>4 3 2<br />1 1 1 1<br />1 1 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>0 1 1 0<br /></pre></div><div class="input"><div class="title">Input</div><pre>3 1 5<br />1 2 3<br />4<br /></pre></div><div class="output"><div class="title">Output</div><pre>0 1 2<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample the encryption is performed in two steps: after the first step <span class="tex-span"><i>a</i> = (0, 0, 0, 1)</span> (remember that the calculations are performed modulo 2), after the second step <span class="tex-span"><i>a</i> = (0, 1, 1, 0)</span>, and that is the answer. </p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=D1]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/49284");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="D2" data-uuid="ps_db2cfcd916414aa1cebfbabb8db16f2bf87aaadc">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D2. Encrypting Messages</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>The Smart Beaver from ABBYY invented a new message encryption method and now wants to check its performance. Checking it manually is long and tiresome, so he decided to ask the ABBYY Cup contestants for help.</p><p>A message is a sequence of <span class="tex-span"><i>n</i></span> integers <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>n</i></sub></span>. Encryption uses a key which is a sequence of <span class="tex-span"><i>m</i></span> integers <span class="tex-span"><i>b</i><sub class="lower-index">1</sub>, <i>b</i><sub class="lower-index">2</sub>, ..., <i>b</i><sub class="lower-index"><i>m</i></sub></span> (<span class="tex-span"><i>m</i> ≤ <i>n</i></span>). All numbers from the message and from the key belong to the interval from <span class="tex-span">0</span> to <span class="tex-span"><i>c</i> - 1</span>, inclusive, and all the calculations are performed modulo <span class="tex-span"><i>c</i></span>.</p><p>Encryption is performed in <span class="tex-span"><i>n</i> - <i>m</i> + 1</span> steps. On the first step we add to each number <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>m</i></sub></span> a corresponding number <span class="tex-span"><i>b</i><sub class="lower-index">1</sub>, <i>b</i><sub class="lower-index">2</sub>, ..., <i>b</i><sub class="lower-index"><i>m</i></sub></span>. On the second step we add to each number <span class="tex-span"><i>a</i><sub class="lower-index">2</sub>, <i>a</i><sub class="lower-index">3</sub>, ..., <i>a</i><sub class="lower-index"><i>m</i> + 1</sub></span> (changed on the previous step) a corresponding number <span class="tex-span"><i>b</i><sub class="lower-index">1</sub>, <i>b</i><sub class="lower-index">2</sub>, ..., <i>b</i><sub class="lower-index"><i>m</i></sub></span>. And so on: on step number <span class="tex-span"><i>i</i></span> we add to each number <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub>, <i>a</i><sub class="lower-index"><i>i</i> + 1</sub>, ..., <i>a</i><sub class="lower-index"><i>i</i> + <i>m</i> - 1</sub></span> a corresponding number <span class="tex-span"><i>b</i><sub class="lower-index">1</sub>, <i>b</i><sub class="lower-index">2</sub>, ..., <i>b</i><sub class="lower-index"><i>m</i></sub></span>. The result of the encryption is the sequence <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>n</i></sub></span> after <span class="tex-span"><i>n</i> - <i>m</i> + 1</span> steps.</p><p>Help the Beaver to write a program that will encrypt messages in the described manner.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first input line contains three integers <span class="tex-span"><i>n</i></span>, <span class="tex-span"><i>m</i></span> and <span class="tex-span"><i>c</i></span>, separated by single spaces. </p><p>The second input line contains <span class="tex-span"><i>n</i></span> integers <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">0 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> &lt; <i>c</i></span>), separated by single spaces — the original message. </p><p>The third input line contains <span class="tex-span"><i>m</i></span> integers <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">0 ≤ <i>b</i><sub class="lower-index"><i>i</i></sub> &lt; <i>c</i></span>), separated by single spaces — the encryption key.</p><p>The input limitations for getting 30 points are: </p><ul> <li> <span class="tex-span">1 ≤ <i>m</i> ≤ <i>n</i> ≤ 10<sup class="upper-index">3</sup></span> </li><li> <span class="tex-span">1 ≤ <i>c</i> ≤ 10<sup class="upper-index">3</sup></span> </li></ul> <p>The input limitations for getting 100 points are: </p><ul> <li> <span class="tex-span">1 ≤ <i>m</i> ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup></span> </li><li> <span class="tex-span">1 ≤ <i>c</i> ≤ 10<sup class="upper-index">3</sup></span> </li></ul> </div><div class="output-specification"><div class="section-title">Output</div><p>Print <span class="tex-span"><i>n</i></span> space-separated integers — the result of encrypting the original message.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>4 3 2<br />1 1 1 1<br />1 1 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>0 1 1 0<br /></pre></div><div class="input"><div class="title">Input</div><pre>3 1 5<br />1 2 3<br />4<br /></pre></div><div class="output"><div class="title">Output</div><pre>0 1 2<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample the encryption is performed in two steps: after the first step <span class="tex-span"><i>a</i> = (0, 0, 0, 1)</span> (remember that the calculations are performed modulo 2), after the second step <span class="tex-span"><i>a</i> = (0, 1, 1, 0)</span>, and that is the answer. </p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=D2]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/49284");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="E1" data-uuid="ps_e5d987523201a0a666b700fa83619d8d55d74001">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E1. Space Voyage</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>The Smart Beaver from ABBYY plans a space travel on an ultramodern spaceship. During the voyage he plans to visit <span class="tex-span"><i>n</i></span> planets. For planet <span class="tex-span"><i>i</i></span> <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> is the maximum number of suitcases that an alien tourist is allowed to bring to the planet, and <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> is the number of citizens on the planet.</p><p>The Smart Beaver is going to bring some presents from ABBYY to the planets he will be visiting. The presents are packed in suitcases, <span class="tex-span"><i>x</i></span> presents in each. The Beaver will take to the ship exactly <span class="tex-span"><i>a</i><sub class="lower-index">1</sub> + ... + <i>a</i><sub class="lower-index"><i>n</i></sub></span> suitcases.</p><p>As the Beaver lands on the <span class="tex-span"><i>i</i></span>-th planet, he takes <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> suitcases and goes out. On the first day on the planet the Beaver takes a walk and gets to know the citizens. On the second and all subsequent days the Beaver gives presents to the citizens — each of the <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> citizens gets one present per day. The Beaver leaves the planet in the evening of the day when the number of presents left is strictly less than the number of citizens (i.e. as soon as he won't be able to give away the proper number of presents the next day). He leaves the remaining presents at the hotel.</p><p>The Beaver is going to spend exactly <span class="tex-span"><i>c</i></span> days traveling. The time spent on flights between the planets is considered to be zero. In how many ways can one choose the positive integer <span class="tex-span"><i>x</i></span> so that the planned voyage will take exactly <span class="tex-span"><i>c</i></span> days?</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first input line contains space-separated integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>c</i></span> — the number of planets that the Beaver is going to visit and the number of days he is going to spend traveling, correspondingly.</p><p>The next <span class="tex-span"><i>n</i></span> lines contain pairs of space-separated integers <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>i</i> ≤ <i>n</i></span>) — the number of suitcases he can bring to the <span class="tex-span"><i>i</i></span>-th planet and the number of citizens of the <span class="tex-span"><i>i</i></span>-th planet, correspondingly.</p><p>The input limitations for getting 30 points are: </p><ul> <li> <span class="tex-span">1 ≤ <i>n</i> ≤ 100</span> </li><li> <span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> ≤ 100</span> </li><li> <span class="tex-span">1 ≤ <i>b</i><sub class="lower-index"><i>i</i></sub> ≤ 100</span> </li><li> <span class="tex-span">1 ≤ <i>c</i> ≤ 100</span> </li></ul> <p>The input limitations for getting 100 points are: </p><ul> <li> <span class="tex-span">1 ≤ <i>n</i> ≤ 10<sup class="upper-index">4</sup></span> </li><li> <span class="tex-span">0 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span> </li><li> <span class="tex-span">1 ≤ <i>b</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span> </li><li> <span class="tex-span">1 ≤ <i>c</i> ≤ 10<sup class="upper-index">9</sup></span> </li></ul> <p>Due to possible overflow, it is recommended to use the 64-bit arithmetic. In some solutions even the 64-bit arithmetic can overflow. So be careful in calculations!</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print a single number <span class="tex-span"><i>k</i></span> — the number of ways to choose <span class="tex-span"><i>x</i></span> so as to travel for exactly <span class="tex-span"><i>c</i></span> days. If there are infinitely many possible values of <span class="tex-span"><i>x</i></span>, print -1.</p><p>Please do not use the <span class="tex-font-style-tt">%lld</span> specifier to read or write 64-bit integers in С++. It is preferred to use <span class="tex-font-style-tt">cin</span>, <span class="tex-font-style-tt">cout</span> streams or the <span class="tex-font-style-tt">%I64d</span> specifier.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>2 5<br />1 5<br />2 4<br /></pre></div><div class="output"><div class="title">Output</div><pre>1<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first example there is only one suitable value <span class="tex-span"><i>x</i> = 5</span>. Then the Beaver takes 1 suitcase with 5 presents to the first planet. Here he spends 2 days: he hangs around on the first day, and he gives away five presents on the second day. He takes 2 suitcases with 10 presents to the second planet. Here he spends 3 days — he gives away 4 presents on the second and the third days and leaves the remaining 2 presents at the hotel. In total, the Beaver spends 5 days traveling.</p><p>For <span class="tex-span"><i>x</i> = 4</span> or less the Beaver won't have enough presents for the second day on the first planet, so the voyage will end too soon. For <span class="tex-span"><i>x</i> = 6</span> and more the Beaver will spend at least one more day on the second planet, and the voyage will take too long.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=E1]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/49284");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="E2" data-uuid="ps_e5d987523201a0a666b700fa83619d8d55d74001">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E2. Space Voyage</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>The Smart Beaver from ABBYY plans a space travel on an ultramodern spaceship. During the voyage he plans to visit <span class="tex-span"><i>n</i></span> planets. For planet <span class="tex-span"><i>i</i></span> <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> is the maximum number of suitcases that an alien tourist is allowed to bring to the planet, and <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> is the number of citizens on the planet.</p><p>The Smart Beaver is going to bring some presents from ABBYY to the planets he will be visiting. The presents are packed in suitcases, <span class="tex-span"><i>x</i></span> presents in each. The Beaver will take to the ship exactly <span class="tex-span"><i>a</i><sub class="lower-index">1</sub> + ... + <i>a</i><sub class="lower-index"><i>n</i></sub></span> suitcases.</p><p>As the Beaver lands on the <span class="tex-span"><i>i</i></span>-th planet, he takes <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> suitcases and goes out. On the first day on the planet the Beaver takes a walk and gets to know the citizens. On the second and all subsequent days the Beaver gives presents to the citizens — each of the <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> citizens gets one present per day. The Beaver leaves the planet in the evening of the day when the number of presents left is strictly less than the number of citizens (i.e. as soon as he won't be able to give away the proper number of presents the next day). He leaves the remaining presents at the hotel.</p><p>The Beaver is going to spend exactly <span class="tex-span"><i>c</i></span> days traveling. The time spent on flights between the planets is considered to be zero. In how many ways can one choose the positive integer <span class="tex-span"><i>x</i></span> so that the planned voyage will take exactly <span class="tex-span"><i>c</i></span> days?</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first input line contains space-separated integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>c</i></span> — the number of planets that the Beaver is going to visit and the number of days he is going to spend traveling, correspondingly.</p><p>The next <span class="tex-span"><i>n</i></span> lines contain pairs of space-separated integers <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>i</i> ≤ <i>n</i></span>) — the number of suitcases he can bring to the <span class="tex-span"><i>i</i></span>-th planet and the number of citizens of the <span class="tex-span"><i>i</i></span>-th planet, correspondingly.</p><p>The input limitations for getting 30 points are: </p><ul> <li> <span class="tex-span">1 ≤ <i>n</i> ≤ 100</span> </li><li> <span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> ≤ 100</span> </li><li> <span class="tex-span">1 ≤ <i>b</i><sub class="lower-index"><i>i</i></sub> ≤ 100</span> </li><li> <span class="tex-span">1 ≤ <i>c</i> ≤ 100</span> </li></ul> <p>The input limitations for getting 100 points are: </p><ul> <li> <span class="tex-span">1 ≤ <i>n</i> ≤ 10<sup class="upper-index">4</sup></span> </li><li> <span class="tex-span">0 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span> </li><li> <span class="tex-span">1 ≤ <i>b</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span> </li><li> <span class="tex-span">1 ≤ <i>c</i> ≤ 10<sup class="upper-index">9</sup></span> </li></ul> <p>Due to possible overflow, it is recommended to use the 64-bit arithmetic. In some solutions even the 64-bit arithmetic can overflow. So be careful in calculations!</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print a single number <span class="tex-span"><i>k</i></span> — the number of ways to choose <span class="tex-span"><i>x</i></span> so as to travel for exactly <span class="tex-span"><i>c</i></span> days. If there are infinitely many possible values of <span class="tex-span"><i>x</i></span>, print -1.</p><p>Please do not use the <span class="tex-font-style-tt">%lld</span> specifier to read or write 64-bit integers in С++. It is preferred to use <span class="tex-font-style-tt">cin</span>, <span class="tex-font-style-tt">cout</span> streams or the <span class="tex-font-style-tt">%I64d</span> specifier.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>2 5<br />1 5<br />2 4<br /></pre></div><div class="output"><div class="title">Output</div><pre>1<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first example there is only one suitable value <span class="tex-span"><i>x</i> = 5</span>. Then the Beaver takes 1 suitcase with 5 presents to the first planet. Here he spends 2 days: he hangs around on the first day, and he gives away five presents on the second day. He takes 2 suitcases with 10 presents to the second planet. Here he spends 3 days — he gives away 4 presents on the second and the third days and leaves the remaining 2 presents at the hotel. In total, the Beaver spends 5 days traveling.</p><p>For <span class="tex-span"><i>x</i> = 4</span> or less the Beaver won't have enough presents for the second day on the first planet, so the voyage will end too soon. For <span class="tex-span"><i>x</i> = 6</span> and more the Beaver will spend at least one more day on the second planet, and the voyage will take too long.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=E2]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/49284");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="F1" data-uuid="ps_e0b92b6c0ba4eb9870d7f9526843355ce28a80ea">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">F1. Script Generation</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>The Smart Beaver from ABBYY was offered a job of a screenwriter for the ongoing TV series. In particular, he needs to automate the hard decision: which main characters will get married by the end of the series.</p><p>There are <span class="tex-span"><i>n</i></span> single men and <span class="tex-span"><i>n</i></span> single women among the main characters. An opinion poll showed that viewers like several couples, and a marriage of any of them will make the audience happy. The Smart Beaver formalized this fact as <span class="tex-span"><i>k</i></span> triples of numbers <span class="tex-span">(<i>h</i>, <i>w</i>, <i>r</i>)</span>, where <span class="tex-span"><i>h</i></span> is the index of the man, <span class="tex-span"><i>w</i></span> is the index of the woman, and <span class="tex-span"><i>r</i></span> is the measure of the audience's delight in case of the marriage of this couple. The same poll showed that the marriage of any other couple will leave the audience indifferent, so the screenwriters decided not to include any such marriages in the plot.</p><p>The script allows you to arrange several marriages between the heroes or not to arrange marriages at all. A subset of some of the <span class="tex-span"><i>k</i></span> marriages is considered acceptable if each man and each woman is involved in at most one marriage of the subset (the series won't allow any divorces). The value of the acceptable set of marriages is the total delight the spectators will get from the marriages included in this set.</p><p>Obviously, there is a finite number of acceptable sets, and they all describe some variants of the script. The screenwriters do not want to choose a set with maximum value — it would make the plot too predictable. So the Smart Beaver offers the following option: sort all the acceptable sets in increasing order of value and choose the <span class="tex-span"><i>t</i></span>-th set from the sorted list. Thus, <span class="tex-span"><i>t</i> = 1</span> corresponds to a plot without marriages, <span class="tex-span"><i>t</i> = 2</span> — to a single marriage resulting in minimal delight for the audience, and so on.</p><p>Help the Beaver to implement the algorithm for selecting the desired set.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first input line contains integers <span class="tex-span"><i>n</i></span>, <span class="tex-span"><i>k</i></span> and <span class="tex-span"><i>t</i></span> (<span class="tex-span">1 ≤ <i>k</i> ≤ <i>min</i>(100, <i>n</i><sup class="upper-index">2</sup>)</span>, <span class="tex-span">1 ≤ <i>t</i> ≤ 2·10<sup class="upper-index">5</sup></span>), separated by single spaces. Next <span class="tex-span"><i>k</i></span> lines contain triples of integers <span class="tex-span">(<i>h</i>, <i>w</i>, <i>r</i>)</span> <span class="tex-span">(1 ≤ <i>h</i>, <i>w</i> ≤ <i>n</i>; 1 ≤ <i>r</i> ≤ 1000)</span>, separated by single spaces, which describe the possible marriages. It is guaranteed that the input data is correct: <span class="tex-span"><i>t</i></span> doesn't exceed the total number of acceptable sets, and each pair <span class="tex-span">(<i>h</i>, <i>w</i>)</span> is present in at most one triple.</p><p>The input limitations for getting 30 points are: </p><ul> <li> <span class="tex-span">1 ≤ <i>n</i> ≤ 5</span> </li></ul> <p>The input limitations for getting 100 points are: </p><ul> <li> <span class="tex-span">1 ≤ <i>n</i> ≤ 20</span> </li></ul> </div><div class="output-specification"><div class="section-title">Output</div><p>Print a single number — the value of the <span class="tex-span"><i>t</i></span>-th acceptable variant.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>2 4 3<br />1 1 1<br />1 2 2<br />2 1 3<br />2 2 7<br /></pre></div><div class="output"><div class="title">Output</div><pre>2<br /></pre></div><div class="input"><div class="title">Input</div><pre>2 4 7<br />1 1 1<br />1 2 2<br />2 1 3<br />2 2 7<br /></pre></div><div class="output"><div class="title">Output</div><pre>8<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>The figure shows 7 acceptable sets of marriages that exist in the first sample. </p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/e81cca4d944cf770623a5d124e055748f8900cc8.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=F1]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/49284");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="F2" data-uuid="ps_e0b92b6c0ba4eb9870d7f9526843355ce28a80ea">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">F2. Script Generation</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>The Smart Beaver from ABBYY was offered a job of a screenwriter for the ongoing TV series. In particular, he needs to automate the hard decision: which main characters will get married by the end of the series.</p><p>There are <span class="tex-span"><i>n</i></span> single men and <span class="tex-span"><i>n</i></span> single women among the main characters. An opinion poll showed that viewers like several couples, and a marriage of any of them will make the audience happy. The Smart Beaver formalized this fact as <span class="tex-span"><i>k</i></span> triples of numbers <span class="tex-span">(<i>h</i>, <i>w</i>, <i>r</i>)</span>, where <span class="tex-span"><i>h</i></span> is the index of the man, <span class="tex-span"><i>w</i></span> is the index of the woman, and <span class="tex-span"><i>r</i></span> is the measure of the audience's delight in case of the marriage of this couple. The same poll showed that the marriage of any other couple will leave the audience indifferent, so the screenwriters decided not to include any such marriages in the plot.</p><p>The script allows you to arrange several marriages between the heroes or not to arrange marriages at all. A subset of some of the <span class="tex-span"><i>k</i></span> marriages is considered acceptable if each man and each woman is involved in at most one marriage of the subset (the series won't allow any divorces). The value of the acceptable set of marriages is the total delight the spectators will get from the marriages included in this set.</p><p>Obviously, there is a finite number of acceptable sets, and they all describe some variants of the script. The screenwriters do not want to choose a set with maximum value — it would make the plot too predictable. So the Smart Beaver offers the following option: sort all the acceptable sets in increasing order of value and choose the <span class="tex-span"><i>t</i></span>-th set from the sorted list. Thus, <span class="tex-span"><i>t</i> = 1</span> corresponds to a plot without marriages, <span class="tex-span"><i>t</i> = 2</span> — to a single marriage resulting in minimal delight for the audience, and so on.</p><p>Help the Beaver to implement the algorithm for selecting the desired set.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first input line contains integers <span class="tex-span"><i>n</i></span>, <span class="tex-span"><i>k</i></span> and <span class="tex-span"><i>t</i></span> (<span class="tex-span">1 ≤ <i>k</i> ≤ <i>min</i>(100, <i>n</i><sup class="upper-index">2</sup>)</span>, <span class="tex-span">1 ≤ <i>t</i> ≤ 2·10<sup class="upper-index">5</sup></span>), separated by single spaces. Next <span class="tex-span"><i>k</i></span> lines contain triples of integers <span class="tex-span">(<i>h</i>, <i>w</i>, <i>r</i>)</span> <span class="tex-span">(1 ≤ <i>h</i>, <i>w</i> ≤ <i>n</i>; 1 ≤ <i>r</i> ≤ 1000)</span>, separated by single spaces, which describe the possible marriages. It is guaranteed that the input data is correct: <span class="tex-span"><i>t</i></span> doesn't exceed the total number of acceptable sets, and each pair <span class="tex-span">(<i>h</i>, <i>w</i>)</span> is present in at most one triple.</p><p>The input limitations for getting 30 points are: </p><ul> <li> <span class="tex-span">1 ≤ <i>n</i> ≤ 5</span> </li></ul> <p>The input limitations for getting 100 points are: </p><ul> <li> <span class="tex-span">1 ≤ <i>n</i> ≤ 20</span> </li></ul> </div><div class="output-specification"><div class="section-title">Output</div><p>Print a single number — the value of the <span class="tex-span"><i>t</i></span>-th acceptable variant.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>2 4 3<br />1 1 1<br />1 2 2<br />2 1 3<br />2 2 7<br /></pre></div><div class="output"><div class="title">Output</div><pre>2<br /></pre></div><div class="input"><div class="title">Input</div><pre>2 4 7<br />1 1 1<br />1 2 2<br />2 1 3<br />2 2 7<br /></pre></div><div class="output"><div class="title">Output</div><pre>8<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>The figure shows 7 acceptable sets of marriages that exist in the first sample. </p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/e81cca4d944cf770623a5d124e055748f8900cc8.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=F2]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/49284");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="G1" data-uuid="ps_3aabb027a2cd99f00096da2292b4a1205460738b">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">G1. Fibonacci Strings</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Fibonacci strings are defined as follows: </p><ul> <li> <span class="tex-span"><i>f</i><sub class="lower-index">1</sub></span> = «<span class="tex-font-style-tt">a</span>» </li><li> <span class="tex-span"><i>f</i><sub class="lower-index">2</sub></span> = «<span class="tex-font-style-tt">b</span>» </li><li> <span class="tex-span"><i>f</i><sub class="lower-index"><i>n</i></sub></span> = <span class="tex-span"><i>f</i><sub class="lower-index"><i>n</i> - 1</sub> <i>f</i><sub class="lower-index"><i>n</i> - 2</sub></span>, <span class="tex-span"><i>n</i> &gt; 2</span> </li></ul><p>Thus, the first five Fibonacci strings are: &quot;<span class="tex-font-style-tt">a</span>&quot;, &quot;<span class="tex-font-style-tt">b</span>&quot;, &quot;<span class="tex-font-style-tt">ba</span>&quot;, &quot;<span class="tex-font-style-tt">bab</span>&quot;, &quot;<span class="tex-font-style-tt">babba</span>&quot;.</p><p>You are given a Fibonacci string and <span class="tex-span"><i>m</i></span> strings <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span>. For each string <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span>, find the number of times it occurs in the given Fibonacci string as a substring.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains two space-separated integers <span class="tex-span"><i>k</i></span> and <span class="tex-span"><i>m</i></span> — the number of a Fibonacci string and the number of queries, correspondingly.</p><p>Next <span class="tex-span"><i>m</i></span> lines contain strings <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span> that correspond to the queries. It is guaranteed that strings <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span> aren't empty and consist only of characters &quot;<span class="tex-font-style-tt">a</span>&quot; and &quot;<span class="tex-font-style-tt">b</span>&quot;.</p><p>The input limitations for getting 30 points are: </p><ul> <li> <span class="tex-span">1 ≤ <i>k</i> ≤ 3000</span> </li><li> <span class="tex-span">1 ≤ <i>m</i> ≤ 3000</span> </li><li> The total length of strings <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span> doesn't exceed <span class="tex-span">3000</span> </li></ul> <p>The input limitations for getting 100 points are: </p><ul> <li> <span class="tex-span">1 ≤ <i>k</i> ≤ 10<sup class="upper-index">18</sup></span> </li><li> <span class="tex-span">1 ≤ <i>m</i> ≤ 10<sup class="upper-index">4</sup></span> </li><li> The total length of strings <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span> doesn't exceed <span class="tex-span">10<sup class="upper-index">5</sup></span> </li></ul> <p>Please do not use the <span class="tex-font-style-tt">%lld</span> specifier to read or write 64-bit integers in С++. It is preferred to use <span class="tex-font-style-tt">cin</span>, <span class="tex-font-style-tt">cout</span> streams or the <span class="tex-font-style-tt">%I64d</span> specifier.</p></div><div class="output-specification"><div class="section-title">Output</div><p>For each string <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span> print the number of times it occurs in the given Fibonacci string as a substring. Since the numbers can be large enough, print them modulo <span class="tex-span">1000000007</span> <span class="tex-span">(10<sup class="upper-index">9</sup> + 7)</span>. Print the answers for the strings in the order in which they are given in the input.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>6 5<br />a<br />b<br />ab<br />ba<br />aba<br /></pre></div><div class="output"><div class="title">Output</div><pre>3<br />5<br />3<br />3<br />1<br /></pre></div></div></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=G1]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/49284");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 1em;"
        >


<div class="problemindexholder" problemindex="G2" data-uuid="ps_3aabb027a2cd99f00096da2292b4a1205460738b">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">G2. Fibonacci Strings</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Fibonacci strings are defined as follows: </p><ul> <li> <span class="tex-span"><i>f</i><sub class="lower-index">1</sub></span> = «<span class="tex-font-style-tt">a</span>» </li><li> <span class="tex-span"><i>f</i><sub class="lower-index">2</sub></span> = «<span class="tex-font-style-tt">b</span>» </li><li> <span class="tex-span"><i>f</i><sub class="lower-index"><i>n</i></sub></span> = <span class="tex-span"><i>f</i><sub class="lower-index"><i>n</i> - 1</sub> <i>f</i><sub class="lower-index"><i>n</i> - 2</sub></span>, <span class="tex-span"><i>n</i> &gt; 2</span> </li></ul><p>Thus, the first five Fibonacci strings are: &quot;<span class="tex-font-style-tt">a</span>&quot;, &quot;<span class="tex-font-style-tt">b</span>&quot;, &quot;<span class="tex-font-style-tt">ba</span>&quot;, &quot;<span class="tex-font-style-tt">bab</span>&quot;, &quot;<span class="tex-font-style-tt">babba</span>&quot;.</p><p>You are given a Fibonacci string and <span class="tex-span"><i>m</i></span> strings <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span>. For each string <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span>, find the number of times it occurs in the given Fibonacci string as a substring.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains two space-separated integers <span class="tex-span"><i>k</i></span> and <span class="tex-span"><i>m</i></span> — the number of a Fibonacci string and the number of queries, correspondingly.</p><p>Next <span class="tex-span"><i>m</i></span> lines contain strings <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span> that correspond to the queries. It is guaranteed that strings <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span> aren't empty and consist only of characters &quot;<span class="tex-font-style-tt">a</span>&quot; and &quot;<span class="tex-font-style-tt">b</span>&quot;.</p><p>The input limitations for getting 30 points are: </p><ul> <li> <span class="tex-span">1 ≤ <i>k</i> ≤ 3000</span> </li><li> <span class="tex-span">1 ≤ <i>m</i> ≤ 3000</span> </li><li> The total length of strings <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span> doesn't exceed <span class="tex-span">3000</span> </li></ul> <p>The input limitations for getting 100 points are: </p><ul> <li> <span class="tex-span">1 ≤ <i>k</i> ≤ 10<sup class="upper-index">18</sup></span> </li><li> <span class="tex-span">1 ≤ <i>m</i> ≤ 10<sup class="upper-index">4</sup></span> </li><li> The total length of strings <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span> doesn't exceed <span class="tex-span">10<sup class="upper-index">5</sup></span> </li></ul> <p>Please do not use the <span class="tex-font-style-tt">%lld</span> specifier to read or write 64-bit integers in С++. It is preferred to use <span class="tex-font-style-tt">cin</span>, <span class="tex-font-style-tt">cout</span> streams or the <span class="tex-font-style-tt">%I64d</span> specifier.</p></div><div class="output-specification"><div class="section-title">Output</div><p>For each string <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span> print the number of times it occurs in the given Fibonacci string as a substring. Since the numbers can be large enough, print them modulo <span class="tex-span">1000000007</span> <span class="tex-span">(10<sup class="upper-index">9</sup> + 7)</span>. Print the answers for the strings in the order in which they are given in the input.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>6 5<br />a<br />b<br />ab<br />ba<br />aba<br /></pre></div><div class="output"><div class="title">Output</div><pre>3<br />5<br />3<br />3<br />1<br /></pre></div></div></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=G2]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/49284");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
    </div>

    <div id="footer">
        <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2024 Mike Mirzayanov</div>
        <div>The only programming contests Web 2.0 platform</div>

    </div>

</div>
</div>
    <script type="application/javascript">
        if ('serviceWorker' in navigator && 'fetch' in window && 'caches' in window) {
            navigator.serviceWorker.register('/service-worker-49284.js')
                .then(function (registration) {
                    console.log('Service worker registered: ', registration);
                })
                .catch(function (error) {
                    console.log('Registration failed: ', error);
                });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'89f76a017baa777b',t:'MTcyMDM1MDkwMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>


<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-743380-5"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-743380-5');
        </script>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="a470c09a80e0780161f9cc792360b26e"/>
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01"/>

    <script type="text/javascript" src="//codeforces.org/s/20331/js/jquery-1.8.3.js"></script>
    <script type="application/javascript">
        window.locale = "en";
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }

        /* Protection against trailing dot in domain. */
        let hostLength = window.location.host.length;
        if (hostLength > 1 && window.location.host[hostLength - 1] === '.') {
            window.location = window.location.protocol + "//" + window.location.host.substring(0, hostLength - 1);
        }
    </script>

    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="l3">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="//codeforces.org/s/20331/images/codeforces-sponsored-by-ton.png" />
    <link rel="image_src" href="//codeforces.org/s/20331/images/codeforces-sponsored-by-ton.png" />
    <meta property="og:title" content="Problems - Codeforces"/>
    <meta property="og:description" content=""/>
    
    <meta property="og:site_name" content="Codeforces"/>
    
    
    
    
    
    
    <meta name="utc_offset" content="+03:00"/>
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Problems - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community" />
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup" />
    <meta name="robots" content="index, follow" />

    <link rel="stylesheet" href="//codeforces.org/s/20331/css/font-awesome.min.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/20331/css/line-awesome.min.css" type="text/css" charset="utf-8" />

        <link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>


    <link rel="apple-touch-icon" sizes="57x57" href="//codeforces.org/s/20331/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="//codeforces.org/s/20331/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="//codeforces.org/s/20331/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="//codeforces.org/s/20331/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="//codeforces.org/s/20331/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="//codeforces.org/s/20331/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="//codeforces.org/s/20331/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="//codeforces.org/s/20331/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="//codeforces.org/s/20331/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="//codeforces.org/s/20331/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="//codeforces.org/s/20331/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="//codeforces.org/s/20331/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="//codeforces.org/s/20331/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="//codeforces.org/s/20331/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="//codeforces.org/s/20331/css/prettify.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/20331/css/clear.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/20331/css/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/20331/css/ttypography.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/20331/css/problem-statement.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/20331/css/second-level-menu.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/20331/css/roundbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/20331/css/datatable.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/20331/css/table-form.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/20331/css/topic.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/20331/css/jquery.jgrowl.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/20331/css/facebox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/20331/css/jquery.wysiwyg.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/20331/css/jquery.autocomplete.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/20331/css/codeforces.datepick.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/20331/css/colorbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/20331/css/jquery.drafts.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/20331/css/community.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/20331/css/sidebar-menu.css" type="text/css" charset="utf-8" />

    <!-- MathJax -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    MathJax.Hub.Register.StartupHook("End", function () {
        Codeforces.runMathJaxListeners();
    });
    </script>
    <script type="text/javascript" async
            src="https://mathjax.codeforces.org/MathJax.js?config=TeX-AMS_HTML-full"
    >
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="//codeforces.org/s/20331/js/prettify/prettify.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/20331/js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/20331/js/pushstream.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/20331/js/jquery.easing.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/20331/js/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/20331/js/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/20331/js/jquery.swipe.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/20331/js/jquery.hotkeys.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/20331/js/facebox.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/20331/js/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/20331/js/controls/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/20331/js/controls/wysiwyg.table.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/20331/js/controls/wysiwyg.image.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/20331/js/controls/wysiwyg.link.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/20331/js/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/20331/js/jquery.datepick.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/20331/js/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/20331/js/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/20331/js/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/20331/js/jquery.drafts.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/20331/js/clipboard.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/20331/js/autosize.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/20331/js/sjcl.js"></script>
    <script type="text/javascript" src="/scripts/1b3cddaf1fc910f88c99b21c974b7cde/en/codeforces-options.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/20331/js/codeforces.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/20331/js/EventCatcher.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/20331/js/preparedVerdictFormats-en.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/20331/js/confetti.min.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="//codeforces.org/s/20331/markitup/skins/markitup/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/20331/markitup/sets/markdown/style.css" type="text/css" charset="utf-8" />


    <script type="text/javascript" src="//codeforces.org/s/20331/markitup/jquery.markitup.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/20331/markitup/sets/markdown/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->




</head>
<body class=" "><span style='display:none;' class='csrf-token' data-csrf='a470c09a80e0780161f9cc792360b26e'>&nbsp;</span>

<!-- .notificationTextCleaner used in Codeforces.showAnnouncements() -->
<div class="notificationTextCleaner" style="font-size: 0"></div>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 3.0rem;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    String.prototype.hashCode = function() {
        var hash = 0, i, chr;
        if (this.length === 0) return hash;
        for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };

    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile === "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>





    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 700
        });
    }, 100);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


    function showAnnouncements(json) {
        //info("j=" + JSON.stringify(json));

        if (json.t != "a") {
            return;
        }

        setTimeout(function() {
            Codeforces.showAnnouncements(json.d, "en");
        }, Math.random() * 500);
    }

    function showEventCatcherUserMessage(json) {
        if (json.t == "s") {
            var points = json.d[5];
            var passedTestCount = json.d[7];
            var judgedTestCount = json.d[8];
            var verdict = preparedVerdictFormats[json.d[12]];
            var verdictPrototypeDiv = $(".verdictPrototypeDiv");
            verdictPrototypeDiv.html(verdict);
            if (judgedTestCount != null && judgedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-judged").text(judgedTestCount);
            }
            if (passedTestCount != null && passedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-passed").text(passedTestCount);
            }
            if (points != null && points != undefined) {
                verdictPrototypeDiv.find(".verdict-format-points").text(points);
            }
            Codeforces.showMessage(verdictPrototypeDiv.text());
        }
    }

    $(".clickable-title").each(function() {
        var title = $(this).attr("data-title");
        if (title) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = title;
            $(this).attr("title", tmp.textContent || tmp.innerText || "");
        }
    });

    $(".clickable-title").click(function() {
        var title = $(this).attr("data-title");
        if (title) {
            Codeforces.alert(title);
        } else {
            Codeforces.alert($(this).attr("title"));
        }
    }).css("position", "relative").css("bottom", "3px");

        Codeforces.showDelayedMessage();

    Codeforces.reformatTimes();

    //Codeforces.initializePubSub();
    if (window.codeforcesOptions.subscribeServerUrl) {
        window.eventCatcher = new EventCatcher(
            window.codeforcesOptions.subscribeServerUrl,
            [
                Codeforces.getGlobalChannel(),
                Codeforces.getUserChannel(),
                Codeforces.getUserShowMessageChannel(),
                Codeforces.getContestChannel(),
                Codeforces.getParticipantChannel(),
                Codeforces.getTalkChannel()
            ]
        );

        if (Codeforces.getParticipantChannel()) {
            window.eventCatcher.subscribe(Codeforces.getParticipantChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getContestChannel()) {
            window.eventCatcher.subscribe(Codeforces.getContestChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getGlobalChannel()) {
            window.eventCatcher.subscribe(Codeforces.getGlobalChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserShowMessageChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserShowMessageChannel(), function(json) {
                showEventCatcherUserMessage(json);
            });
        }
    }

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>


<div id="body">
<div style="width: 950px; margin: 0 auto;" class="compact-problemset">
    <div id="header" style="position: relative; margin: 0;">
        <div style="float:left;">
                  <a href="/"><img height="65" style="height: 65px;" src="//codeforces.org/s/20331/images/codeforces-sponsored-by-ton.png" alt="Codeforces"/></a>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="//codeforces.org/s/20331/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="//codeforces.org/s/20331/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <br style="clear: both;"/>

    <div style="text-align: center; font-size: 1.8rem; margin-bottom: 0.5em;"
         class="caption">VK Cup 2015 - Finals, online mirror</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

    <div class="problem-frames">
        <div
                    style="margin-bottom: 2em;"
        >

    <style>
        #facebox .content:has(.diff-popup) {
            width: 90vw;
            max-width: 120rem !important;
        }

        .testCaseMarker {
            position: absolute;
            font-weight: bold;
            font-size: 1rem;
        }

        .diff-popup {
            width: 90vw;
            max-width: 120rem !important;
            display: none;
            overflow: auto;
        }

        .input-output-copier {
            font-size: 1.2rem;
            float: right;
            color: #888 !important;
            cursor: pointer;
            border: 1px solid rgb(185, 185, 185);
            padding: 3px;
            margin: 1px;
            line-height: 1.1rem;
            text-transform: none;
        }

        .input-output-copier:hover {
            background-color: #def;
        }

        .test-explanation textarea {
            width: 100%;
            height: 1.5em;
        }

        .pending-submission-message {
            color: darkorange !important;
        }
    </style>
    <script>
        const OPENING_SPACE = String.fromCharCode(1001);
        const CLOSING_SPACE = String.fromCharCode(1002);

        const nodeToText = function (node, pre) {
            let result = [];

            if (node.tagName === "SCRIPT" || node.tagName === "math"
                || (node.classList && node.classList.contains("input-output-copier")))
                return [];

            if (node.tagName === "NOBR") {
                result.push(OPENING_SPACE);
            }

            if (node.nodeType === Node.TEXT_NODE) {
                let s = node.textContent;
                if (!pre) {
                    s = s.replace(/\s+/g, " ");
                }
                if (s.length > 0) {
                    result.push(s);
                }
            }

            if (pre && node.tagName === "BR") {
                result.push("\n");
            }

            node.childNodes.forEach(function (child) {
                result.push(nodeToText(child, node.tagName === "PRE").join(""));
            });

            if (node.tagName === "DIV"
                || node.tagName === "P"
                || node.tagName === "PRE"
                || node.tagName === "UL"
                || node.tagName === "LI"
            ) {
                result.push("\n");
            }

            if (node.tagName === "NOBR") {
                result.push(CLOSING_SPACE);
            }

            return result;
        }

        const isSpecial = function (c) {
            return c === ',' || c === '.' || c === ';' || c === ')' || c === ' ';
        }

        const convertStatementToText = function(statmentNode) {
            const text = nodeToText(statmentNode, false).join("").replace(/ +/g, " ").replace(/\n\n+/g, "\n\n");
            let result = [];
            for (let i = 0; i < text.length; i++) {
                const c = text.charAt(i);
                if (c === OPENING_SPACE) {
                    if (!((i > 0 && text.charAt(i - 1) === '(') || (result.length > 0 && result[result.length - 1] === ' '))) {
                        result.push('+');
                    }
                } else if (c === CLOSING_SPACE) {
                    if (!(i + 1 < text.length && isSpecial(text.charAt(i + 1)))) {
                        result.push('-');
                    }
                } else {
                    result.push(c);
                }
            }
            return result.join("").split("\n").map(value => value.trim()).join("\n");
        };
    </script>
    <div class="diff-popup">
    </div>

<div class="problemindexholder" problemindex="A" data-uuid="ps_21fd5219537cf04ebd32872f345caa5a401973cd">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A. Matching Names</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Teachers of one programming summer school decided to make a surprise for the students by giving them names in the style of the &quot;Hobbit&quot; movie. Each student must get a pseudonym maximally similar to his own name. The pseudonym must be a name of some character of the popular saga and now the teachers are busy matching pseudonyms to student names.</p><p>There are <span class="tex-span"><i>n</i></span> students in a summer school. Teachers chose exactly <span class="tex-span"><i>n</i></span> pseudonyms for them. Each student must get exactly one pseudonym corresponding to him. Let us determine the relevance of a pseudonym <span class="tex-span"><i>b</i></span> to a student with name <span class="tex-span"><i>a</i></span> as the length of the largest common prefix <span class="tex-span"><i>a</i></span> and <span class="tex-span"><i>b</i></span>. We will represent such value as <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/d770c95a871517ce5a1e7d0f45f1313b04dbeef1.png" style="max-width: 100.0%;max-height: 100.0%;" />. Then we can determine the <span class="tex-font-style-it">quality</span> of matching of the pseudonyms to students as a sum of relevances of all pseudonyms to the corresponding students.</p><p>Find the matching between students and pseudonyms with the maximum <span class="tex-font-style-it">quality</span>.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains number <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 100 000</span>) — the number of students in the summer school.</p><p>Next <span class="tex-span"><i>n</i></span> lines contain the name of the students. Each name is a non-empty word consisting of lowercase English letters. Some names can be repeating.</p><p>The last <span class="tex-span"><i>n</i></span> lines contain the given pseudonyms. Each pseudonym is a non-empty word consisting of small English letters. Some pseudonyms can be repeating.</p><p>The total length of all the names and pseudonyms doesn't exceed <span class="tex-span">800 000</span> characters.</p></div><div class="output-specification"><div class="section-title">Output</div><p>In the first line print the maximum possible <span class="tex-font-style-it">quality</span> of matching pseudonyms to students.</p><p>In the next <span class="tex-span"><i>n</i></span> lines describe the optimal matching. Each line must have the form <span class="tex-span"><i>a</i></span> <span class="tex-span"><i>b</i></span> (<span class="tex-span">1 ≤ <i>a</i>, <i>b</i> ≤ <i>n</i></span>), that means that the student who was number <span class="tex-span"><i>a</i></span> in the input, must match to the pseudonym number <span class="tex-span"><i>b</i></span> in the input.</p><p>The matching should be a one-to-one correspondence, that is, each student and each pseudonym should occur exactly once in your output. If there are several optimal answers, output any.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>5<br />gennady<br />galya<br />boris<br />bill<br />toshik<br />bilbo<br />torin<br />gendalf<br />smaug<br />galadriel<br /></pre></div><div class="output"><div class="title">Output</div><pre>11<br />4 1<br />2 5<br />1 3<br />5 2<br />3 4<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>The first test from the statement the match looks as follows: </p><ul> <li> <span class="tex-font-style-bf">bil</span>l <span class="tex-span"> → </span> <span class="tex-font-style-bf">bil</span>bo (lcp = 3) </li><li> <span class="tex-font-style-bf">gal</span>ya <span class="tex-span"> → </span> <span class="tex-font-style-bf">gal</span>adriel (lcp = 3) </li><li> <span class="tex-font-style-bf">gen</span>nady <span class="tex-span"> → </span> <span class="tex-font-style-bf">gen</span>dalf (lcp = 3) </li><li> <span class="tex-font-style-bf">to</span>shik <span class="tex-span"> → </span> <span class="tex-font-style-bf">to</span>rin (lcp = 2) </li><li> boris <span class="tex-span"> → </span> smaug (lcp = 0) </li></ul></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=A]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/20331");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {
        window.changedTests = new Set();

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");



        String.prototype.replaceAll = function (search, replace) {
            return this.split(search).join(replace);
        };

        $(".sample-test .title").each(function () {
            const preId = ("id" + Math.random()).replaceAll(".", "0");
            const cpyId = ("id" + Math.random()).replaceAll(".", "0");

            $(this).parent().find("pre").attr("id", preId);
            const $copy = $("<div title='Copy' data-clipboard-target='#" + preId + "' id='" + cpyId + "' class='input-output-copier'>Copy</div>");
            $(this).append($copy);

            const clipboard = new Clipboard('#' + cpyId, {
                text: function (trigger) {
                    const pre = document.querySelector('#' + preId);
                    const lines = pre.querySelectorAll(".test-example-line");
                    return Codeforces.filterClipboardText(pre.innerText, lines.length);
                }
            });

            const isInput = $(this).parent().hasClass("input");

            clipboard.on('success', function (e) {
                if (isInput) {
                    Codeforces.showMessage("The example input has been copied into the clipboard");
                } else {
                    Codeforces.showMessage("The example output has been copied into the clipboard");
                }
                e.clearSelection();
            });
        });

        $(".test-form-item input").change(function () {
            addPendingSubmissionMessage($($(this).closest("form")), "You changed the answer, do not forget to submit it if you want to save the changes");
            const index = $(this).closest(".problemindexholder").attr("problemindex");
            let test = "";
            $(this).closest("form input").each(function () {
                const test_ = $(this).attr("name");
                if (test_ && test_.substring(0, 4) === "test") {
                    test = test_;
                }
            });
            if (index.length > 0 && test.length > 0) {
                const indexTest = index + "::" + test;
                window.changedTests.add(indexTest);
            }
        });

        $(window).on('beforeunload', function () {
            if (window.changedTests.size > 0) {
                return 'Dialog text here';
            }
        });

        autosize($('.test-explanation textarea'));

        $(".test-example-line").hover(function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        let top = 1E20;
                        let left = 1E20;
                        let problem = $(this).closest(".problemindexholder");
                        $(this).closest(".input").find("." + clazz).css("background-color", "#FFFDE7").each(function() {
                            top = Math.min(top, $(this).offset().top);
                            left = Math.min(left, $(this).offset().left);
                        });
                        let testCaseMarker = problem.find(".testCaseMarker_" + end);
                        if (testCaseMarker.length === 0) {
                            const html = "<div class=\"testCaseMarker testCaseMarker_" + end + " notice\"></div>";
                            problem.append($(html));
                            testCaseMarker = problem.find(".testCaseMarker_" + end);
                        }
                        if (testCaseMarker) {
                            testCaseMarker.show()
                                    .offset({top, left: left - 20})
                                    .text(end);
                        }
                    }
                }
            });
        }, function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        $("." + clazz).css("background-color", "");
                        $(this).closest(".problemindexholder").find(".testCaseMarker_" + end).hide();
                    }
                }
            });
        });

    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="B" data-uuid="ps_6e54f14b138155a0f140ffc9d9c0cdca15c4bd8e">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B. Replicating Processes</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>A Large Software Company develops its own social network. Analysts have found that during the holidays, major sporting events and other significant events users begin to enter the network more frequently, resulting in great load increase on the infrastructure.</p><p>As part of this task, we assume that the social network is <span class="tex-span">4<i>n</i></span> processes running on the <span class="tex-span"><i>n</i></span> servers. All servers are absolutely identical machines, each of which has a volume of RAM of <span class="tex-span">1</span> GB = <span class="tex-span">1024</span> MB <span class="tex-span"><sup class="upper-index">(1)</sup></span>. Each process takes 100 MB of RAM on the server. At the same time, the needs of maintaining the viability of the server takes about <span class="tex-span">100</span> more megabytes of RAM. Thus, each server may have up to <span class="tex-span">9</span> different processes of social network.</p><p>Now each of the <span class="tex-span"><i>n</i></span> servers is running exactly <span class="tex-span">4</span> processes. However, at the moment of peak load it is sometimes necessary to replicate the existing <span class="tex-span">4<i>n</i></span> processes by creating <span class="tex-span">8<i>n</i></span> new processes instead of the old ones. More formally, there is a set of replication rules, the <span class="tex-span"><i>i</i></span>-th (<span class="tex-span">1 ≤ <i>i</i> ≤ 4<i>n</i></span>) of which has the form of <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub> → (<i>b</i><sub class="lower-index"><i>i</i></sub>, <i>c</i><sub class="lower-index"><i>i</i></sub>)</span>, where <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub>, <i>c</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i></span>) are the numbers of servers. This means that instead of an old process running on server <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>, there should appear two new copies of the process running on servers <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span>. The two new replicated processes can be on the same server (i.e., <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> may be equal to <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span>) or even on the same server where the original process was (i.e. <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> may be equal to <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> or <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span>). During the implementation of the rule <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub> → (<i>b</i><sub class="lower-index"><i>i</i></sub>, <i>c</i><sub class="lower-index"><i>i</i></sub>)</span> first the process from the server <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> is destroyed, then appears a process on the server <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span>, then appears a process on the server <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span>.</p><p>There is a set of <span class="tex-span">4<i>n</i></span> rules, destroying all the original <span class="tex-span">4<i>n</i></span> processes from <span class="tex-span"><i>n</i></span> servers, and creating after their application <span class="tex-span">8<i>n</i></span> replicated processes, besides, on each of the <span class="tex-span"><i>n</i></span> servers will be exactly <span class="tex-span">8</span> processes. However, the rules can only be applied consecutively, and therefore the amount of RAM of the servers imposes limitations on the procedure for the application of the rules.</p><p>According to this set of rules determine the order in which you want to apply all the <span class="tex-span">4<i>n</i></span> rules so that at any given time the memory of each of the servers contained at most <span class="tex-span">9</span> processes (old and new together), or tell that it is impossible.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of the input contains integer <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 30 000</span>) — the number of servers of the social network.</p><p>Next <span class="tex-span">4<i>n</i></span> lines contain the rules of replicating processes, the <span class="tex-span"><i>i</i></span>-th (<span class="tex-span">1 ≤ <i>i</i> ≤ 4<i>n</i></span>) of these lines as form <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub>, <i>c</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub>, <i>c</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i></span>) and describes rule <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub> → (<i>b</i><sub class="lower-index"><i>i</i></sub>, <i>c</i><sub class="lower-index"><i>i</i></sub>)</span>.</p><p>It is guaranteed that each number of a server from <span class="tex-span">1</span> to <span class="tex-span"><i>n</i></span> occurs four times in the set of all <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>, and eight times among a set that unites all <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span>.</p></div><div class="output-specification"><div class="section-title">Output</div><p>If the required order of performing rules does not exist, print &quot;<span class="tex-font-style-tt">NO</span>&quot; (without the quotes).</p><p>Otherwise, print in the first line &quot;<span class="tex-font-style-tt">YES</span>&quot; (without the quotes), and in the second line — a sequence of <span class="tex-span">4<i>n</i></span> numbers from <span class="tex-span">1</span> to <span class="tex-span">4<i>n</i></span>, giving the numbers of the rules in the order they are applied. The sequence should be a permutation, that is, include each number from <span class="tex-span">1</span> to <span class="tex-span">4<i>n</i></span> exactly once.</p><p>If there are multiple possible variants, you are allowed to print any of them.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>2<br />1 2 2<br />1 2 2<br />1 2 2<br />1 2 2<br />2 1 1<br />2 1 1<br />2 1 1<br />2 1 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>YES<br />1 2 5 6 3 7 4 8<br /></pre></div><div class="input"><div class="title">Input</div><pre>3<br />1 2 3<br />1 1 1<br />1 1 1<br />1 1 1<br />2 1 3<br />2 2 2<br />2 2 2<br />2 2 2<br />3 1 2<br />3 3 3<br />3 3 3<br />3 3 3<br /></pre></div><div class="output"><div class="title">Output</div><pre>YES<br />2 3 4 6 7 8 10 11 12 1 5 9<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p><span class="tex-span"><sup class="upper-index">(1)</sup></span> To be extremely accurate, we should note that the amount of server memory is <span class="tex-span">1</span> GiB = <span class="tex-span">1024</span> MiB and processes require <span class="tex-span">100</span> MiB RAM where a gibibyte (GiB) is the amount of RAM of <span class="tex-span">2<sup class="upper-index">30</sup></span> bytes and a mebibyte (MiB) is the amount of RAM of <span class="tex-span">2<sup class="upper-index">20</sup></span> bytes.</p><p>In the first sample test the network uses two servers, each of which initially has four launched processes. In accordance with the rules of replication, each of the processes must be destroyed and twice run on another server. One of the possible answers is given in the statement: after applying rules <span class="tex-span">1</span> and <span class="tex-span">2</span> the first server will have <span class="tex-span">2</span> old running processes, and the second server will have <span class="tex-span">8</span> (<span class="tex-span">4</span> old and <span class="tex-span">4</span> new) processes. After we apply rules <span class="tex-span">5</span> and <span class="tex-span">6</span>, both servers will have <span class="tex-span">6</span> running processes (<span class="tex-span">2</span> old and <span class="tex-span">4</span> new). After we apply rules <span class="tex-span">3</span> and <span class="tex-span">7</span>, both servers will have <span class="tex-span">7</span> running processes (<span class="tex-span">1</span> old and <span class="tex-span">6</span> new), and after we apply rules <span class="tex-span">4</span> and <span class="tex-span">8</span>, each server will have <span class="tex-span">8</span> running processes. At no time the number of processes on a single server exceeds <span class="tex-span">9</span>.</p><p>In the second sample test the network uses three servers. On each server, three processes are replicated into two processes on the same server, and the fourth one is replicated in one process for each of the two remaining servers. As a result of applying rules <span class="tex-span">2, 3, 4, 6, 7, 8, 10, 11, 12</span> each server would have <span class="tex-span">7</span> processes (<span class="tex-span">6</span> old and <span class="tex-span">1</span> new), as a result of applying rules <span class="tex-span">1, 5, 9</span> each server will have <span class="tex-span">8</span> processes. At no time the number of processes on a single server exceeds <span class="tex-span">9</span>.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=B]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/20331");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="C" data-uuid="ps_5fc3f5275e4a0706ecfec8a9d5e3ada6073e6f2e">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C. Logistical Questions</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Some country consists of <span class="tex-span"><i>n</i></span> cities, connected by a railroad network. The transport communication of the country is so advanced that the network consists of a minimum required number of <span class="tex-span">(<i>n</i> - 1)</span> bidirectional roads (in the other words, the graph of roads is a tree). The <span class="tex-span"><i>i</i></span>-th road that directly connects cities <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span>, has the length of <span class="tex-span"><i>l</i><sub class="lower-index"><i>i</i></sub></span> kilometers.</p><p>The transport network is served by a state transporting company FRR (Fabulous Rail Roads). In order to simplify the price policy, it offers a single ride fare on the train. In order to follow the route of length <span class="tex-span"><i>t</i></span> kilometers, you need to pay <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/d859317482668da17f2b69b7470d5fc143216fb4.png" style="max-width: 100.0%;max-height: 100.0%;" /> burles. Note that it is forbidden to split a long route into short segments and pay them separately (a special railroad police, or RRP, controls that the law doesn't get violated).</p><p>A Large Software Company decided to organize a programming tournament. Having conducted several online rounds, the company employees determined a list of finalists and sent it to the logistical department to find a place where to conduct finals. The Large Software Company can easily organize the tournament finals in any of the <span class="tex-span"><i>n</i></span> cities of the country, so the the main factor in choosing the city for the last stage of the tournament is the total cost of buying tickets for all the finalists. We know that the <span class="tex-span"><i>i</i></span>-th city of the country has <span class="tex-span"><i>w</i><sub class="lower-index"><i>i</i></sub></span> cup finalists living there.</p><p>Help the company employees find the city such that the total cost of travel of all the participants to it is minimum.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of the input contains number <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 200 000</span>) — the number of cities in the country.</p><p>The next line contains <span class="tex-span"><i>n</i></span> integers <span class="tex-span"><i>w</i><sub class="lower-index">1</sub>, <i>w</i><sub class="lower-index">2</sub>, ..., <i>w</i><sub class="lower-index"><i>n</i></sub></span> (<span class="tex-span">0 ≤ <i>w</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">8</sup></span>) — the number of finalists living in each city of the country.</p><p>Next <span class="tex-span">(<i>n</i> - 1)</span> lines contain the descriptions of the railroad, the <span class="tex-span"><i>i</i></span>-th line contains three integers, <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>l</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i></span>, <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub> ≠ <i>b</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span">1 ≤ <i>l</i><sub class="lower-index"><i>i</i></sub> ≤ 1000</span>).</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print two numbers — an integer <span class="tex-span"><i>f</i></span> that is the number of the optimal city to conduct the competition, and the real number <span class="tex-span"><i>c</i></span>, equal to the minimum total cost of transporting all the finalists to the competition. Your answer will be considered correct if two conditions are fulfilled at the same time: </p><ol> <li> The absolute or relative error of the printed number <span class="tex-span"><i>c</i></span> in comparison with the cost of setting up a final in city <span class="tex-span"><i>f</i></span> doesn't exceed <span class="tex-span">10<sup class="upper-index"> - 6</sup></span>; </li><li> Absolute or relative error of the printed number <span class="tex-span"><i>c</i></span> in comparison to the answer of the jury doesn't exceed <span class="tex-span">10<sup class="upper-index"> - 6</sup></span>. </li></ol><p>If there are multiple answers, you are allowed to print any of them.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>5<br />3 1 2 6 5<br />1 2 3<br />2 3 1<br />4 3 9<br />5 3 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>3 192.0</pre></div><div class="input"><div class="title">Input</div><pre>2<br />5 5<br />1 2 2<br /></pre></div><div class="output"><div class="title">Output</div><pre>1 14.142135623730951000<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the sample test an optimal variant of choosing a city to conduct the finals of the competition is <span class="tex-span">3</span>. At such choice the cost of conducting is <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/4219dfaeaed77b348dc7ca0c500739d1c0ff9e3f.png" style="max-width: 100.0%;max-height: 100.0%;" /> burles.</p><p>In the second sample test, whatever city you would choose, you will need to pay for the transport for five participants, so you will need to pay <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/bec9396b77dab4487d19f32c85b0edb26924da8c.png" style="max-width: 100.0%;max-height: 100.0%;" /> burles for each one of them.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=C]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/20331");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="D" data-uuid="ps_9baaa65ca2494400394d8dd18082dce43bcfe6d1">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. Restructuring Company</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Even the most successful company can go through a crisis period when you have to make a hard decision — to restructure, discard and merge departments, fire employees and do other unpleasant stuff. Let's consider the following model of a company.</p><p>There are <span class="tex-span"><i>n</i></span> people working for the Large Software Company. Each person belongs to some <span class="tex-font-style-it">department</span>. Initially, each person works on his own project in his own department (thus, each company initially consists of <span class="tex-span"><i>n</i></span> departments, one person in each).</p><p>However, harsh times have come to the company and the management had to hire a crisis manager who would rebuild the working process in order to boost efficiency. Let's use <span class="tex-span"><i>team</i>(<i>person</i>)</span> to represent a team where person <span class="tex-span"><i>person</i></span> works. A crisis manager can make decisions of two types:</p><ol> <li> Merge departments <span class="tex-span"><i>team</i>(<i>x</i>)</span> and <span class="tex-span"><i>team</i>(<i>y</i>)</span> into one large department containing all the employees of <span class="tex-span"><i>team</i>(<i>x</i>)</span> and <span class="tex-span"><i>team</i>(<i>y</i>)</span>, where <span class="tex-span"><i>x</i></span> and <span class="tex-span"><i>y</i></span> (<span class="tex-span">1 ≤ <i>x</i>, <i>y</i> ≤ <i>n</i></span>) — are numbers of two of some company employees. If <span class="tex-span"><i>team</i>(<i>x</i>)</span> matches <span class="tex-span"><i>team</i>(<i>y</i>)</span>, then nothing happens. </li><li> Merge departments <span class="tex-span"><i>team</i>(<i>x</i>), <i>team</i>(<i>x</i> + 1), ..., <i>team</i>(<i>y</i>)</span>, where <span class="tex-span"><i>x</i></span> and <span class="tex-span"><i>y</i></span> (<span class="tex-span">1 ≤ <i>x</i> ≤ <i>y</i> ≤ <i>n</i></span>) — the numbers of some two employees of the company. </li></ol><p>At that the crisis manager can sometimes wonder whether employees <span class="tex-span"><i>x</i></span> and <span class="tex-span"><i>y</i></span> (<span class="tex-span">1 ≤ <i>x</i>, <i>y</i> ≤ <i>n</i></span>) work at the same department.</p><p>Help the crisis manager and answer all of his queries.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of the input contains two integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>q</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 200 000</span>, <span class="tex-span">1 ≤ <i>q</i> ≤ 500 000</span>) — the number of the employees of the company and the number of queries the crisis manager has.</p><p>Next <span class="tex-span"><i>q</i></span> lines contain the queries of the crisis manager. Each query looks like <span class="tex-span"><i>type</i> <i>x</i> <i>y</i></span>, where <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/e566753f0340e5050e00bfbdcfeac4c7abd6a7d5.png" style="max-width: 100.0%;max-height: 100.0%;" />. If <span class="tex-span"><i>type</i> = 1</span> or <span class="tex-span"><i>type</i> = 2</span>, then the query represents the decision of a crisis manager about merging departments of the first and second types respectively. If <span class="tex-span"><i>type</i> = 3</span>, then your task is to determine whether employees <span class="tex-span"><i>x</i></span> and <span class="tex-span"><i>y</i></span> work at the same department. Note that <span class="tex-span"><i>x</i></span> can be equal to <span class="tex-span"><i>y</i></span> in the query of any type.</p></div><div class="output-specification"><div class="section-title">Output</div><p>For each question of type <span class="tex-span">3</span> print &quot;<span class="tex-font-style-tt">YES</span>&quot; or &quot;<span class="tex-font-style-tt">NO</span>&quot; (without the quotes), depending on whether the corresponding people work in the same department.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>8 6<br />3 2 5<br />1 2 5<br />3 2 5<br />2 4 7<br />2 1 2<br />3 1 7<br /></pre></div><div class="output"><div class="title">Output</div><pre>NO<br />YES<br />YES<br /></pre></div></div></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=D]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/20331");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="E" data-uuid="ps_8b12ed789effa439b2628e49cb1266d44d3e38c2">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. Restoring Map</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Archaeologists found some information about an ancient land of Treeland. We know for sure that the Treeland consisted of <span class="tex-span"><i>n</i></span> cities connected by the <span class="tex-span"><i>n</i> - 1</span> road, such that you can get from each city to any other one along the roads. However, the information about the specific design of roads in Treeland has been lost. The only thing that the archaeologists can use is the preserved information about <span class="tex-font-style-it">near</span> cities.</p><p>Two cities of Treeland were called <span class="tex-font-style-it">near</span>, if it were possible to move from one city to the other one by moving through at most two roads. Also, a city is considered <span class="tex-font-style-it">near</span> to itself. During the recent excavations archaeologists found a set of <span class="tex-span"><i>n</i></span> notes, each of them represents a list of cities, <span class="tex-font-style-it">near</span> to some of the <span class="tex-span"><i>n</i></span> cities of the country. However, unfortunately, none of the found records lets you understand in what order the cities go in the list and for which city in the list the <span class="tex-font-style-it">near</span> to it cities were listed. </p><p>Help the archaeologists and restore any variant of the map of Treeland that meets the found information.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains integer <span class="tex-span"><i>n</i></span> (<span class="tex-span">2 ≤ <i>n</i> ≤ 1000</span>) — the number of cities in the country. </p><p>Next <span class="tex-span"><i>n</i></span> lines describe the found lists of <span class="tex-font-style-it">near</span> cities. Each list starts from number <span class="tex-span"><i>k</i></span> (<span class="tex-span">1 ≤ <i>k</i> ≤ <i>n</i></span>), representing the number of cities in the list followed by <span class="tex-span"><i>k</i></span> city numbers. All numbers in each list are distinct.</p><p>It is guaranteed that the given information determines at least one possible road map.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print <span class="tex-span"><i>n</i> - 1</span> pairs of numbers representing the roads of the country. The <span class="tex-span"><i>i</i></span>-th line must contain two integers <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i></span>, <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub> ≠ <i>b</i><sub class="lower-index"><i>i</i></sub></span>), showing that there is a road between cities <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span>.</p><p>The answer you print must satisfy the description of close cities from the input. You may print the roads of the countries in any order. The cities that are connected by a road may also be printed in any order.</p><p>If there are multiple good answers, you may print any of them.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>5<br />4 3 2 4 1<br />5 5 3 2 4 1<br />5 4 2 1 5 3<br />4 2 1 4 3<br />3 1 4 5<br /></pre></div><div class="output"><div class="title">Output</div><pre>1 4<br />1 2<br />1 3<br />4 5<br /></pre></div><div class="input"><div class="title">Input</div><pre>6<br />5 6 1 3 4 2<br />5 2 1 3 4 6<br />6 3 6 2 5 4 1<br />6 6 1 2 5 3 4<br />3 5 2 4<br />5 3 1 2 4 6<br /></pre></div><div class="output"><div class="title">Output</div><pre>2 4<br />1 2<br />2 3<br />2 6<br />4 5<br /></pre></div></div></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=E]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/20331");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="F" data-uuid="ps_b868aa66f5e5f27cfcf2e9963c73b694be3384ba">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">F. Clique in the Divisibility Graph</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>As you must know, the maximum clique problem in an arbitrary graph is <span class="tex-span"><i>NP</i></span>-hard. Nevertheless, for some graphs of specific kinds it can be solved effectively.</p><p>Just in case, let us remind you that a clique in a non-directed graph is a subset of the vertices of a graph, such that any two vertices of this subset are connected by an edge. In particular, an empty set of vertexes and a set consisting of a single vertex, are cliques.</p><p>Let's define a divisibility graph for a set of positive integers <span class="tex-span"><i>A</i> = {<i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>n</i></sub>}</span> as follows. The vertices of the given graph are numbers from set <span class="tex-span"><i>A</i></span>, and two numbers <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>a</i><sub class="lower-index"><i>j</i></sub></span> (<span class="tex-span"><i>i</i> ≠ <i>j</i></span>) are connected by an edge if and only if either <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> is divisible by <span class="tex-span"><i>a</i><sub class="lower-index"><i>j</i></sub></span>, or <span class="tex-span"><i>a</i><sub class="lower-index"><i>j</i></sub></span> is divisible by <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>.</p><p>You are given a set of non-negative integers <span class="tex-span"><i>A</i></span>. Determine the size of a maximum clique in a divisibility graph for set <span class="tex-span"><i>A</i></span>.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains integer <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 10<sup class="upper-index">6</sup></span>), that sets the size of set <span class="tex-span"><i>A</i></span>.</p><p>The second line contains <span class="tex-span"><i>n</i></span> distinct positive integers <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>n</i></sub></span> (<span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">6</sup></span>) — elements of subset <span class="tex-span"><i>A</i></span>. The numbers in the line follow in the ascending order.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print a single number — the maximum size of a clique in a divisibility graph for set <span class="tex-span"><i>A</i></span>.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>8<br />3 4 6 8 10 18 21 24<br /></pre></div><div class="output"><div class="title">Output</div><pre>3<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample test a clique of size 3 is, for example, a subset of vertexes <span class="tex-span">{3, 6, 18}</span>. A clique of a larger size doesn't exist in this graph.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=F]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/20331");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 1em;"
        >


<div class="problemindexholder" problemindex="G" data-uuid="ps_a293b48aef4549fdbf1d03e31ff98e2712886485">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">G. Max and Min</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Two kittens, Max and Min, play with a pair of non-negative integers <span class="tex-span"><i>x</i></span> and <span class="tex-span"><i>y</i></span>. As you can guess from their names, kitten Max loves to maximize and kitten Min loves to minimize. As part of this game Min wants to make sure that both numbers, <span class="tex-span"><i>x</i></span> and <span class="tex-span"><i>y</i></span> became negative at the same time, and kitten Max tries to prevent him from doing so.</p><p>Each kitten has a set of pairs of integers available to it. Kitten Max has <span class="tex-span"><i>n</i></span> pairs of non-negative integers <span class="tex-span">(<i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub>)</span> (<span class="tex-span">1 ≤ <i>i</i> ≤ <i>n</i></span>), and kitten Min has <span class="tex-span"><i>m</i></span> pairs of non-negative integers <span class="tex-span">(<i>c</i><sub class="lower-index"><i>j</i></sub>, <i>d</i><sub class="lower-index"><i>j</i></sub>)</span> (<span class="tex-span">1 ≤ <i>j</i> ≤ <i>m</i></span>). As kitten Max makes a move, it can take any available pair <span class="tex-span">(<i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub>)</span> and add <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> to <span class="tex-span"><i>x</i></span> and <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> to <span class="tex-span"><i>y</i></span>, and kitten Min can take any available pair <span class="tex-span">(<i>c</i><sub class="lower-index"><i>j</i></sub>, <i>d</i><sub class="lower-index"><i>j</i></sub>)</span> and subtract <span class="tex-span"><i>c</i><sub class="lower-index"><i>j</i></sub></span> from <span class="tex-span"><i>x</i></span> and <span class="tex-span"><i>d</i><sub class="lower-index"><i>j</i></sub></span> from <span class="tex-span"><i>y</i></span>. Each kitten can use each pair multiple times during distinct moves.</p><p>Max moves first. Kitten Min is winning if at some moment both numbers <span class="tex-span"><i>a</i></span>, <span class="tex-span"><i>b</i></span> are negative <span class="tex-font-style-bf">simultaneously</span>. Otherwise, the winner of the game is kitten Max. Determine which kitten wins if both of them play optimally.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains two integers, <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>m</i></span> (<span class="tex-span">1 ≤ <i>n</i>, <i>m</i> ≤ 100 000</span>) — the number of pairs of numbers available to Max and Min, correspondingly.</p><p>The second line contains two integers <span class="tex-span"><i>x</i></span>, <span class="tex-span"><i>y</i></span> (<span class="tex-span">1 ≤ <i>x</i>, <i>y</i> ≤ 10<sup class="upper-index">9</sup></span>) — the initial values of numbers with which the kittens are playing.</p><p>Next <span class="tex-span"><i>n</i></span> lines contain the pairs of numbers <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>) — the pairs available to Max.</p><p>The last <span class="tex-span"><i>m</i></span> lines contain pairs of numbers <span class="tex-span"><i>c</i><sub class="lower-index"><i>j</i></sub>, <i>d</i><sub class="lower-index"><i>j</i></sub></span> (<span class="tex-span">1 ≤ <i>c</i><sub class="lower-index"><i>j</i></sub>, <i>d</i><sub class="lower-index"><i>j</i></sub> ≤ 10<sup class="upper-index">9</sup></span>) — the pairs available to Min.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print «<span class="tex-font-style-tt">Max</span>» (without the quotes), if kitten Max wins, or &quot;<span class="tex-font-style-tt">Min</span>&quot; (without the quotes), if kitten Min wins.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>2 2<br />42 43<br />2 3<br />3 2<br />3 10<br />10 3<br /></pre></div><div class="output"><div class="title">Output</div><pre>Min<br /></pre></div><div class="input"><div class="title">Input</div><pre>1 1<br />1 1<br />3 4<br />1 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>Max<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first test from the statement Min can respond to move <span class="tex-span">(2, 3)</span> by move <span class="tex-span">(3, 10)</span>, and to move <span class="tex-span">(3, 2)</span> by move <span class="tex-span">(10, 3)</span>. Thus, for each pair of Max and Min's moves the values of both numbers <span class="tex-span"><i>x</i></span> and <span class="tex-span"><i>y</i></span> will strictly decrease, ergo, Min will win sooner or later.</p><p>In the second sample test after each pair of Max and Min's moves both numbers <span class="tex-span"><i>x</i></span> and <span class="tex-span"><i>y</i></span> only increase, thus none of them will become negative.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=G]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/20331");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
    </div>

    <div id="footer">
        <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2024 Mike Mirzayanov</div>
        <div>The only programming contests Web 2.0 platform</div>

    </div>

</div>
</div>
    <script type="application/javascript">
        if ('serviceWorker' in navigator && 'fetch' in window && 'caches' in window) {
            navigator.serviceWorker.register('/service-worker-20331.js')
                .then(function (registration) {
                    console.log('Service worker registered: ', registration);
                })
                .catch(function (error) {
                    console.log('Registration failed: ', error);
                });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8a013da45c337782',t:'MTcyMDQ1Mzk0MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

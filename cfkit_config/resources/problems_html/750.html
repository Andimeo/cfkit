
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-743380-5"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-743380-5');
        </script>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="21cbc99f1b579109120e42137878211c"/>
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01"/>

    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery-1.8.3.js"></script>
    <script type="application/javascript">
        window.locale = "en";
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }

        /* Protection against trailing dot in domain. */
        let hostLength = window.location.host.length;
        if (hostLength > 1 && window.location.host[hostLength - 1] === '.') {
            window.location = window.location.protocol + "//" + window.location.host.substring(0, hostLength - 1);
        }
    </script>

    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="k2">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="//codeforces.org/s/82867/images/codeforces-sponsored-by-ton.png" />
    <link rel="image_src" href="//codeforces.org/s/82867/images/codeforces-sponsored-by-ton.png" />
    <meta property="og:title" content="Problems - Codeforces"/>
    <meta property="og:description" content=""/>
    
    <meta property="og:site_name" content="Codeforces"/>
    
    
    
    
    
    
    <meta name="utc_offset" content="+03:00"/>
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Problems - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community" />
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup" />
    <meta name="robots" content="index, follow" />

    <link rel="stylesheet" href="//codeforces.org/s/82867/css/font-awesome.min.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/line-awesome.min.css" type="text/css" charset="utf-8" />

        <link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>


    <link rel="apple-touch-icon" sizes="57x57" href="//codeforces.org/s/82867/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="//codeforces.org/s/82867/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="//codeforces.org/s/82867/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="//codeforces.org/s/82867/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="//codeforces.org/s/82867/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="//codeforces.org/s/82867/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="//codeforces.org/s/82867/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="//codeforces.org/s/82867/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="//codeforces.org/s/82867/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="//codeforces.org/s/82867/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="//codeforces.org/s/82867/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="//codeforces.org/s/82867/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="//codeforces.org/s/82867/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="//codeforces.org/s/82867/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/prettify.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/clear.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/ttypography.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/problem-statement.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/second-level-menu.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/roundbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/datatable.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/table-form.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/topic.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/jquery.jgrowl.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/facebox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/jquery.wysiwyg.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/jquery.autocomplete.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/codeforces.datepick.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/colorbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/jquery.drafts.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/82867/css/community.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/82867/css/sidebar-menu.css" type="text/css" charset="utf-8" />

    <!-- MathJax -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    MathJax.Hub.Register.StartupHook("End", function () {
        Codeforces.runMathJaxListeners();
    });
    </script>
    <script type="text/javascript" async
            src="https://mathjax.codeforces.org/MathJax.js?config=TeX-AMS_HTML-full"
    >
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="//codeforces.org/s/82867/js/prettify/prettify.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/pushstream.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.easing.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.swipe.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.hotkeys.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/facebox.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/controls/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/controls/wysiwyg.table.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/controls/wysiwyg.image.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/controls/wysiwyg.link.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.datepick.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.drafts.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/clipboard.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/autosize.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/sjcl.js"></script>
    <script type="text/javascript" src="/scripts/aceaa6ea286fe931bca570a1bb55e620/en/codeforces-options.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/codeforces.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/EventCatcher.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/preparedVerdictFormats-en.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/confetti.min.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="//codeforces.org/s/82867/markitup/skins/markitup/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/markitup/sets/markdown/style.css" type="text/css" charset="utf-8" />


    <script type="text/javascript" src="//codeforces.org/s/82867/markitup/jquery.markitup.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/markitup/sets/markdown/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->




</head>
<body class=" "><span style='display:none;' class='csrf-token' data-csrf='21cbc99f1b579109120e42137878211c'>&nbsp;</span>

<!-- .notificationTextCleaner used in Codeforces.showAnnouncements() -->
<div class="notificationTextCleaner" style="font-size: 0"></div>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 3.0rem;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    String.prototype.hashCode = function() {
        var hash = 0, i, chr;
        if (this.length === 0) return hash;
        for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };

    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile === "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>





    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 700
        });
    }, 100);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


    function showAnnouncements(json) {
        //info("j=" + JSON.stringify(json));

        if (json.t != "a") {
            return;
        }

        setTimeout(function() {
            Codeforces.showAnnouncements(json.d, "en");
        }, Math.random() * 500);
    }

    function showEventCatcherUserMessage(json) {
        if (json.t == "s") {
            var points = json.d[5];
            var passedTestCount = json.d[7];
            var judgedTestCount = json.d[8];
            var verdict = preparedVerdictFormats[json.d[12]];
            var verdictPrototypeDiv = $(".verdictPrototypeDiv");
            verdictPrototypeDiv.html(verdict);
            if (judgedTestCount != null && judgedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-judged").text(judgedTestCount);
            }
            if (passedTestCount != null && passedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-passed").text(passedTestCount);
            }
            if (points != null && points != undefined) {
                verdictPrototypeDiv.find(".verdict-format-points").text(points);
            }
            Codeforces.showMessage(verdictPrototypeDiv.text());
        }
    }

    $(".clickable-title").each(function() {
        var title = $(this).attr("data-title");
        if (title) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = title;
            $(this).attr("title", tmp.textContent || tmp.innerText || "");
        }
    });

    $(".clickable-title").click(function() {
        var title = $(this).attr("data-title");
        if (title) {
            Codeforces.alert(title);
        } else {
            Codeforces.alert($(this).attr("title"));
        }
    }).css("position", "relative").css("bottom", "3px");

        Codeforces.showDelayedMessage();

    Codeforces.reformatTimes();

    //Codeforces.initializePubSub();
    if (window.codeforcesOptions.subscribeServerUrl) {
        window.eventCatcher = new EventCatcher(
            window.codeforcesOptions.subscribeServerUrl,
            [
                Codeforces.getGlobalChannel(),
                Codeforces.getUserChannel(),
                Codeforces.getUserShowMessageChannel(),
                Codeforces.getContestChannel(),
                Codeforces.getParticipantChannel(),
                Codeforces.getTalkChannel()
            ]
        );

        if (Codeforces.getParticipantChannel()) {
            window.eventCatcher.subscribe(Codeforces.getParticipantChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getContestChannel()) {
            window.eventCatcher.subscribe(Codeforces.getContestChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getGlobalChannel()) {
            window.eventCatcher.subscribe(Codeforces.getGlobalChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserShowMessageChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserShowMessageChannel(), function(json) {
                showEventCatcherUserMessage(json);
            });
        }
    }

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>


<div id="body">
<div style="width: 950px; margin: 0 auto;" class="compact-problemset">
    <div id="header" style="position: relative; margin: 0;">
        <div style="float:left;">
                  <a href="/"><img height="65" style="height: 65px;" src="//codeforces.org/s/82867/images/codeforces-sponsored-by-ton.png" alt="Codeforces"/></a>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="//codeforces.org/s/82867/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="//codeforces.org/s/82867/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <br style="clear: both;"/>

    <div style="text-align: center; font-size: 1.8rem; margin-bottom: 0.5em;"
         class="caption">Good Bye 2016</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

    <div class="problem-frames">
        <div
                    style="margin-bottom: 2em;"
        >

    <style>
        #facebox .content:has(.diff-popup) {
            width: 90vw;
            max-width: 120rem !important;
        }

        .testCaseMarker {
            position: absolute;
            font-weight: bold;
            font-size: 1rem;
        }

        .diff-popup {
            width: 90vw;
            max-width: 120rem !important;
            display: none;
            overflow: auto;
        }

        .input-output-copier {
            font-size: 1.2rem;
            float: right;
            color: #888 !important;
            cursor: pointer;
            border: 1px solid rgb(185, 185, 185);
            padding: 3px;
            margin: 1px;
            line-height: 1.1rem;
            text-transform: none;
        }

        .input-output-copier:hover {
            background-color: #def;
        }

        .test-explanation textarea {
            width: 100%;
            height: 1.5em;
        }

        .pending-submission-message {
            color: darkorange !important;
        }
    </style>
    <script>
        const OPENING_SPACE = String.fromCharCode(1001);
        const CLOSING_SPACE = String.fromCharCode(1002);

        const nodeToText = function (node, pre) {
            let result = [];

            if (node.tagName === "SCRIPT" || node.tagName === "math"
                || (node.classList && node.classList.contains("input-output-copier")))
                return [];

            if (node.tagName === "NOBR") {
                result.push(OPENING_SPACE);
            }

            if (node.nodeType === Node.TEXT_NODE) {
                let s = node.textContent;
                if (!pre) {
                    s = s.replace(/\s+/g, " ");
                }
                if (s.length > 0) {
                    result.push(s);
                }
            }

            if (pre && node.tagName === "BR") {
                result.push("\n");
            }

            node.childNodes.forEach(function (child) {
                result.push(nodeToText(child, node.tagName === "PRE").join(""));
            });

            if (node.tagName === "DIV"
                || node.tagName === "P"
                || node.tagName === "PRE"
                || node.tagName === "UL"
                || node.tagName === "LI"
            ) {
                result.push("\n");
            }

            if (node.tagName === "NOBR") {
                result.push(CLOSING_SPACE);
            }

            return result;
        }

        const isSpecial = function (c) {
            return c === ',' || c === '.' || c === ';' || c === ')' || c === ' ';
        }

        const convertStatementToText = function(statmentNode) {
            const text = nodeToText(statmentNode, false).join("").replace(/ +/g, " ").replace(/\n\n+/g, "\n\n");
            let result = [];
            for (let i = 0; i < text.length; i++) {
                const c = text.charAt(i);
                if (c === OPENING_SPACE) {
                    if (!((i > 0 && text.charAt(i - 1) === '(') || (result.length > 0 && result[result.length - 1] === ' '))) {
                        result.push('+');
                    }
                } else if (c === CLOSING_SPACE) {
                    if (!(i + 1 < text.length && isSpecial(text.charAt(i + 1)))) {
                        result.push('-');
                    }
                } else {
                    result.push(c);
                }
            }
            return result.join("").split("\n").map(value => value.trim()).join("\n");
        };
    </script>
    <div class="diff-popup">
    </div>

<div class="problemindexholder" problemindex="A" data-uuid="ps_7c9ae3ad5ee28010d9fee6f99ef06a65bd096e91">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A. New Year and Hurry</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Limak is going to participate in a contest on the last day of the 2016. The contest will start at 20:00 and will last four hours, exactly until midnight. There will be <span class="tex-span"><i>n</i></span> problems, sorted by difficulty, i.e. problem <span class="tex-span">1</span> is the easiest and problem <span class="tex-span"><i>n</i></span> is the hardest. Limak knows it will take him <span class="tex-span">5·<i>i</i></span> minutes to solve the <span class="tex-span"><i>i</i></span>-th problem.</p><p>Limak's friends organize a New Year's Eve party and Limak wants to be there at midnight or earlier. He needs <span class="tex-span"><i>k</i></span> minutes to get there from his house, where he will participate in the contest first.</p><p>How many problems can Limak solve if he wants to make it to the party?</p></div><div class="input-specification"><div class="section-title">Input</div><p>The only line of the input contains two integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>k</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 10</span>, <span class="tex-span">1 ≤ <i>k</i> ≤ 240</span>) — the number of the problems in the contest and the number of minutes Limak needs to get to the party from his house.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print one integer, denoting the maximum possible number of problems Limak can solve so that he could get to the party at midnight or earlier.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3 222<br /></pre></div><div class="output"><div class="title">Output</div><pre>2<br /></pre></div><div class="input"><div class="title">Input</div><pre>4 190<br /></pre></div><div class="output"><div class="title">Output</div><pre>4<br /></pre></div><div class="input"><div class="title">Input</div><pre>7 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>7<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample, there are <span class="tex-span">3</span> problems and Limak needs <span class="tex-span">222</span> minutes to get to the party. The three problems require <span class="tex-span">5</span>, <span class="tex-span">10</span> and <span class="tex-span">15</span> minutes respectively. Limak can spend <span class="tex-span">5 + 10 = 15</span> minutes to solve first two problems. Then, at 20:15 he can leave his house to get to the party at 23:57 (after <span class="tex-span">222</span> minutes). In this scenario Limak would solve <span class="tex-span">2</span> problems. He doesn't have enough time to solve <span class="tex-span">3</span> problems so the answer is <span class="tex-span">2</span>.</p><p>In the second sample, Limak can solve all <span class="tex-span">4</span> problems in <span class="tex-span">5 + 10 + 15 + 20 = 50</span> minutes. At 20:50 he will leave the house and go to the party. He will get there exactly at midnight.</p><p>In the third sample, Limak needs only <span class="tex-span">1</span> minute to get to the party. He has enough time to solve all <span class="tex-span">7</span> problems.</p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=A]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/82867");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {
        window.changedTests = new Set();

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");



        String.prototype.replaceAll = function (search, replace) {
            return this.split(search).join(replace);
        };

        $(".sample-test .title").each(function () {
            const preId = ("id" + Math.random()).replaceAll(".", "0");
            const cpyId = ("id" + Math.random()).replaceAll(".", "0");

            $(this).parent().find("pre").attr("id", preId);
            const $copy = $("<div title='Copy' data-clipboard-target='#" + preId + "' id='" + cpyId + "' class='input-output-copier'>Copy</div>");
            $(this).append($copy);

            const clipboard = new Clipboard('#' + cpyId, {
                text: function (trigger) {
                    const pre = document.querySelector('#' + preId);
                    const lines = pre.querySelectorAll(".test-example-line");
                    return Codeforces.filterClipboardText(pre.innerText, lines.length);
                }
            });

            const isInput = $(this).parent().hasClass("input");

            clipboard.on('success', function (e) {
                if (isInput) {
                    Codeforces.showMessage("The example input has been copied into the clipboard");
                } else {
                    Codeforces.showMessage("The example output has been copied into the clipboard");
                }
                e.clearSelection();
            });
        });

        $(".test-form-item input").change(function () {
            addPendingSubmissionMessage($($(this).closest("form")), "You changed the answer, do not forget to submit it if you want to save the changes");
            const index = $(this).closest(".problemindexholder").attr("problemindex");
            let test = "";
            $(this).closest("form input").each(function () {
                const test_ = $(this).attr("name");
                if (test_ && test_.substring(0, 4) === "test") {
                    test = test_;
                }
            });
            if (index.length > 0 && test.length > 0) {
                const indexTest = index + "::" + test;
                window.changedTests.add(indexTest);
            }
        });

        $(window).on('beforeunload', function () {
            if (window.changedTests.size > 0) {
                return 'Dialog text here';
            }
        });

        autosize($('.test-explanation textarea'));

        $(".test-example-line").hover(function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        let top = 1E20;
                        let left = 1E20;
                        let problem = $(this).closest(".problemindexholder");
                        $(this).closest(".input").find("." + clazz).css("background-color", "#FFFDE7").each(function() {
                            top = Math.min(top, $(this).offset().top);
                            left = Math.min(left, $(this).offset().left);
                        });
                        let testCaseMarker = problem.find(".testCaseMarker_" + end);
                        if (testCaseMarker.length === 0) {
                            const html = "<div class=\"testCaseMarker testCaseMarker_" + end + " notice\"></div>";
                            problem.append($(html));
                            testCaseMarker = problem.find(".testCaseMarker_" + end);
                        }
                        if (testCaseMarker) {
                            testCaseMarker.show()
                                    .offset({top, left: left - 20})
                                    .text(end);
                        }
                    }
                }
            });
        }, function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        $("." + clazz).css("background-color", "");
                        $(this).closest(".problemindexholder").find(".testCaseMarker_" + end).hide();
                    }
                }
            });
        });

    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="B" data-uuid="ps_207800391031ff40da813a49d5b28f491e17cad6">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B. New Year and North Pole</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>In this problem we assume the Earth to be a completely round ball and its surface a perfect sphere. The length of the equator and any meridian is considered to be exactly <span class="tex-span">40 000</span> kilometers. Thus, travelling from North Pole to South Pole or vice versa takes exactly <span class="tex-span">20 000</span> kilometers.</p><p>Limak, a polar bear, lives on the North Pole. Close to the New Year, he helps somebody with delivering packages all around the world. Instead of coordinates of places to visit, Limak got a description how he should move, assuming that he starts from the North Pole. The description consists of <span class="tex-span"><i>n</i></span> parts. In the <span class="tex-span"><i>i</i></span>-th part of his journey, Limak should move <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub></span> kilometers in the direction represented by a string <span class="tex-span"><i>dir</i><sub class="lower-index"><i>i</i></sub></span> that is one of: &quot;<span class="tex-font-style-tt">North</span>&quot;, &quot;<span class="tex-font-style-tt">South</span>&quot;, &quot;<span class="tex-font-style-tt">West</span>&quot;, &quot;<span class="tex-font-style-tt">East</span>&quot;.</p><p>Limak isn’t sure whether the description is valid. You must help him to check the following conditions:</p><ul> <li> If at any moment of time (before any of the instructions or while performing one of them) Limak is on the North Pole, he can move only to the South. </li><li> If at any moment of time (before any of the instructions or while performing one of them) Limak is on the South Pole, he can move only to the North. </li><li> The journey must end on the North Pole. </li></ul><p>Check if the above conditions are satisfied and print &quot;<span class="tex-font-style-tt">YES</span>&quot; or &quot;<span class="tex-font-style-tt">NO</span>&quot; on a single line.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of the input contains a single integer <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 50</span>).</p><p>The <span class="tex-span"><i>i</i></span>-th of next <span class="tex-span"><i>n</i></span> lines contains an integer <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub></span> and a string <span class="tex-span"><i>dir</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>t</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">6</sup></span>, <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/cf8071d3b962bd7ac7bb77393d8cb0cc045dddb1.png" style="max-width: 100.0%;max-height: 100.0%;" />) — the length and the direction of the <span class="tex-span"><i>i</i></span>-th part of the journey, according to the description Limak got.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print &quot;<span class="tex-font-style-tt">YES</span>&quot; if the description satisfies the three conditions, otherwise print &quot;<span class="tex-font-style-tt">NO</span>&quot;, both without the quotes.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>5<br />7500 South<br />10000 East<br />3500 North<br />4444 West<br />4000 North<br /></pre></div><div class="output"><div class="title">Output</div><pre>YES<br /></pre></div><div class="input"><div class="title">Input</div><pre>2<br />15000 South<br />4000 East<br /></pre></div><div class="output"><div class="title">Output</div><pre>NO<br /></pre></div><div class="input"><div class="title">Input</div><pre>5<br />20000 South<br />1000 North<br />1000000 West<br />9000 North<br />10000 North<br /></pre></div><div class="output"><div class="title">Output</div><pre>YES<br /></pre></div><div class="input"><div class="title">Input</div><pre>3<br />20000 South<br />10 East<br />20000 North<br /></pre></div><div class="output"><div class="title">Output</div><pre>NO<br /></pre></div><div class="input"><div class="title">Input</div><pre>2<br />1000 North<br />1000 South<br /></pre></div><div class="output"><div class="title">Output</div><pre>NO<br /></pre></div><div class="input"><div class="title">Input</div><pre>4<br />50 South<br />50 North<br />15000 South<br />15000 North<br /></pre></div><div class="output"><div class="title">Output</div><pre>YES<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Drawings below show how Limak's journey would look like in first two samples. In the second sample the answer is &quot;<span class="tex-font-style-tt">NO</span>&quot; because he doesn't end on the North Pole.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/4111b0289682e9ffd50e39250e7a61bc1c9dcde4.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=B]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/82867");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="C" data-uuid="ps_1f732240e8ef6ff5ea0e266d2e925c9ea3f63b97">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C. New Year and Rating</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Every Codeforces user has rating, described with one integer, possibly negative or zero. Users are divided into two divisions. The first division is for users with rating <span class="tex-span">1900</span> or higher. Those with rating <span class="tex-span">1899</span> or lower belong to the second division. In every contest, according to one's performance, his or her rating changes by some value, possibly negative or zero.</p><p>Limak competed in <span class="tex-span"><i>n</i></span> contests in the year 2016. He remembers that in the <span class="tex-span"><i>i</i></span>-th contest he competed in the division <span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub></span> (i.e. he belonged to this division <span class="tex-font-style-bf">just before</span> the start of this contest) and his rating changed by <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-font-style-bf">just after the contest</span>. Note that negative <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> denotes the loss of rating.</p><p>What is the maximum possible rating Limak can have right now, after all <span class="tex-span"><i>n</i></span> contests? If his rating may be arbitrarily big, print &quot;<span class="tex-font-style-tt">Infinity</span>&quot;. If there is no scenario matching the given information, print &quot;<span class="tex-font-style-tt">Impossible</span>&quot;.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of the input contains a single integer <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 200 000</span>).</p><p>The <span class="tex-span"><i>i</i></span>-th of next <span class="tex-span"><i>n</i></span> lines contains two integers <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span"> - 100 ≤ <i>c</i><sub class="lower-index"><i>i</i></sub> ≤ 100</span>, <span class="tex-span">1 ≤ <i>d</i><sub class="lower-index"><i>i</i></sub> ≤ 2</span>), describing Limak's rating change after the <span class="tex-span"><i>i</i></span>-th contest and his division during the <span class="tex-span"><i>i</i></span>-th contest contest.</p></div><div class="output-specification"><div class="section-title">Output</div><p>If Limak's current rating can be arbitrarily big, print &quot;<span class="tex-font-style-tt">Infinity</span>&quot; (without quotes). If the situation is impossible, print &quot;<span class="tex-font-style-tt">Impossible</span>&quot; (without quotes). Otherwise print one integer, denoting the maximum possible value of Limak's current rating, i.e. rating after the <span class="tex-span"><i>n</i></span> contests.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3<br />-7 1<br />5 2<br />8 2<br /></pre></div><div class="output"><div class="title">Output</div><pre>1907<br /></pre></div><div class="input"><div class="title">Input</div><pre>2<br />57 1<br />22 2<br /></pre></div><div class="output"><div class="title">Output</div><pre>Impossible<br /></pre></div><div class="input"><div class="title">Input</div><pre>1<br />-5 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>Infinity<br /></pre></div><div class="input"><div class="title">Input</div><pre>4<br />27 2<br />13 1<br />-50 1<br />8 2<br /></pre></div><div class="output"><div class="title">Output</div><pre>1897<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample, the following scenario matches all information Limak remembers and has maximum possible final rating:</p><ul> <li> Limak has rating <span class="tex-span">1901</span> and belongs to the division <span class="tex-span">1</span> in the first contest. His rating decreases by <span class="tex-span">7</span>. </li><li> With rating <span class="tex-span">1894</span> Limak is in the division <span class="tex-span">2</span>. His rating increases by <span class="tex-span">5</span>. </li><li> Limak has rating <span class="tex-span">1899</span> and is still in the division <span class="tex-span">2</span>. In the last contest of the year he gets <span class="tex-span"> + 8</span> and ends the year with rating <span class="tex-span">1907</span>. </li></ul><p>In the second sample, it's impossible that Limak is in the division <span class="tex-span">1</span>, his rating increases by <span class="tex-span">57</span> and after that Limak is in the division <span class="tex-span">2</span> in the second contest.</p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=C]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/82867");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="D" data-uuid="ps_c86e022936ee0ed4bfa0ed3d4901ca8303be830a">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. New Year and Fireworks</div><div class="time-limit"><div class="property-title">time limit per test</div>2.5 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>One tradition of welcoming the New Year is launching fireworks into the sky. Usually a launched firework flies vertically upward for some period of time, then explodes, splitting into several parts flying in different directions. Sometimes those parts also explode after some period of time, splitting into even more parts, and so on.</p><p>Limak, who lives in an infinite grid, has a single firework. The behaviour of the firework is described with a recursion depth <span class="tex-span"><i>n</i></span> and a duration for each level of recursion <span class="tex-span"><i>t</i><sub class="lower-index">1</sub>, <i>t</i><sub class="lower-index">2</sub>, ..., <i>t</i><sub class="lower-index"><i>n</i></sub></span>. Once Limak launches the firework in some cell, the firework starts moving upward. After covering <span class="tex-span"><i>t</i><sub class="lower-index">1</sub></span> cells (including the starting cell), it explodes and splits into two parts, each moving in the direction changed by <span class="tex-span">45</span> degrees (see the pictures below for clarification). So, one part moves in the top-left direction, while the other one moves in the top-right direction. Each part explodes again after covering <span class="tex-span"><i>t</i><sub class="lower-index">2</sub></span> cells, splitting into two parts moving in directions again changed by <span class="tex-span">45</span> degrees. The process continues till the <span class="tex-span"><i>n</i></span>-th level of recursion, when all <span class="tex-span">2<sup class="upper-index"><i>n</i> - 1</sup></span> existing parts explode and disappear without creating new parts. After a few levels of recursion, it's possible that some parts will be at the same place and at the same time — it is allowed and such parts do not crash.</p><p>Before launching the firework, Limak must make sure that nobody stands in cells which will be visited at least once by the firework. Can you count the number of those cells?</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of the input contains a single integer <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 30</span>) — the total depth of the recursion.</p><p>The second line contains <span class="tex-span"><i>n</i></span> integers <span class="tex-span"><i>t</i><sub class="lower-index">1</sub>, <i>t</i><sub class="lower-index">2</sub>, ..., <i>t</i><sub class="lower-index"><i>n</i></sub></span> (<span class="tex-span">1 ≤ <i>t</i><sub class="lower-index"><i>i</i></sub> ≤ 5</span>). On the <span class="tex-span"><i>i</i></span>-th level each of <span class="tex-span">2<sup class="upper-index"><i>i</i> - 1</sup></span> parts will cover <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub></span> cells before exploding.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print one integer, denoting the number of cells which will be visited at least once by any part of the firework.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>4<br />4 2 2 3<br /></pre></div><div class="output"><div class="title">Output</div><pre>39<br /></pre></div><div class="input"><div class="title">Input</div><pre>6<br />1 1 1 1 1 3<br /></pre></div><div class="output"><div class="title">Output</div><pre>85<br /></pre></div><div class="input"><div class="title">Input</div><pre>1<br />3<br /></pre></div><div class="output"><div class="title">Output</div><pre>3<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>For the first sample, the drawings below show the situation after each level of recursion. Limak launched the firework from the bottom-most red cell. It covered <span class="tex-span"><i>t</i><sub class="lower-index">1</sub> = 4</span> cells (marked red), exploded and divided into two parts (their further movement is marked green). All explosions are marked with an '<span class="tex-font-style-tt">X</span>' character. On the last drawing, there are <span class="tex-span">4</span> red, <span class="tex-span">4</span> green, <span class="tex-span">8</span> orange and <span class="tex-span">23</span> pink cells. So, the total number of visited cells is <span class="tex-span">4 + 4 + 8 + 23 = 39</span>.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/799301453cafb0c28681ee24314b2b9376137a83.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>For the second sample, the drawings below show the situation after levels <span class="tex-span">4</span>, <span class="tex-span">5</span> and <span class="tex-span">6</span>. The middle drawing shows directions of all parts that will move in the next level.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/407567f64deaf74be06c1da955bbd47d4005e03f.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=D]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/82867");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="E" data-uuid="ps_decb2be6d8c39c0b23e369cb258170bfae991033">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. New Year and Old Subsequence</div><div class="time-limit"><div class="property-title">time limit per test</div>3 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>A string <span class="tex-span"><i>t</i></span> is called <span class="tex-font-style-it">nice</span> if a string &quot;<span class="tex-font-style-tt">2017</span>&quot; occurs in <span class="tex-span"><i>t</i></span> as a <span class="tex-font-style-bf">subsequence</span> but a string &quot;<span class="tex-font-style-tt">2016</span>&quot; doesn't occur in <span class="tex-span"><i>t</i></span> as a <span class="tex-font-style-bf">subsequence</span>. For example, strings &quot;<span class="tex-font-style-tt">203434107</span>&quot; and &quot;<span class="tex-font-style-tt">9220617</span>&quot; are nice, while strings &quot;<span class="tex-font-style-tt">20016</span>&quot;, &quot;<span class="tex-font-style-tt">1234</span>&quot; and &quot;<span class="tex-font-style-tt">20167</span>&quot; aren't nice.</p><p>The <span class="tex-font-style-it">ugliness</span> of a string is the minimum possible number of characters to remove, in order to obtain a nice string. If it's impossible to make a string nice by removing characters, its ugliness is <span class="tex-span"> - 1</span>.</p><p>Limak has a string <span class="tex-span"><i>s</i></span> of length <span class="tex-span"><i>n</i></span>, with characters indexed <span class="tex-span">1</span> through <span class="tex-span"><i>n</i></span>. He asks you <span class="tex-span"><i>q</i></span> queries. In the <span class="tex-span"><i>i</i></span>-th query you should compute and print the ugliness of a <span class="tex-font-style-bf">substring</span> (continuous subsequence) of <span class="tex-span"><i>s</i></span> starting at the index <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> and ending at the index <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> (inclusive).</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of the input contains two integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>q</i></span> (<span class="tex-span">4 ≤ <i>n</i> ≤ 200 000</span>, <span class="tex-span">1 ≤ <i>q</i> ≤ 200 000</span>) — the length of the string <span class="tex-span"><i>s</i></span> and the number of queries respectively.</p><p>The second line contains a string <span class="tex-span"><i>s</i></span> of length <span class="tex-span"><i>n</i></span>. Every character is one of digits '<span class="tex-font-style-tt">0</span>'–'<span class="tex-font-style-tt">9</span>'.</p><p>The <span class="tex-span"><i>i</i></span>-th of next <span class="tex-span"><i>q</i></span> lines contains two integers <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> ≤ <i>b</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i></span>), describing a substring in the <span class="tex-span"><i>i</i></span>-th query.</p></div><div class="output-specification"><div class="section-title">Output</div><p>For each query print the ugliness of the given substring.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>8 3<br />20166766<br />1 8<br />1 7<br />2 8<br /></pre></div><div class="output"><div class="title">Output</div><pre>4<br />3<br />-1<br /></pre></div><div class="input"><div class="title">Input</div><pre>15 5<br />012016662091670<br />3 4<br />1 14<br />4 15<br />1 13<br />10 15<br /></pre></div><div class="output"><div class="title">Output</div><pre>-1<br />2<br />1<br />-1<br />-1<br /></pre></div><div class="input"><div class="title">Input</div><pre>4 2<br />1234<br />2 4<br />1 2<br /></pre></div><div class="output"><div class="title">Output</div><pre>-1<br />-1<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample:</p><ul> <li> In the first query, <span class="tex-span"><i>ugliness</i>(</span>&quot;<span class="tex-font-style-tt">20166766</span>&quot;<span class="tex-span">) = 4</span> because all four sixes must be removed. </li><li> In the second query, <span class="tex-span"><i>ugliness</i>(</span>&quot;<span class="tex-font-style-tt">2016676</span>&quot;<span class="tex-span">) = 3</span> because all three sixes must be removed. </li><li> In the third query, <span class="tex-span"><i>ugliness</i>(</span>&quot;<span class="tex-font-style-tt">0166766</span>&quot;<span class="tex-span">) =  - 1</span> because it's impossible to remove some digits to get a nice string. </li></ul><p>In the second sample:</p><ul> <li> In the second query, <span class="tex-span"><i>ugliness</i>(</span>&quot;<span class="tex-font-style-tt">01201666209167</span>&quot;<span class="tex-span">) = 2</span>. It's optimal to remove the first digit '<span class="tex-font-style-tt">2</span>' and the last digit '<span class="tex-font-style-tt">6</span>', what gives a string &quot;<span class="tex-font-style-tt">010166620917</span>&quot;, which is nice. </li><li> In the third query, <span class="tex-span"><i>ugliness</i>(</span>&quot;<span class="tex-font-style-tt">016662091670</span>&quot;<span class="tex-span">) = 1</span>. It's optimal to remove the last digit '<span class="tex-font-style-tt">6</span>', what gives a nice string &quot;<span class="tex-font-style-tt">01666209170</span>&quot;. </li></ul></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=E]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/82867");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="F" data-uuid="ps_d4bbde4735aaaee0541732dcb9a843a8a99ee529">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">F. New Year and Finding Roots</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p><span class="tex-font-style-bf">This is an interactive problem. In the interaction section below you will find the information about flushing the output.</span></p><p>The New Year tree of height <span class="tex-span"><i>h</i></span> is a perfect binary tree with vertices numbered <span class="tex-span">1</span> through <span class="tex-span">2<sup class="upper-index"><i>h</i></sup> - 1</span> in some order. In this problem we assume that <span class="tex-span"><i>h</i></span> is at least <span class="tex-span">2</span>. The drawing below shows one example New Year tree of height <span class="tex-span">3</span>:</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/cf3d6f10e64c6f16261ac7a39a532d09821fc235.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>Polar bears love decorating the New Year tree and Limak is no exception. To decorate the tree, he must first find its root, i.e. a vertex with exactly two neighbours (assuming that <span class="tex-span"><i>h</i> ≥ 2</span>). It won't be easy because Limak is a little bear and he doesn't even see the whole tree. Can you help him?</p><p>There are <span class="tex-span"><i>t</i></span> testcases. In each testcase, you should first read <span class="tex-span"><i>h</i></span> from the input. Then you can ask at most <span class="tex-span">16</span> questions of format &quot;<span class="tex-font-style-tt">? x</span>&quot; (without quotes), where <span class="tex-span"><i>x</i></span> is an integer between <span class="tex-span">1</span> and <span class="tex-span">2<sup class="upper-index"><i>h</i></sup> - 1</span>, inclusive. As a reply you will get the list of neighbours of vertex <span class="tex-span"><i>x</i></span> (more details in the &quot;Interaction&quot; section below). For example, for a tree on the drawing above after asking &quot;<span class="tex-font-style-tt">? 1</span>&quot; you would get a response with <span class="tex-span">3</span> neighbours: <span class="tex-span">4</span>, <span class="tex-span">5</span> and <span class="tex-span">7</span>. Your goal is to find the index of the root <span class="tex-span"><i>y</i></span> and print it in the format &quot;<span class="tex-font-style-tt">! y</span>&quot;. You will be able to read <span class="tex-span"><i>h</i></span> for a next testcase only after printing the answer in a previous testcase and flushing the output.</p><p>Each tree is fixed from the beginning and it doesn't change during your questions.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of the input contains a single integer <span class="tex-span"><i>t</i></span> (<span class="tex-span">1 ≤ <i>t</i> ≤ 500</span>) — the number of testcases.</p><p>At the beginning of each testcase you should read from the input a single integer <span class="tex-span"><i>h</i></span> (<span class="tex-span">2 ≤ <i>h</i> ≤ 7</span>) — the height of the tree. You can't read the value of <span class="tex-span"><i>h</i></span> in a next testcase until you answer a previous testcase.</p></div><div><div class="section-title">Interaction</div><p>To ask a question about neighbours of vertex <span class="tex-span"><i>x</i></span>, print &quot;<span class="tex-font-style-tt">? x</span>&quot; (without quotes) on a separate line. Note, you must print an end-of-line character after the last character of the line and flush your output to get a response.</p><p>The response will consist of two lines. The first line will contain a single integer <span class="tex-span"><i>k</i></span> (<span class="tex-span">1 ≤ <i>k</i> ≤ 3</span>) — the number of neighbours of vertex <span class="tex-span"><i>x</i></span>. The second line will contain <span class="tex-span"><i>k</i></span> distinct integers <span class="tex-span"><i>t</i><sub class="lower-index">1</sub>, ..., <i>t</i><sub class="lower-index"><i>k</i></sub></span> (<span class="tex-span">1 ≤ <i>t</i><sub class="lower-index">1</sub> &lt; ... &lt; <i>t</i><sub class="lower-index"><i>k</i></sub> ≤ 2<sup class="upper-index"><i>h</i></sup> - 1</span>) — indices of neighbours of vertex <span class="tex-span"><i>x</i></span>, gives in the increasing order.</p><p>After asking at most <span class="tex-span">16</span> questions you have to say <span class="tex-span"><i>y</i></span> — the index of the root. Print &quot;<span class="tex-font-style-tt">! y</span>&quot; (without quotes) and an end-of-line character, and flush the output.</p><p>Each tree is fixed from the beginning and it doesn't change during your questions.</p><p>You can get <span class="tex-font-style-tt">Idleness Limit Exceeded</span> if you don't print anything or if you forget to flush the output.</p><p>To flush you can use (just printing a query/answer and end-of-line): </p><ul> <li> <span class="tex-font-style-tt">fflush(stdout)</span> in C++; </li><li> <span class="tex-font-style-tt">System.out.flush()</span> in Java; </li><li> <span class="tex-font-style-tt">stdout.flush()</span> in Python; </li><li> <span class="tex-font-style-tt">flush(output)</span> in Pascal; </li><li> See the documentation for other languages. </li></ul><p>In any moment if the program reads <span class="tex-span"><i>h</i> = 0</span> or <span class="tex-span"><i>k</i> = 0</span> it should immediately terminate normally (for example, calling exit(0)). It means that the system detected incorrect request/output from your program and printed 0 because if can't process your requests anymore. In this case you'll receive verdict &quot;Wrong Answer&quot;, but if you ignore case <span class="tex-span"><i>h</i> = 0</span> or <span class="tex-span"><i>k</i> = 0</span> it could lead to &quot;Runtime Error&quot;, &quot;Time/Memory limit exceeded&quot; or any other verdict because your program could read a trash from the closed input stream.</p><p><span class="tex-font-style-bf">Hacking</span>. To hack someone, use the following format:</p><p>The first line should contain a single integer <span class="tex-span"><i>t</i></span> equal to <span class="tex-span">1</span> (only one testcase is allowed in hacks). The second line should contain a single integer <span class="tex-span"><i>h</i></span>. Each of next <span class="tex-span">2<sup class="upper-index"><i>h</i></sup> - 2</span> lines should contain two distinct integers <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub> ≤ 2<sup class="upper-index"><i>h</i></sup> - 1</span>), denoting two nodes connected with an edge. The printed edges must form a perfect binary tree of height <span class="tex-span"><i>h</i></span>.</p><p>Of course, contestant programs will not be able to see this input.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>1<br />3<br />3<br />4 5 7<br />2<br />1 2<br />1<br />2<br /></pre></div><div class="output"><div class="title">Output</div><pre>? 1<br />? 5<br />? 6<br />! 5<br /></pre></div><div class="input"><div class="title">Input</div><pre>2<br />2<br />1<br />3<br />2<br />1 2<br />2<br />1 2<br />4<br />3<br />3 12 13<br /></pre></div><div class="output"><div class="title">Output</div><pre>? 1<br />? 3<br />? 3<br />! 3<br />? 6<br />! 1<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample, a tree corresponds to the drawing from the statement.</p><p>In the second sample, there are two two testcases. A tree in the first testcase has height <span class="tex-span">2</span> and thus <span class="tex-span">3</span> vertices. A tree in the second testcase has height <span class="tex-span">4</span> and thus <span class="tex-span">15</span> vertices. You can see both trees on the drawing below.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/9db3581501e9c1bf651760cf0a6824c0ac95dc52.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=F]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/82867");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="G" data-uuid="ps_0dbee9d2558723e9871bcd8fe6e469a537e04a89">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">G. New Year and Binary Tree Paths</div><div class="time-limit"><div class="property-title">time limit per test</div>3 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>The New Year tree is an infinite perfect binary tree rooted in the node <span class="tex-span">1</span>. Each node <span class="tex-span"><i>v</i></span> has two children: nodes indexed <span class="tex-span">(2·<i>v</i>)</span> and <span class="tex-span">(2·<i>v</i> + 1)</span>.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/578dae225c172e9b11607044d8dec11bfb27bb3e.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>Polar bears love decorating the New Year tree and Limak is no exception. As he is only a little bear, he was told to decorate only one simple path between some pair of nodes. Though he was given an opportunity to pick the pair himself! Now he wants to know the number of unordered pairs of indices <span class="tex-span">(<i>u</i>, <i>v</i>)</span> (<span class="tex-span"><i>u</i> ≤ <i>v</i></span>), such that the sum of indices of all nodes along the simple path between <span class="tex-span"><i>u</i></span> and <span class="tex-span"><i>v</i></span> (including endpoints) is equal to <span class="tex-span"><i>s</i></span>. Can you help him and count this value?</p></div><div class="input-specification"><div class="section-title">Input</div><p>The only line of the input contains a single integer <span class="tex-span"><i>s</i></span> (<span class="tex-span">1 ≤ <i>s</i> ≤ 10<sup class="upper-index">15</sup></span>).</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print one integer, denoting the number of unordered pairs of nodes indices defining simple paths with the sum of indices of vertices equal to <span class="tex-span"><i>s</i></span>.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>10<br /></pre></div><div class="output"><div class="title">Output</div><pre>4<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In sample test, there are <span class="tex-span">4</span> paths with the sum of indices equal to <span class="tex-span">10</span>:</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/601f96a381f523da43346d21ab772e03fcd0d9c0.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=G]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/82867");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 1em;"
        >


<div class="problemindexholder" problemindex="H" data-uuid="ps_4895f8953d52a473663c1ea46b41be3e91f71220">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">H. New Year and Snowy Grid</div><div class="time-limit"><div class="property-title">time limit per test</div>9 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p><span class="tex-font-style-bf">Pay attention to the output section below, where you will see the information about flushing the output.</span></p><p>Bearland is a grid with <span class="tex-span"><i>h</i></span> rows and <span class="tex-span"><i>w</i></span> columns. Rows are numbered <span class="tex-span">1</span> through <span class="tex-span"><i>h</i></span> from top to bottom. Columns are numbered <span class="tex-span">1</span> through <span class="tex-span"><i>w</i></span> from left to right. Every cell is either allowed (denoted by '<span class="tex-font-style-tt">.</span>' in the input) or permanently blocked (denoted by '<span class="tex-font-style-tt">#</span>').</p><p>Bearland is a cold land, where heavy snow often makes travelling harder. Every day a few allowed cells are <span class="tex-font-style-bf">temporarily</span> blocked by snow. Note, that this block works only on this particular day and next day any of these cells might be allowed again (unless there is another temporarily block).</p><p>It's possible to move directly between two cells only if they share a side and none of them is permanently or temporarily blocked.</p><p>Limak is a little polar bear who lives in Bearland. His house is at the top left cell, while his school is at the bottom right cell. Every day Limak should first go from his house to the school and then return back to his house. Since he gets bored easily, he doesn't want to <span class="tex-font-style-bf">visit the same cell twice</span> on one day, except for the cell with his house, where he starts and ends. If Limak can reach a school and return home avoiding revisiting cells, he calls a day <span class="tex-font-style-it">interesting</span>.</p><p>There are <span class="tex-span"><i>q</i></span> days you must process, one after another. For each of these days you should check if it's interesting and print &quot;<span class="tex-font-style-tt">YES</span>&quot; or &quot;<span class="tex-font-style-tt">NO</span>&quot; on a separate line. In order to be able to read the description of the next day you should print the answer for the previous one and flush the output.</p><p>It's guaranteed that a day with no cells temporarily blocked by snow would be interesting. It's also guaranteed that cells with Limak's house and school are never blocked (neither permanently or temporarily).</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of the input contains three integers <span class="tex-span"><i>h</i></span>, <span class="tex-span"><i>w</i></span> and <span class="tex-span"><i>q</i></span> (<span class="tex-span">2 ≤ <i>h</i>, <i>w</i> ≤ 1000</span>, <span class="tex-span">1 ≤ <i>q</i> ≤ 10 000</span>) — the height and the width of the grid, and the number of days, respectively.</p><p>Next <span class="tex-span"><i>h</i></span> lines describe which cells are allowed and which permanently blocked. The <span class="tex-span"><i>i</i></span>-th line contains a string of length <span class="tex-span"><i>w</i></span>, describing the <span class="tex-span"><i>i</i></span>-th row. Every character is either '<span class="tex-font-style-tt">.</span>' (denoting an allowed cell) or '<span class="tex-font-style-tt">#</span>' (denoting a permanently blocked cell). It's guaranteed that a day with no cells temporarily blocked by snow would be interesting.</p><p>Then, the description of <span class="tex-span"><i>q</i></span> days is given. The description of the <span class="tex-span"><i>i</i></span>-th day starts with a line containing a single integer <span class="tex-span"><i>k</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>k</i><sub class="lower-index"><i>i</i></sub> ≤ 10</span>) — the number of cells that are temporarily blocked by snow on that day. Each of next <span class="tex-span"><i>k</i><sub class="lower-index"><i>i</i></sub></span> lines contains two integers <span class="tex-span"><i>r</i><sub class="lower-index"><i>i</i>, <i>j</i></sub></span> and <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i>, <i>j</i></sub></span> (<span class="tex-span">1 ≤ <i>r</i><sub class="lower-index"><i>i</i>, <i>j</i></sub> ≤ <i>h</i></span>, <span class="tex-span">1 ≤ <i>c</i><sub class="lower-index"><i>i</i>, <i>j</i></sub> ≤ <i>w</i></span>), representing a cell at the intersection of the row <span class="tex-span"><i>r</i><sub class="lower-index"><i>i</i>, <i>j</i></sub></span> and the column <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i>, <i>j</i></sub></span>. The given <span class="tex-span"><i>k</i><sub class="lower-index"><i>i</i></sub></span> cells are distinct and none of them is permanently blocked. Also, none of them contains Limak's house or school.</p></div><div class="output-specification"><div class="section-title">Output</div><p>For each of <span class="tex-span"><i>q</i></span> days print &quot;<span class="tex-font-style-tt">YES</span>&quot; if that day is interesting, and otherwise print &quot;<span class="tex-font-style-tt">NO</span>&quot;, both without the quotes. After printing an answer, you have to both print the end-of-line character and <span class="tex-font-style-tt">flush</span> the output. Then you can proceed to the next day. You can get <span class="tex-font-style-tt">Idleness Limit Exceeded</span> if you don't print anything or if you forget to flush the output.</p><p>To flush you can use (just after printing a <span class="tex-font-style-tt">YES/NO</span> and end-of-line): </p><ul> <li> <span class="tex-font-style-tt">fflush(stdout)</span> in C++; </li><li> <span class="tex-font-style-tt">System.out.flush()</span> in Java; </li><li> <span class="tex-font-style-tt">stdout.flush()</span> in Python; </li><li> <span class="tex-font-style-tt">flush(output)</span> in Pascal; </li><li> See the documentation for other languages. </li></ul></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3 5 4<br />.....<br />.....<br />.#...<br />1<br />1 4<br />1<br />1 5<br />2<br />2 4<br />3 1<br />2<br />1 5<br />3 3<br /></pre></div><div class="output"><div class="title">Output</div><pre>NO<br />YES<br />YES<br />NO<br /></pre></div><div class="input"><div class="title">Input</div><pre>9 31 5<br />...............................<br />...............................<br />.###.###.#.###...###.###.#.###.<br />...#.#.#.#.#.......#.#.#.#...#.<br />.###.#.#.#.###...###.#.#.#...#.<br />.#...#.#.#.#.#...#...#.#.#...#.<br />.###.###.#.###...###.###.#...#.<br />...............................<br />...............................<br />5<br />6 5<br />2 11<br />1 14<br />8 15<br />2 14<br />5<br />2 14<br />1 14<br />8 16<br />6 5<br />2 11<br />3<br />2 2<br />1 4<br />8 30<br />10<br />3 1<br />3 11<br />5 16<br />7 21<br />4 16<br />3 5<br />7 31<br />3 9<br />7 25<br />3 27<br />10<br />3 1<br />3 9<br />7 25<br />3 27<br />7 21<br />4 17<br />3 5<br />7 31<br />4 16<br />3 11<br /></pre></div><div class="output"><div class="title">Output</div><pre>NO<br />YES<br />YES<br />YES<br />NO<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample, there are <span class="tex-span">4</span> days. Drawings below show how Limak could go to school and return to his home in the second and the third day (on the left and on the right respectively). A permanently blocked cell is painted red, while cells temporarily blocked by snow are painted orange. Black and green arrows should Limak's way to the school and back to the house respectively.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/6f942313c829d29dbaed96b832b4f9bcee16d7ae.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>For the second sample, below you can see how the grid looks like on each day, where '<span class="tex-font-style-tt">#</span>' denotes a cell that is blocked, either temporarily or permanently.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/3f1d9cd95c7038ef248adf677e0bb6e91c682e71.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=H]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/82867");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
    </div>

    <div id="footer">
        <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2024 Mike Mirzayanov</div>
        <div>The only programming contests Web 2.0 platform</div>

    </div>

</div>
</div>
    <script type="application/javascript">
        if ('serviceWorker' in navigator && 'fetch' in window && 'caches' in window) {
            navigator.serviceWorker.register('/service-worker-82867.js')
                .then(function (registration) {
                    console.log('Service worker registered: ', registration);
                })
                .catch(function (error) {
                    console.log('Registration failed: ', error);
                });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8a0aa2a96c897784',t:'MTcyMDU1MjQ0OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

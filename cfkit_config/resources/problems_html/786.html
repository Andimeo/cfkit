
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-743380-5"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-743380-5');
        </script>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="aadd2768de54ec88b8c7a0755ae6411e"/>
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01"/>

    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery-1.8.3.js"></script>
    <script type="application/javascript">
        window.locale = "en";
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }

        /* Protection against trailing dot in domain. */
        let hostLength = window.location.host.length;
        if (hostLength > 1 && window.location.host[hostLength - 1] === '.') {
            window.location = window.location.protocol + "//" + window.location.host.substring(0, hostLength - 1);
        }
    </script>

    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="k2">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="//codeforces.org/s/82867/images/codeforces-sponsored-by-ton.png" />
    <link rel="image_src" href="//codeforces.org/s/82867/images/codeforces-sponsored-by-ton.png" />
    <meta property="og:title" content="Problems - Codeforces"/>
    <meta property="og:description" content=""/>
    
    <meta property="og:site_name" content="Codeforces"/>
    
    
    
    
    
    
    <meta name="utc_offset" content="+03:00"/>
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Problems - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community" />
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup" />
    <meta name="robots" content="index, follow" />

    <link rel="stylesheet" href="//codeforces.org/s/82867/css/font-awesome.min.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/line-awesome.min.css" type="text/css" charset="utf-8" />

        <link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>


    <link rel="apple-touch-icon" sizes="57x57" href="//codeforces.org/s/82867/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="//codeforces.org/s/82867/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="//codeforces.org/s/82867/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="//codeforces.org/s/82867/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="//codeforces.org/s/82867/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="//codeforces.org/s/82867/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="//codeforces.org/s/82867/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="//codeforces.org/s/82867/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="//codeforces.org/s/82867/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="//codeforces.org/s/82867/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="//codeforces.org/s/82867/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="//codeforces.org/s/82867/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="//codeforces.org/s/82867/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="//codeforces.org/s/82867/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/prettify.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/clear.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/ttypography.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/problem-statement.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/second-level-menu.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/roundbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/datatable.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/table-form.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/topic.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/jquery.jgrowl.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/facebox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/jquery.wysiwyg.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/jquery.autocomplete.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/codeforces.datepick.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/colorbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/css/jquery.drafts.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/82867/css/community.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/82867/css/sidebar-menu.css" type="text/css" charset="utf-8" />

    <!-- MathJax -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    MathJax.Hub.Register.StartupHook("End", function () {
        Codeforces.runMathJaxListeners();
    });
    </script>
    <script type="text/javascript" async
            src="https://mathjax.codeforces.org/MathJax.js?config=TeX-AMS_HTML-full"
    >
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="//codeforces.org/s/82867/js/prettify/prettify.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/pushstream.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.easing.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.swipe.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.hotkeys.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/facebox.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/controls/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/controls/wysiwyg.table.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/controls/wysiwyg.image.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/controls/wysiwyg.link.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.datepick.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/jquery.drafts.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/clipboard.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/autosize.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/sjcl.js"></script>
    <script type="text/javascript" src="/scripts/aceaa6ea286fe931bca570a1bb55e620/en/codeforces-options.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/codeforces.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/EventCatcher.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/preparedVerdictFormats-en.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/js/confetti.min.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="//codeforces.org/s/82867/markitup/skins/markitup/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/82867/markitup/sets/markdown/style.css" type="text/css" charset="utf-8" />


    <script type="text/javascript" src="//codeforces.org/s/82867/markitup/jquery.markitup.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/82867/markitup/sets/markdown/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->




</head>
<body class=" "><span style='display:none;' class='csrf-token' data-csrf='aadd2768de54ec88b8c7a0755ae6411e'>&nbsp;</span>

<!-- .notificationTextCleaner used in Codeforces.showAnnouncements() -->
<div class="notificationTextCleaner" style="font-size: 0"></div>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 3.0rem;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    String.prototype.hashCode = function() {
        var hash = 0, i, chr;
        if (this.length === 0) return hash;
        for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };

    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile === "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>





    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 700
        });
    }, 100);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


    function showAnnouncements(json) {
        //info("j=" + JSON.stringify(json));

        if (json.t != "a") {
            return;
        }

        setTimeout(function() {
            Codeforces.showAnnouncements(json.d, "en");
        }, Math.random() * 500);
    }

    function showEventCatcherUserMessage(json) {
        if (json.t == "s") {
            var points = json.d[5];
            var passedTestCount = json.d[7];
            var judgedTestCount = json.d[8];
            var verdict = preparedVerdictFormats[json.d[12]];
            var verdictPrototypeDiv = $(".verdictPrototypeDiv");
            verdictPrototypeDiv.html(verdict);
            if (judgedTestCount != null && judgedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-judged").text(judgedTestCount);
            }
            if (passedTestCount != null && passedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-passed").text(passedTestCount);
            }
            if (points != null && points != undefined) {
                verdictPrototypeDiv.find(".verdict-format-points").text(points);
            }
            Codeforces.showMessage(verdictPrototypeDiv.text());
        }
    }

    $(".clickable-title").each(function() {
        var title = $(this).attr("data-title");
        if (title) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = title;
            $(this).attr("title", tmp.textContent || tmp.innerText || "");
        }
    });

    $(".clickable-title").click(function() {
        var title = $(this).attr("data-title");
        if (title) {
            Codeforces.alert(title);
        } else {
            Codeforces.alert($(this).attr("title"));
        }
    }).css("position", "relative").css("bottom", "3px");

        Codeforces.showDelayedMessage();

    Codeforces.reformatTimes();

    //Codeforces.initializePubSub();
    if (window.codeforcesOptions.subscribeServerUrl) {
        window.eventCatcher = new EventCatcher(
            window.codeforcesOptions.subscribeServerUrl,
            [
                Codeforces.getGlobalChannel(),
                Codeforces.getUserChannel(),
                Codeforces.getUserShowMessageChannel(),
                Codeforces.getContestChannel(),
                Codeforces.getParticipantChannel(),
                Codeforces.getTalkChannel()
            ]
        );

        if (Codeforces.getParticipantChannel()) {
            window.eventCatcher.subscribe(Codeforces.getParticipantChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getContestChannel()) {
            window.eventCatcher.subscribe(Codeforces.getContestChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getGlobalChannel()) {
            window.eventCatcher.subscribe(Codeforces.getGlobalChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserShowMessageChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserShowMessageChannel(), function(json) {
                showEventCatcherUserMessage(json);
            });
        }
    }

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>


<div id="body">
<div style="width: 950px; margin: 0 auto;" class="compact-problemset">
    <div id="header" style="position: relative; margin: 0;">
        <div style="float:left;">
                  <a href="/"><img height="65" style="height: 65px;" src="//codeforces.org/s/82867/images/codeforces-sponsored-by-ton.png" alt="Codeforces"/></a>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="//codeforces.org/s/82867/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="//codeforces.org/s/82867/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <br style="clear: both;"/>

    <div style="text-align: center; font-size: 1.8rem; margin-bottom: 0.5em;"
         class="caption">Codeforces Round 406 (Div. 1)</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

    <div class="problem-frames">
        <div
                    style="margin-bottom: 2em;"
        >

    <style>
        #facebox .content:has(.diff-popup) {
            width: 90vw;
            max-width: 120rem !important;
        }

        .testCaseMarker {
            position: absolute;
            font-weight: bold;
            font-size: 1rem;
        }

        .diff-popup {
            width: 90vw;
            max-width: 120rem !important;
            display: none;
            overflow: auto;
        }

        .input-output-copier {
            font-size: 1.2rem;
            float: right;
            color: #888 !important;
            cursor: pointer;
            border: 1px solid rgb(185, 185, 185);
            padding: 3px;
            margin: 1px;
            line-height: 1.1rem;
            text-transform: none;
        }

        .input-output-copier:hover {
            background-color: #def;
        }

        .test-explanation textarea {
            width: 100%;
            height: 1.5em;
        }

        .pending-submission-message {
            color: darkorange !important;
        }
    </style>
    <script>
        const OPENING_SPACE = String.fromCharCode(1001);
        const CLOSING_SPACE = String.fromCharCode(1002);

        const nodeToText = function (node, pre) {
            let result = [];

            if (node.tagName === "SCRIPT" || node.tagName === "math"
                || (node.classList && node.classList.contains("input-output-copier")))
                return [];

            if (node.tagName === "NOBR") {
                result.push(OPENING_SPACE);
            }

            if (node.nodeType === Node.TEXT_NODE) {
                let s = node.textContent;
                if (!pre) {
                    s = s.replace(/\s+/g, " ");
                }
                if (s.length > 0) {
                    result.push(s);
                }
            }

            if (pre && node.tagName === "BR") {
                result.push("\n");
            }

            node.childNodes.forEach(function (child) {
                result.push(nodeToText(child, node.tagName === "PRE").join(""));
            });

            if (node.tagName === "DIV"
                || node.tagName === "P"
                || node.tagName === "PRE"
                || node.tagName === "UL"
                || node.tagName === "LI"
            ) {
                result.push("\n");
            }

            if (node.tagName === "NOBR") {
                result.push(CLOSING_SPACE);
            }

            return result;
        }

        const isSpecial = function (c) {
            return c === ',' || c === '.' || c === ';' || c === ')' || c === ' ';
        }

        const convertStatementToText = function(statmentNode) {
            const text = nodeToText(statmentNode, false).join("").replace(/ +/g, " ").replace(/\n\n+/g, "\n\n");
            let result = [];
            for (let i = 0; i < text.length; i++) {
                const c = text.charAt(i);
                if (c === OPENING_SPACE) {
                    if (!((i > 0 && text.charAt(i - 1) === '(') || (result.length > 0 && result[result.length - 1] === ' '))) {
                        result.push('+');
                    }
                } else if (c === CLOSING_SPACE) {
                    if (!(i + 1 < text.length && isSpecial(text.charAt(i + 1)))) {
                        result.push('-');
                    }
                } else {
                    result.push(c);
                }
            }
            return result.join("").split("\n").map(value => value.trim()).join("\n");
        };
    </script>
    <div class="diff-popup">
    </div>

<div class="problemindexholder" problemindex="A" data-uuid="ps_ee70df61af9d2e2f5ca641d14cd81bc08b9595f0">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A. Berzerk</div><div class="time-limit"><div class="property-title">time limit per test</div>4 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Rick and Morty are playing their own version of Berzerk (which has nothing in common with the famous Berzerk game). This game needs a huge space, so they play it with a computer.</p><p>In this game there are <span class="tex-span"><i>n</i></span> objects numbered from <span class="tex-span">1</span> to <span class="tex-span"><i>n</i></span> arranged in a circle (in clockwise order). Object number <span class="tex-span">1</span> is a black hole and the others are planets. There's a monster in one of the planet. Rick and Morty don't know on which one yet, only that he's not initially in the black hole, but Unity will inform them before the game starts. But for now, they want to be prepared for every possible scenario.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/5223c66459688e507de83718a3822a5087713359.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>Each one of them has a set of numbers between <span class="tex-span">1</span> and <span class="tex-span"><i>n</i> - 1</span> (inclusive). Rick's set is <span class="tex-span"><i>s</i><sub class="lower-index">1</sub></span> with <span class="tex-span"><i>k</i><sub class="lower-index">1</sub></span> elements and Morty's is <span class="tex-span"><i>s</i><sub class="lower-index">2</sub></span> with <span class="tex-span"><i>k</i><sub class="lower-index">2</sub></span> elements. One of them goes first and the player changes alternatively. In each player's turn, he should choose an arbitrary number like <span class="tex-span"><i>x</i></span> from his set and the monster will move to his <span class="tex-span"><i>x</i></span>-th next object from its current position (clockwise). If after his move the monster gets to the black hole he wins.</p><p>Your task is that for each of monster's initial positions and who plays first determine if the starter wins, loses, or the game will stuck in an infinite loop. In case when player can lose or make game infinity, it more profitable to choose infinity game.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of input contains a single integer <span class="tex-span"><i>n</i></span> (<span class="tex-span">2 ≤ <i>n</i> ≤ 7000</span>) — number of objects in game.</p><p>The second line contains integer <span class="tex-span"><i>k</i><sub class="lower-index">1</sub></span> followed by <span class="tex-span"><i>k</i><sub class="lower-index">1</sub></span> distinct integers <span class="tex-span"><i>s</i><sub class="lower-index">1, 1</sub>, <i>s</i><sub class="lower-index">1, 2</sub>, ..., <i>s</i><sub class="lower-index">1, <i>k</i><sub class="lower-index">1</sub></sub></span> — Rick's set.</p><p>The third line contains integer <span class="tex-span"><i>k</i><sub class="lower-index">2</sub></span> followed by <span class="tex-span"><i>k</i><sub class="lower-index">2</sub></span> distinct integers <span class="tex-span"><i>s</i><sub class="lower-index">2, 1</sub>, <i>s</i><sub class="lower-index">2, 2</sub>, ..., <i>s</i><sub class="lower-index">2, <i>k</i><sub class="lower-index">2</sub></sub></span> — Morty's set</p><p><span class="tex-span">1 ≤ <i>k</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i> - 1</span> and <span class="tex-span">1 ≤ <i>s</i><sub class="lower-index"><i>i</i>, 1</sub>, <i>s</i><sub class="lower-index"><i>i</i>, 2</sub>, ..., <i>s</i><sub class="lower-index"><i>i</i>, <i>k</i><sub class="lower-index"><i>i</i></sub></sub> ≤ <i>n</i> - 1</span> for <span class="tex-span">1 ≤ <i>i</i> ≤ 2</span>.</p></div><div class="output-specification"><div class="section-title">Output</div><p>In the first line print <span class="tex-span"><i>n</i> - 1</span> words separated by spaces where <span class="tex-span"><i>i</i></span>-th word is &quot;<span class="tex-font-style-tt">Win</span>&quot; (without quotations) if in the scenario that Rick plays first and monster is initially in object number <span class="tex-span"><i>i</i> + 1</span> he wins, &quot;<span class="tex-font-style-tt">Lose</span>&quot; if he loses and &quot;<span class="tex-font-style-tt">Loop</span>&quot; if the game will never end.</p><p>Similarly, in the second line print <span class="tex-span"><i>n</i> - 1</span> words separated by spaces where <span class="tex-span"><i>i</i></span>-th word is &quot;<span class="tex-font-style-tt">Win</span>&quot; (without quotations) if in the scenario that Morty plays first and monster is initially in object number <span class="tex-span"><i>i</i> + 1</span> he wins, &quot;<span class="tex-font-style-tt">Lose</span>&quot; if he loses and &quot;<span class="tex-font-style-tt">Loop</span>&quot; if the game will never end.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>5<br />2 3 2<br />3 1 2 3<br /></pre></div><div class="output"><div class="title">Output</div><pre>Lose Win Win Loop<br />Loop Win Win Win<br /></pre></div><div class="input"><div class="title">Input</div><pre>8<br />4 6 2 3 4<br />2 3 6<br /></pre></div><div class="output"><div class="title">Output</div><pre>Win Win Win Win Win Win Win<br />Lose Win Lose Lose Win Lose Lose<br /></pre></div></div></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=A]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/82867");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {
        window.changedTests = new Set();

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");



        String.prototype.replaceAll = function (search, replace) {
            return this.split(search).join(replace);
        };

        $(".sample-test .title").each(function () {
            const preId = ("id" + Math.random()).replaceAll(".", "0");
            const cpyId = ("id" + Math.random()).replaceAll(".", "0");

            $(this).parent().find("pre").attr("id", preId);
            const $copy = $("<div title='Copy' data-clipboard-target='#" + preId + "' id='" + cpyId + "' class='input-output-copier'>Copy</div>");
            $(this).append($copy);

            const clipboard = new Clipboard('#' + cpyId, {
                text: function (trigger) {
                    const pre = document.querySelector('#' + preId);
                    const lines = pre.querySelectorAll(".test-example-line");
                    return Codeforces.filterClipboardText(pre.innerText, lines.length);
                }
            });

            const isInput = $(this).parent().hasClass("input");

            clipboard.on('success', function (e) {
                if (isInput) {
                    Codeforces.showMessage("The example input has been copied into the clipboard");
                } else {
                    Codeforces.showMessage("The example output has been copied into the clipboard");
                }
                e.clearSelection();
            });
        });

        $(".test-form-item input").change(function () {
            addPendingSubmissionMessage($($(this).closest("form")), "You changed the answer, do not forget to submit it if you want to save the changes");
            const index = $(this).closest(".problemindexholder").attr("problemindex");
            let test = "";
            $(this).closest("form input").each(function () {
                const test_ = $(this).attr("name");
                if (test_ && test_.substring(0, 4) === "test") {
                    test = test_;
                }
            });
            if (index.length > 0 && test.length > 0) {
                const indexTest = index + "::" + test;
                window.changedTests.add(indexTest);
            }
        });

        $(window).on('beforeunload', function () {
            if (window.changedTests.size > 0) {
                return 'Dialog text here';
            }
        });

        autosize($('.test-explanation textarea'));

        $(".test-example-line").hover(function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        let top = 1E20;
                        let left = 1E20;
                        let problem = $(this).closest(".problemindexholder");
                        $(this).closest(".input").find("." + clazz).css("background-color", "#FFFDE7").each(function() {
                            top = Math.min(top, $(this).offset().top);
                            left = Math.min(left, $(this).offset().left);
                        });
                        let testCaseMarker = problem.find(".testCaseMarker_" + end);
                        if (testCaseMarker.length === 0) {
                            const html = "<div class=\"testCaseMarker testCaseMarker_" + end + " notice\"></div>";
                            problem.append($(html));
                            testCaseMarker = problem.find(".testCaseMarker_" + end);
                        }
                        if (testCaseMarker) {
                            testCaseMarker.show()
                                    .offset({top, left: left - 20})
                                    .text(end);
                        }
                    }
                }
            });
        }, function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        $("." + clazz).css("background-color", "");
                        $(this).closest(".problemindexholder").find(".testCaseMarker_" + end).hide();
                    }
                }
            });
        });

    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="B" data-uuid="ps_18d8546a9ce0249f4a062dde2b69c8d17ca9f3d9">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B. Legacy</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Rick and his co-workers have made a new radioactive formula and a lot of bad guys are after them. So Rick wants to give his legacy to Morty before bad guys catch them. </p><p>There are <span class="tex-span"><i>n</i></span> planets in their universe numbered from <span class="tex-span">1</span> to <span class="tex-span"><i>n</i></span>. Rick is in planet number <span class="tex-span"><i>s</i></span> (the earth) and he doesn't know where Morty is. As we all know, Rick owns a portal gun. With this gun he can open one-way portal from a planet he is in to any other planet (including that planet). But there are limits on this gun because he's still using its free trial.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/3e33a87e8ba090af9cf4c5a8e27cb131ebefa1c7.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>By default he can not open any portal by this gun. There are <span class="tex-span"><i>q</i></span> plans in the website that sells these guns. Every time you purchase a plan you can only use it once but you can purchase it again if you want to use it more.</p><p>Plans on the website have three types:</p><ol> <li> With a plan of this type you can open a portal from planet <span class="tex-span"><i>v</i></span> to planet <span class="tex-span"><i>u</i></span>. </li><li> With a plan of this type you can open a portal from planet <span class="tex-span"><i>v</i></span> to any planet with index in range <span class="tex-span">[<i>l</i>, <i>r</i>]</span>. </li><li> With a plan of this type you can open a portal from any planet with index in range <span class="tex-span">[<i>l</i>, <i>r</i>]</span> to planet <span class="tex-span"><i>v</i></span>. </li></ol><p>Rick doesn't known where Morty is, but Unity is going to inform him and he wants to be prepared for when he finds and start his journey immediately. So for each planet (including earth itself) he wants to know the minimum amount of money he needs to get from earth to that planet.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of input contains three integers <span class="tex-span"><i>n</i></span>, <span class="tex-span"><i>q</i></span> and <span class="tex-span"><i>s</i></span> (<span class="tex-span">1 ≤ <i>n</i>, <i>q</i> ≤ 10<sup class="upper-index">5</sup></span>, <span class="tex-span">1 ≤ <i>s</i> ≤ <i>n</i></span>) — number of planets, number of plans and index of earth respectively.</p><p>The next <span class="tex-span"><i>q</i></span> lines contain the plans. Each line starts with a number <span class="tex-span"><i>t</i></span>, type of that plan (<span class="tex-span">1 ≤ <i>t</i> ≤ 3</span>). If <span class="tex-span"><i>t</i> = 1</span> then it is followed by three integers <span class="tex-span"><i>v</i></span>, <span class="tex-span"><i>u</i></span> and <span class="tex-span"><i>w</i></span> where <span class="tex-span"><i>w</i></span> is the cost of that plan (<span class="tex-span">1 ≤ <i>v</i>, <i>u</i> ≤ <i>n</i></span>, <span class="tex-span">1 ≤ <i>w</i> ≤ 10<sup class="upper-index">9</sup></span>). Otherwise it is followed by four integers <span class="tex-span"><i>v</i></span>, <span class="tex-span"><i>l</i></span>, <span class="tex-span"><i>r</i></span> and <span class="tex-span"><i>w</i></span> where <span class="tex-span"><i>w</i></span> is the cost of that plan (<span class="tex-span">1 ≤ <i>v</i> ≤ <i>n</i></span>, <span class="tex-span">1 ≤ <i>l</i> ≤ <i>r</i> ≤ <i>n</i></span>, <span class="tex-span">1 ≤ <i>w</i> ≤ 10<sup class="upper-index">9</sup></span>).</p></div><div class="output-specification"><div class="section-title">Output</div><p>In the first and only line of output print <span class="tex-span"><i>n</i></span> integers separated by spaces. <span class="tex-span"><i>i</i></span>-th of them should be minimum money to get from earth to <span class="tex-span"><i>i</i></span>-th planet, or <span class="tex-span"> - 1</span> if it's impossible to get to that planet.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3 5 1<br />2 3 2 3 17<br />2 3 2 2 16<br />2 2 2 3 3<br />3 3 1 1 12<br />1 3 3 17<br /></pre></div><div class="output"><div class="title">Output</div><pre>0 28 12 <br /></pre></div><div class="input"><div class="title">Input</div><pre>4 3 1<br />3 4 1 3 12<br />2 2 3 4 10<br />1 2 4 16<br /></pre></div><div class="output"><div class="title">Output</div><pre>0 -1 -1 12 <br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample testcase, Rick can purchase <span class="tex-span">4</span>th plan once and then <span class="tex-span">2</span>nd plan in order to get to get to planet number <span class="tex-span">2</span>.</p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=B]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/82867");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="C" data-uuid="ps_71dd7fbf5afa1f72f458a511bd0e8b793400049b">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C. Till I Collapse</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Rick and Morty want to find MR. PBH and they can't do it alone. So they need of Mr. Meeseeks. They Have generated <span class="tex-span"><i>n</i></span> Mr. Meeseeks, standing in a line numbered from <span class="tex-span">1</span> to <span class="tex-span"><i>n</i></span>. Each of them has his own color. <span class="tex-span"><i>i</i></span>-th Mr. Meeseeks' color is <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>. </p><p>Rick and Morty are gathering their army and they want to divide Mr. Meeseeks into some squads. They don't want their squads to be too colorful, so each squad should have Mr. Meeseeks of at most <span class="tex-span"><i>k</i></span> different colors. Also each squad should be a continuous subarray of Mr. Meeseeks in the line. Meaning that for each <span class="tex-span">1 ≤ <i>i</i> ≤ <i>e</i> ≤ <i>j</i> ≤ <i>n</i></span>, if Mr. Meeseeks number <span class="tex-span"><i>i</i></span> and Mr. Meeseeks number <span class="tex-span"><i>j</i></span> are in the same squad then Mr. Meeseeks number <span class="tex-span"><i>e</i></span> should be in that same squad.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/29768635332701edee5966c3719c3792b3462ba3.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>Also, each squad needs its own presidio, and building a presidio needs money, so they want the total number of squads to be minimized.</p><p>Rick and Morty haven't finalized the exact value of <span class="tex-span"><i>k</i></span>, so in order to choose it, for each <span class="tex-span"><i>k</i></span> between <span class="tex-span">1</span> and <span class="tex-span"><i>n</i></span> (inclusive) need to know the minimum number of presidios needed.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of input contains a single integer <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup></span>) — number of Mr. Meeseeks.</p><p>The second line contains <span class="tex-span"><i>n</i></span> integers <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>n</i></sub></span> separated by spaces (<span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i></span>) — colors of Mr. Meeseeks in order they standing in a line.</p></div><div class="output-specification"><div class="section-title">Output</div><p>In the first and only line of input print <span class="tex-span"><i>n</i></span> integers separated by spaces. <span class="tex-span"><i>i</i></span>-th integer should be the minimum number of presidios needed if the value of <span class="tex-span"><i>k</i></span> is <span class="tex-span"><i>i</i></span>.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>5<br />1 3 4 3 3<br /></pre></div><div class="output"><div class="title">Output</div><pre>4 2 1 1 1 <br /></pre></div><div class="input"><div class="title">Input</div><pre>8<br />1 5 7 8 1 7 6 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>8 4 3 2 1 1 1 1 <br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>For the first sample testcase, some optimal ways of dividing army into squads for each <span class="tex-span"><i>k</i></span> are:</p><ol> <li> <span class="tex-span">[1], [3], [4], [3, 3]</span> </li><li> <span class="tex-span">[1], [3, 4, 3, 3]</span> </li><li> <span class="tex-span">[1, 3, 4, 3, 3]</span> </li><li> <span class="tex-span">[1, 3, 4, 3, 3]</span> </li><li> <span class="tex-span">[1, 3, 4, 3, 3]</span> </li></ol><p>For the second testcase, some optimal ways of dividing army into squads for each <span class="tex-span"><i>k</i></span> are:</p><ol> <li> <span class="tex-span">[1], [5], [7], [8], [1], [7], [6], [1]</span> </li><li> <span class="tex-span">[1, 5], [7, 8], [1, 7], [6, 1]</span> </li><li> <span class="tex-span">[1, 5, 7], [8], [1, 7, 6, 1]</span> </li><li> <span class="tex-span">[1, 5, 7, 8], [1, 7, 6, 1]</span> </li><li> <span class="tex-span">[1, 5, 7, 8, 1, 7, 6, 1]</span> </li><li> <span class="tex-span">[1, 5, 7, 8, 1, 7, 6, 1]</span> </li><li> <span class="tex-span">[1, 5, 7, 8, 1, 7, 6, 1]</span> </li><li> <span class="tex-span">[1, 5, 7, 8, 1, 7, 6, 1]</span> </li></ol></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=C]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/82867");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="D" data-uuid="ps_665719e016d54d7abec9137ff2dacd970ef08316">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. Rap God</div><div class="time-limit"><div class="property-title">time limit per test</div>7 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Rick is in love with Unity. But Mr. Meeseeks also love Unity, so Rick and Mr. Meeseeks are &quot;love rivals&quot;. </p><p>Unity loves rap, so it decided that they have to compete in a rap game (battle) in order to choose the best. Rick is too nerds, so instead he's gonna make his verse with running his original algorithm on lyrics &quot;Rap God&quot; song.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/a94566b49fa931c549f7d7c15b578ba5316c888d.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>His algorithm is a little bit complicated. He's made a tree with <span class="tex-span"><i>n</i></span> vertices numbered from <span class="tex-span">1</span> to <span class="tex-span"><i>n</i></span> and there's a lowercase english letter written on each edge. He denotes <span class="tex-span"><i>str</i>(<i>a</i>, <i>b</i>)</span> to be the string made by writing characters on edges on the shortest path from <span class="tex-span"><i>a</i></span> to <span class="tex-span"><i>b</i></span> one by one (a string of length equal to distance of <span class="tex-span"><i>a</i></span> to <span class="tex-span"><i>b</i></span>). Note that <span class="tex-span"><i>str</i>(<i>a</i>, <i>b</i>)</span> is reverse of <span class="tex-span"><i>str</i>(<i>b</i>, <i>a</i>)</span> and <span class="tex-span"><i>str</i>(<i>a</i>, <i>a</i>)</span> is empty.</p><p> In order to make the best verse he can, he needs to answer some queries, but he's not a computer scientist and is not able to answer those queries, so he asked you to help him. Each query is characterized by two vertices <span class="tex-span"><i>x</i></span> and <span class="tex-span"><i>y</i></span> (<span class="tex-span"><i>x</i> ≠ <i>y</i></span>). Answer to this query is the number of vertices like <span class="tex-span"><i>z</i></span> such that <span class="tex-span"><i>z</i> ≠ <i>x</i>, <i>z</i> ≠ <i>y</i></span> and <span class="tex-span"><i>str</i>(<i>x</i>, <i>y</i>)</span> is lexicographically larger than <span class="tex-span"><i>str</i>(<i>x</i>, <i>z</i>)</span>.</p><p>String <span class="tex-span"><i>x</i>  =  <i>x</i><sub class="lower-index">1</sub><i>x</i><sub class="lower-index">2</sub>...<i>x</i><sub class="lower-index">|<i>x</i>|</sub></span> is lexicographically larger than string <span class="tex-span"><i>y</i>  =  <i>y</i><sub class="lower-index">1</sub><i>y</i><sub class="lower-index">2</sub>...<i>y</i><sub class="lower-index">|<i>y</i>|</sub></span>, if either <span class="tex-span">|<i>x</i>|  &gt;  |<i>y</i>|</span> and <span class="tex-span"><i>x</i><sub class="lower-index">1</sub>  =  <i>y</i><sub class="lower-index">1</sub>,  <i>x</i><sub class="lower-index">2</sub>  =  <i>y</i><sub class="lower-index">2</sub>,  ...,  <i>x</i><sub class="lower-index">|<i>y</i>|</sub>  =  <i>y</i><sub class="lower-index">|<i>y</i>|</sub></span>, or exists such number <span class="tex-span"><i>r</i> (<i>r</i>  &lt;  |<i>x</i>|,  <i>r</i>  &lt;  |<i>y</i>|)</span>, that <span class="tex-span"><i>x</i><sub class="lower-index">1</sub>  =  <i>y</i><sub class="lower-index">1</sub>,  <i>x</i><sub class="lower-index">2</sub>  =  <i>y</i><sub class="lower-index">2</sub>,  ...,  <i>x</i><sub class="lower-index"><i>r</i></sub>  =  <i>y</i><sub class="lower-index"><i>r</i></sub></span> and <span class="tex-span"><i>x</i><sub class="lower-index"><i>r</i>  +  1</sub>  &gt;  <i>y</i><sub class="lower-index"><i>r</i>  +  1</sub></span>. Characters are compared like their ASCII codes (or alphabetic order).</p><p>Help Rick get the girl (or whatever gender Unity has).</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of input contain two integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>q</i></span> (<span class="tex-span">2 ≤ <i>n</i> ≤ 20000</span>, <span class="tex-span">1 ≤ <i>q</i> ≤ 20000</span>) — number of vertices in tree and number of queries respectively.</p><p>The next <span class="tex-span"><i>n</i> - 1</span> lines contain the edges. Each line contains two integers <span class="tex-span"><i>v</i></span> and <span class="tex-span"><i>u</i></span> (endpoints of the edge) followed by an English lowercase letter <span class="tex-span"><i>c</i></span> (<span class="tex-span">1 ≤ <i>v</i>, <i>u</i> ≤ <i>n</i>, <i>v</i> ≠ <i>u</i></span>).</p><p>The next <span class="tex-span"><i>q</i></span> line contain the queries. Each line contains two integers <span class="tex-span"><i>x</i></span> and <span class="tex-span"><i>y</i></span> (<span class="tex-span">1 ≤ <i>x</i>, <i>y</i> ≤ <i>n</i>, <i>x</i> ≠ <i>y</i></span>).</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print the answer for each query in one line.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>4 3<br />4 1 t<br />3 2 p<br />1 2 s<br />3 2<br />1 3<br />2 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>0<br />1<br />1<br /></pre></div><div class="input"><div class="title">Input</div><pre>8 4<br />4 6 p<br />3 7 o<br />7 8 p<br />4 5 d<br />1 3 o<br />4 3 p<br />3 2 e<br />8 6<br />3 7<br />8 1<br />4 3<br /></pre></div><div class="output"><div class="title">Output</div><pre>6<br />1<br />3<br />1<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Here's the tree of first sample testcase:</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/52c4ac206682b1b83187e8deafc93c06dac6e544.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>Here's the tree of second sample testcase:</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/04907a839e56ddf24e0491a4cf8d51397afb2e25.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>In this test:</p><ul> <li> <span class="tex-span"><i>str</i>(8, 1)</span> = <span class="tex-font-style-tt">poo</span> </li><li> <span class="tex-span"><i>str</i>(8, 2)</span> = <span class="tex-font-style-tt">poe</span> </li><li> <span class="tex-span"><i>str</i>(8, 3)</span> = <span class="tex-font-style-tt">po</span> </li><li> <span class="tex-span"><i>str</i>(8, 4)</span> = <span class="tex-font-style-tt">pop</span> </li><li> <span class="tex-span"><i>str</i>(8, 5)</span> = <span class="tex-font-style-tt">popd</span> </li><li> <span class="tex-span"><i>str</i>(8, 6)</span> = <span class="tex-font-style-tt">popp</span> </li><li> <span class="tex-span"><i>str</i>(8, 7)</span> = <span class="tex-font-style-tt">p</span> </li></ul><p>So, for the first query, <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/9ac3bcb50c63fc450b7ff3ad3f82b1aa9b0ffdb8.png" style="max-width: 100.0%;max-height: 100.0%;" /> and for the third query <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/01f13fd2e1e98dac35dfd28b98a1cdb970305a72.png" style="max-width: 100.0%;max-height: 100.0%;" /> is the answer.</p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=D]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/82867");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 1em;"
        >


<div class="problemindexholder" problemindex="E" data-uuid="ps_6b81b1e10c6b87acb685337ea1fbbfafbc226ae6">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. ALT</div><div class="time-limit"><div class="property-title">time limit per test</div>4 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>ALT is a planet in a galaxy called &quot;Encore&quot;. Humans rule this planet but for some reason there's no dog in their planet, so the people there are sad and depressed. Rick and Morty are universal philanthropists and they want to make people in ALT happy. </p><p>ALT has <span class="tex-span"><i>n</i></span> cities numbered from <span class="tex-span">1</span> to <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>n</i> - 1</span> bidirectional roads numbered from <span class="tex-span">1</span> to <span class="tex-span"><i>n</i> - 1</span>. One can go from any city to any other city using these roads.</p><p>There are two types of people in ALT:</p><ol> <li> Guardians. A guardian lives in a house alongside a road and guards the road. </li><li> Citizens. A citizen lives in a house inside a city and works in an office in another city. </li></ol><p>Every person on ALT is either a guardian or a citizen and there's exactly one guardian alongside each road. </p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/61dcf062c022f6ca6a051935d105ab8c874a42c0.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>Rick and Morty talked to all the people in ALT, and here's what they got:</p><ul> <li> There are <span class="tex-span"><i>m</i></span> citizens living in ALT. </li><li> Citizen number <span class="tex-span"><i>i</i></span> lives in city number <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> and works in city number <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub></span>. </li><li> Every day each citizen will go through all roads along the shortest path from his home to his work. </li><li> A citizen will be happy if and only if either he himself has a puppy himself or all of guardians along his path to his work has a puppy (he sees the guardian's puppy in each road and will be happy). </li><li> A guardian is always happy. </li></ul><p>You need to tell Rick and Morty the minimum number of puppies they need in order to make all people in ALT happy, and also provide an optimal way to distribute these puppies.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of input contains two integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>m</i></span> (<span class="tex-span">2 ≤ <i>n</i> ≤ 2 × 10<sup class="upper-index">4</sup></span>, <span class="tex-span">1 ≤ <i>m</i> ≤ 10<sup class="upper-index">4</sup></span>) — number of cities and number of citizens respectively.</p><p>The next <span class="tex-span"><i>n</i> - 1</span> lines contain the roads, <span class="tex-span"><i>i</i></span>-th line contains endpoint of <span class="tex-span"><i>i</i></span>-th edge, <span class="tex-span"><i>v</i></span> and <span class="tex-span"><i>u</i></span> (<span class="tex-span">1 ≤ <i>v</i>, <i>u</i> ≤ <i>n</i></span>, <span class="tex-span"><i>v</i> ≠ <i>u</i></span>).</p><p>The next <span class="tex-span"><i>m</i></span> lines contain the information about citizens. <span class="tex-span"><i>i</i></span>-th line contains two integers <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>x</i><sub class="lower-index"><i>i</i></sub>, <i>y</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i></span>, <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub> ≠ <i>y</i><sub class="lower-index"><i>i</i></sub></span>).</p></div><div class="output-specification"><div class="section-title">Output</div><p>In the first line of input print a single integer <span class="tex-span"><i>k</i></span>, the total number of puppies they need (<span class="tex-span">1 ≤ <i>k</i> ≤ <i>n</i></span>).</p><p>In the second line print an integer <span class="tex-span"><i>q</i></span>, the number of puppies to give to citizens, followed by <span class="tex-span"><i>q</i></span> distinct integers <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>q</i></sub></span>, index of citizens to give puppy to (<span class="tex-span">0 ≤ <i>q</i> ≤ <i>min</i>(<i>m</i>, <i>k</i>)</span>, <span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> ≤ <i>m</i></span>).</p><p>In the third line print an integer <span class="tex-span"><i>e</i></span>, the number of puppies to give to guardians, followed by <span class="tex-span"><i>e</i></span> distinct integers <span class="tex-span"><i>b</i><sub class="lower-index">1</sub>, <i>b</i><sub class="lower-index">2</sub>, ..., <i>b</i><sub class="lower-index"><i>e</i></sub></span>, index of road of guardians to give puppy to (<span class="tex-span">0 ≤ <i>e</i> ≤ <i>min</i>(<i>n</i> - 1, <i>k</i>)</span>, <span class="tex-span">1 ≤ <i>b</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i> - 1</span>).</p><p>Sum of <span class="tex-span"><i>q</i></span> and <span class="tex-span"><i>e</i></span> should be equal to <span class="tex-span"><i>k</i></span>.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>4 5<br />2 4<br />3 4<br />1 4<br />2 4<br />2 1<br />2 4<br />1 2<br />2 3<br /></pre></div><div class="output"><div class="title">Output</div><pre>3<br />1 5 <br />2 3 1 <br /></pre></div><div class="input"><div class="title">Input</div><pre>4 7<br />3 4<br />1 4<br />2 1<br />4 2<br />4 2<br />2 4<br />1 4<br />2 1<br />3 1<br />4 2<br /></pre></div><div class="output"><div class="title">Output</div><pre>3<br />1 6 <br />2 2 3 <br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Map of ALT in the first sample testcase (numbers written on a road is its index):</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/e37848bd14a5afd4038dbdf7b44ddc8027f094d9.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>Map of ALT in the second sample testcase (numbers written on a road is its index): </p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/2b32454688a3ca0111418923557cdd11f6a3e41e.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=E]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/82867");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
    </div>

    <div id="footer">
        <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2024 Mike Mirzayanov</div>
        <div>The only programming contests Web 2.0 platform</div>

    </div>

</div>
</div>
    <script type="application/javascript">
        if ('serviceWorker' in navigator && 'fetch' in window && 'caches' in window) {
            navigator.serviceWorker.register('/service-worker-82867.js')
                .then(function (registration) {
                    console.log('Service worker registered: ', registration);
                })
                .catch(function (error) {
                    console.log('Registration failed: ', error);
                });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8a0aac1fcf667784',t:'MTcyMDU1MjgzNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>


<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-743380-5"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-743380-5');
        </script>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="603632ecbc2995594fe4e485b95466e4"/>
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01"/>

    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery-1.8.3.js"></script>
    <script type="application/javascript">
        window.locale = "en";
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }

        /* Protection against trailing dot in domain. */
        let hostLength = window.location.host.length;
        if (hostLength > 1 && window.location.host[hostLength - 1] === '.') {
            window.location = window.location.protocol + "//" + window.location.host.substring(0, hostLength - 1);
        }
    </script>

    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="k1">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="//codeforces.org/s/64849/images/codeforces-sponsored-by-ton.png" />
    <link rel="image_src" href="//codeforces.org/s/64849/images/codeforces-sponsored-by-ton.png" />
    <meta property="og:title" content="Problems - Codeforces"/>
    <meta property="og:description" content=""/>
    
    <meta property="og:site_name" content="Codeforces"/>
    
    
    
    
    
    
    <meta name="utc_offset" content="+03:00"/>
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Problems - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community" />
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup" />
    <meta name="robots" content="index, follow" />

    <link rel="stylesheet" href="//codeforces.org/s/64849/css/font-awesome.min.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/line-awesome.min.css" type="text/css" charset="utf-8" />

        <link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>


    <link rel="apple-touch-icon" sizes="57x57" href="//codeforces.org/s/64849/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="//codeforces.org/s/64849/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="//codeforces.org/s/64849/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="//codeforces.org/s/64849/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="//codeforces.org/s/64849/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="//codeforces.org/s/64849/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="//codeforces.org/s/64849/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="//codeforces.org/s/64849/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="//codeforces.org/s/64849/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="//codeforces.org/s/64849/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="//codeforces.org/s/64849/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="//codeforces.org/s/64849/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="//codeforces.org/s/64849/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="//codeforces.org/s/64849/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/prettify.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/clear.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/ttypography.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/problem-statement.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/second-level-menu.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/roundbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/datatable.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/table-form.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/topic.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/jquery.jgrowl.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/facebox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/jquery.wysiwyg.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/jquery.autocomplete.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/codeforces.datepick.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/colorbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/jquery.drafts.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/64849/css/community.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/64849/css/sidebar-menu.css" type="text/css" charset="utf-8" />

    <!-- MathJax -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    MathJax.Hub.Register.StartupHook("End", function () {
        Codeforces.runMathJaxListeners();
    });
    </script>
    <script type="text/javascript" async
            src="https://mathjax.codeforces.org/MathJax.js?config=TeX-AMS_HTML-full"
    >
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="//codeforces.org/s/64849/js/prettify/prettify.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/pushstream.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.easing.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.swipe.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.hotkeys.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/facebox.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/controls/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/controls/wysiwyg.table.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/controls/wysiwyg.image.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/controls/wysiwyg.link.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.datepick.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.drafts.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/clipboard.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/autosize.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/sjcl.js"></script>
    <script type="text/javascript" src="/scripts/f8f695306b4bab3cbdd456143062ab76/en/codeforces-options.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/codeforces.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/EventCatcher.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/preparedVerdictFormats-en.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/confetti.min.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="//codeforces.org/s/64849/markitup/skins/markitup/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/markitup/sets/markdown/style.css" type="text/css" charset="utf-8" />


    <script type="text/javascript" src="//codeforces.org/s/64849/markitup/jquery.markitup.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/markitup/sets/markdown/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->




</head>
<body class=" "><span style='display:none;' class='csrf-token' data-csrf='603632ecbc2995594fe4e485b95466e4'>&nbsp;</span>

<!-- .notificationTextCleaner used in Codeforces.showAnnouncements() -->
<div class="notificationTextCleaner" style="font-size: 0"></div>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 3.0rem;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    String.prototype.hashCode = function() {
        var hash = 0, i, chr;
        if (this.length === 0) return hash;
        for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };

    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile === "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>





    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 700
        });
    }, 100);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


    function showAnnouncements(json) {
        //info("j=" + JSON.stringify(json));

        if (json.t != "a") {
            return;
        }

        setTimeout(function() {
            Codeforces.showAnnouncements(json.d, "en");
        }, Math.random() * 500);
    }

    function showEventCatcherUserMessage(json) {
        if (json.t == "s") {
            var points = json.d[5];
            var passedTestCount = json.d[7];
            var judgedTestCount = json.d[8];
            var verdict = preparedVerdictFormats[json.d[12]];
            var verdictPrototypeDiv = $(".verdictPrototypeDiv");
            verdictPrototypeDiv.html(verdict);
            if (judgedTestCount != null && judgedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-judged").text(judgedTestCount);
            }
            if (passedTestCount != null && passedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-passed").text(passedTestCount);
            }
            if (points != null && points != undefined) {
                verdictPrototypeDiv.find(".verdict-format-points").text(points);
            }
            Codeforces.showMessage(verdictPrototypeDiv.text());
        }
    }

    $(".clickable-title").each(function() {
        var title = $(this).attr("data-title");
        if (title) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = title;
            $(this).attr("title", tmp.textContent || tmp.innerText || "");
        }
    });

    $(".clickable-title").click(function() {
        var title = $(this).attr("data-title");
        if (title) {
            Codeforces.alert(title);
        } else {
            Codeforces.alert($(this).attr("title"));
        }
    }).css("position", "relative").css("bottom", "3px");

        Codeforces.showDelayedMessage();

    Codeforces.reformatTimes();

    //Codeforces.initializePubSub();
    if (window.codeforcesOptions.subscribeServerUrl) {
        window.eventCatcher = new EventCatcher(
            window.codeforcesOptions.subscribeServerUrl,
            [
                Codeforces.getGlobalChannel(),
                Codeforces.getUserChannel(),
                Codeforces.getUserShowMessageChannel(),
                Codeforces.getContestChannel(),
                Codeforces.getParticipantChannel(),
                Codeforces.getTalkChannel()
            ]
        );

        if (Codeforces.getParticipantChannel()) {
            window.eventCatcher.subscribe(Codeforces.getParticipantChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getContestChannel()) {
            window.eventCatcher.subscribe(Codeforces.getContestChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getGlobalChannel()) {
            window.eventCatcher.subscribe(Codeforces.getGlobalChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserShowMessageChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserShowMessageChannel(), function(json) {
                showEventCatcherUserMessage(json);
            });
        }
    }

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>


<div id="body">
<div style="width: 950px; margin: 0 auto;" class="compact-problemset">
    <div id="header" style="position: relative; margin: 0;">
        <div style="float:left;">
                  <a href="/"><img height="65" style="height: 65px;" src="//codeforces.org/s/64849/images/codeforces-sponsored-by-ton.png" alt="Codeforces"/></a>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="//codeforces.org/s/64849/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="//codeforces.org/s/64849/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <br style="clear: both;"/>

    <div style="text-align: center; font-size: 1.8rem; margin-bottom: 0.5em;"
         class="caption">Codeforces Round 366 (Div. 1)</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

    <div class="problem-frames">
        <div
                    style="margin-bottom: 2em;"
        >

    <style>
        #facebox .content:has(.diff-popup) {
            width: 90vw;
            max-width: 120rem !important;
        }

        .testCaseMarker {
            position: absolute;
            font-weight: bold;
            font-size: 1rem;
        }

        .diff-popup {
            width: 90vw;
            max-width: 120rem !important;
            display: none;
            overflow: auto;
        }

        .input-output-copier {
            font-size: 1.2rem;
            float: right;
            color: #888 !important;
            cursor: pointer;
            border: 1px solid rgb(185, 185, 185);
            padding: 3px;
            margin: 1px;
            line-height: 1.1rem;
            text-transform: none;
        }

        .input-output-copier:hover {
            background-color: #def;
        }

        .test-explanation textarea {
            width: 100%;
            height: 1.5em;
        }

        .pending-submission-message {
            color: darkorange !important;
        }
    </style>
    <script>
        const OPENING_SPACE = String.fromCharCode(1001);
        const CLOSING_SPACE = String.fromCharCode(1002);

        const nodeToText = function (node, pre) {
            let result = [];

            if (node.tagName === "SCRIPT" || node.tagName === "math"
                || (node.classList && node.classList.contains("input-output-copier")))
                return [];

            if (node.tagName === "NOBR") {
                result.push(OPENING_SPACE);
            }

            if (node.nodeType === Node.TEXT_NODE) {
                let s = node.textContent;
                if (!pre) {
                    s = s.replace(/\s+/g, " ");
                }
                if (s.length > 0) {
                    result.push(s);
                }
            }

            if (pre && node.tagName === "BR") {
                result.push("\n");
            }

            node.childNodes.forEach(function (child) {
                result.push(nodeToText(child, node.tagName === "PRE").join(""));
            });

            if (node.tagName === "DIV"
                || node.tagName === "P"
                || node.tagName === "PRE"
                || node.tagName === "UL"
                || node.tagName === "LI"
            ) {
                result.push("\n");
            }

            if (node.tagName === "NOBR") {
                result.push(CLOSING_SPACE);
            }

            return result;
        }

        const isSpecial = function (c) {
            return c === ',' || c === '.' || c === ';' || c === ')' || c === ' ';
        }

        const convertStatementToText = function(statmentNode) {
            const text = nodeToText(statmentNode, false).join("").replace(/ +/g, " ").replace(/\n\n+/g, "\n\n");
            let result = [];
            for (let i = 0; i < text.length; i++) {
                const c = text.charAt(i);
                if (c === OPENING_SPACE) {
                    if (!((i > 0 && text.charAt(i - 1) === '(') || (result.length > 0 && result[result.length - 1] === ' '))) {
                        result.push('+');
                    }
                } else if (c === CLOSING_SPACE) {
                    if (!(i + 1 < text.length && isSpecial(text.charAt(i + 1)))) {
                        result.push('-');
                    }
                } else {
                    result.push(c);
                }
            }
            return result.join("").split("\n").map(value => value.trim()).join("\n");
        };
    </script>
    <div class="diff-popup">
    </div>

<div class="problemindexholder" problemindex="A" data-uuid="ps_b587197c466d818ece71c85c24567d69e11de2dd">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A. Thor</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Thor is getting used to the Earth. As a gift Loki gave him a smartphone. There are <span class="tex-span"><i>n</i></span> applications on this phone. Thor is fascinated by this phone. He has only one minor issue: he can't count the number of unread notifications generated by those applications (maybe Loki put a curse on it so he can't).</p><p><span class="tex-span"><i>q</i></span> events are about to happen (in chronological order). They are of three types:</p><ol> <li> Application <span class="tex-span"><i>x</i></span> generates a notification (this new notification is unread). </li><li> Thor reads all notifications generated so far by application <span class="tex-span"><i>x</i></span> (he may re-read some notifications). </li><li> Thor reads the first <span class="tex-span"><i>t</i></span> notifications generated by phone applications (notifications generated in first <span class="tex-span"><i>t</i></span> events of the first type). It's guaranteed that there were at least <span class="tex-span"><i>t</i></span> events of the first type before this event. Please note that he doesn't read first <span class="tex-span"><i>t</i></span> unread notifications, he just reads the very first <span class="tex-span"><i>t</i></span> notifications generated on his phone and he may re-read some of them in this operation. </li></ol><p>Please help Thor and tell him the number of unread notifications after each event. You may assume that initially there are no notifications in the phone.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of input contains two integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>q</i></span> (<span class="tex-span">1 ≤ <i>n</i>, <i>q</i> ≤ 300 000</span>) — the number of applications and the number of events to happen.</p><p>The next <span class="tex-span"><i>q</i></span> lines contain the events. The <span class="tex-span"><i>i</i></span>-th of these lines starts with an integer <span class="tex-span"><i>type</i><sub class="lower-index"><i>i</i></sub></span> — type of the <span class="tex-span"><i>i</i></span>-th event. If <span class="tex-span"><i>type</i><sub class="lower-index"><i>i</i></sub> = 1</span> or <span class="tex-span"><i>type</i><sub class="lower-index"><i>i</i></sub> = 2</span> then it is followed by an integer <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span>. Otherwise it is followed by an integer <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>type</i><sub class="lower-index"><i>i</i></sub> ≤ 3, 1 ≤ <i>x</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i>, 1 ≤ <i>t</i><sub class="lower-index"><i>i</i></sub> ≤ <i>q</i></span>).</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print the number of unread notifications after each event.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3 4<br />1 3<br />1 1<br />1 2<br />2 3<br /></pre></div><div class="output"><div class="title">Output</div><pre>1<br />2<br />3<br />2<br /></pre></div><div class="input"><div class="title">Input</div><pre>4 6<br />1 2<br />1 4<br />1 2<br />3 3<br />1 3<br />1 3<br /></pre></div><div class="output"><div class="title">Output</div><pre>1<br />2<br />3<br />0<br />1<br />2<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample:</p><ol> <li> Application <span class="tex-span">3</span> generates a notification (there is <span class="tex-span">1</span> unread notification). </li><li> Application <span class="tex-span">1</span> generates a notification (there are <span class="tex-span">2</span> unread notifications). </li><li> Application <span class="tex-span">2</span> generates a notification (there are <span class="tex-span">3</span> unread notifications). </li><li> Thor reads the notification generated by application <span class="tex-span">3</span>, there are <span class="tex-span">2</span> unread notifications left. </li></ol><p>In the second sample test:</p><ol> <li> Application <span class="tex-span">2</span> generates a notification (there is <span class="tex-span">1</span> unread notification). </li><li> Application <span class="tex-span">4</span> generates a notification (there are <span class="tex-span">2</span> unread notifications). </li><li> Application <span class="tex-span">2</span> generates a notification (there are <span class="tex-span">3</span> unread notifications). </li><li> Thor reads first three notifications and since there are only three of them so far, there will be no unread notification left. </li><li> Application <span class="tex-span">3</span> generates a notification (there is <span class="tex-span">1</span> unread notification). </li><li> Application <span class="tex-span">3</span> generates a notification (there are <span class="tex-span">2</span> unread notifications). </li></ol></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=A]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {
        window.changedTests = new Set();

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");



        String.prototype.replaceAll = function (search, replace) {
            return this.split(search).join(replace);
        };

        $(".sample-test .title").each(function () {
            const preId = ("id" + Math.random()).replaceAll(".", "0");
            const cpyId = ("id" + Math.random()).replaceAll(".", "0");

            $(this).parent().find("pre").attr("id", preId);
            const $copy = $("<div title='Copy' data-clipboard-target='#" + preId + "' id='" + cpyId + "' class='input-output-copier'>Copy</div>");
            $(this).append($copy);

            const clipboard = new Clipboard('#' + cpyId, {
                text: function (trigger) {
                    const pre = document.querySelector('#' + preId);
                    const lines = pre.querySelectorAll(".test-example-line");
                    return Codeforces.filterClipboardText(pre.innerText, lines.length);
                }
            });

            const isInput = $(this).parent().hasClass("input");

            clipboard.on('success', function (e) {
                if (isInput) {
                    Codeforces.showMessage("The example input has been copied into the clipboard");
                } else {
                    Codeforces.showMessage("The example output has been copied into the clipboard");
                }
                e.clearSelection();
            });
        });

        $(".test-form-item input").change(function () {
            addPendingSubmissionMessage($($(this).closest("form")), "You changed the answer, do not forget to submit it if you want to save the changes");
            const index = $(this).closest(".problemindexholder").attr("problemindex");
            let test = "";
            $(this).closest("form input").each(function () {
                const test_ = $(this).attr("name");
                if (test_ && test_.substring(0, 4) === "test") {
                    test = test_;
                }
            });
            if (index.length > 0 && test.length > 0) {
                const indexTest = index + "::" + test;
                window.changedTests.add(indexTest);
            }
        });

        $(window).on('beforeunload', function () {
            if (window.changedTests.size > 0) {
                return 'Dialog text here';
            }
        });

        autosize($('.test-explanation textarea'));

        $(".test-example-line").hover(function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        let top = 1E20;
                        let left = 1E20;
                        let problem = $(this).closest(".problemindexholder");
                        $(this).closest(".input").find("." + clazz).css("background-color", "#FFFDE7").each(function() {
                            top = Math.min(top, $(this).offset().top);
                            left = Math.min(left, $(this).offset().left);
                        });
                        let testCaseMarker = problem.find(".testCaseMarker_" + end);
                        if (testCaseMarker.length === 0) {
                            const html = "<div class=\"testCaseMarker testCaseMarker_" + end + " notice\"></div>";
                            problem.append($(html));
                            testCaseMarker = problem.find(".testCaseMarker_" + end);
                        }
                        if (testCaseMarker) {
                            testCaseMarker.show()
                                    .offset({top, left: left - 20})
                                    .text(end);
                        }
                    }
                }
            });
        }, function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        $("." + clazz).css("background-color", "");
                        $(this).closest(".problemindexholder").find(".testCaseMarker_" + end).hide();
                    }
                }
            });
        });

    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="B" data-uuid="ps_402806fdf3f5deb1afe215bb06eae9af5a4968c3">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B. Ant Man</div><div class="time-limit"><div class="property-title">time limit per test</div>4 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Scott Lang is at war with Darren Cross. There are <span class="tex-span"><i>n</i></span> chairs in a hall where they are, numbered with <span class="tex-span">1, 2, ..., <i>n</i></span> from left to right. The <span class="tex-span"><i>i</i></span>-th chair is located at coordinate <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span>. Scott is on chair number <span class="tex-span"><i>s</i></span> and Cross is on chair number <span class="tex-span"><i>e</i></span>. Scott can jump to all other chairs (not only neighboring chairs). He wants to start at his position (chair number <span class="tex-span"><i>s</i></span>), visit each chair <span class="tex-font-style-bf">exactly once</span> and end up on chair number <span class="tex-span"><i>e</i></span> with Cross. </p><p>As we all know, Scott can shrink or grow big (grow big only to his normal size), so at any moment of time he can be either small or large (normal). The thing is, he can only shrink or grow big while being on a chair (not in the air while jumping to another chair). Jumping takes time, but shrinking and growing big takes no time. Jumping from chair number <span class="tex-span"><i>i</i></span> to chair number <span class="tex-span"><i>j</i></span> takes <span class="tex-span">|<i>x</i><sub class="lower-index"><i>i</i></sub> - <i>x</i><sub class="lower-index"><i>j</i></sub>|</span> seconds. Also, jumping off a chair and landing on a chair takes extra amount of time. </p><p>If Scott wants to jump to a chair on his left, he can only be small, and if he wants to jump to a chair on his right he should be large.</p><p>Jumping off the <span class="tex-span"><i>i</i></span>-th chair takes:</p><ul> <li> <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> extra seconds if he's small. </li><li> <span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub></span> extra seconds otherwise (he's large). </li></ul><p>Also, landing on <span class="tex-span"><i>i</i></span>-th chair takes:</p><ul> <li> <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> extra seconds if he's small. </li><li> <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> extra seconds otherwise (he's large). </li></ul><p>In simpler words, jumping from <span class="tex-span"><i>i</i></span>-th chair to <span class="tex-span"><i>j</i></span>-th chair takes exactly:</p><ul> <li> <span class="tex-span">|<i>x</i><sub class="lower-index"><i>i</i></sub> - <i>x</i><sub class="lower-index"><i>j</i></sub>| + <i>c</i><sub class="lower-index"><i>i</i></sub> + <i>b</i><sub class="lower-index"><i>j</i></sub></span> seconds if <span class="tex-span"><i>j</i> &lt; <i>i</i></span>. </li><li> <span class="tex-span">|<i>x</i><sub class="lower-index"><i>i</i></sub> - <i>x</i><sub class="lower-index"><i>j</i></sub>| + <i>d</i><sub class="lower-index"><i>i</i></sub> + <i>a</i><sub class="lower-index"><i>j</i></sub></span> seconds otherwise (<span class="tex-span"><i>j</i> &gt; <i>i</i></span>). </li></ul><p>Given values of <span class="tex-span"><i>x</i></span>, <span class="tex-span"><i>a</i></span>, <span class="tex-span"><i>b</i></span>, <span class="tex-span"><i>c</i></span>, <span class="tex-span"><i>d</i></span> find the minimum time Scott can get to Cross, assuming he wants to visit each chair exactly once.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of the input contains three integers <span class="tex-span"><i>n</i>, <i>s</i></span> and <span class="tex-span"><i>e</i></span> (<span class="tex-span">2 ≤ <i>n</i> ≤ 5000, 1 ≤ <i>s</i>, <i>e</i> ≤ <i>n</i>, <i>s</i> ≠ <i>e</i></span>) — the total number of chairs, starting and ending positions of Scott.</p><p>The second line contains <span class="tex-span"><i>n</i></span> integers <span class="tex-span"><i>x</i><sub class="lower-index">1</sub>, <i>x</i><sub class="lower-index">2</sub>, ..., <i>x</i><sub class="lower-index"><i>n</i></sub></span> (<span class="tex-span">1 ≤ <i>x</i><sub class="lower-index">1</sub> &lt; <i>x</i><sub class="lower-index">2</sub> &lt; ... &lt; <i>x</i><sub class="lower-index"><i>n</i></sub> ≤ 10<sup class="upper-index">9</sup></span>).</p><p>The third line contains <span class="tex-span"><i>n</i></span> integers <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>n</i></sub></span> (<span class="tex-span">1 ≤ <i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>n</i></sub> ≤ 10<sup class="upper-index">9</sup></span>).</p><p>The fourth line contains <span class="tex-span"><i>n</i></span> integers <span class="tex-span"><i>b</i><sub class="lower-index">1</sub>, <i>b</i><sub class="lower-index">2</sub>, ..., <i>b</i><sub class="lower-index"><i>n</i></sub></span> (<span class="tex-span">1 ≤ <i>b</i><sub class="lower-index">1</sub>, <i>b</i><sub class="lower-index">2</sub>, ..., <i>b</i><sub class="lower-index"><i>n</i></sub> ≤ 10<sup class="upper-index">9</sup></span>).</p><p>The fifth line contains <span class="tex-span"><i>n</i></span> integers <span class="tex-span"><i>c</i><sub class="lower-index">1</sub>, <i>c</i><sub class="lower-index">2</sub>, ..., <i>c</i><sub class="lower-index"><i>n</i></sub></span> (<span class="tex-span">1 ≤ <i>c</i><sub class="lower-index">1</sub>, <i>c</i><sub class="lower-index">2</sub>, ..., <i>c</i><sub class="lower-index"><i>n</i></sub> ≤ 10<sup class="upper-index">9</sup></span>).</p><p>The sixth line contains <span class="tex-span"><i>n</i></span> integers <span class="tex-span"><i>d</i><sub class="lower-index">1</sub>, <i>d</i><sub class="lower-index">2</sub>, ..., <i>d</i><sub class="lower-index"><i>n</i></sub></span> (<span class="tex-span">1 ≤ <i>d</i><sub class="lower-index">1</sub>, <i>d</i><sub class="lower-index">2</sub>, ..., <i>d</i><sub class="lower-index"><i>n</i></sub> ≤ 10<sup class="upper-index">9</sup></span>).</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print the minimum amount of time Scott needs to get to the Cross while visiting each chair exactly once.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>7 4 3<br />8 11 12 16 17 18 20<br />17 16 20 2 20 5 13<br />17 8 8 16 12 15 13<br />12 4 16 4 15 7 6<br />8 14 2 11 17 12 8<br /></pre></div><div class="output"><div class="title">Output</div><pre>139<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the sample testcase, an optimal solution would be <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/5bbd3e094ffa5a72e263dfaec7aeaff795bc22a3.png" style="max-width: 100.0%;max-height: 100.0%;" />. Spent time would be <span class="tex-span">17 + 24 + 23 + 20 + 33 + 22 = 139</span>.</p></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=B]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="C" data-uuid="ps_109c1834f9423aa2747479ad4b47495d299ac7c2">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C. Black Widow</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Natalia Romanova is trying to test something on the new gun S.H.I.E.L.D gave her. In order to determine the result of the test, she needs to find the number of answers to a certain equation. The equation is of form:</p><p><img align="middle" class="tex-formula" src="https://espresso.codeforces.com/a67291804bcb142d1b1db4b8216291ef927e26bf.png" style="max-width: 100.0%;max-height: 100.0%;" /></p><p>Where <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/5e8ef042050cb082b91c8fb3ee50d2c87b494854.png" style="max-width: 100.0%;max-height: 100.0%;" /> represents logical OR and <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/c4b7092c0f7ce6535f2574569c98f7b3c2fe2c5f.png" style="max-width: 100.0%;max-height: 100.0%;" /> represents logical exclusive OR (XOR), and <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i>, <i>j</i></sub></span> are some boolean variables or their negations. Natalia calls the left side of the equation a XNF formula. Each statement in brackets is called a clause, and <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i>, <i>j</i></sub></span> are called literals.</p><p>In the equation Natalia has, the left side is actually a 2-XNF-2 containing variables <span class="tex-span"><i>x</i><sub class="lower-index">1</sub>, <i>x</i><sub class="lower-index">2</sub>, ..., <i>x</i><sub class="lower-index"><i>m</i></sub></span> and their negations. An XNF formula is 2-XNF-2 if:</p><ol> <li> For each <span class="tex-span">1 ≤ <i>i</i> ≤ <i>n</i></span>, <span class="tex-span"><i>k</i><sub class="lower-index"><i>i</i></sub> ≤ 2</span>, i.e. the size of each clause doesn't exceed two. </li><li> Each variable occurs <span class="tex-font-style-bf">in the formula at most two times</span> (with negation and without negation in total). Please note that it's possible that a variable occurs twice but its negation doesn't occur in any clause (or vice versa). </li></ol><p>Natalia is given a formula of <span class="tex-span"><i>m</i></span> variables, consisting of <span class="tex-span"><i>n</i></span> clauses. Please, make sure to check the samples in order to properly understand how the formula looks like.</p><p>Natalia is more into fight than theory, so she asked you to tell her the number of answers to this equation. More precisely, you need to find the number of ways to set <span class="tex-span"><i>x</i><sub class="lower-index">1</sub>, ..., <i>x</i><sub class="lower-index"><i>m</i></sub></span> with <span class="tex-span"><i>true</i></span> and <span class="tex-span"><i>false</i></span> (out of total of <span class="tex-span">2<sup class="upper-index"><i>m</i></sup></span> ways) so that the equation is satisfied. Since this number can be extremely large, you need to print the answer modulo <span class="tex-span">10<sup class="upper-index">9</sup> + 7</span>.</p><p>Please, note that some variable may appear twice in one clause, or not appear in the equation at all (but still, setting it to <span class="tex-span"><i>false</i></span> or <span class="tex-span"><i>true</i></span> gives different ways to set variables).</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of input contains two integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>m</i></span> (<span class="tex-span">1 ≤ <i>n</i>, <i>m</i> ≤ 100 000</span>) — the number of clauses and the number of variables respectively.</p><p>The next <span class="tex-span"><i>n</i></span> lines contain the formula. The <span class="tex-span"><i>i</i></span>-th of them starts with an integer <span class="tex-span"><i>k</i><sub class="lower-index"><i>i</i></sub></span> — the number of literals in the <span class="tex-span"><i>i</i></span>-th clause. It is followed by <span class="tex-span"><i>k</i><sub class="lower-index"><i>i</i></sub></span> non-zero integers <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i>, 1</sub>, ..., <i>a</i><sub class="lower-index"><i>i</i>, <i>k</i><sub class="lower-index"><i>i</i></sub></sub></span>. If <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i>, <i>j</i></sub> &gt; 0</span> then <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i>, <i>j</i></sub></span> is <span class="tex-span"><i>x</i><sub class="lower-index"><i>a</i><sub class="lower-index"><i>i</i>, <i>j</i></sub></sub></span> otherwise it's negation of <span class="tex-span"><i>x</i><sub class="lower-index"> - <i>a</i><sub class="lower-index"><i>i</i>, <i>j</i></sub></sub></span> (<span class="tex-span">1 ≤ <i>k</i><sub class="lower-index"><i>i</i></sub> ≤ 2</span>, <span class="tex-span"> - <i>m</i> ≤ <i>a</i><sub class="lower-index"><i>i</i>, <i>j</i></sub> ≤ <i>m</i></span>, <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i>, <i>j</i></sub> ≠ 0</span>).</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print the answer modulo <span class="tex-span">1 000 000 007</span> (<span class="tex-span">10<sup class="upper-index">9</sup> + 7</span>) in one line.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>6 7<br />2 4 -2<br />2 6 3<br />2 -7 1<br />2 -5 1<br />2 3 6<br />2 -2 -5<br /></pre></div><div class="output"><div class="title">Output</div><pre>48<br /></pre></div><div class="input"><div class="title">Input</div><pre>8 10<br />1 -5<br />2 4 -6<br />2 -2 -6<br />2 -7 9<br />2 10 -1<br />2 3 -1<br />2 -8 9<br />2 5 8<br /></pre></div><div class="output"><div class="title">Output</div><pre>544<br /></pre></div><div class="input"><div class="title">Input</div><pre>2 3<br />2 1 1<br />2 -3 3<br /></pre></div><div class="output"><div class="title">Output</div><pre>4<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>The equation in the first sample is:</p><center class="tex-equation"><img align="middle" class="tex-formula" src="https://espresso.codeforces.com/79796a51feb310dbecd7a236356d0599a2874c1d.png" style="max-width: 100.0%;max-height: 100.0%;" /></center><p>The equation in the second sample is:</p><center class="tex-equation"><img align="middle" class="tex-formula" src="https://espresso.codeforces.com/0bf5953fc0531771e961b12ae10ef2007a539f38.png" style="max-width: 100.0%;max-height: 100.0%;" /></center><p>The equation in the third sample is:</p><center class="tex-equation"><img align="middle" class="tex-formula" src="https://espresso.codeforces.com/b655529d1d18181e0e752f7c15a00d9a82ad2d53.png" style="max-width: 100.0%;max-height: 100.0%;" /></center></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=C]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="D" data-uuid="ps_5a57c032b0ae5c9275fba6bf71c37db67e19cea6">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. Captain America</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Steve Rogers is fascinated with new vibranium shields S.H.I.E.L.D gave him. They're all uncolored. There are <span class="tex-span"><i>n</i></span> shields in total, the <span class="tex-span"><i>i</i></span>-th shield is located at point <span class="tex-span">(<i>x</i><sub class="lower-index"><i>i</i></sub>, <i>y</i><sub class="lower-index"><i>i</i></sub>)</span> of the coordinate plane. It's possible that two or more shields share the same location.</p><p>Steve wants to paint all these shields. He paints each shield in either red or blue. Painting a shield in red costs <span class="tex-span"><i>r</i></span> dollars while painting it in blue costs <span class="tex-span"><i>b</i></span> dollars.</p><p>Additionally, there are <span class="tex-span"><i>m</i></span> constraints Steve wants to be satisfied. The <span class="tex-span"><i>i</i></span>-th constraint is provided by three integers <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>l</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub></span>:</p><ul> <li> If <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub> = 1</span>, then the absolute difference between the number of red and blue shields on line <span class="tex-span"><i>x</i> = <i>l</i><sub class="lower-index"><i>i</i></sub></span> should not exceed <span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub></span>. </li><li> If <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub> = 2</span>, then the absolute difference between the number of red and blue shields on line <span class="tex-span"><i>y</i> = <i>l</i><sub class="lower-index"><i>i</i></sub></span> should not exceed <span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub></span>. </li></ul><p>Steve gave you the task of finding the painting that satisfies all the condition and the total cost is minimum.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of the input contains two integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>m</i></span> (<span class="tex-span">1 ≤ <i>n</i>, <i>m</i> ≤ 100 000</span>) — the number of shields and the number of constraints respectively.</p><p>The second line contains two integers <span class="tex-span"><i>r</i></span> and <span class="tex-span"><i>b</i></span> (<span class="tex-span">1 ≤ <i>r</i>, <i>b</i> ≤ 10<sup class="upper-index">9</sup></span>).</p><p>The next <span class="tex-span"><i>n</i></span> lines contain the shields coordinates. The <span class="tex-span"><i>i</i></span>-th of these lines contains two integers <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>x</i><sub class="lower-index"><i>i</i></sub>, <i>y</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>).</p><p>The next <span class="tex-span"><i>m</i></span> lines contain the constrains. The <span class="tex-span"><i>j</i></span>-th of these lines contains three integers <span class="tex-span"><i>t</i><sub class="lower-index"><i>j</i></sub></span>, <span class="tex-span"><i>l</i><sub class="lower-index"><i>j</i></sub></span> and <span class="tex-span"><i>d</i><sub class="lower-index"><i>j</i></sub></span> (<span class="tex-span">1 ≤ <i>t</i><sub class="lower-index"><i>j</i></sub> ≤ 2, 1 ≤ <i>l</i><sub class="lower-index"><i>j</i></sub> ≤ 10<sup class="upper-index">9</sup>, 0 ≤ <i>d</i><sub class="lower-index"><i>j</i></sub> ≤ <i>n</i></span>).</p></div><div class="output-specification"><div class="section-title">Output</div><p>If satisfying all the constraints is impossible print <span class="tex-font-style-tt">-1</span> in first and only line of the output.</p><p>Otherwise, print the minimum total cost in the first line of output. In the second line print a string of length <span class="tex-span"><i>n</i></span> consisting of letters '<span class="tex-font-style-tt">r</span>' and '<span class="tex-font-style-tt">b</span>' only. The <span class="tex-span"><i>i</i></span>-th character should be '<span class="tex-font-style-tt">r</span>' if the <span class="tex-span"><i>i</i></span>-th shield should be painted red in the optimal answer and '<span class="tex-font-style-tt">b</span>' if it should be painted blue. The cost of painting shields in these colors should be equal the minimum cost you printed on the first line.</p><p>If there exist more than one optimal solution, print any of them.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>5 6<br />8 3<br />2 10<br />1 5<br />9 10<br />9 10<br />2 8<br />1 9 1<br />1 2 1<br />2 10 3<br />2 10 2<br />1 1 1<br />2 5 2<br /></pre></div><div class="output"><div class="title">Output</div><pre>25<br />rbrbb<br /></pre></div><div class="input"><div class="title">Input</div><pre>4 4<br />7 3<br />10 3<br />9 8<br />10 3<br />2 8<br />2 8 0<br />2 8 0<br />1 2 0<br />1 9 0<br /></pre></div><div class="output"><div class="title">Output</div><pre>-1<br /></pre></div></div></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=D]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 1em;"
        >


<div class="problemindexholder" problemindex="E" data-uuid="ps_08157ba446fb225c2e15b8d10bd9a5e60a708711">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. Iron Man</div><div class="time-limit"><div class="property-title">time limit per test</div>5 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Tony Stark is playing a game with his suits (they have auto-pilot now). He lives in Malibu. Malibu has <span class="tex-span"><i>n</i></span> junctions numbered from <span class="tex-span">1</span> to <span class="tex-span"><i>n</i></span>, connected with <span class="tex-span"><i>n</i> - 1</span> roads. One can get from a junction to any other junction using these roads (graph of Malibu forms a tree).</p><p>Tony has <span class="tex-span"><i>m</i></span> suits. There's a special plan for each suit. The <span class="tex-span"><i>i</i></span>-th suit will appear at the moment of time <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub></span> in the junction <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span>, and will move to junction <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub></span> using the shortest path between <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub></span> with the speed <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> roads per second (passing a junctions takes no time), and vanishing immediately when arriving at <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub></span> (if it reaches <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub></span> in time <span class="tex-span"><i>q</i></span>, it's available there at moment <span class="tex-span"><i>q</i></span>, but not in further moments). Also, suits move continuously (for example if <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub> ≠ <i>u</i><sub class="lower-index"><i>i</i></sub></span>, at time <img align="middle" class="tex-formula" src="https://espresso.codeforces.com/8a78415dec5c16ac7b870d1f8a9ad2317aaa2743.png" style="max-width: 100.0%;max-height: 100.0%;" /> it's in the middle of a road. Please note that if <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub> = <i>u</i><sub class="lower-index"><i>i</i></sub></span> it means the suit will be at junction number <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span> only at moment <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub></span> and then it vanishes. </p><p>An explosion happens if at any moment of time two suits share the same exact location (it may be in a junction or somewhere on a road; while appearing, vanishing or moving).</p><p>Your task is to tell Tony the moment of the the first explosion (if there will be any).</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of the input contains two integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>m</i></span> (<span class="tex-span">1 ≤ <i>n</i>, <i>m</i> ≤ 100 000</span>) — the number of junctions and the number of suits respectively.</p><p>The next <span class="tex-span"><i>n</i> - 1</span> lines contain the roads descriptions. Each line contains two integers <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> — endpoints of the <span class="tex-span"><i>i</i></span>-th road (<span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i></span>, <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub> ≠ <i>b</i><sub class="lower-index"><i>i</i></sub></span>).</p><p>The next <span class="tex-span"><i>m</i></span> lines contain the suit descriptions. The <span class="tex-span"><i>i</i></span>-th of them contains four integers <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">0 ≤ <i>t</i><sub class="lower-index"><i>i</i></sub> ≤ 10 000, 1 ≤ <i>c</i><sub class="lower-index"><i>i</i></sub> ≤ 10 000</span>, <span class="tex-span">1 ≤ <i>v</i><sub class="lower-index"><i>i</i></sub>, <i>u</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i></span>), meaning the <span class="tex-span"><i>i</i></span>-th suit will appear at moment of time <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub></span> at the junction <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span> and will move to the junction <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub></span> with a speed <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> roads per second.</p></div><div class="output-specification"><div class="section-title">Output</div><p>If there would be no explosions at all, print <span class="tex-font-style-tt">-1</span> in the first and only line of output.</p><p>Otherwise print the moment of the first explosion.</p><p>Your answer will be considered correct if its relative or absolute error doesn't exceed <span class="tex-span">10<sup class="upper-index"> - 6</sup></span>.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>6 4<br />2 5<br />6 5<br />3 6<br />4 6<br />4 1<br />27 6 1 3<br />9 5 1 6<br />27 4 3 4<br />11 29 2 6<br /></pre></div><div class="output"><div class="title">Output</div><pre>27.3<br /></pre></div><div class="input"><div class="title">Input</div><pre>6 4<br />3 1<br />4 5<br />6 4<br />6 1<br />2 6<br />16 4 4 5<br />13 20 6 2<br />3 16 4 5<br />28 5 3 5<br /></pre></div><div class="output"><div class="title">Output</div><pre>-1<br /></pre></div></div></div></div><p>  </p></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=E]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
    </div>

    <div id="footer">
        <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2024 Mike Mirzayanov</div>
        <div>The only programming contests Web 2.0 platform</div>

    </div>

</div>
</div>
    <script type="application/javascript">
        if ('serviceWorker' in navigator && 'fetch' in window && 'caches' in window) {
            navigator.serviceWorker.register('/service-worker-64849.js')
                .then(function (registration) {
                    console.log('Service worker registered: ', registration);
                })
                .catch(function (error) {
                    console.log('Registration failed: ', error);
                });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8a0179dc8eee777b',t:'MTcyMDQ1NjQwNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>


<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-743380-5"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-743380-5');
        </script>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="4a4b7e3d9d0a410aba269bcb3ca6fb87"/>
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01"/>

    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery-1.8.3.js"></script>
    <script type="application/javascript">
        window.locale = "en";
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }

        /* Protection against trailing dot in domain. */
        let hostLength = window.location.host.length;
        if (hostLength > 1 && window.location.host[hostLength - 1] === '.') {
            window.location = window.location.protocol + "//" + window.location.host.substring(0, hostLength - 1);
        }
    </script>

    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="k1">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="//codeforces.org/s/64849/images/codeforces-sponsored-by-ton.png" />
    <link rel="image_src" href="//codeforces.org/s/64849/images/codeforces-sponsored-by-ton.png" />
    <meta property="og:title" content="Problems - Codeforces"/>
    <meta property="og:description" content=""/>
    
    <meta property="og:site_name" content="Codeforces"/>
    
    
    
    
    
    
    <meta name="utc_offset" content="+03:00"/>
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Problems - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community" />
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup" />
    <meta name="robots" content="index, follow" />

    <link rel="stylesheet" href="//codeforces.org/s/64849/css/font-awesome.min.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/line-awesome.min.css" type="text/css" charset="utf-8" />

        <link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>


    <link rel="apple-touch-icon" sizes="57x57" href="//codeforces.org/s/64849/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="//codeforces.org/s/64849/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="//codeforces.org/s/64849/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="//codeforces.org/s/64849/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="//codeforces.org/s/64849/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="//codeforces.org/s/64849/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="//codeforces.org/s/64849/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="//codeforces.org/s/64849/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="//codeforces.org/s/64849/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="//codeforces.org/s/64849/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="//codeforces.org/s/64849/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="//codeforces.org/s/64849/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="//codeforces.org/s/64849/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="//codeforces.org/s/64849/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/prettify.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/clear.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/ttypography.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/problem-statement.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/second-level-menu.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/roundbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/datatable.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/table-form.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/topic.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/jquery.jgrowl.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/facebox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/jquery.wysiwyg.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/jquery.autocomplete.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/codeforces.datepick.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/colorbox.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/css/jquery.drafts.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/64849/css/community.css" type="text/css" charset="utf-8" />
        <link rel="stylesheet" href="//codeforces.org/s/64849/css/sidebar-menu.css" type="text/css" charset="utf-8" />

    <!-- MathJax -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    MathJax.Hub.Register.StartupHook("End", function () {
        Codeforces.runMathJaxListeners();
    });
    </script>
    <script type="text/javascript" async
            src="https://mathjax.codeforces.org/MathJax.js?config=TeX-AMS_HTML-full"
    >
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="//codeforces.org/s/64849/js/prettify/prettify.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/pushstream.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.easing.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.swipe.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.hotkeys.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/facebox.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/controls/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/controls/wysiwyg.table.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/controls/wysiwyg.image.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/controls/wysiwyg.link.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.datepick.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/jquery.drafts.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/clipboard.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/autosize.min.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/sjcl.js"></script>
    <script type="text/javascript" src="/scripts/f8f695306b4bab3cbdd456143062ab76/en/codeforces-options.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/codeforces.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/EventCatcher.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/preparedVerdictFormats-en.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/js/confetti.min.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="//codeforces.org/s/64849/markitup/skins/markitup/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="//codeforces.org/s/64849/markitup/sets/markdown/style.css" type="text/css" charset="utf-8" />


    <script type="text/javascript" src="//codeforces.org/s/64849/markitup/jquery.markitup.js"></script>
    <script type="text/javascript" src="//codeforces.org/s/64849/markitup/sets/markdown/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->




</head>
<body class=" "><span style='display:none;' class='csrf-token' data-csrf='4a4b7e3d9d0a410aba269bcb3ca6fb87'>&nbsp;</span>

<!-- .notificationTextCleaner used in Codeforces.showAnnouncements() -->
<div class="notificationTextCleaner" style="font-size: 0"></div>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 3.0rem;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    String.prototype.hashCode = function() {
        var hash = 0, i, chr;
        if (this.length === 0) return hash;
        for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };

    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile === "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>





    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 700
        });
    }, 100);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


    function showAnnouncements(json) {
        //info("j=" + JSON.stringify(json));

        if (json.t != "a") {
            return;
        }

        setTimeout(function() {
            Codeforces.showAnnouncements(json.d, "en");
        }, Math.random() * 500);
    }

    function showEventCatcherUserMessage(json) {
        if (json.t == "s") {
            var points = json.d[5];
            var passedTestCount = json.d[7];
            var judgedTestCount = json.d[8];
            var verdict = preparedVerdictFormats[json.d[12]];
            var verdictPrototypeDiv = $(".verdictPrototypeDiv");
            verdictPrototypeDiv.html(verdict);
            if (judgedTestCount != null && judgedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-judged").text(judgedTestCount);
            }
            if (passedTestCount != null && passedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-passed").text(passedTestCount);
            }
            if (points != null && points != undefined) {
                verdictPrototypeDiv.find(".verdict-format-points").text(points);
            }
            Codeforces.showMessage(verdictPrototypeDiv.text());
        }
    }

    $(".clickable-title").each(function() {
        var title = $(this).attr("data-title");
        if (title) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = title;
            $(this).attr("title", tmp.textContent || tmp.innerText || "");
        }
    });

    $(".clickable-title").click(function() {
        var title = $(this).attr("data-title");
        if (title) {
            Codeforces.alert(title);
        } else {
            Codeforces.alert($(this).attr("title"));
        }
    }).css("position", "relative").css("bottom", "3px");

        Codeforces.showDelayedMessage();

    Codeforces.reformatTimes();

    //Codeforces.initializePubSub();
    if (window.codeforcesOptions.subscribeServerUrl) {
        window.eventCatcher = new EventCatcher(
            window.codeforcesOptions.subscribeServerUrl,
            [
                Codeforces.getGlobalChannel(),
                Codeforces.getUserChannel(),
                Codeforces.getUserShowMessageChannel(),
                Codeforces.getContestChannel(),
                Codeforces.getParticipantChannel(),
                Codeforces.getTalkChannel()
            ]
        );

        if (Codeforces.getParticipantChannel()) {
            window.eventCatcher.subscribe(Codeforces.getParticipantChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getContestChannel()) {
            window.eventCatcher.subscribe(Codeforces.getContestChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getGlobalChannel()) {
            window.eventCatcher.subscribe(Codeforces.getGlobalChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserShowMessageChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserShowMessageChannel(), function(json) {
                showEventCatcherUserMessage(json);
            });
        }
    }

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>


<div id="body">
<div style="width: 950px; margin: 0 auto;" class="compact-problemset">
    <div id="header" style="position: relative; margin: 0;">
        <div style="float:left;">
                  <a href="/"><img height="65" style="height: 65px;" src="//codeforces.org/s/64849/images/codeforces-sponsored-by-ton.png" alt="Codeforces"/></a>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="//codeforces.org/s/64849/images/flags/24/gb.png" title="In English" alt="In English"/></a>
                <a href="?locale=ru"><img src="//codeforces.org/s/64849/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
            </div>
        </div>
        <br style="clear: both;"/>
    </div>

    <br style="clear: both;"/>

    <div style="text-align: center; font-size: 1.8rem; margin-bottom: 0.5em;"
         class="caption">Codeforces Round 286 (Div. 1)</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

    <div class="problem-frames">
        <div
                    style="margin-bottom: 2em;"
        >

    <style>
        #facebox .content:has(.diff-popup) {
            width: 90vw;
            max-width: 120rem !important;
        }

        .testCaseMarker {
            position: absolute;
            font-weight: bold;
            font-size: 1rem;
        }

        .diff-popup {
            width: 90vw;
            max-width: 120rem !important;
            display: none;
            overflow: auto;
        }

        .input-output-copier {
            font-size: 1.2rem;
            float: right;
            color: #888 !important;
            cursor: pointer;
            border: 1px solid rgb(185, 185, 185);
            padding: 3px;
            margin: 1px;
            line-height: 1.1rem;
            text-transform: none;
        }

        .input-output-copier:hover {
            background-color: #def;
        }

        .test-explanation textarea {
            width: 100%;
            height: 1.5em;
        }

        .pending-submission-message {
            color: darkorange !important;
        }
    </style>
    <script>
        const OPENING_SPACE = String.fromCharCode(1001);
        const CLOSING_SPACE = String.fromCharCode(1002);

        const nodeToText = function (node, pre) {
            let result = [];

            if (node.tagName === "SCRIPT" || node.tagName === "math"
                || (node.classList && node.classList.contains("input-output-copier")))
                return [];

            if (node.tagName === "NOBR") {
                result.push(OPENING_SPACE);
            }

            if (node.nodeType === Node.TEXT_NODE) {
                let s = node.textContent;
                if (!pre) {
                    s = s.replace(/\s+/g, " ");
                }
                if (s.length > 0) {
                    result.push(s);
                }
            }

            if (pre && node.tagName === "BR") {
                result.push("\n");
            }

            node.childNodes.forEach(function (child) {
                result.push(nodeToText(child, node.tagName === "PRE").join(""));
            });

            if (node.tagName === "DIV"
                || node.tagName === "P"
                || node.tagName === "PRE"
                || node.tagName === "UL"
                || node.tagName === "LI"
            ) {
                result.push("\n");
            }

            if (node.tagName === "NOBR") {
                result.push(CLOSING_SPACE);
            }

            return result;
        }

        const isSpecial = function (c) {
            return c === ',' || c === '.' || c === ';' || c === ')' || c === ' ';
        }

        const convertStatementToText = function(statmentNode) {
            const text = nodeToText(statmentNode, false).join("").replace(/ +/g, " ").replace(/\n\n+/g, "\n\n");
            let result = [];
            for (let i = 0; i < text.length; i++) {
                const c = text.charAt(i);
                if (c === OPENING_SPACE) {
                    if (!((i > 0 && text.charAt(i - 1) === '(') || (result.length > 0 && result[result.length - 1] === ' '))) {
                        result.push('+');
                    }
                } else if (c === CLOSING_SPACE) {
                    if (!(i + 1 < text.length && isSpecial(text.charAt(i + 1)))) {
                        result.push('-');
                    }
                } else {
                    result.push(c);
                }
            }
            return result.join("").split("\n").map(value => value.trim()).join("\n");
        };
    </script>
    <div class="diff-popup">
    </div>

<div class="problemindexholder" problemindex="A" data-uuid="ps_4a18e8adc28b78b7cd1dffd9343cdb47a368c887">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A. Mr. Kitayuta, the Treasure Hunter</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div class="legend"><p>The Shuseki Islands are an archipelago of <span class="tex-span">30001</span> small islands in the Yutampo Sea. The islands are evenly spaced along a line, numbered from <span class="tex-span">0</span> to <span class="tex-span">30000</span> from the west to the east. These islands are known to contain many treasures. There are <span class="tex-span"><i>n</i></span> gems in the Shuseki Islands in total, and the <span class="tex-span"><i>i</i></span>-th gem is located on island <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub></span>.</p><p>Mr. Kitayuta has just arrived at island <span class="tex-span">0</span>. With his great jumping ability, he will repeatedly perform jumps between islands to the east according to the following process: </p><ul> <li> First, he will jump from island <span class="tex-span">0</span> to island <span class="tex-span"><i>d</i></span>. </li><li> After that, he will continue jumping according to the following rule. Let <span class="tex-span"><i>l</i></span> be the length of the previous jump, that is, if his previous jump was from island <span class="tex-span"><i>prev</i></span> to island <span class="tex-span"><i>cur</i></span>, let <span class="tex-span"><i>l</i> = <i>cur</i> - <i>prev</i></span>. He will perform a jump of length <span class="tex-span"><i>l</i> - 1</span>, <span class="tex-span"><i>l</i></span> or <span class="tex-span"><i>l</i> + 1</span> to the east. That is, he will jump to island <span class="tex-span">(<i>cur</i> + <i>l</i> - 1)</span>, <span class="tex-span">(<i>cur</i> + <i>l</i>)</span> or <span class="tex-span">(<i>cur</i> + <i>l</i> + 1)</span> (if they exist). The length of a jump must be positive, that is, he cannot perform a jump of length <span class="tex-span">0</span> when <span class="tex-span"><i>l</i> = 1</span>. If there is no valid destination, he will stop jumping. </li></ul><p></p><p>Mr. Kitayuta will collect the gems on the islands visited during the process. Find the maximum number of gems that he can collect.</p></div><p></p><p></p><div class="input-specification"><div class="section-title">Input</div><p></p><p>The first line of the input contains two space-separated integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>d</i></span> (<span class="tex-span">1 ≤ <i>n</i>, <i>d</i> ≤ 30000</span>), denoting the number of the gems in the Shuseki Islands and the length of the Mr. Kitayuta's first jump, respectively.</p><p>The next <span class="tex-span"><i>n</i></span> lines describe the location of the gems. The <span class="tex-span"><i>i</i></span>-th of them (<span class="tex-span">1 ≤ <i>i</i> ≤ <i>n</i></span>) contains a integer <span class="tex-span"><i>p</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span"><i>d</i> ≤ <i>p</i><sub class="lower-index">1</sub> ≤ <i>p</i><sub class="lower-index">2</sub> ≤ ... ≤ <i>p</i><sub class="lower-index"><i>n</i></sub> ≤ 30000</span>), denoting the number of the island that contains the <span class="tex-span"><i>i</i></span>-th gem.</p></div><p></p><p></p><div class="output-specification"><div class="section-title">Output</div><p></p><p>Print the maximum number of gems that Mr. Kitayuta can collect.</p></div><p></p><p></p><div class="sample-tests"><div class="section-title">Examples</div><p></p><p></p><div class="sample-test"><div class="input"><div class="title">Input</div><pre class="content">4 10<br />10<br />21<br />27<br />27<br /></pre></div><div class="output"><div class="title">Output</div><pre class="content">3<br /></pre></div><div class="input"><div class="title">Input</div><pre class="content">8 8<br />9<br />19<br />28<br />36<br />45<br />55<br />66<br />78<br /></pre></div><div class="output"><div class="title">Output</div><pre class="content">6<br /></pre></div><div class="input"><div class="title">Input</div><pre class="content">13 7<br />8<br />8<br />9<br />16<br />17<br />17<br />18<br />21<br />23<br />24<br />24<br />26<br />30<br /></pre></div><div class="output"><div class="title">Output</div><pre class="content">4<br /></pre></div></div></div><p></p><p></p><div class="note"><div class="section-title">Note</div><p></p><p>In the first sample, the optimal route is 0 <span class="tex-span"> → </span> 10 (+1 gem) <span class="tex-span"> → </span> 19 <span class="tex-span"> → </span> 27 (+2 gems) <span class="tex-span"> → ...&#x1;</span></p><p>In the second sample, the optimal route is 0 <span class="tex-span"> → </span> 8 <span class="tex-span"> → </span> 15 <span class="tex-span"> → </span> 21<span class="tex-span"> → </span> 28 (+1 gem) <span class="tex-span"> → </span> 36 (+1 gem) <span class="tex-span"> → </span> 45 (+1 gem) <span class="tex-span"> → </span> 55 (+1 gem) <span class="tex-span"> → </span> 66 (+1 gem) <span class="tex-span"> → </span> 78 (+1 gem) <span class="tex-span"> → ...</span></p><p>In the third sample, the optimal route is 0 <span class="tex-span"> → </span> 7 <span class="tex-span"> → </span> 13 <span class="tex-span"> → </span> 18 (+1 gem) <span class="tex-span"> → </span> 24 (+2 gems) <span class="tex-span"> → </span> 30 (+1 gem) <span class="tex-span"> → ...</span></p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=A]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {
        window.changedTests = new Set();

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");



        String.prototype.replaceAll = function (search, replace) {
            return this.split(search).join(replace);
        };

        $(".sample-test .title").each(function () {
            const preId = ("id" + Math.random()).replaceAll(".", "0");
            const cpyId = ("id" + Math.random()).replaceAll(".", "0");

            $(this).parent().find("pre").attr("id", preId);
            const $copy = $("<div title='Copy' data-clipboard-target='#" + preId + "' id='" + cpyId + "' class='input-output-copier'>Copy</div>");
            $(this).append($copy);

            const clipboard = new Clipboard('#' + cpyId, {
                text: function (trigger) {
                    const pre = document.querySelector('#' + preId);
                    const lines = pre.querySelectorAll(".test-example-line");
                    return Codeforces.filterClipboardText(pre.innerText, lines.length);
                }
            });

            const isInput = $(this).parent().hasClass("input");

            clipboard.on('success', function (e) {
                if (isInput) {
                    Codeforces.showMessage("The example input has been copied into the clipboard");
                } else {
                    Codeforces.showMessage("The example output has been copied into the clipboard");
                }
                e.clearSelection();
            });
        });

        $(".test-form-item input").change(function () {
            addPendingSubmissionMessage($($(this).closest("form")), "You changed the answer, do not forget to submit it if you want to save the changes");
            const index = $(this).closest(".problemindexholder").attr("problemindex");
            let test = "";
            $(this).closest("form input").each(function () {
                const test_ = $(this).attr("name");
                if (test_ && test_.substring(0, 4) === "test") {
                    test = test_;
                }
            });
            if (index.length > 0 && test.length > 0) {
                const indexTest = index + "::" + test;
                window.changedTests.add(indexTest);
            }
        });

        $(window).on('beforeunload', function () {
            if (window.changedTests.size > 0) {
                return 'Dialog text here';
            }
        });

        autosize($('.test-explanation textarea'));

        $(".test-example-line").hover(function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        let top = 1E20;
                        let left = 1E20;
                        let problem = $(this).closest(".problemindexholder");
                        $(this).closest(".input").find("." + clazz).css("background-color", "#FFFDE7").each(function() {
                            top = Math.min(top, $(this).offset().top);
                            left = Math.min(left, $(this).offset().left);
                        });
                        let testCaseMarker = problem.find(".testCaseMarker_" + end);
                        if (testCaseMarker.length === 0) {
                            const html = "<div class=\"testCaseMarker testCaseMarker_" + end + " notice\"></div>";
                            problem.append($(html));
                            testCaseMarker = problem.find(".testCaseMarker_" + end);
                        }
                        if (testCaseMarker) {
                            testCaseMarker.show()
                                    .offset({top, left: left - 20})
                                    .text(end);
                        }
                    }
                }
            });
        }, function() {
            $(this).attr("class").split(" ").forEach((clazz) => {
                if (clazz.substr(0, "test-example-line-".length) === "test-example-line-") {
                    let end = clazz.substr("test-example-line-".length);
                    if (end !== "even" && end !== "odd" && end !== "0") {
                        $("." + clazz).css("background-color", "");
                        $(this).closest(".problemindexholder").find(".testCaseMarker_" + end).hide();
                    }
                }
            });
        });

    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="B" data-uuid="ps_d3af7f1140a9b8bacd31242c7946b9ae9461c3f6">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B. Mr. Kitayuta's Technology</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Shuseki Kingdom is the world's leading nation for innovation and technology. There are <span class="tex-span"><i>n</i></span> cities in the kingdom, numbered from <span class="tex-span">1</span> to <span class="tex-span"><i>n</i></span>.</p><p>Thanks to Mr. Kitayuta's research, it has finally become possible to construct teleportation pipes between two cities. A teleportation pipe will connect two cities unidirectionally, that is, a teleportation pipe from city <span class="tex-span"><i>x</i></span> to city <span class="tex-span"><i>y</i></span> cannot be used to travel from city <span class="tex-span"><i>y</i></span> to city <span class="tex-span"><i>x</i></span>. The transportation within each city is extremely developed, therefore if a pipe from city <span class="tex-span"><i>x</i></span> to city <span class="tex-span"><i>y</i></span> and a pipe from city <span class="tex-span"><i>y</i></span> to city <span class="tex-span"><i>z</i></span> are both constructed, people will be able to travel from city <span class="tex-span"><i>x</i></span> to city <span class="tex-span"><i>z</i></span> instantly.</p><p>Mr. Kitayuta is also involved in national politics. He considers that the transportation between the <span class="tex-span"><i>m</i></span> pairs of city <span class="tex-span">(<i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub>)</span> (<span class="tex-span">1 ≤ <i>i</i> ≤ <i>m</i></span>) is important. He is planning to construct teleportation pipes so that for each important pair <span class="tex-span">(<i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub>)</span>, it will be possible to travel from city <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> to city <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> by using one or more teleportation pipes (but not necessarily from city <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> to city <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>). Find the minimum number of teleportation pipes that need to be constructed. So far, no teleportation pipe has been constructed, and there is no other effective transportation between cities.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains two space-separated integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>m</i></span> (<span class="tex-span">2 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup>, 1 ≤ <i>m</i> ≤ 10<sup class="upper-index">5</sup></span>), denoting the number of the cities in Shuseki Kingdom and the number of the important pairs, respectively.</p><p>The following <span class="tex-span"><i>m</i></span> lines describe the important pairs. The <span class="tex-span"><i>i</i></span>-th of them (<span class="tex-span">1 ≤ <i>i</i> ≤ <i>m</i></span>) contains two space-separated integers <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i>, <i>a</i><sub class="lower-index"><i>i</i></sub> ≠ <i>b</i><sub class="lower-index"><i>i</i></sub></span>), denoting that it must be possible to travel from city <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> to city <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> by using one or more teleportation pipes (but not necessarily from city <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> to city <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>). It is guaranteed that all pairs <span class="tex-span">(<i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub>)</span> are distinct.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print the minimum required number of teleportation pipes to fulfill Mr. Kitayuta's purpose.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>4 5<br />1 2<br />1 3<br />1 4<br />2 3<br />2 4<br /></pre></div><div class="output"><div class="title">Output</div><pre>3<br /></pre></div><div class="input"><div class="title">Input</div><pre>4 6<br />1 2<br />1 4<br />2 3<br />2 4<br />3 2<br />3 4<br /></pre></div><div class="output"><div class="title">Output</div><pre>4<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>For the first sample, one of the optimal ways to construct pipes is shown in the image below: </p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/618cff5d9c222bba4f60450cbc8c588c25c34c29.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center><p>For the second sample, one of the optimal ways is shown below: </p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/cddc1aebdb5e47e666b506b6067586942fae37ba.png" style="max-width: 100.0%;max-height: 100.0%;" /> </center></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=B]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="C" data-uuid="ps_79bd2913e35edf13421a4f62ba0b4ef24ad325a4">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C. Mr. Kitayuta vs. Bamboos</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Mr. Kitayuta's garden is planted with <span class="tex-span"><i>n</i></span> bamboos. (Bamboos are tall, fast-growing tropical plants with hollow stems.) At the moment, the height of the <span class="tex-span"><i>i</i></span>-th bamboo is <span class="tex-span"><i>h</i><sub class="lower-index"><i>i</i></sub></span> meters, and it grows <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> meters at the end of each day. </p><p>Actually, Mr. Kitayuta hates these bamboos. He once attempted to cut them down, but failed because their stems are too hard. Mr. Kitayuta have not given up, however. He has crafted Magical Hammer with his intelligence to drive them into the ground.</p><p>He can use Magical Hammer at most <span class="tex-span"><i>k</i></span> times during each day, due to his limited Magic Power. Each time he beat a bamboo with Magical Hammer, its height decreases by <span class="tex-span"><i>p</i></span> meters. If the height would become negative by this change, it will become <span class="tex-span">0</span> meters instead (it does not disappear). In other words, if a bamboo whose height is <span class="tex-span"><i>h</i></span> meters is beaten with Magical Hammer, its new height will be <span class="tex-span"><i>max</i>(0, <i>h</i> - <i>p</i>)</span> meters. It is possible to beat the same bamboo more than once in a day.</p><p>Mr. Kitayuta will fight the bamboos for <span class="tex-span"><i>m</i></span> days, starting today. His purpose is to minimize the height of the tallest bamboo after <span class="tex-span"><i>m</i></span> days (that is, <span class="tex-span"><i>m</i></span> iterations of &quot;Mr. Kitayuta beats the bamboos and then they grow&quot;). Find the lowest possible height of the tallest bamboo after <span class="tex-span"><i>m</i></span> days.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of the input contains four space-separated integers <span class="tex-span"><i>n</i></span>, <span class="tex-span"><i>m</i></span>, <span class="tex-span"><i>k</i></span> and <span class="tex-span"><i>p</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup>, 1 ≤ <i>m</i> ≤ 5000, 1 ≤ <i>k</i> ≤ 10, 1 ≤ <i>p</i> ≤ 10<sup class="upper-index">9</sup></span>). They represent the number of the bamboos in Mr. Kitayuta's garden, the duration of Mr. Kitayuta's fight in days, the maximum number of times that Mr. Kitayuta beat the bamboos during each day, and the power of Magic Hammer, respectively.</p><p>The following <span class="tex-span"><i>n</i></span> lines describe the properties of the bamboos. The <span class="tex-span"><i>i</i></span>-th of them (<span class="tex-span">1 ≤ <i>i</i> ≤ <i>n</i></span>) contains two space-separated integers <span class="tex-span"><i>h</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">0 ≤ <i>h</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup>, 1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>), denoting the initial height and the growth rate of the <span class="tex-span"><i>i</i></span>-th bamboo, respectively.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print the lowest possible height of the tallest bamboo after <span class="tex-span"><i>m</i></span> days.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3 1 2 5<br />10 10<br />10 10<br />15 2<br /></pre></div><div class="output"><div class="title">Output</div><pre>17<br /></pre></div><div class="input"><div class="title">Input</div><pre>2 10 10 1000000000<br />0 10<br />0 10<br /></pre></div><div class="output"><div class="title">Output</div><pre>10<br /></pre></div><div class="input"><div class="title">Input</div><pre>5 3 3 10<br />9 5<br />9 2<br />4 7<br />9 10<br />3 8<br /></pre></div><div class="output"><div class="title">Output</div><pre>14<br /></pre></div></div></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=C]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 2em;"
        >


<div class="problemindexholder" problemindex="D" data-uuid="ps_5516f9148bb67c95cf7aead1940f1f128df7454d">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. Mr. Kitayuta's Colorful Graph</div><div class="time-limit"><div class="property-title">time limit per test</div>4 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Mr. Kitayuta has just bought an undirected graph with <span class="tex-span"><i>n</i></span> vertices and <span class="tex-span"><i>m</i></span> edges. The vertices of the graph are numbered from 1 to <span class="tex-span"><i>n</i></span>. Each edge, namely edge <span class="tex-span"><i>i</i></span>, has a color <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span>, connecting vertex <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span>.</p><p>Mr. Kitayuta wants you to process the following <span class="tex-span"><i>q</i></span> queries.</p><p>In the <span class="tex-span"><i>i</i></span>-th query, he gives you two integers - <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span>.</p><p>Find the number of the colors that satisfy the following condition: the edges of that color connect vertex <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub></span> and vertex <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span> directly or indirectly.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of the input contains space-separated two integers - <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>m</i>(2 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup>, 1 ≤ <i>m</i> ≤ 10<sup class="upper-index">5</sup>)</span>, denoting the number of the vertices and the number of the edges, respectively.</p><p>The next <span class="tex-span"><i>m</i></span> lines contain space-separated three integers - <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub>(1 ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> &lt; <i>b</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i>)</span> and <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub>(1 ≤ <i>c</i><sub class="lower-index"><i>i</i></sub> ≤ <i>m</i>)</span>. Note that there can be multiple edges between two vertices. However, there are no multiple edges of the same color between two vertices, that is, if <span class="tex-span"><i>i</i> ≠ <i>j</i>, (<i>a</i><sub class="lower-index"><i>i</i></sub>, <i>b</i><sub class="lower-index"><i>i</i></sub>, <i>c</i><sub class="lower-index"><i>i</i></sub>) ≠ (<i>a</i><sub class="lower-index"><i>j</i></sub>, <i>b</i><sub class="lower-index"><i>j</i></sub>, <i>c</i><sub class="lower-index"><i>j</i></sub>)</span>.</p><p>The next line contains a integer- <span class="tex-span"><i>q</i>(1 ≤ <i>q</i> ≤ 10<sup class="upper-index">5</sup>)</span>, denoting the number of the queries.</p><p>Then follows <span class="tex-span"><i>q</i></span> lines, containing space-separated two integers - <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub>(1 ≤ <i>u</i><sub class="lower-index"><i>i</i></sub>, <i>v</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i>)</span>. It is guaranteed that <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub> ≠ <i>v</i><sub class="lower-index"><i>i</i></sub></span>.</p></div><div class="output-specification"><div class="section-title">Output</div><p>For each query, print the answer in a separate line.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>4 5<br />1 2 1<br />1 2 2<br />2 3 1<br />2 3 3<br />2 4 3<br />3<br />1 2<br />3 4<br />1 4<br /></pre></div><div class="output"><div class="title">Output</div><pre>2<br />1<br />0<br /></pre></div><div class="input"><div class="title">Input</div><pre>5 7<br />1 5 1<br />2 5 1<br />3 5 1<br />4 5 1<br />1 2 2<br />2 3 2<br />3 4 2<br />5<br />1 5<br />5 1<br />2 5<br />1 5<br />1 4<br /></pre></div><div class="output"><div class="title">Output</div><pre>1<br />1<br />1<br />1<br />2<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Let's consider the first sample. </p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/8f43ac5327ccc8fd7e1c3b3f0f085d87e9391d78.png" style="max-width: 100.0%;max-height: 100.0%;" />   The figure above shows the first sample. </center> <ul> <li> Vertex <span class="tex-span">1</span> and vertex <span class="tex-span">2</span> are connected by color <span class="tex-span">1</span> and <span class="tex-span">2</span>. </li><li> Vertex <span class="tex-span">3</span> and vertex <span class="tex-span">4</span> are connected by color <span class="tex-span">3</span>. </li><li> Vertex <span class="tex-span">1</span> and vertex <span class="tex-span">4</span> are not connected by any single color. </li></ul></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=D]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
        <div
                    style="margin-bottom: 1em;"
        >


<div class="problemindexholder" problemindex="E" data-uuid="ps_36010bfc9e5d9eec1ce39385811c4b98214e1656">
    <div style="display: none; margin:1em 0;text-align: center; position: relative;" class="alert alert-info diff-notifier">
        <div>The problem statement has recently been changed. <a class="view-changes" href="#">View the changes.</a></div>
        <span class="diff-notifier-close" style="position: absolute; top: 0.2em; right: 0.3em; cursor: pointer; font-size: 1.4em;">&times;</span>
    </div>
        <div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. Mr. Kitayuta's Gift</div><div class="time-limit"><div class="property-title">time limit per test</div>6 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>768 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Mr. Kitayuta has kindly given you a string <span class="tex-span"><i>s</i></span> consisting of lowercase English letters. You are asked to insert exactly <span class="tex-span"><i>n</i></span> lowercase English letters into <span class="tex-span"><i>s</i></span> to make it a palindrome. (A <span class="tex-font-style-it">palindrome</span> is a string that reads the same forward and backward. For example, &quot;<span class="tex-font-style-tt">noon</span>&quot;, &quot;<span class="tex-font-style-tt">testset</span>&quot; and &quot;<span class="tex-font-style-tt">a</span>&quot; are all palindromes, while &quot;<span class="tex-font-style-tt">test</span>&quot; and &quot;<span class="tex-font-style-tt">kitayuta</span>&quot; are not.) You can choose any <span class="tex-span"><i>n</i></span> lowercase English letters, and insert each of them to any position of <span class="tex-span"><i>s</i></span>, possibly to the beginning or the end of <span class="tex-span"><i>s</i></span>. You have to insert exactly <span class="tex-span"><i>n</i></span> letters even if it is possible to turn <span class="tex-span"><i>s</i></span> into a palindrome by inserting less than <span class="tex-span"><i>n</i></span> letters.</p><p>Find the number of the palindromes that can be obtained in this way, modulo <span class="tex-span">10007</span>.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains a string <span class="tex-span"><i>s</i></span> (<span class="tex-span">1 ≤ |<i>s</i>| ≤ 200</span>). Each character in <span class="tex-span"><i>s</i></span> is a lowercase English letter.</p><p>The second line contains an integer <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 10<sup class="upper-index">9</sup></span>).</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print the number of the palindromes that can be obtained, modulo <span class="tex-span">10007</span>.</p></div><div class="sample-tests"><div class="section-title">Examples</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>revive<br />1<br /></pre></div><div class="output"><div class="title">Output</div><pre>1<br /></pre></div><div class="input"><div class="title">Input</div><pre>add<br />2<br /></pre></div><div class="output"><div class="title">Output</div><pre>28<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>For the first sample, you can obtain the palindrome &quot;<span class="tex-font-style-tt">reviver</span>&quot; by inserting '<span class="tex-font-style-tt">r</span>' to the end of &quot;<span class="tex-font-style-tt">revive</span>&quot;.</p><p>For the second sample, the following 28 palindromes can be obtained: &quot;<span class="tex-font-style-tt">adada</span>&quot;, &quot;<span class="tex-font-style-tt">adbda</span>&quot;, ..., &quot;<span class="tex-font-style-tt">adzda</span>&quot;, &quot;<span class="tex-font-style-tt">dadad</span>&quot; and &quot;<span class="tex-font-style-tt">ddadd</span>&quot;.</p></div></div></div>
</div>

    <script>
        $(function () {
            Codeforces.addMathJaxListener(function () {
                let $problem = $("div[problemindex=E]");
                let uuid = $problem.attr("data-uuid");
                let statementText = convertStatementToText($problem.find(".ttypography").get(0));

                let previousStatementText = Codeforces.getFromStorage(uuid);
                if (previousStatementText) {
                    if (previousStatementText !== statementText) {
                        $problem.find(".diff-notifier").show();

                        $problem.find(".diff-notifier-close").click(function() {
                            Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                            $problem.find(".diff-notifier").hide();
                        });

                        $problem.find("a.view-changes").click(function() {
                            $.post("/data/diff", {action: "getDiff", a: previousStatementText, b: statementText}, function (result) {
                                if (result["success"] === "true") {
                                    Codeforces.facebox(".diff-popup", "//codeforces.org/s/64849");
                                    $("#facebox .diff-popup").html(result["diff"]);
                                }
                            }, "json");
                        });
                    }
                } else {
                    Codeforces.putToStorageTtl(uuid, statementText, 6 * 60 * 60);
                }
            });
        });
    </script>


<script type="text/javascript">
    $(document).ready(function () {

        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        const inputFileDiv = $("div.input-file");
        const inputFile = inputFileDiv.text();
        const outputFileDiv = $("div.output-file");
        const outputFile = outputFileDiv.text();


        if (!endsWith(inputFile, "standard input")
            && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")
            && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        const titleDiv = $("div.header div.title");




    });
</script>
        </div>
    </div>

    <div id="footer">
        <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2024 Mike Mirzayanov</div>
        <div>The only programming contests Web 2.0 platform</div>

    </div>

</div>
</div>
    <script type="application/javascript">
        if ('serviceWorker' in navigator && 'fetch' in window && 'caches' in window) {
            navigator.serviceWorker.register('/service-worker-64849.js')
                .then(function (registration) {
                    console.log('Service worker registered: ', registration);
                })
                .catch(function (error) {
                    console.log('Registration failed: ', error);
                });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8a012874a8ae7787',t:'MTcyMDQ1MzA3Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
